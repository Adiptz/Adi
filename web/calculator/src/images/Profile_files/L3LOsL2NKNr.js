if (self.CavalryLogger) { CavalryLogger.start_js(["LxOOK"]); }

__d("RTWebCallWindowOpener",["requireCond","cr:1099565"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:1099565")}),null);
__d("ZenonCallInviteModel",["BaseEventEmitter","FBLogger","gkx"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$ZenonCallInviteModel3=function(a){b("FBLogger")("rtc_www").info("Received cancel for: ",a.ringID);if(d.__currentRequest&&d.__currentRequest.model&&d.__currentRequest.model.ringID===a.ringID)switch(a.reason){case"hangup":d.__currentRequest.model=babelHelpers["extends"]({},d.__currentRequest.model,{type:"missed"});d.emit("callInvite",d.__currentRequest.model);break;default:d.dismiss();break}};d.$ZenonCallInviteModel2=function(a){var c;b("FBLogger")("rtc_www").info("Receiving ring: ",a.ringID);if(((c=d.__currentRequest)==null?void 0:(c=c.model)==null?void 0:c.type)==="ringing"){if(((c=d.__currentRequest)==null?void 0:(c=c.model)==null?void 0:c.ringID)!==a.ringID&&b("gkx")("1434282")){a.onDecline("InAnotherCall");b("FBLogger")("rtc_www").info("Sending InAnotherCall to ring: ",a.ringID,"Current ring: ",(c=d.__currentRequest)==null?void 0:(c=c.model)==null?void 0:c.ringID)}}else d.__currentRequest={model:{context:a.context,controllerParams:a.controllerParams,inviterID:a.inviterID,participants:a.otherParticipants,requestingVideo:a.requestingVideo,ringID:a.ringID,type:a.isClientPermissableRing?"ringing":"unsupported_browser"},ringPayload:a},d.emit("callInvite",d.__currentRequest.model),a.isClientPermissableRing||a.onDecline("VersionUnsupported")};d.__eventSource=c;d.__currentRequest=null;return d}var d=c.prototype;d.getCurrentInvite=function(){var a;return(a=(a=this.__currentRequest)==null?void 0:a.model)!=null?a:null};d.startListening=function(a){a=a.callsBlocked;this.__currentRequest&&this.dismiss();this.stopListening();a?this.__eventSource.addListener("incomingRing",this.$ZenonCallInviteModel1):(this.__eventSource.addListener("incomingRing",this.$ZenonCallInviteModel2),this.__eventSource.addListener("ringCancel",this.$ZenonCallInviteModel3))};d.stopListening=function(){this.__eventSource.removeAllListeners("incomingRing"),this.__eventSource.removeAllListeners("ringCancel"),this.__currentRequest=null};d.dismiss=function(){var a;b("FBLogger")("rtc_www").info("Dismissing ring: ",(a=this.__currentRequest)==null?void 0:(a=a.model)==null?void 0:a.ringID);this.__currentRequest=null;this.emit("callInvite",Object.freeze(null))};d.accept=function(a,c){var d=this.__currentRequest;if(d){var e;b("FBLogger")("rtc_www").info("Accepting ring: ",(e=d.model)==null?void 0:e.ringID);((e=d.model)==null?void 0:e.type)==="ringing"&&d.ringPayload.onAccept(a,c);this.dismiss()}};d.decline=function(a,c){a===void 0&&(a="IgnoreCall");var d=this.__currentRequest;if(d){var e;b("FBLogger")("rtc_www").info("Declining ring: ",(e=d.model)==null?void 0:e.ringID);d.ringPayload.onDecline(a,c);this.dismiss();return}};d.$ZenonCallInviteModel1=function(a){b("FBLogger")("rtc_www").info("Blocking ring: ",a.ringID),a.onDecline("IgnoreCall","CallsBlocked")};return c}(b("BaseEventEmitter"));e.exports=a}),null);
__d("delegateZenonCallInviteModel",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a.getCurrentInvite=b.getCurrentInvite.bind(b),a.startListening=b.startListening.bind(b),a.stopListening=b.stopListening.bind(b),a.dismiss=b.dismiss.bind(b),a.accept=b.accept.bind(b),a.decline=b.decline.bind(b),b.addListener("callInvite",function(b){a.emit("callInvite",b)})}e.exports=a}),null);
__d("ZenonCallWindowController",["Promise","FBLogger","ZenonCallWindowErrors"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonCallWindowErrors").OpeningAnotherCallError;a=function(){function a(a,b){var c=b.callWindowInitializerResource,d=b.callWindowOpener;b=b.uriBuilderResource;this.$2=null;this.$3=!1;this.$5=null;this.$1=a;this.$7=b;this.$4=c;this.$6=d}var c=a.prototype;c.initCall=function(a){var c=this;if(this.$3)throw new g();try{if(this.$2&&!this.$2.closed&&a.joinContext.type==="thread"&&this.$2.inCallWith===a.joinContext.thread.id){this.$2.focus();return[this.$2,b("Promise").resolve()]}}catch(a){b("FBLogger")("rtc_www").catching(a).warn("Failed to access inCallWith on call window")}var d=this.$6.openWindow(a);this.$2&&(this.$2.closed||this.$2.close(),this.$2=null);this.$2=d;this.$3=!0;return[d,b("Promise").all([this.$7.load(),this.$4.load()]).then(function(b){var d=b[0];b=b[1];c.$5===null&&(c.$5=new b(c.$1,new d(c.$1)));return c.$5.initCall(c.$2,a)})["finally"](function(){c.$3=!1})]};return a}();e.exports=a}),null);
__d("ZenonCallLogger",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b){var c=this,d;this.$1=[];this.$2={localCallID:a.callID,peerID:a.peerID,sharedCallID:(d=a.serverInfoData)!=null?d:a.callID};b.forEach(function(b){return c.$1.push(new b(a))})}var b=a.prototype;b.log=function(a){this.$1.forEach(function(b){b.processEvent(a)})};b.getLogIdentifiers=function(){return this.$2};return a}();e.exports=a}),null);
__d("ZenonParentCallSummaryLogProcessor",["CurrentUser","FBRTCCallSummaryStore","ZenonCallSummary","ZenonDismissReason","gkx","pageID"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonDismissReason").ZenonDismissReason;a=function(){function a(a){this.$2=b("FBRTCCallSummaryStore").getInstance(),this.$3=a.protocol,this.$3==="mw"&&(a.peerID="MW_PEER_ID"),this.$1=new(b("ZenonCallSummary"))(a)}var c=a.prototype;c.$4=function(a){if(a!=null){a=a.deviceID;a=a==="mobile";this.$1.setIsPeerMobile(a)}};c.processEvent=function(a){switch(a.name){case"inviteResponded":this.$1.onInviteResponded();break;case"inviteReceived":this.$1.onInviteReceived();this.$4(a.remoteDeviceInfo);break;case"callEnded":this.$5(a);break;case"callAccepted":this.$1.onCallAccepted(a.trigger);this.$1.save(this.$2);break;case"popupOpened":this.$6(a);this.$1.save(this.$2);break}};c.$6=function(a){this.$1.setInitByPageID(b("pageID")),this.$1.setInitByAppID(b("CurrentUser").getAppID()),this.$1.onCallEnded(g.CLIENT_ERROR,!1,!0,a.isPopupBlocked?"PopupBlocked":"PopupPending"),this.$1.save(this.$2)};c.$5=function(a){if(this.$3==="mw"&&a.isRemoteEnded)return;var c=a.endCallReason,d=a.endCallSubreason;a=a.isRemoteEnded;var e=b("gkx")("1148995");if(!e&&c===g.OTHER_INSTANCE_HANDLED&&a)return;this.$1.onCallEnded(c,a,!1,d);this.$1.save(this.$2)};return a}();e.exports=a}),null);
__d("ZenonCollisionContext",[],(function(a,b,c,d,e,f){function a(a){var b=null;a.groupThreadID!=null?b={id:a.groupThreadID,type:2}:a.peerID!=null&&(b={id:a.peerID,type:1});return b}e.exports={getThreadIDAndTypeFromCollisionContext:a}}),null);
__d("ZenonParticipantState",[],(function(a,b,c,d,e,f){"use strict";b=Object.freeze({APPROVED:15,CONNECTED:10,CONNECTING:9,CONNECTION_DROPPED:5,CONTACTING:6,DISCONNECTED:1,FAILED_APPROVAL:16,IN_ANOTHER_CALL:12,NEGOTIATING:8,NO_ANSWER:2,PARTICIPANT_LIMIT_REACHED:11,PENDING_APPROVAL:14,REJECTED:3,RINGING:7,RING_TYPE_UNSUPPORTED:13,UNKNOWN:0,UNREACHABLE:4});function a(a){return a==null?"disconnected":g[a]}var g=Object.freeze((c={},c[b.UNKNOWN]="disconnected",c[b.DISCONNECTED]="disconnected",c[b.NO_ANSWER]="disconnected",c[b.REJECTED]="disconnected",c[b.UNREACHABLE]="disconnected",c[b.CONNECTION_DROPPED]="disconnected",c[b.CONTACTING]="contacting",c[b.RINGING]="ringing",c[b.NEGOTIATING]="connecting",c[b.CONNECTING]="connecting",c[b.CONNECTED]="connected",c[b.PARTICIPANT_LIMIT_REACHED]="disconnected",c[b.IN_ANOTHER_CALL]="disconnected",c[b.RING_TYPE_UNSUPPORTED]="disconnected",c[b.PENDING_APPROVAL]="pending_approval",c[b.APPROVED]="approved",c[b.FAILED_APPROVAL]="failed_approval",c));e.exports={ZenonParticipantState:b,toCallParticipantState:a}}),null);
__d("ZenonPlatformExperiments",["gkx","qex"],(function(a,b,c,d,e,f){"use strict";a={isMwpp:function(){return b("gkx")("1273355")},isZenonPlatform:function(){var a;return(a=b("qex")._("1298004"))!=null?a:!1}};e.exports=a}),null);
__d("multiway_Capability",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4,SUPPORT_MWPP:5,REQUIRE_FULL_SDP_IN_SMU:6,SUPPORT_PRECONNECT:7,SUPPORT_MWPP_DEESCALATION:8})}),null);
__d("multiway_DeviceStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10})}),null);
__d("multiway_DismissReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,CALL_ENDED_BY_PRODUCT:9,JOIN_APPROVAL_DENIED:10,JOIN_APPROVAL_TIMEDOUT:11,UNSUPPORTED_VERSION:12,LIVE_NOT_ACKED:13,TX_ACK_TIMEDOUT:14})}),null);
__d("multiway_HangupReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6})}),null);
__d("multiway_MediaPauseStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NotPaused:0,Paused:1})}),null);
__d("multiway_MessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,P2P_PROTOCOL:19,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26})}),null);
__d("multiway_ParticipantCallState",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:0,DISCONNECTED:1,NO_ANSWER:2,REJECTED:3,UNREACHABLE:4,CONNECTION_DROPPED:5,CONTACTING:6,RINGING:7,CONNECTING:8,CONNECTED:9,PARTICIPANT_LIMIT_REACHED:10,IN_ANOTHER_CALL:11,RING_TYPE_UNSUPPORTED:12,PENDING_APPROVAL:13,APPROVED:14,FAILED_APPROVAL:15,HANGUP_IN_WAITING_ROOM:16,UNCALLABLE:17})}),null);
__d("multiway_RingType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6})}),null);
__d("multiway_RtcResponseStatusCode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503})}),null);
__d("multiway_RtcResponseSubCode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:1e3,EXCEEDED_MAX_ALLOWED_PARTICIPANTS:1001,MEMBERSHIP_CHECK_FAIL:1002,CONFERENCE_THROTTLED:1003,ENDPOINT_THROTTLED:1004,UNSUPPORTED_REQUEST_TYPE:2e3,CLIENT_REQUEST_UNACCEPTABLE:2001,CLIENT_RESPONSE_UNACCEPTABLE:2002,RING_RESPONSE_BODY_NOT_SET:2004,SERVER_MEDIA_UPDATE_RESPONSE_BODY_NOT_SET:2005,INVALID_SDP:2006,INVALID_CONFERENCE_NAME:2007,SERVER_INFO_CONFERENCE_NAME_MISMATCH:2008,INVALID_USER_ID:2009,INCORRECT_VERSION_RANGE:2010,SENDER_ID_MISMATCH:2011,RECIPIENT_NOT_SPECIFIED:2012,FIELD_NOT_ALLOWED:2013,USERS_NOT_SPECIFIED:2015,REQUEST_UNACCEPTABLE_FOR_ENDPOINT_STATE:2016,INVALID_CALL_ID:2017,SESSION_DESCRIPTION_ID_MISMATCH:2018,EMPTY_CLIENT_MEDIA_UPDATES:2019,INVALID_SERVER_INFO_DATA:2020,INCORRECT_STATE_VERSION:2021,MISMATCHED_STATE_FOR_VERSION:2022,INVALID_STATE_VERSION:2023,NO_RESOLVER_FOUND:2024,MISSING_APPROVERLIST:2025,FULL_SDP_REQUIRED_IN_APPROVED_STATE:2026,INVALID_BROADCAST_ID:2027,MISSING_BODY_ENDPOINT:2101,MISSING_BODY_HEADER:2102,MISSING_BODY_BODY:2103,MISSING_BODY_PARAMS:2104,MISSING_BODY_REMOVE_PARTICIPANTS_REQUEST:2105,MISSING_BODY_DATA_MESSAGE_REQUEST:2106,MISSING_BODY_CLIENT_MEDIA_UPDATE_REQUEST:2107,MISSING_BODY_ADD_PARTICIPANTS_REQUEST:2108,MISSING_BODY_SUBSCRIPTION_REQUEST:2110,MISSING_BODY_JOIN_REQUEST:2111,MISSING_BODY_HANGUP_REQUEST:2112,MISSING_BODY_ICE_CANDIDATE_REQUEST:2113,MISSING_BODY_P2P_MESSAGE_REQUEST:2114,MISSING_BODY_UPDATE_REQUEST:2115,MISSING_BODY_CLIENT_EVENT_REQUEST:2116,MISSING_BODY_CONNECT_REQUEST:2117,MISSING_BODY_UNSUBSCRIBE_REQUEST:2118,MISSING_BODY_APPROVAL_REQUEST:2119,MISSING_BODY_GENERIC:2199,REQUESTOR_NOT_MEMBER_CONFERENCE:3002,NOT_BROADCAST_OWNER:3003,GUEST_NOT_INVITED:3004,GUEST_DISCONNECTED:3005,GUEST_INVITATION_EXPIRED:3006,SHOULD_USE_NEW_SIGNALING_PATH:3007,PARTICIPANT_IN_PENDING_APPROVAL_STATE:3008,BROADCAST_ALREADY_STOPPED:4002,FAILED_TO_GENERATE_SDP_ANSWER:4003,FAILED_GENERATE_SESSION_DESCRIPTION:4004,SDP_SESSION_ID_MISMATCH:4005,MEDIA_ENDPOINT_GONE:4007,MEDIA_ENDPOINT_ALREADY_EXISTS:4008,MEDIA_ENDPOINT_EXISTS_DIFFERENT_SESSION_ID:4009,LEGACY_MESSENGER_SENDER_UNSET:4010,FAILED_TO_SET_TRANSPORT_INFO:4011,NON_PRIMARY_MULTIWAY_SERVER:4012,FAILED_TO_GET_REMOTE_DESCRIPTION:4013,LOCAL_DESCRIPTION_NOT_SET:4014,INVALID_SDP_TYPE:4015,CLIENT_MEDIA_UPDATE_WITHOUT_REMOTE_SDP_INFO:4016,SDP_UNSET_ON_P2P_ANSWER:4017,MISSING_ICE_CANDIDATE_PAYLOAD:4018,P2P_PROTOCOL_UNSET:4019,CREATE_ACK_FOR_INVALID_MESSAGE_TYPE:4020,LEGACY_CLIENT_CANNOT_JOIN_SFU_MODE:4021,CONNECT_UNSUPPORTED_IN_SFU_MODE:4022,CONNECT_UNSUPPORTED_FOR_JOINED_ENDPOINTS:4023,RESOLVE_STATE_API_ERROR:4024,EXTERNAL_RESOLUTION_ERROR:4025,INTERNAL_RESOLUTION_ERROR:4026,RESOLUTION_DISABLED:4027,BROADCAST_ID_MISSING:4028,CONFERENCE_NOT_FOUND:5001,CONFERENCE_IS_TERMINATING:5002,CONFERENCE_IS_TERMINATED:5003,CONFERENCE_NAME_EMPTY:5004,NONCE_EMPTY:5005,NONCE_MISMATCH:5006,CONFERENCE_HAS_GONE:5007,PARTICIPANT_HAS_GONE:5008,MEDIA_SERVER_NOT_FOUND:5009,MEDIA_CODECS_UNSUPPORTED_BY_CONFERENCE:6001,CONFERENCE_INCAPABLE_RENEGOTIATION:6002,REJECTING_CMU_WHEN_SMU_PENDING:6003,PARTICIPANT_NOT_SUBSCRIBED_TO_TOPIC:6004,PARTICIPANT_ALREADY_IN_WAITING_ROOM:6005,PARTICIPANT_NOT_IN_PENDING_APPROVAL:6006,USER_NOT_APPROVER_FOR_TARGET_USER:6007,OK:9e3})}),null);
__d("ZenonMWMessageTypes",["multiway_Capability","multiway_DeviceStatus","multiway_DismissReason","multiway_HangupReason","multiway_MediaPauseStatus","multiway_ParticipantCallState","multiway_RingType","multiway_RtcResponseStatusCode","multiway_RtcResponseSubCode","multiway_MessageType"],(function(a,b,c,d,e,f){"use strict";e.exports={ZenonMWCapability:b("multiway_Capability"),ZenonMWDeviceStatus:b("multiway_DeviceStatus"),ZenonMWDismissReason:b("multiway_DismissReason"),ZenonMWHangupReason:b("multiway_HangupReason"),ZenonMWMediaPauseStatus:b("multiway_MediaPauseStatus"),ZenonMWParticipantCallState:b("multiway_ParticipantCallState"),ZenonMWResponseStatusCode:b("multiway_RtcResponseStatusCode"),ZenonMWResponseSubCode:b("multiway_RtcResponseSubCode"),ZenonMWRingType:b("multiway_RingType"),ZenonMWSignalingPayloadType:b("multiway_MessageType")}}),null);
__d("ZenonMWMessageMap",["ZenonMWMessageTypes"],(function(a,b,c,d,e,f){a=b("ZenonMWMessageTypes").ZenonMWSignalingPayloadType;e.exports=Object.freeze((c={},c[a.JOIN]="JOIN",c[a.SERVER_MEDIA_UPDATE]="SERVER_MEDIA_UPDATE",c[a.ICE_CANDIDATE]="ICE_CANDIDATE",c[a.HANGUP]="HANGUP",c[a.RING]="RING",c[a.DISMISS]="DISMISS",c[a.CONFERENCE_STATE]="CONFERENCE_STATE",c[a.ADD_PARTICIPANTS]="ADD_PARTICIPANTS",c[a.SUBSCRIPTION]="SUBSCRIPTION",c[a.CLIENT_MEDIA_UPDATE]="CLIENT_MEDIA_UPDATE",c[a.DATA_MESSAGE]="DATA_MESSAGE",c[a.REMOVE_PARTICIPANTS]="REMOVE_PARTICIPANTS",c[a.PING]="PING",c[a.P2P_PROTOCOL]="P2P_PROTOCOL",c[a.NOTIFY]="NOTIFY",c[a.CONNECT]="CONNECT",c[a.CLIENT_EVENT]="CLIENT_EVENT",c[a.UNSUBSCRIBE]="UNSUBSCRIBE",c))}),null);
__d("ZenonDebugLogger",["Log","LogHistory","ZenonMWMessageMap","ZenonMWMessageTypes","formatDate","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonMWMessageTypes").ZenonMWSignalingPayloadType,h=null;a=function(){a.getInstance=function(){h||(h=new a());return h};function a(){this.$1=b("LogHistory").getInstance("webrtc")}var c=a.prototype;c.$2=function(a){var c=b("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",c+" "+a)};c.logStateMachine=function(a,b,c,d){a=d==null?a:a+": "+d;d="["+a+"] [Current State: "+b+"] Processing event: "+c;this.$2(d)};c.logMWMessage=function(a,c){if(c.jsonPayload==null)return;var d=c.jsonPayload.header,e=b("ZenonMWMessageMap")[d.type];a="[ms] "+a+" "+e+" [messageID: "+d.transactionId+" retryCount: "+d.retryCount+"]";this.$2(a);this.logMWMessageDetails(c)};c.logMWMessageDetails=function(a){if(a.jsonPayload==null){b("recoverableViolation")("Should never call logMWMessageDetails with a null jsonPayload message","rtc_www");return}a=a.jsonPayload;var c=a.body;a=a.header;var d=b("ZenonMWMessageMap")[a.type],e=a.responseStatusCode!=null,f="";switch(a.type){case g.SERVER_MEDIA_UPDATE:if(e){f="[md] "+d+" resp [currentVersion: "+((a=(a=c.serverMediaUpdateResponse)==null?void 0:a.currentVersion)!=null?a:"")+"]";break}f="[md] "+d+" req [fromVersion: "+((a=(a=c.serverMediaUpdateRequest)==null?void 0:a.fromVersion)!=null?a:"")+" toVersion: "+((a=(a=c.serverMediaUpdateRequest)==null?void 0:a.toVersion)!=null?a:"")+"]";break;case g.CLIENT_MEDIA_UPDATE:if(e){f="[md] "+d+" resp [currentVersion: "+((e=(a=c.clientMediaUpdateResponse)==null?void 0:a.currentVersion)!=null?e:"")+"]";break}f="[md] "+d+" req [fromVersion: "+((e=(a=c.clientMediaUpdateRequest)==null?void 0:a.fromVersion)!=null?e:"")+" toVersion: "+((a=(d=c.clientMediaUpdateRequest)==null?void 0:d.toVersion)!=null?a:"")+"]";break;default:return}this.$2(f)};return a}();e.exports=a}),null);
__d("LazyLoadInstance",["promiseDone"],(function(a,b,c,d,e,f){"use strict";var g={LOADING:1,NOT_READY:0,READY:2};a=function(){function a(a,b){this.$1={instantiate:b,moduleReference:a,stage:g.NOT_READY}}var c=a.prototype;c.get=function(a){switch(this.$1.stage){case g.NOT_READY:b("promiseDone")(this.$2(this.$1),a);break;case g.LOADING:b("promiseDone")(this.$1.instancePromise,a);break;case g.READY:a(this.$1.instance);break}};c.getNow=function(){return this.$1.stage===g.READY?this.$1.instance:null};c.preload=function(){this.$1.stage===g.NOT_READY&&this.$2(this.$1)};c.$2=function(a){var b=this,c=a.instantiate;a=a.moduleReference;a=a.load().then(function(a){a=c(a);b.$1={instance:a,stage:g.READY};return a});this.$1={instancePromise:a,stage:g.LOADING};return a};return a}();e.exports=a}),null);
__d("ZenonOfferStorage",["CacheStorage"],(function(a,b,c,d,e,f){var g="localstorage",h="RTC_",i="offer",j="offer_msg",k={writePeerOfferToStorage:function(a,b){a=k.getStorage(a,j);k._storeData(a,i,b)},_storeData:function(a,b,c){c={__d:c,__t:Date.now()};a.set(b,c)},getStorage:function(a,c){return new(b("CacheStorage"))(g,""+h+a+"_"+c+"_")}};e.exports=k}),null);
__d("CallEndReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IGNORE_CALL:"IgnoreCall",HANGUP_CALL:"HangupCall",IN_ANOTHER_CALL:"InAnotherCall",ACCEPT_AFTER_HANGUP:"CallEndAcceptAfterHangUp",NO_ANSWER_TIMEOUT:"NoAnswerTimeout",INCOMING_TIMEOUT:"IncomingTimeout",OTHER_INSTANCE_HANDLED:"OtherInstanceHandled",SIGNALING_MESSAGE_FAILED:"SignalingMessageFailed",CONNECTION_DROPPED:"ConnectionDropped",CLIENT_INTERRUPTED:"ClientInterrupted",WEBRTC_ERROR:"WebRTCError",CLIENT_ERROR:"ClientError",NO_PERMISSION:"NoPermission",OTHER_NOT_CAPABLE:"OtherNotCapable",NO_UI_ERROR:"NoUIShown",UNSUPPORTED_VERSION:"VersionUnsupported",CALLER_NOT_VISIBLE:"CallerNotVisible",CARRIER_BLOCKED:"CarrierBlocked",OTHER_CARRIER_BLOCKED:"OtherCarrierBlocked",CLIENT_ENCRYPTION_ERROR:"ClientEncryptionError"})}),null);
__d("WebrtcMessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OFFER:"offer",ANSWER:"answer",ICE_CANDIDATE:"ice_candidate",OK:"ok",HANG_UP:"hang_up",OTHER_DISMISS:"other_dismiss",MESSAGE_ACK:"msg_ack",PRANSWER:"pranswer",PING:"ping",PING_ACK:"ping_ack",ICE_RESTART_OFFER:"icerestart_offer",ICE_RESTART_ANSWER:"icerestart_answer",OFFER_ACK:"offer_ack",ANSWER_ACK:"answer_ack",SET_VIDEO:"set_video",ACK:"ack",INVALID:"invalid",OFFER_NACK:"offer_nack",NACK:"nack",VIDEO_REQUEST:"video_request",SDP_UPDATE:"sdp_update",SWITCH_TO_MULTIWAY:"switch_to_multiway",ON_HOLD:"on_hold",NEGOTIATE:"negotiate",RING:"ring",PR_OFFER_ACK:"pr_offer_ack",NOTIFY_MEDIA_STATE:"notify_media_state",CLIENT_REPORTED_EVENT:"client_reported_event"})}),null);
__d("ZenonP2PMessageTypes",["WebrtcMessageType","CallEndReason"],(function(a,b,c,d,e,f){e.exports={ZenonP2PCallEndReason:b("CallEndReason"),ZenonP2PSignalingPayloadType:b("WebrtcMessageType")}}),null);
__d("ZenonSignalingTypes",[],(function(a,b,c,d,e,f){a={OK:0,REJECTED_FROM_VERSION_DOES_NOT_MATCH:1};e.exports={ZenonRemoteSdpResponseStatus:a}}),null);
__d("ZenonParentSignalingClient",["ZenonDebugLogger","ZenonSignalingTypes","recoverableViolation","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus;a=function(){function a(a,c,d,e){var f=this;this.remoteSignalingID=null;this.$4="init";this.$6=null;this.$7=null;this.$8=function(){};this.$9=function(a,c,d){b("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",f.$4,"received "+a.eventName,f.$1.getSignalingID());switch(a.eventName){case"inviteRequest":f.$11(a,c,d);break;case"remoteSdpRequest":f.$12(a,c);break;case"terminateRequest":f.$13(a,c,d);break}};this.$1=a;this.$3=d;this.$5=e;this.$2=c;c.setReceiver(this.$9)}var c=a.prototype;c.setSignalingEventHandlers=function(a){if(this.$6!=null){b("recoverableViolation")("setSignalingEventHandlers should only be called once, to avoid accidentally losing handlers.","rtc_www");return}this.$6=a};c.setLoggingEventHandler=function(a){this.$8=a};c.getSignalingModel=function(){return this.$1};c.sendDismiss=function(a){this.$4="terminated";a={eventName:"terminateRequest",fromJoinResponse:!1,reason:a,shouldInformPeer:!0};this.$10(a)};c.receiveMessage=function(a){this.$2.receiveMessage(a)};c.isTerminated=function(){return this.$4==="terminated"};c.sendAnswerIntent=function(){if(this.$4==="inviteAcknowledged"){this.$4="answered";var a={eventName:"answerIntentRequest"};this.$10(a)}else throw b("unrecoverableViolation")("sendAnswerIntent called in unexpected state "+this.$4,"rtc_www")};c.respondToInvite=function(a){if(this.$4==="inviteReceived"){if(this.$7==null)throw b("unrecoverableViolation")("respondToInvite called without inviteMessageId being populated first","rtc_www");this.$4="inviteAcknowledged";a={ackMessageId:this.$7,eventName:"inviteResponse",status:a};this.$10(a)}else throw b("unrecoverableViolation")("respondToInvite called in unexpected state "+this.$4,"rtc_www")};c.sendInvite=function(a,c){throw b("unrecoverableViolation")("sendInvite called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendSdp=function(a,c){throw b("unrecoverableViolation")("sendSdp called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendIceCandidate=function(a){throw b("unrecoverableViolation")("sendIceCandidate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendMediaUpdate=function(a){throw b("unrecoverableViolation")("sendMediaUpdate called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendAddParticipantsMessage=function(a){throw b("unrecoverableViolation")("sendAddParticipantsMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendRemoveParticipantsRequest=function(a){throw b("unrecoverableViolation")("sendRemoveParticipantsRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendSubscriptionRequest=function(a){throw b("unrecoverableViolation")("sendSubscriptionRequest called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendClientInfo=function(a){throw b("unrecoverableViolation")("sendClientInfo called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.sendGenericDataMessage=function(a,c,d){throw b("unrecoverableViolation")("sendGenericDataMessage called on ZenonParentSignalingClient. Did you mean to use ZenonSignalingClient instead?","rtc_www")};c.$10=function(a){b("ZenonDebugLogger").getInstance().logStateMachine("ParentSignalingClient",this.$4,"sending "+a.eventName,this.$1.getSignalingID()),this.$3.sendEvent(a)};c.$11=function(a,b,c){this.$4=="init"&&(this.$4="inviteReceived",this.$7=b,this.$5(a,c,this))};c.$13=function(a,b,c){if(this.$4!=="terminated"){this.$4="terminated";c={ackMessageId:b,eventName:"dismissResponse"};this.$3.sendEvent(c);this.$6&&this.$6.onDismissReceived&&this.$6.onDismissReceived(this.$1.getSignalingID(),a.reason)}};c.$12=function(a,b){b={ackMessageId:b,acknowledgedVersion:a.sdp.version,eventName:"remoteSdpResponse",negotiateType:a.negotiateType,status:g.OK,type:a.sdp.type};this.$3.sendEvent(b)};return a}();e.exports=a}),null);
__d("ZenonParentCallsManager",["BaseEventEmitter","JSResource","LazyLoadInstance","ZenonCallLogger","ZenonCollisionContext","ZenonDismissReason","ZenonOfferStorage","ZenonP2PMessageTypes","ZenonParentCallSummaryLogProcessor","ZenonParentSignalingClient","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonCollisionContext").getThreadIDAndTypeFromCollisionContext,h=b("ZenonDismissReason").ZenonDismissReason,i=b("ZenonDismissReason").endCallToDismissReason,j=b("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType;a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$ZenonParentCallsManager4=new Map();d.$ZenonParentCallsManager5=new Set();d.$ZenonParentCallsManager6=new Map();d.$ZenonParentCallsManager7=new Map();d.$ZenonParentCallsManager8=new Map();d.getRawP2PMessages=function(a){return(a=d.$ZenonParentCallsManager7.get(a))!=null?a:null};d.getMWRingRequest=function(a){return(a=d.$ZenonParentCallsManager6.get(a))!=null?a:null};d.onInviteReceived=function(a,b,c){var e,f=c.getSignalingModel().getSignalingID();c.setSignalingEventHandlers({onDismissReceived:d.onDismissReceived});var h=a.inviterID,i=a.otherParticipants,j=a.requestingVideo;a=a.roomInfo;var k="zenon_incoming_call_dialog",l=d.$ZenonParentCallsManager9({callID:f,callTrigger:k,isCaller:!1,isVideo:j,peerID:h,protocol:b});l.log({name:"inviteReceived"});k=d.$ZenonParentCallsManager3.isSupportedClientForProtocol(b);var m=k?"OK":"NOT_SUPPORTED";c.respondToInvite(m);l.log({name:"inviteResponded"});m={thread:{id:"0",type:2},type:"thread"};if(((e=a.context)==null?void 0:e.groupThreadID)||((e=a.context)==null?void 0:e.peerID)){m={thread:(e=g(a.context))!=null?e:m.thread,type:"thread"}}else((e=a.room)==null?void 0:e.linkHash)!=null&&((e=a.room)==null?void 0:e.roomName)!=null&&(m={room:a.room,type:"room"});a={context:m,controllerParams:{callContext:a.name,callID:f,configuration:b,serverInfoData:(m=(e=a.context)==null?void 0:e.serverInfoData)!=null?m:null},inviterID:h,isClientPermissableRing:k,onAccept:function(a,e){var g=e.isPopupBlocked;e=e.trigger;l.log({name:"callAccepted",trigger:e});d.$ZenonParentCallsManager11(h);c.sendAnswerIntent();d.$ZenonParentCallsManager10(a,{callID:f,callTrigger:e,isPopupBlocked:g,isVideo:j,peerID:h,protocol:b})},onDecline:function(a,b){b===void 0&&(b=null),d.onDecline(f,l,a,b)},otherParticipants:i,requestingVideo:j,ringID:f};d.emit("incomingRing",a)};d.onDismissReceived=function(a,b){var c=d.$ZenonParentCallsManager12(b);c={reason:c,ringID:a};d.emit("ringCancel",c);c=d.$ZenonParentCallsManager4.get(a);c!=null&&c.log({endCallReason:b,isRemoteEnded:!0,name:"callEnded"})};d.$ZenonParentCallsManager3=c;d.$ZenonParentCallsManager2=new(b("LazyLoadInstance"))(b("JSResource")("ZenonSignalingParentTransport").__setRef("ZenonParentCallsManager"),function(a){a=new a();a.init(d.getRawP2PMessages,d.getMWRingRequest);return a});d.$ZenonParentCallsManager1=new(b("LazyLoadInstance"))(b("JSResource")("ZenonSignalingClientManager").__setRef("ZenonParentCallsManager"),function(a){return new a(b("ZenonParentSignalingClient"),d.onInviteReceived)});return d}var d=c.prototype;d.startOutgoingCallIntent=function(a,b){var c=b.callID,d=b.callTrigger,e=b.isVideo,f=b.peerID,g=b.protocol;this.$ZenonParentCallsManager9({callID:c,callTrigger:d,isCaller:!0,isVideo:e,peerID:f,protocol:g});this.$ZenonParentCallsManager10(a,b)};d.$ZenonParentCallsManager9=function(a){var c=a.callID,d=a.callTrigger,e=a.isCaller,f=a.isVideo,g=a.peerID;a=a.protocol;var h=this.$ZenonParentCallsManager4.get(c);!h?(h=new(b("ZenonCallLogger"))({callID:c,callTrigger:d,isCaller:e,isVideo:f,peerID:g,protocol:a},[b("ZenonParentCallSummaryLogProcessor")]),this.$ZenonParentCallsManager4.set(c,h)):b("recoverableViolation")("Call logger key collision in parentCallsManager for callID: "+c,"rtc_www");return h};d.$ZenonParentCallsManager10=function(a,b){var c=b.callID;b=b.isPopupBlocked;this.$ZenonParentCallsManager2.get(function(b){b.verificationNonce=a});this.$ZenonParentCallsManager5.add(c);c=this.$ZenonParentCallsManager4.get(c);c!=null&&c.log({isPopupBlocked:b,name:"popupOpened"})};d.initListeners=function(a){var b=this;for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e.subscribe(function(a){return b.onMessageReceived(a)},function(a){return b.onRawP2PMessageReceived(a)},function(a){return b.onRawMWMessageReceived(a)})}};d.onMessageReceived=function(a){var b=a.getHeader().signalingID;if(b!=null&&this.$ZenonParentCallsManager5.has(b))return;this.$ZenonParentCallsManager1.get(function(b){b.receiveMessage(a)})};d.onRawP2PMessageReceived=function(a){var b=String(a.from);if(a.msg_type!==j.OFFER){var c=this.$ZenonParentCallsManager7.get(b);c||(c=[],this.$ZenonParentCallsManager7.set(b,c));c.push(a)}else this.$ZenonParentCallsManager8.set(b,a)};d.onRawMWMessageReceived=function(a){var b=a.jsonPayload,c=b.body;b=b.header;c=c.ringRequest;if(c){c=b.conferenceName;this.$ZenonParentCallsManager6.set(c,a)}};d.onDecline=function(a,c,d,e){e===void 0&&(e=null),this.$ZenonParentCallsManager1.get(function(f){f=f.getSignalingClient(a);if(f){var g=i(d);d!=="NoAnswerTimeout"&&d!=="VersionUnsupported"&&e!=="CallsBlocked"&&f.sendDismiss(g);c.log({endCallReason:g,endCallSubreason:e,isRemoteEnded:!1,name:"callEnded"})}else b("recoverableViolation")("signaling client should be defined","rtc_www")})};d.removeListeners=function(a){for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.unsubscribe()}};d.$ZenonParentCallsManager12=function(a){switch(a){case h.OTHER_INSTANCE_HANDLED:case h.ANSWERED_ON_ANOTHER_DEVICE:case h.REJECTED_ON_ANOTHER_DEVICE:return"other_dismiss";default:return"hangup"}};d.$ZenonParentCallsManager11=function(a){var c=this.$ZenonParentCallsManager8.get(a);c&&b("ZenonOfferStorage").writePeerOfferToStorage(a,c)};return c}(b("BaseEventEmitter"));e.exports=a}),null);
__d("ZenonSignalingMessage",[],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getHeader=function(){return this.$1};b.getEvents=function(){return this.$2};b.setSignalingID=function(a){this.$1.signalingID=a};b.setRetryCount=function(a){this.$1.retryCount=a};return a}();e.exports=a}),null);
__d("ZenonMWTranslatorUtils",["ChannelClientID","CurrentUser","FacebookAppIDs","ZenonDismissReason","ZenonMWMessageTypes","ZenonParticipantState","ZenonSignalingTypes","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonDismissReason").ZenonDismissReason,h=(a=b("ZenonMWMessageTypes")).ZenonMWDeviceStatus;c=a.ZenonMWDismissReason;var i=a.ZenonMWHangupReason,j=a.ZenonMWParticipantCallState,k=a.ZenonMWResponseStatusCode,l=a.ZenonMWResponseSubCode;d=b("ZenonParticipantState").ZenonParticipantState;f=b("ZenonSignalingTypes").ZenonRemoteSdpResponseStatus;var m={mwMessageHeaderToSignalingMessageHeader:function(a){var b=a.clientSessionId,c=a.conferenceName,d=a.serverInfoData,e=a.transactionId;b=b;var f={userID:"2"};e={messageID:e,roomInfo:{name:c},signalingID:b,protocol:"mw",userInfo:{userID:"1"},remoteInfo:f,retryCount:a.retryCount};d!=null&&(e.remoteSignalingID=d);return e},signalingMessageHeaderToMWHeader:function(a,b){var c=a.messageID,d=a.remoteSignalingID,e=a.roomInfo,f=a.signalingID;e={conferenceName:e.name,retryCount:a.retryCount,transactionId:c,type:b};f!=null&&(e.clientSessionId=f);d!=null&&(e.serverInfoData=d);return e},signalingMessageHeaderToMWResponseHeader:function(a,b,c){a=m.signalingMessageHeaderToMWHeader(a,b);a.responseStatusCode=(b=c)!=null?b:k.OK;return a},createMWMessage:function(a,c){var d={appId:m.getMWAppID(),deviceId:b("ChannelClientID").getID(),userId:b("CurrentUser").getID()};return{endpoint:d,jsonPayload:{body:c,header:a}}},getMWAppID:function(){return b("FacebookAppIDs").MQTT_WEB.toString()},getCollisionContextFromAppMessages:function(a){var b=null,c=null,d=null;a!=null&&a.forEach(function(a){a=(a=a.body)==null?void 0:a.genericMessage;if(a!=null&&a.topic==="collision_context_payload"){a=a.data;if(a!=null){var e;a=JSON.parse(a);b=(e=a.group_thread_id)!=null?e:null;c=(e=a.peer_id)!=null?e:null;d=(e=a.server_info_data)!=null?e:null}}});return{groupThreadID:b,peerID:c,serverInfoData:d}},getRoomMetadataFromAppMessages:function(a){a=a&&a.length>0?a.find(function(a){return((a=a.body)==null?void 0:(a=a.genericMessage)==null?void 0:a.topic)==="room_metadata"}):null;if(a){a=(a=a.body)==null?void 0:(a=a.genericMessage)==null?void 0:a.data;if(a!=null){a=JSON.parse(a);if(a.link_hash!=null&&a.room_name!=null)return{linkHash:a.link_hash,profileURL:a.profile_url,ringSubtitle:a.ring_subtitle,roomName:a.room_name}}}return{}},fromMWDismissReason:function(a){a=o[a];return(a=a)!=null?a:g.CALL_ENDED},fromMWJoinResponseStatusToDismissReason:function(a,c){if(c===l.EXCEEDED_MAX_ALLOWED_PARTICIPANTS)return g.MAX_ALLOWED_PARTICIPANTS_REACHED;switch(a){case k.METHOD_NOT_ALLOWED:case k.UNAUTHORIZED:return g.NO_PERMISSION;case k.SERVICE_UNAVAILABLE:return g.SIGNALING_MESSAGE_FAILED;case k.OK:throw b("unrecoverableViolation")("Response status code is OK; should not return a dismiss reason","rtc_www");default:return g.CLIENT_ERROR}},fromMWParticipantState:function(a){a=q[a];return(a=a)!=null?a:j.UNKNOWN},toMWHangupReason:function(a){a=p[a];return(a=a)!=null?a:i.HANGUP_CALL},toMWDeviceStatus:function(a){a=n[a];return(a=a)!=null?a:h.OK},toZenonMediaStates:function(a){var b={tracks:[],version:0};Object.keys(a.tracks).forEach(function(c){var d=a.tracks[c];c={enabled:d.enabled,trackID:c,userID:d.owner};b.tracks.push(c);b.version++});return b},toMWMediaStatus:function(a){var b={};a.tracks.forEach(function(a){b[a.trackID]=a.enabled});return b},toMWClientMediaStatus:function(a){var b={tracks:{}};a.tracks.forEach(function(a){b.tracks[a.trackID]={enabled:a.enabled,owner:a.userID}});return b},toMWResponseStatusCode:function(a){return r[a]},getSdpVersion:function(a){a=a.split("\n");if(a.length<2)throw b("unrecoverableViolation")("Expected SDP string with two or more lines, but got "+a.length,"rtc_www");a=a[1].trim();a=a.split(" ");if(a.length<3)throw b("unrecoverableViolation")("Session line should have at least 3 tokens, but got "+a.length,"rtc_www");a=parseInt(a[2],10);if(isNaN(a))throw b("unrecoverableViolation")("SDP version could not be parsed as number.","rtc_www");return a}},n={IN_ANOTHER_CALL:h.IN_ANOTHER_CALL,NOT_SUPPORTED:h.NOT_SUPPORTED,OK:h.OK},o=Object.freeze((a={},a[c.CALL_ENDED]=g.CALL_ENDED,a[c.ANSWERED_ON_ANOTHER_DEVICE]=g.ANSWERED_ON_ANOTHER_DEVICE,a[c.IN_ANOTHER_CALL]=g.IN_ANOTHER_CALL,a[c.CONNECTION_DROPPED]=g.CONNECTION_DROPPED,a[c.REJECTED_ON_ANOTHER_DEVICE]=g.REJECTED_ON_ANOTHER_DEVICE,a[c.REJECTED_BY_CALLEE]=g.REJECTED_BY_CALLEE,a[c.CALL_ENDED_BY_PRODUCT]=g.CALL_ENDED_BY_PRODUCT,a[c.INTERNAL_ERROR]=g.CLIENT_ERROR,a[c.REMOVED_BY_PARTICIPANT]=g.HANGUP_CALL,a)),p=Object.freeze((c={},c[g.IGNORE_CALL]=i.IGNORE_CALL,c[g.HANGUP_CALL]=i.HANGUP_CALL,c[g.NO_ANSWER_TIMEOUT]=i.NO_ANSWER_TIMEOUT,c[g.CLIENT_ERROR]=i.CLIENT_ERROR,c[g.IN_ANOTHER_CALL]=i.IN_ANOTHER_CALL,c[g.CLIENT_INTERRUPTED]=i.CLIENT_INTERRUPTED,c[g.SESSION_MIGRATED]=i.SESSION_MIGRATED,c)),q=Object.freeze((a={},a[j.UNKNOWN]=d.UNKNOWN,a[j.DISCONNECTED]=d.DISCONNECTED,a[j.NO_ANSWER]=d.NO_ANSWER,a[j.REJECTED]=d.REJECTED,a[j.UNREACHABLE]=d.UNREACHABLE,a[j.CONNECTION_DROPPED]=d.CONNECTION_DROPPED,a[j.CONTACTING]=d.CONTACTING,a[j.RINGING]=d.RINGING,a[j.CONNECTING]=d.CONNECTING,a[j.CONNECTED]=d.CONNECTED,a[j.PARTICIPANT_LIMIT_REACHED]=d.PARTICIPANT_LIMIT_REACHED,a[j.IN_ANOTHER_CALL]=d.IN_ANOTHER_CALL,a[j.RING_TYPE_UNSUPPORTED]=d.RING_TYPE_UNSUPPORTED,a[j.PENDING_APPROVAL]=d.PENDING_APPROVAL,a[j.APPROVED]=d.APPROVED,a[j.FAILED_APPROVAL]=d.FAILED_APPROVAL,a)),r=Object.freeze((c={},c[f.OK]=k.OK,c[f.REJECTED_FROM_VERSION_DOES_NOT_MATCH]=k.CONDITIONAL_REQUEST_FAILED,c));e.exports=m}),null);
__d("ZenonMWMessageTranslator",["CurrentUser","ZenonMWMessageTypes","ZenonMWTranslatorUtils","ZenonPlatformExperiments","ZenonSignalingMessage","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("ZenonMWMessageTypes")).ZenonMWCapability,h=a.ZenonMWResponseStatusCode,i=a.ZenonMWRingType,j=a.ZenonMWSignalingPayloadType,k="joining_context";c={toMWMessage:function(a){var c=a.getHeader();a=a.getEvents();if(a.length===0)throw b("unrecoverableViolation")("Unexpected Translation: called toMWMessage with empty signaling events","messenger_web_product");else{var d=a[0];switch(d.eventName){case"addParticipantsRequest":return v(c,d);case"clientInfoRequest":if(a.length>=2&&a[1].eventName==="localSdpRequest"&&(a[1].sdp.type==="offer"||a[1].sdp.type==="answer"&&b("ZenonPlatformExperiments").isMwpp()))return A(c,d,a[1]);break;case"genericDataMessageRequest":return x(c,d);case"inviteRequest":if(a.length>=3&&a[1].eventName==="clientInfoRequest"&&a[2].eventName==="localSdpRequest"&&a[2].sdp.type==="offer")return A(c,a[1],a[2],d);break;case"inviteResponse":return B(c,d);case"dismissResponse":return E(c);case"initiateRenegotiationResponse":return J(c,d);case"iceCandidateRequest":return z(c,d);case"iceCandidateResponse":return y(c,d);case"localSdpRequest":return H(c,d.mediaStates,d.sdp);case"mediaUpdateRequest":return H(c,d.mediaStates);case"participantUpdateResponse":return G(c,d);case"pingRequest":return F(c);case"remoteSdpResponse":return d.type==="offer"&&(a.length>=2&&a[1].eventName==="localSdpRequest"&&a[1].sdp.type==="answer")?I(c,d,a[1]):I(c,d);case"removeParticipantsRequest":return w(c,d);case"subscriptionRequest":return D(c,d);case"terminateRequest":return C(c,d)}}return null},toSignalingMessage:function(a){var c=a.jsonPayload.header,d=c.type,e=c.responseStatusCode==null;c=b("ZenonMWTranslatorUtils").mwMessageHeaderToSignalingMessageHeader(c);var f=[];switch(d){case j.RING:e&&(f=n(a));break;case j.DISMISS:e&&(f=o(a));break;case j.JOIN:e||(f=p(a));break;case j.ICE_CANDIDATE:e?f=q(a):f=r(a);break;case j.CONFERENCE_STATE:e&&(f=s(a));break;case j.CLIENT_MEDIA_UPDATE:e||(f=t(a));break;case j.SERVER_MEDIA_UPDATE:e&&(f=u(a));break;case j.PING:e||(f=l(a));break;case j.HANGUP:e||(f=m(a));break}return new(b("ZenonSignalingMessage"))(c,f)}};function l(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"pingResponse"};b.push(a);return b}function m(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"hangupResponse"};b.push(a);return b}function n(a){var c=[];a=a.jsonPayload;var d=a.body;a=a.header;d=d.ringRequest;if(d){var e=d.appMessages,f=d.caller,g=d.otherParticipants,h=d.ringType;f=f;h=h===i.PEER_VIDEO_CALL||h===i.GROUP_VIDEO_CALL||h===i.LIVE_STREAM||h===i.PEER_ESCALATED_AUDIO_CALL;a=a.conferenceName;var j=b("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(e);e=b("ZenonMWTranslatorUtils").getRoomMetadataFromAppMessages(e);f={eventName:"inviteRequest",inviterID:f,isRemoteOfferer:!1,otherParticipants:g,requestingVideo:h,roomInfo:{context:j,name:a,room:e}};c.push(f);j=(h=(g=d.offer)==null?void 0:g.sdpString)!=null?h:"";e=(a=d.mediaStatusEx)!=null?a:null;if(j!=""&&e!=null&&b("ZenonPlatformExperiments").isMwpp()){f={sdp:j,type:"offer",version:b("ZenonMWTranslatorUtils").getSdpVersion(j)};g=b("ZenonMWTranslatorUtils").toZenonMediaStates(e);h={eventName:"remoteSdpRequest",mediaStates:g,negotiateType:!1,sdp:f};c.push(h)}}return c}function o(a){var c=[];a=a.jsonPayload.body.dismissRequest;if(a){a=a.reason;a={eventName:"terminateRequest",fromJoinResponse:!1,reason:b("ZenonMWTranslatorUtils").fromMWDismissReason(a),shouldInformPeer:!0};c.push(a)}return c}function p(a){var c=[],d=a.jsonPayload.header;if(d.responseStatusCode&&d.responseStatusCode!==h.OK){var e={eventName:"terminateRequest",fromJoinResponse:!0,reason:b("ZenonMWTranslatorUtils").fromMWJoinResponseStatusToDismissReason(d.responseStatusCode,d.responseSubCode),shouldInformPeer:!1};c.push(e);return c}e=a.jsonPayload.body.joinResponse;if(!e)return c;a={ackMessageId:d.transactionId,eventName:"localSdpResponse"};c.push(a);d=(a=(d=e.answer)==null?void 0:d.sdpString)!=null?a:"";if(d!==""){a={sdp:d,type:"answer",version:b("ZenonMWTranslatorUtils").getSdpVersion(d)};d=b("ZenonMWTranslatorUtils").toZenonMediaStates(e.mediaStatusEx);d={eventName:"remoteSdpRequest",mediaStates:d,negotiateType:!1,sdp:a};c.push(d)}a={capabilities:{addParticipantEnabled:!0},eventName:"capabilitiesRequest"};c.push(a);if(e.isPendingApproval){d={eventName:"pendingApprovalRequest"};c.push(d)}return c}function q(a){var b=[];a=a.jsonPayload.body.iceCandidateRequest;if(a){a={eventName:"iceCandidateRequest",iceCandidates:a.iceCandidateSdps.map(function(a){var b;return{candidateSdpString:(b=a.candidateSdpString)!=null?b:"",sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid}})};b.push(a)}return b}function r(a){var b=[];a=a.jsonPayload.header;a={ackMessageId:a.transactionId,eventName:"iceCandidateResponse"};b.push(a);return b}function s(a){var c=[];a=a.jsonPayload.body.conferenceStateRequest;if(a){var d=a.appMessages,e=a.participantStates,f={eventName:"participantUpdateRequest",participantStates:new Map(),versionId:a.version},g={eventName:"clientInfoRequest",userCapabilities:new Map()};Object.keys(e).forEach(function(a){var c=e[a],d=c.state;c=c.userCapabilities;f.participantStates.set(a,b("ZenonMWTranslatorUtils").fromMWParticipantState(d));g.userCapabilities.set(a,(d=c)!=null?d:"")});a=b("ZenonMWTranslatorUtils").getCollisionContextFromAppMessages(d);d={context:a,eventName:"roomContextUpdateRequest"};c.push(f);c.push(g);c.push(d)}return c}function t(a){var c=[];a=a.jsonPayload;var d=a.body;a=a.header;d=d.clientMediaUpdateResponse;if(d){var e=d.answer,f=d.mediaStatus;if(e!=null&&f!=null){e=(e=e.sdpString)!=null?e:"";f=b("ZenonMWTranslatorUtils").toZenonMediaStates(f);var g={ackMessageId:a.transactionId,eventName:"localSdpResponse"};f={eventName:"remoteSdpRequest",mediaStates:f,negotiateType:!1,sdp:{sdp:e,type:"answer",version:b("ZenonMWTranslatorUtils").getSdpVersion(e)}};c.push(g);c.push(f)}else{e={ackMessageId:a.transactionId,eventName:"mediaUpdateResponse",requestVersionId:d.currentVersion};c.push(e)}}return c}function u(a){var c=[];a=a.jsonPayload;var d=a.body;a=a.header;d=d.serverMediaUpdateRequest;if(!d)return c;a={eventName:"overlayConfigServerUpdateRequest",serializedConfig:(a=(a=a.extensions)==null?void 0:a.oc1)!=null?a:""};c.push(a);if(d.renegotiationRequested){a={eventName:"initiateRenegotiationRequest",fromVersion:d.fromVersion,version:d.toVersion};c.push(a)}a=(a=(a=d.answer)==null?void 0:a.sdpString)!=null?a:"";var e="answer";if(a===""){var f;a=(f=(f=d.offer)==null?void 0:f.sdpString)!=null?f:"";e="offer"}if(a==="")return c;f={sdp:a,type:e,version:b("ZenonMWTranslatorUtils").getSdpVersion(a)};e=b("ZenonMWTranslatorUtils").toZenonMediaStates(d.mediaStatus);a={eventName:"remoteSdpRequest",fromVersion:d.fromVersion,mediaStates:e,negotiateType:!1,sdp:f};c.push(a);return c}function v(a,c){c={usersToInvite:c.participants};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.ADD_PARTICIPANTS);return b("ZenonMWTranslatorUtils").createMWMessage(a,{addParticipantsRequest:c})}function w(a,c){c={usersToRemove:c.participants};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.REMOVE_PARTICIPANTS);return b("ZenonMWTranslatorUtils").createMWMessage(a,{removeParticipantsRequest:c})}function x(a,c){var d={data:c.data,topic:c.topic};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.DATA_MESSAGE);return b("ZenonMWTranslatorUtils").createMWMessage(a,{dataMessageRequest:{message:{body:{genericMessage:d},header:{recipients:c.recipientIDs,sender:b("CurrentUser").getID(),topic_DEPRECATED:""}}}})}function y(a,c){c=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.ICE_CANDIDATE);return b("ZenonMWTranslatorUtils").createMWMessage(c,{})}function z(a,c){c=c.iceCandidates;c=c.map(function(a){return{candidateSdpString:a.candidateSdpString,sdpMLineIndex:a.sdpMLineIndex,sdpMid:a.sdpMid}});c={iceCandidateSdps:c};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.ICE_CANDIDATE);return b("ZenonMWTranslatorUtils").createMWMessage(a,{iceCandidateRequest:c})}function A(a,c,d,e){c={deviceCapabilities:[g.SUPPORT_NEW_PARTICIPANT_STATES,g.REQUIRE_FULL_SDP_IN_SMU,g.SUPPORT_SDP_RENEGOTIATION],mediaStatus:b("ZenonMWTranslatorUtils").toMWMediaStatus(d.mediaStates),offer:{sdpString:d.sdp.sdp},userCapabilities:c.userCapabilities.get(a.userInfo.userID)};b("ZenonPlatformExperiments").isMwpp()&&(c.deviceCapabilities.push(g.SUPPORT_MWPP),d.sdp.type==="answer"&&(c.answer={sdpString:d.sdp.sdp}));d=e==null?void 0:e.otherParticipants;d&&(c.usersToCall=d);e=(d=e==null?void 0:e.roomInfo.context)!=null?d:a.roomInfo.context;e&&(c.appMessages=[{body:{genericMessage:{data:JSON.stringify(e),topic:k}},header:{topic_DEPRECATED:k}}]);d=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.JOIN);e&&e.serverInfoData!=null&&(d.serverInfoData=e.serverInfoData);return b("ZenonMWTranslatorUtils").createMWMessage(d,{joinRequest:c})}function B(a,c){c=c.status;c=b("ZenonMWTranslatorUtils").toMWDeviceStatus(c);c={deviceCapabilities:[g.SUPPORT_AUDIO_DEPRECATED,g.SUPPORT_VIDEO_DEPRECATED],deviceStatus:c};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.RING);return b("ZenonMWTranslatorUtils").createMWMessage(a,{ringResponse:c})}function C(a,c){c=c.reason;c={detailedReasonString:"",reason:b("ZenonMWTranslatorUtils").toMWHangupReason(c)};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.HANGUP);return b("ZenonMWTranslatorUtils").createMWMessage(a,{hangupRequest:c})}function D(a,c){c=c.subscriptions;c={subscriptions:c};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.SUBSCRIPTION);return b("ZenonMWTranslatorUtils").createMWMessage(a,{subscriptionRequest:c})}function E(a){a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.DISMISS);return b("ZenonMWTranslatorUtils").createMWMessage(a,{})}function F(a){var c=Object.freeze({});a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.PING);return b("ZenonMWTranslatorUtils").createMWMessage(a,{pingRequest:c})}function G(a,c){c={currentVersion:c.requestVersionId};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.CONFERENCE_STATE);return b("ZenonMWTranslatorUtils").createMWMessage(a,{conferenceStateResponse:c})}function H(a,c,d){c={fromVersion:c.version,mediaUpdates:[{mediaStatus:b("ZenonMWTranslatorUtils").toMWMediaStatus(c)}],toVersion:c.version};d!==void 0&&(c.offer={sdpString:d.sdp});d=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWHeader(a,j.CLIENT_MEDIA_UPDATE);return b("ZenonMWTranslatorUtils").createMWMessage(d,{clientMediaUpdateRequest:c})}function I(a,c,d){if(c.acknowledgedVersion==null)throw b("unrecoverableViolation")("Error creating ServerMediaUpdateResponse: remoteSdpResponse.acknowledgedVersion is null","messenger_web_product");var e={currentVersion:c.acknowledgedVersion};d&&(e.answer={sdpString:d.sdp.sdp},e.mediaStatus=b("ZenonMWTranslatorUtils").toMWClientMediaStatus(d.mediaStates));d=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.SERVER_MEDIA_UPDATE,b("ZenonMWTranslatorUtils").toMWResponseStatusCode(c.status));return b("ZenonMWTranslatorUtils").createMWMessage(d,{serverMediaUpdateResponse:e})}function J(a,c){var d={currentVersion:c.acknowledgedVersion};a=b("ZenonMWTranslatorUtils").signalingMessageHeaderToMWResponseHeader(a,j.SERVER_MEDIA_UPDATE,b("ZenonMWTranslatorUtils").toMWResponseStatusCode(c.status));return b("ZenonMWTranslatorUtils").createMWMessage(a,{serverMediaUpdateResponse:d})}e.exports=c}),null);
__d("ZenonP2PTranslatorUtils",["CurrentUser","ZenonDismissReason","ZenonP2PMessageTypes"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonDismissReason").ZenonDismissReason,h=b("ZenonP2PMessageTypes").ZenonP2PCallEndReason;a={fromP2PCallEndReason:function(a){a=i[a];return(a=a)!=null?a:g.CALL_ENDED},p2pMessageToSignalingMessageHeader:function(a,c){var d=c.call_id,e=c.from;c=c.source;var f=e+":"+b("CurrentUser").getID();return{messageID:a,protocol:"p2p",remoteInfo:{deviceInfo:{deviceID:c},userID:e},remoteSignalingID:String(d),retryCount:0,roomInfo:{name:f},signalingID:String(d),userInfo:{userID:b("CurrentUser").getID()}}},toP2PCallEndReason:function(a){a=j[a];return(a=a)!=null?a:h.HANGUP_CALL}};var i=Object.freeze((c={},c[h.HANGUP_CALL]=g.HANGUP_CALL,c[h.IGNORE_CALL]=g.IGNORE_CALL,c[h.IN_ANOTHER_CALL]=g.IN_ANOTHER_CALL,c[h.ACCEPT_AFTER_HANGUP]=g.ACCEPT_AFTER_HANGUP,c[h.NO_ANSWER_TIMEOUT]=g.NO_ANSWER_TIMEOUT,c[h.INCOMING_TIMEOUT]=g.INCOMING_TIMEOUT,c[h.OTHER_INSTANCE_HANDLED]=g.OTHER_INSTANCE_HANDLED,c[h.SIGNALING_MESSAGE_FAILED]=g.SIGNALING_MESSAGE_FAILED,c[h.CONNECTION_DROPPED]=g.CONNECTION_DROPPED,c[h.CLIENT_INTERRUPTED]=g.CLIENT_INTERRUPTED,c[h.WEBRTC_ERROR]=g.WEBRTC_ERROR,c[h.CLIENT_ERROR]=g.CLIENT_ERROR,c[h.NO_PERMISSION]=g.NO_PERMISSION,c[h.OTHER_NOT_CAPABLE]=g.OTHER_NOT_CAPABLE,c[h.NO_UI_ERROR]=g.NO_UI_ERROR,c[h.UNSUPPORTED_VERSION]=g.UNSUPPORTED_VERSION,c[h.CALLER_NOT_VISIBLE]=g.CALLER_NOT_VISIBLE,c[h.CARRIER_BLOCKED]=g.CARRIER_BLOCKED,c[h.OTHER_CARRIER_BLOCKED]=g.OTHER_CARRIER_BLOCKED,c[h.CLIENT_ENCRYPTION_ERROR]=g.CLIENT_ENCRYPTION_ERROR,c)),j=Object.freeze((d={},d[g.HANGUP_CALL]=h.HANGUP_CALL,d[g.IGNORE_CALL]=h.IGNORE_CALL,d[g.IN_ANOTHER_CALL]=h.IN_ANOTHER_CALL,d[g.ACCEPT_AFTER_HANGUP]=h.ACCEPT_AFTER_HANGUP,d[g.NO_ANSWER_TIMEOUT]=h.NO_ANSWER_TIMEOUT,d[g.INCOMING_TIMEOUT]=h.INCOMING_TIMEOUT,d[g.OTHER_INSTANCE_HANDLED]=h.OTHER_INSTANCE_HANDLED,d[g.SIGNALING_MESSAGE_FAILED]=h.SIGNALING_MESSAGE_FAILED,d[g.CONNECTION_DROPPED]=h.CONNECTION_DROPPED,d[g.CLIENT_INTERRUPTED]=h.CLIENT_INTERRUPTED,d[g.WEBRTC_ERROR]=h.WEBRTC_ERROR,d[g.CLIENT_ERROR]=h.CLIENT_ERROR,d[g.NO_PERMISSION]=h.NO_PERMISSION,d[g.OTHER_NOT_CAPABLE]=h.OTHER_NOT_CAPABLE,d[g.NO_UI_ERROR]=h.NO_UI_ERROR,d[g.UNSUPPORTED_VERSION]=h.UNSUPPORTED_VERSION,d[g.CALLER_NOT_VISIBLE]=h.CALLER_NOT_VISIBLE,d[g.CARRIER_BLOCKED]=h.CARRIER_BLOCKED,d[g.OTHER_CARRIER_BLOCKED]=h.OTHER_CARRIER_BLOCKED,d[g.CLIENT_ENCRYPTION_ERROR]=h.CLIENT_ENCRYPTION_ERROR,d));e.exports=a}),null);
__d("ZenonP2PMessageTranslator",["errorCode","ZenonDismissReason","ZenonP2PMessageTypes","ZenonP2PTranslatorUtils","ZenonParticipantState","ZenonSignalingMessage"],(function(a,b,c,d,e,f,g){"use strict";var h=b("ZenonDismissReason").ZenonDismissReason,i=b("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType,j=b("ZenonParticipantState").ZenonParticipantState,k=0,l=3;a={toP2PMessage:function(a){var b=a.getHeader();a=a.getEvents();if(a.length===0)throw new Error("Unexpected Translation: called toP2PMessage with empty signaling events");switch(a[0].eventName){case"answerIntentRequest":return t(b);case"inviteResponse":if(a[0].status==="NOT_SUPPORTED")return r(b);else return q(b);case"terminateRequest":return s(b,a[0]);default:return null}},toSignalingMessage:function(a){switch(a.type){case i.OFFER:return m(a);case i.HANG_UP:return n(a);case i.OTHER_DISMISS:return o(a);case i.ICE_CANDIDATE:return p(a);default:return null}}};function m(a){var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.escalation_conference_name,f=a.from,g=a.videoon;g={eventName:"inviteRequest",inviterID:f,isRemoteOfferer:!0,otherParticipants:[],requestingVideo:g,roomInfo:{context:{groupThreadID:null,peerID:f,serverInfoData:null},name:e}};d.push(g);e={eventName:"remoteSdpRequest",sdp:{sdp:a.sdp,type:"offer",version:0},mediaStates:{tracks:[],version:0},negotiateType:!1};d.push(e);g={capabilities:{addParticipantEnabled:a.offer_escalation_support},eventName:"capabilitiesRequest"};d.push(g);e=new Map([[f,j.CONNECTED]]);a={eventName:"participantUpdateRequest",participantStates:e,versionId:k};d.push(a);return new(b("ZenonSignalingMessage"))(c,d)}function n(a){var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.from;a=a.reason;a={eventName:"terminateRequest",fromJoinResponse:!1,reason:b("ZenonP2PTranslatorUtils").fromP2PCallEndReason(a),shouldInformPeer:!0};d.push(a);a=new Map([[e,j.DISCONNECTED]]);e={eventName:"participantUpdateRequest",participantStates:a,versionId:l};d.push(e);return new(b("ZenonSignalingMessage"))(c,d)}function o(a){a=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a);var c=[],d={eventName:"terminateRequest",fromJoinResponse:!1,reason:h.OTHER_INSTANCE_HANDLED,shouldInformPeer:!0};c.push(d);return new(b("ZenonSignalingMessage"))(a,c)}function p(a){var c=b("ZenonP2PTranslatorUtils").p2pMessageToSignalingMessageHeader(String(a.msg_id),a),d=[],e=a.sdp,f=a.sdp_line_idx;a=a.sdp_mid;e={candidateSdpString:e,sdpMLineIndex:f,sdpMid:a};f={eventName:"iceCandidateRequest",iceCandidates:[e]};d.push(f);return new(b("ZenonSignalingMessage"))(c,d)}function q(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");return{ack_id:parseInt(a.messageID,10),call_id:parseInt(a.signalingID,10),msg_id:parseInt(a.messageID,10),type:"offer_ack"}}function r(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");return{ack_id:parseInt(a.messageID,10),call_id:parseInt(a.signalingID,10),error_code:1356043,msg_id:parseInt(a.messageID,10),type:"offer_nack"}}function s(a,c){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");var d=parseInt(a.messageID,10);a=parseInt(a.signalingID,10);c=b("ZenonP2PTranslatorUtils").toP2PCallEndReason(c.reason);return{call_id:a,msg_id:d,reason:c,type:"hang_up",version:0}}function t(a){if(a.signalingID===null)throw new Error("Unexpected P2P Translation: expected signalingID to not be null");var b=parseInt(a.signalingID,10);a=parseInt(a.messageID,10);return{call_id:b,msg_id:a,type:"other_dismiss"}}e.exports=a}),null);
__d("ZenonP2PMessageValidator",["ZenonP2PMessageTypes"],(function(a,b,c,d,e,f){"use strict";var g=b("ZenonP2PMessageTypes").ZenonP2PSignalingPayloadType;a={validateAndTransformP2PMessage:function(a){a=h(a);if(a){var b=a.msg_type;switch(b){case g.OFFER:return j(a);case g.HANG_UP:return k(a);case g.ICE_CANDIDATE:return i(a);case g.OTHER_DISMISS:return l(a)}}return null}};function h(a){a=JSON.parse(a);var b=a.call_id,c=a.from,d=a.id,e=a.msg_type,f=a.payload,g=a.source;a=a.type;if(c&&b&&f){b={call_id:b,from:c,id:d,msg_type:e,payload:f,source:g,type:a};return b}else throw Error("P2P message does not have valid from, call_id, and payload fields")}function i(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var d=c.call_id,e=c.capability,f=c.label,h=c.msg_id,i=c.sdp,j=c.sdp_line_idx,k=c.sdp_mid;c=c.version;d={call_id:d,capability:e,from:b,label:f,msg_id:h,sdp:i,sdp_line_idx:j,sdp_mid:k,source:a,type:g.ICE_CANDIDATE,version:c};return d}function j(a){var b,c,d,e,f=a.from,h=a.payload;a=a.source;h=JSON.parse(h);var i=h.call_id,j=h.calltype,k=h.capability;b=(b=h.escalation_conference_name)!=null?b:null;c=(c=h.experiments)!=null?c:[];d=(d=h.extraParams)!=null?d:[];e=(e=h.fbexp)!=null?e:"";var l=h.handlescollision!==void 0?h.handlescollision:!1,m=h.offer_escalation_support!==void 0?h.offer_escalation_support:!1,n=h.msg_id,o=h.sdp;h=h.videoon;i={call_id:i,calltype:j,capability:k,escalation_conference_name:b,experiments:c,extraParams:d,fbexp:e,from:f,handlescollision:l,msg_id:n,offer_escalation_support:m,sdp:o,source:a,type:g.OFFER,videoon:h};return i}function k(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var d=c.call_id,e=c.capability,f=c.msg_id,h=c.reason;c=c.subreason;d={call_id:d,capability:e,from:b,msg_id:f,reason:h,source:a,subreason:c,type:g.HANG_UP};return d}function l(a){var b=a.from,c=a.payload;a=a.source;c=JSON.parse(c);var d=c.call_id,e=c.capability;c=c.msg_id;d={call_id:d,capability:e,from:b,msg_id:c,source:a,type:g.OTHER_DISMISS};return d}e.exports=a}),null);
__d("RTWebSignalingListener",["FBMqttChannel","ZenonDebugLogger","ZenonMWMessageTranslator","ZenonP2PMessageTranslator","ZenonP2PMessageValidator","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.subscribe=function(a,c,d){var e=this;b("FBMqttChannel").subscribe("/webrtc",function(d){var f=b("ZenonP2PMessageValidator").validateAndTransformP2PMessage(d);e.$1(d,c);if(f){d=b("ZenonP2PMessageTranslator").toSignalingMessage(f);d&&a(d)}});b("FBMqttChannel").subscribe("/rtc_multi",function(c){var f=JSON.parse(c);b("ZenonDebugLogger").getInstance().logMWMessage("RECEIVED [MQTT]",f);f=b("ZenonMWMessageTranslator").toSignalingMessage(f);f&&(a(f),d&&e.$2(c,d))})};c.unsubscribe=function(){b("FBMqttChannel").unsubscribeAll("/webrtc"),b("FBMqttChannel").unsubscribeAll("/rtc_multi")};c.$1=function(a,c){try{a=JSON.parse(a);c(a)}catch(a){b("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};c.$2=function(a,c){try{a=JSON.parse(a);c(a)}catch(a){b("recoverableViolation")("Signaling messages should be json parsable. error:"+a,"rtweb")}};return a}();e.exports=a}),null);