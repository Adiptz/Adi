if (self.CavalryLogger) { CavalryLogger.start_js(["3PIgg"]); }

__d("FBMapZoomMessage.react",["cx","fbt","React"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j=String.fromCodePoint(8984),k=window.navigator.platform,l=["Macintosh","MacIntel","MacPPC","Mac68K","iPhone","iPad","iPod"],m=null;a=function(){l.indexOf(k)!=-1&&(m="mac");if(m!="mac")return i.jsx("div",{className:"_928y",children:i.jsx("div",{className:"_9293",children:h._("Use ctrl + scroll to zoom the map")})});else return i.jsx("div",{className:"_928y",children:i.jsx("div",{className:"_9293",children:h._("Use {command symbol} + scroll to zoom the map",[h._param("command symbol",j)])})})};e.exports=a}),null);
__d("FBMapZoomOverlay.react",["ix","fbt","FDSButton.react","FlexLayout.react","Image.react","React","asset"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j=i.jsx(a=b("Image.react"),{src:g("492052")}),k=i.jsx(a,{src:g("541450")}),l=i.jsx(a,{src:g("563526")}),m=i.jsx(a,{src:g("587704")});c=function(a){var c=a.className,d=a.onZoomIn,e=a.onZoomOut;a=a.onRecenter;return i.jsx("div",{className:c,children:i.jsxs(b("FlexLayout.react"),{direction:"vertical",children:[i.jsx(b("FDSButton.react"),{icon:d==null?k:j,isDisabled:d==null,label:h._("Zoom In"),labelIsHidden:!0,onClick:d,size:"small",type:"button",width:24}),i.jsx(b("FDSButton.react"),{icon:e==null?m:l,isDisabled:e==null,label:h._("Zoom Out"),labelIsHidden:!0,onClick:e,size:"small",type:"button",width:24}),a?i.jsx(b("FDSButton.react"),{icon:i.jsx(b("Image.react"),{src:g("621541")}),label:h._("Recenter"),labelIsHidden:!0,onClick:a,size:"small",type:"button",style:{marginTop:8},width:24}):null]})})};e.exports=c}),null);
__d("FBTilesAttributionLogo.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){switch(a.mapProvider){case"OSM":return h.jsx("div",{className:b("joinClasses")(a.className,"_wuu"),children:"\xa9 OpenStreetMap"});case"MAPBOX":return h.jsx("div",{className:b("joinClasses")(a.className,"_6o-0"),children:h.jsx("span",{className:"_6o-1","aria-label":"Mapbox logo"})});case"DG":return h.jsx("div",{className:b("joinClasses")(a.className,"_wuu"),children:"Imagery \xa9 DigitalGlobe, Inc"});default:return null}};e.exports=a}),null);
__d("FBMapBaseStyles",[],(function(a,b,c,d,e,f){"use strict";a="pk.eyJ1IjoiZmJtYXBzIiwiYSI6ImNqOGFmamkxdTBmbzUyd28xY3lybnEwamIifQ.oabgbuGc81ENlOJoPhv4OQ";b="pk.eyJ1IjoiZGlnaXRhbGdsb2JlIiwiYSI6ImNpd2ZteHV1bjAwZXEyb21tcWZocmNoODIifQ.BIVHHSfx1pIaWoEyvgtiQg";c={options:{DEFAULT:"mapbox://styles/fbmaps/ck393xsbz45su1cny29f1kg63",INTERN_ONLY_LIGHT:"mapbox://styles/mapbox/light-v9",INTERN_ONLY_DARK:"mapbox://styles/mapbox/dark-v9",INTERN_ONLY_SATELLITE:"mapbox://styles/mapbox/satellite-v9",INTERN_ONLY_LIGHT_CUSTOMIZE:"mapbox://styles/fbmaps/cjmmaqchy0ire2rn4nkwwd199",BANKSY:"mapbox://styles/fbmaps/cjsqcrmlm1wf51fs6ryvon5cs",OUTDOORS:"mapbox://styles/fbmaps/cj8eldcsv19iu2spesqr8mhxl"},accessToken:a};d={options:{SATELLITE_PREMIUM:"mapbox://styles/digitalglobe/cis9un3vw00402yqngmmi6dk6",SATELLITE_RECENT:"mapbox://styles/digitalglobe/ciode6t5k0081aqm7k06dod4v"},accessToken:b};e.exports={mapboxBaseStyle:c,digitalGlobeBaseStyle:d}}),null);
__d("FBMapConfigs",[],(function(a,b,c,d,e,f){"use strict";e.exports={MIN_ZOOM:0,MAX_ZOOM:22}}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("turf-helpers-6.1.4",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){Object.defineProperty(g,"__esModule",{value:!0});g.earthRadius=6371008.8;g.factors={centimeters:g.earthRadius*100,centimetres:g.earthRadius*100,degrees:g.earthRadius/111325,feet:g.earthRadius*3.28084,inches:g.earthRadius*39.37,kilometers:g.earthRadius/1e3,kilometres:g.earthRadius/1e3,meters:g.earthRadius,metres:g.earthRadius,miles:g.earthRadius/1609.344,millimeters:g.earthRadius*1e3,millimetres:g.earthRadius*1e3,nauticalmiles:g.earthRadius/1852,radians:1,yards:g.earthRadius/1.0936};g.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/g.earthRadius,yards:1/1.0936};g.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function a(a,b,c){c===void 0&&(c={});var d={type:"Feature"};(c.id===0||c.id)&&(d.id=c.id);c.bbox&&(d.bbox=c.bbox);d.properties=b||{};d.geometry=a;return d}g.feature=a;function b(a,b,d){d===void 0&&({});switch(a){case"Point":return c(b).geometry;case"LineString":return h(b).geometry;case"Polygon":return e(b).geometry;case"MultiPoint":return l(b).geometry;case"MultiLineString":return k(b).geometry;case"MultiPolygon":return m(b).geometry;default:throw new Error(a+" is invalid")}}g.geometry=b;function c(b,c,d){d===void 0&&(d={});b={type:"Point",coordinates:b};return a(b,c,d)}g.point=c;function d(a,b,d){d===void 0&&(d={});return j(a.map(function(a){return c(a,b)}),d)}g.points=d;function e(b,c,d){d===void 0&&(d={});for(var e=0,f=b;e<f.length;e++){var g=f[e];if(g.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var h=0;h<g[g.length-1].length;h++)if(g[g.length-1][h]!==g[0][h])throw new Error("First and last Position are not equivalent.")}h={type:"Polygon",coordinates:b};return a(h,c,d)}g.polygon=e;function f(a,b,c){c===void 0&&(c={});return j(a.map(function(a){return e(a,b)}),c)}g.polygons=f;function h(b,c,d){d===void 0&&(d={});if(b.length<2)throw new Error("coordinates must be an array of two or more positions");b={type:"LineString",coordinates:b};return a(b,c,d)}g.lineString=h;function i(a,b,c){c===void 0&&(c={});return j(a.map(function(a){return h(a,b)}),c)}g.lineStrings=i;function j(a,b){b===void 0&&(b={});var c={type:"FeatureCollection"};b.id&&(c.id=b.id);b.bbox&&(c.bbox=b.bbox);c.features=a;return c}g.featureCollection=j;function k(b,c,d){d===void 0&&(d={});b={type:"MultiLineString",coordinates:b};return a(b,c,d)}g.multiLineString=k;function l(b,c,d){d===void 0&&(d={});b={type:"MultiPoint",coordinates:b};return a(b,c,d)}g.multiPoint=l;function m(b,c,d){d===void 0&&(d={});b={type:"MultiPolygon",coordinates:b};return a(b,c,d)}g.multiPolygon=m;function n(b,c,d){d===void 0&&(d={});b={type:"GeometryCollection",geometries:b};return a(b,c,d)}g.geometryCollection=n;function o(a,b){b===void 0&&(b=0);if(b&&!(b>=0))throw new Error("precision must be a positive number");b=Math.pow(10,b||0);return Math.round(a*b)/b}g.round=o;function p(a,b){b===void 0&&(b="kilometers");var c=g.factors[b];if(!c)throw new Error(b+" units is invalid");return a*c}g.radiansToLength=p;function q(a,b){b===void 0&&(b="kilometers");var c=g.factors[b];if(!c)throw new Error(b+" units is invalid");return a/c}g.lengthToRadians=q;function r(a,b){return t(q(a,b))}g.lengthToDegrees=r;function s(a){a=a%360;a<0&&(a+=360);return a}g.bearingToAzimuth=s;function t(a){a=a%(2*Math.PI);return a*180/Math.PI}g.radiansToDegrees=t;function u(a){a=a%360;return a*Math.PI/180}g.degreesToRadians=u;function v(a,b,c){b===void 0&&(b="kilometers");c===void 0&&(c="kilometers");if(!(a>=0))throw new Error("length must be a positive number");return p(q(a,b),c)}g.convertLength=v;function w(a,b,c){b===void 0&&(b="meters");c===void 0&&(c="kilometers");if(!(a>=0))throw new Error("area must be a positive number");b=g.areaFactors[b];if(!b)throw new Error("invalid original units");c=g.areaFactors[c];if(!c)throw new Error("invalid final units");return a/b*c}g.convertArea=w;function x(a){return!isNaN(a)&&a!==null&&!Array.isArray(a)&&!/^\s*$/.test(a)}g.isNumber=x;function y(a){return!!a&&a.constructor===Object}g.isObject=y;function z(a){if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(a.length!==4&&a.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(a){if(!x(a))throw new Error("bbox must only contain numbers")})}g.validateBBox=z;function A(a){if(!a)throw new Error("id is required");if(["string","number"].indexOf(typeof a)===-1)throw new Error("id must be a number or a string")}g.validateId=A;function B(){throw new Error("method has been renamed to `radiansToDegrees`")}g.radians2degrees=B;function C(){throw new Error("method has been renamed to `degreesToRadians`")}g.degrees2radians=C;function D(){throw new Error("method has been renamed to `lengthToDegrees`")}g.distanceToDegrees=D;function E(){throw new Error("method has been renamed to `lengthToRadians`")}g.distanceToRadians=E;function F(){throw new Error("method has been renamed to `radiansToLength`")}g.radiansToDistance=F;function G(){throw new Error("method has been renamed to `bearingToAzimuth`")}g.bearingToAngle=G;function H(){throw new Error("method has been renamed to `convertLength`")}g.convertDistance=H}var j=!1,k=function(){j||(j=!0,i());return h.exports};a=function(a){switch(a){case void 0:return k()}};e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("turf-invariant-6.1.2",["turf-helpers-6.1.4"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("turf-helpers-6.1.4")),h={},i={exports:h};function j(){Object.defineProperty(h,"__esModule",{value:!0});var a=g();function b(a){if(!a)throw new Error("coord is required");if(!Array.isArray(a)){if(a.type==="Feature"&&a.geometry!==null&&a.geometry.type==="Point")return a.geometry.coordinates;if(a.type==="Point")return a.coordinates}if(Array.isArray(a)&&a.length>=2&&!Array.isArray(a[0])&&!Array.isArray(a[1]))return a;throw new Error("coord must be GeoJSON Point or an Array of numbers")}h.getCoord=b;function c(a){if(Array.isArray(a))return a;if(a.type==="Feature"){if(a.geometry!==null)return a.geometry.coordinates}else if(a.coordinates)return a.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}h.getCoords=c;function d(b){if(b.length>1&&a.isNumber(b[0])&&a.isNumber(b[1]))return!0;if(Array.isArray(b[0])&&b[0].length)return d(b[0]);throw new Error("coordinates must only contain numbers")}h.containsNumber=d;function e(a,b,c){if(!b||!c)throw new Error("type and name required");if(!a||a.type!==b)throw new Error("Invalid input to "+c+": must be a "+b+", given "+a.type)}h.geojsonType=e;function f(a,b,c){if(!a)throw new Error("No feature passed");if(!c)throw new Error(".featureOf() requires a name");if(!a||a.type!=="Feature"||!a.geometry)throw new Error("Invalid input to "+c+", Feature with geometry required");if(!a.geometry||a.geometry.type!==b)throw new Error("Invalid input to "+c+": must be a "+b+", given "+a.geometry.type)}h.featureOf=f;function i(a,b,c){if(!a)throw new Error("No featureCollection passed");if(!c)throw new Error(".collectionOf() requires a name");if(!a||a.type!=="FeatureCollection")throw new Error("Invalid input to "+c+", FeatureCollection required");for(var d=0,a=a.features;d<a.length;d++){var e=a[d];if(!e||e.type!=="Feature"||!e.geometry)throw new Error("Invalid input to "+c+", Feature with geometry required");if(!e.geometry||e.geometry.type!==b)throw new Error("Invalid input to "+c+": must be a "+b+", given "+e.geometry.type)}}h.collectionOf=i;function j(a){return a.type==="Feature"?a.geometry:a}h.getGeom=j;function k(a,b){if(a.type==="FeatureCollection")return"FeatureCollection";if(a.type==="GeometryCollection")return"GeometryCollection";return a.type==="Feature"&&a.geometry!==null?a.geometry.type:a.type}h.getType=k}var k=!1,l=function(){k||(k=!0,j());return i.exports};c=function(a){switch(a){case void 0:return l()}};e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("turf-destination-6.0.1",["turf-helpers-6.1.4","turf-invariant-6.1.2"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("turf-helpers-6.1.4")),h=a(b("turf-invariant-6.1.2")),i={},j={exports:i};function k(){Object.defineProperty(i,"__esModule",{value:!0});var a=g(),b=h();function c(c,d,e,f){f===void 0&&(f={});c=b.getCoord(c);var g=a.degreesToRadians(c[0]);c=a.degreesToRadians(c[1]);e=a.degreesToRadians(e);d=a.lengthToRadians(d,f.units);var h=Math.asin(Math.sin(c)*Math.cos(d)+Math.cos(c)*Math.sin(d)*Math.cos(e));g=g+Math.atan2(Math.sin(e)*Math.sin(d)*Math.cos(c),Math.cos(d)-Math.sin(c)*Math.sin(h));e=a.radiansToDegrees(g);d=a.radiansToDegrees(h);return a.point([e,d],f.properties)}i["default"]=c}var l=!1,m=function(){l||(l=!0,k());return j.exports};c=function(a){switch(a){case void 0:return m()}};e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/MDzNl_j9yvg/
 */
__d("turf-circle-6.0.1",["turf-destination-6.0.1","turf-helpers-6.1.4"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("turf-destination-6.0.1")),h=a(b("turf-helpers-6.1.4")),i={},j={exports:i};function k(){Object.defineProperty(i,"__esModule",{value:!0});var a=g(),b=h();function c(c,d,e){e===void 0&&(e={});var f=e.steps||64,g=e.properties?e.properties:!Array.isArray(c)&&c.type==="Feature"&&c.properties?c.properties:{},h=[];for(var i=0;i<f;i++)h.push(a["default"](c,d,i*-360/f,e).geometry.coordinates);h.push(h[0]);return b.polygon([h],g)}i["default"]=c}var l=!1,m=function(){l||(l=!0,k());return j.exports};c=function(a){switch(a){case void 0:return m()}};e.exports=c}),null);
__d("turf-circle",["turf-circle-6.0.1"],(function(a,b,c,d,e,f){e.exports=b("turf-circle-6.0.1")()}),null);
__d("FBMapCircle",["turf-circle"],(function(a,b,c,d,e,f){"use strict";var g=b("turf-circle")["default"];a=function(a,b){return{type:"geojson",data:g(a,b)}};c=function(a,b){var c=[];b.fill!=null&&c.push({id:a+"_fill",type:"fill",source:a,paint:b.fill});b.line!=null&&c.push({id:a+"_line",type:"line",source:a,paint:b.line});return c};e.exports={getCircleSource:a,getCircleLayers:c}}),null);
__d("FBMapStyleUtils",["FBMapBaseStyles","immutable"],(function(a,b,c,d,e,f){"use strict";a={version:8,name:"FBMapStyleName",metadata:b("immutable").Map(),sources:b("immutable").Map(),layers:b("immutable").List()};c=function(a){return a==null?!1:a.startsWith("mapbox://")};d=function(a){return((a=a)!=null?a:"").includes("/digitalglobe/")};f=function(a){var c=Object.keys(b("FBMapBaseStyles")).find(function(c){c=b("FBMapBaseStyles")[c];var d=c.options;c=c.accessToken;if(Object.values(d).includes(a))return c});return c==null?b("FBMapBaseStyles").mapboxBaseStyle.accessToken:b("FBMapBaseStyles")[c].accessToken};e.exports={EMPTY_STYLE:a,isMapboxStyle:c,isDigitalGlobe:d,getAccessToken:f}}),null);
__d("immutable-v4-rc-9",[],(function(a,b,c,d,e,f){(function(b,c){typeof f==="object"&&e!=="undefined"?c(f):typeof define==="function"&&define.amd?define(["exports"],c):c(b.Immutable={})})(this,function(a){"use strict";var b="delete",c=5,d=1<<c,e=d-1,g={},h={value:!1},i={value:!1};function j(a){a.value=!1;return a}function k(a){a&&(a.value=!0)}function l(){}function m(a){a.size===void 0&&(a.size=a.__iterate(o));return a.size}function n(a,b){if(typeof b!=="number"){var c=b>>>0;if(""+c!==b||c===4294967295)return NaN;b=c}return b<0?m(a)+b:b}function o(){return!0}function p(a,b,c){return(a===0&&!aa(a)||c!==void 0&&a<=-c)&&(b===void 0||c!==void 0&&b>=c)}function q(a,b){return s(a,b,0)}function r(a,b){return s(a,b,b)}function s(a,b,c){return a===void 0?c:aa(a)?b===Infinity?b:Math.max(0,b+a)|0:b===void 0||b===a?a:Math.min(b,a)|0}function aa(a){return a<0||a===0&&1/a===-Infinity}function t(a){return u(a)||ca(a)}function u(a){return!!(a&&a[ea])}function v(a){return!!(a&&a[fa])}function w(a){return!!(a&&a[ga])}function ba(a){return v(a)||w(a)}function x(a){return!!(a&&a[ha])}function ca(a){return!!(a&&a[ia])}function da(a){return!!(a&&typeof a.equals==="function"&&typeof a.hashCode==="function")}var ea="@@__IMMUTABLE_ITERABLE__@@",fa="@@__IMMUTABLE_KEYED__@@",ga="@@__IMMUTABLE_INDEXED__@@",ha="@@__IMMUTABLE_ORDERED__@@",ia="@@__IMMUTABLE_RECORD__@@",y=function(a){return u(a)?a:G(a)},z=function(a){function b(a){return v(a)?a:H(a)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;return b}(y),ja=function(a){function b(a){return w(a)?a:I(a)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;return b}(y),A=function(a){function b(a){return u(a)&&!ba(a)?a:ua(a)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;return b}(y);y.Keyed=z;y.Indexed=ja;y.Set=A;var ka=0,B=1,C=2,la=typeof Symbol==="function"&&Symbol.iterator,ma="@@iterator",na=la||ma,D=function(a){this.next=a};D.prototype.toString=function(){return"[Iterator]"};D.KEYS=ka;D.VALUES=B;D.ENTRIES=C;D.prototype.inspect=D.prototype.toSource=function(){return this.toString()};D.prototype[na]=function(){return this};function E(a,b,c,d){a=a===0?b:a===1?c:[b,c];d?d.value=a:d={value:a,done:!1};return d}function F(){return{value:void 0,done:!0}}function oa(a){return!!ra(a)}function pa(a){return a&&typeof a.next==="function"}function qa(a){var b=ra(a);return b&&b.call(a)}function ra(a){a=a&&(la&&a[la]||a[ma]);if(typeof a==="function")return a}var sa=Object.prototype.hasOwnProperty;function ta(a){return a&&typeof a.length==="number"}var G=function(b){function a(a){return a===null||a===void 0?Ca():t(a)?a.toSeq():Fa(a)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.toSeq=function(){return this};a.prototype.toString=function(){return this.__toString("Seq {","}")};a.prototype.cacheResult=function(){!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length);return this};a.prototype.__iterate=function(a,b){var c=this,d=this._cache;if(d){var e=d.length,f=0;while(f!==e){var g=d[b?e-++f:f++];if(a(g[1],g[0],c)===!1)break}return f}return this.__iterateUncached(a,b)};a.prototype.__iterator=function(a,b){var c=this._cache;if(c){var d=c.length,e=0;return new D(function(){if(e===d)return F();var f=c[b?d-++e:e++];return E(a,f[0],f[1])})}return this.__iteratorUncached(a,b)};return a}(y),H=function(a){function b(a){return a===null||a===void 0?Ca().toKeyedSeq():u(a)?v(a)?a.toSeq():a.fromEntrySeq():ca(a)?a.toSeq():Da(a)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.toKeyedSeq=function(){return this};return b}(G),I=function(a){function b(a){return a===null||a===void 0?Ca():u(a)?v(a)?a.entrySeq():a.toIndexedSeq():ca(a)?a.toSeq().entrySeq():Ea(a)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.of=function(){return b(arguments)};b.prototype.toIndexedSeq=function(){return this};b.prototype.toString=function(){return this.__toString("Seq [","]")};return b}(G),ua=function(a){function b(a){return(u(a)&&!ba(a)?a:I(a)).toSetSeq()}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.of=function(){return b(arguments)};b.prototype.toSetSeq=function(){return this};return b}(G);G.isSeq=Aa;G.Keyed=H;G.Set=ua;G.Indexed=I;var va="@@__IMMUTABLE_SEQ__@@";G.prototype[va]=!0;var wa=function(a){function b(a){this._array=a,this.size=a.length}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.get=function(a,b){return this.has(a)?this._array[n(this,a)]:b};b.prototype.__iterate=function(a,b){var c=this,d=this._array,e=d.length,f=0;while(f!==e){var g=b?e-++f:f++;if(a(d[g],g,c)===!1)break}return f};b.prototype.__iterator=function(a,b){var c=this._array,d=c.length,e=0;return new D(function(){if(e===d)return F();var f=b?d-++e:e++;return E(a,f,c[f])})};return b}(I),xa=function(a){function b(a){var b=Object.keys(a);this._object=a;this._keys=b;this.size=b.length}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.get=function(a,b){return b!==void 0&&!this.has(a)?b:this._object[a]};b.prototype.has=function(a){return sa.call(this._object,a)};b.prototype.__iterate=function(a,b){var c=this,d=this._object,e=this._keys,f=e.length,g=0;while(g!==f){var h=e[b?f-++g:g++];if(a(d[h],h,c)===!1)break}return g};b.prototype.__iterator=function(a,b){var c=this._object,d=this._keys,e=d.length,f=0;return new D(function(){if(f===e)return F();var g=d[b?e-++f:f++];return E(a,g,c[g])})};return b}(H);xa.prototype[ha]=!0;var ya=function(a){function b(a){this._collection=a,this.size=a.length||a.size}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.__iterateUncached=function(a,b){var c=this;if(b)return this.cacheResult().__iterate(a,b);b=this._collection;b=qa(b);var d=0;if(pa(b)){var e;while(!(e=b.next()).done)if(a(e.value,d++,c)===!1)break}return d};b.prototype.__iteratorUncached=function(a,b){if(b)return this.cacheResult().__iterator(a,b);b=this._collection;var c=qa(b);if(!pa(c))return new D(F);var d=0;return new D(function(){var b=c.next();return b.done?b:E(a,d++,b.value)})};return b}(I),za=function(a){function b(a){this._iterator=a,this._iteratorCache=[]}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.__iterateUncached=function(a,b){var c=this;if(b)return this.cacheResult().__iterate(a,b);b=this._iterator;var d=this._iteratorCache,e=0;while(e<d.length)if(a(d[e],e++,c)===!1)return e;var f;while(!(f=b.next()).done){f=f.value;d[e]=f;if(a(f,e++,c)===!1)break}return e};b.prototype.__iteratorUncached=function(a,b){if(b)return this.cacheResult().__iterator(a,b);var c=this._iterator,d=this._iteratorCache,e=0;return new D(function(){if(e>=d.length){var b=c.next();if(b.done)return b;d[e]=b.value}return E(a,e,d[e++])})};return b}(I);function Aa(a){return!!(a&&a[va])}var Ba;function Ca(){return Ba||(Ba=new wa([]))}function Da(a){var b=Array.isArray(a)?new wa(a):pa(a)?new za(a):oa(a)?new ya(a):void 0;if(b)return b.fromEntrySeq();if(typeof a==="object")return new xa(a);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+a)}function Ea(a){var b=Ga(a);if(b)return b;throw new TypeError("Expected Array or collection object of values: "+a)}function Fa(a){var b=Ga(a);if(b)return b;if(typeof a==="object")return new xa(a);throw new TypeError("Expected Array or collection object of values, or keyed object: "+a)}function Ga(a){return ta(a)?new wa(a):pa(a)?new za(a):oa(a)?new ya(a):void 0}function J(a,b){if(a===b||a!==a&&b!==b)return!0;if(!a||!b)return!1;if(typeof a.valueOf==="function"&&typeof b.valueOf==="function"){a=a.valueOf();b=b.valueOf();if(a===b||a!==a&&b!==b)return!0;if(!a||!b)return!1}return!!(da(a)&&da(b)&&a.equals(b))}var Ha=typeof Math.imul==="function"&&Math.imul(4294967295,2)===-2?Math.imul:function(a,b){a|=0;b|=0;var c=a&65535,d=b&65535;return c*d+((a>>>16)*d+c*(b>>>16)<<16>>>0)|0};function Ia(a){return a>>>1&1073741824|a&3221225471}function K(a){if(a===!1||a===null||a===void 0)return 0;if(typeof a.valueOf==="function"){a=a.valueOf();if(a===!1||a===null||a===void 0)return 0}if(a===!0)return 1;var b=typeof a;if(b==="number"){if(a!==a||a===Infinity)return 0;var c=a|0;c!==a&&(c^=a*4294967295);while(a>4294967295)a/=4294967295,c^=a;return Ia(c)}if(b==="string")return a.length>Ta?Ja(a):Ka(a);if(typeof a.hashCode==="function")return Ia(a.hashCode());if(b==="object")return La(a);if(typeof a.toString==="function")return Ka(a.toString());throw new Error("Value type "+b+" cannot be hashed.")}function Ja(a){var b=Wa[a];b===void 0&&(b=Ka(a),Va===Ua&&(Va=0,Wa={}),Va++,Wa[a]=b);return b}function Ka(a){var b=0;for(var c=0;c<a.length;c++)b=31*b+a.charCodeAt(c)|0;return Ia(b)}function La(a){var b;if(Pa){b=Qa.get(a);if(b!==void 0)return b}b=a[Sa];if(b!==void 0)return b;if(!Na){b=a.propertyIsEnumerable&&a.propertyIsEnumerable[Sa];if(b!==void 0)return b;b=Oa(a);if(b!==void 0)return b}b=++Ra;Ra&1073741824&&(Ra=0);if(Pa)Qa.set(a,b);else if(Ma!==void 0&&Ma(a)===!1)throw new Error("Non-extensible objects are not allowed as keys.");else if(Na)Object.defineProperty(a,Sa,{enumerable:!1,configurable:!1,writable:!1,value:b});else if(a.propertyIsEnumerable!==void 0&&a.propertyIsEnumerable===a.constructor.prototype.propertyIsEnumerable)a.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},a.propertyIsEnumerable[Sa]=b;else if(a.nodeType!==void 0)a[Sa]=b;else throw new Error("Unable to set a non-enumerable property on object.");return b}var Ma=Object.isExtensible,Na=function(){try{Object.defineProperty({},"@",{});return!0}catch(a){return!1}}();function Oa(a){if(a&&a.nodeType>0)switch(a.nodeType){case 1:return a.uniqueID;case 9:return a.documentElement&&a.documentElement.uniqueID}}var Pa=typeof WeakMap==="function",Qa;Pa&&(Qa=new WeakMap());var Ra=0,Sa="__immutablehash__";typeof Symbol==="function"&&(Sa=Symbol(Sa));var Ta=16,Ua=255,Va=0,Wa={},Xa=function(b){function a(a,b){this._iter=a,this._useKeys=b,this.size=a.size}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.get=function(a,b){return this._iter.get(a,b)};a.prototype.has=function(a){return this._iter.has(a)};a.prototype.valueSeq=function(){return this._iter.valueSeq()};a.prototype.reverse=function(){var a=this,b=cb(this,!0);this._useKeys||(b.valueSeq=function(){return a._iter.toSeq().reverse()});return b};a.prototype.map=function(a,b){var c=this,d=bb(this,a,b);this._useKeys||(d.valueSeq=function(){return c._iter.toSeq().map(a,b)});return d};a.prototype.__iterate=function(a,b){var c=this;return this._iter.__iterate(function(b,d){return a(b,d,c)},b)};a.prototype.__iterator=function(a,b){return this._iter.__iterator(a,b)};return a}(H);Xa.prototype[ha]=!0;var Ya=function(b){function a(a){this._iter=a,this.size=a.size}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.includes=function(a){return this._iter.includes(a)};a.prototype.__iterate=function(a,b){var c=this,d=0;b&&m(this);return this._iter.__iterate(function(e){return a(e,b?c.size-++d:d++,c)},b)};a.prototype.__iterator=function(a,b){var c=this,d=this._iter.__iterator(B,b),e=0;b&&m(this);return new D(function(){var f=d.next();return f.done?f:E(a,b?c.size-++e:e++,f.value,f)})};return a}(I),Za=function(b){function a(a){this._iter=a,this.size=a.size}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.has=function(a){return this._iter.includes(a)};a.prototype.__iterate=function(a,b){var c=this;return this._iter.__iterate(function(b){return a(b,b,c)},b)};a.prototype.__iterator=function(a,b){var c=this._iter.__iterator(B,b);return new D(function(){var b=c.next();return b.done?b:E(a,b.value,b.value,b)})};return a}(ua),$a=function(b){function a(a){this._iter=a,this.size=a.size}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.entrySeq=function(){return this._iter.toSeq()};a.prototype.__iterate=function(a,b){var c=this;return this._iter.__iterate(function(b){if(b){rb(b);var d=u(b);return a(d?b.get(1):b[1],d?b.get(0):b[0],c)}},b)};a.prototype.__iterator=function(a,b){var c=this._iter.__iterator(B,b);return new D(function(){while(!0){var b=c.next();if(b.done)return b;var d=b.value;if(d){rb(d);var e=u(d);return E(a,e?d.get(0):d[0],e?d.get(1):d[1],b)}}})};return a}(H);Ya.prototype.cacheResult=Xa.prototype.cacheResult=Za.prototype.cacheResult=$a.prototype.cacheResult=tb;function ab(a){var b=M(a);b._iter=a;b.size=a.size;b.flip=function(){return a};b.reverse=function(){var b=a.reverse.apply(this);b.flip=function(){return a.reverse()};return b};b.has=function(b){return a.includes(b)};b.includes=function(b){return a.has(b)};b.cacheResult=tb;b.__iterateUncached=function(b,c){var d=this;return a.__iterate(function(a,c){return b(c,a,d)!==!1},c)};b.__iteratorUncached=function(b,c){if(b===C){var d=a.__iterator(b,c);return new D(function(){var a=d.next();if(!a.done){var b=a.value[0];a.value[0]=a.value[1];a.value[1]=b}return a})}return a.__iterator(b===B?ka:B,c)};return b}function bb(a,b,c){var d=M(a);d.size=a.size;d.has=function(b){return a.has(b)};d.get=function(d,e){var f=a.get(d,g);return f===g?e:b.call(c,f,d,a)};d.__iterateUncached=function(d,e){var f=this;return a.__iterate(function(a,e,g){return d(b.call(c,a,e,g),e,f)!==!1},e)};d.__iteratorUncached=function(d,e){var f=a.__iterator(C,e);return new D(function(){var e=f.next();if(e.done)return e;var g=e.value,h=g[0];return E(d,h,b.call(c,g[1],h,a),e)})};return d}function cb(a,b){var c=this,d=M(a);d._iter=a;d.size=a.size;d.reverse=function(){return a};a.flip&&(d.flip=function(){var b=ab(a);b.reverse=function(){return a.flip()};return b});d.get=function(c,d){return a.get(b?c:-1-c,d)};d.has=function(c){return a.has(b?c:-1-c)};d.includes=function(b){return a.includes(b)};d.cacheResult=tb;d.__iterate=function(d,e){var c=this,f=0;e&&m(a);return a.__iterate(function(a,g){return d(a,b?g:e?c.size-++f:f++,c)},!e)};d.__iterator=function(d,e){var f=0;e&&m(a);var g=a.__iterator(C,!e);return new D(function(){var a=g.next();if(a.done)return a;var h=a.value;return E(d,b?h[0]:e?c.size-++f:f++,h[1],a)})};return d}function db(a,b,c,d){var e=M(a);d&&(e.has=function(d){var e=a.get(d,g);return e!==g&&!!b.call(c,e,d,a)},e.get=function(d,e){var f=a.get(d,g);return f!==g&&b.call(c,f,d,a)?f:e});e.__iterateUncached=function(e,f){var g=this,h=0;a.__iterate(function(a,f,i){if(b.call(c,a,f,i)){h++;return e(a,d?f:h-1,g)}},f);return h};e.__iteratorUncached=function(e,f){var g=a.__iterator(C,f),h=0;return new D(function(){while(!0){var f=g.next();if(f.done)return f;var i=f.value,j=i[0];i=i[1];if(b.call(c,i,j,a))return E(e,d?j:h++,i,f)}})};return e}function eb(a,b,c){var d=ec().asMutable();a.__iterate(function(e,f){d.update(b.call(c,e,f,a),0,function(a){return a+1})});return d.asImmutable()}function fb(a,b,c){var d=v(a),e=(x(a)?U():ec()).asMutable();a.__iterate(function(f,g){e.update(b.call(c,f,g,a),function(a){return a=a||[],a.push(d?[g,f]:f),a})});var f=sb(a);return e.map(function(b){return L(a,f(b))})}function gb(a,b,c,d){var e=a.size;if(p(b,c,e))return a;var f=q(b,e);e=r(c,e);if(f!==f||e!==e)return gb(a.toSeq().cacheResult(),b,c,d);b=e-f;var g;b===b&&(g=b<0?0:b);c=M(a);c.size=g===0?g:a.size&&g||void 0;!d&&Aa(a)&&g>=0&&(c.get=function(b,c){b=n(this,b);return b>=0&&b<g?a.get(b+f,c):c});c.__iterateUncached=function(b,c){var e=this;if(g===0)return 0;if(c)return this.cacheResult().__iterate(b,c);var h=0,i=!0,j=0;a.__iterate(function(a,c){if(!(i&&(i=h++<f))){j++;return b(a,d?c:j-1,e)!==!1&&j!==g}});return j};c.__iteratorUncached=function(b,c){if(g!==0&&c)return this.cacheResult().__iterator(b,c);if(g===0)return new D(F);var e=a.__iterator(b,c),h=0,i=0;return new D(function(){while(h++<f)e.next();if(++i>g)return F();var a=e.next();if(d||b===B||a.done)return a;return b===ka?E(b,i-1,void 0,a):E(b,i-1,a.value[1],a)})};return c}function hb(a,b,c){var d=M(a);d.__iterateUncached=function(d,e){var f=this;if(e)return this.cacheResult().__iterate(d,e);var g=0;a.__iterate(function(a,e,h){return b.call(c,a,e,h)&&++g&&d(a,e,f)});return g};d.__iteratorUncached=function(d,e){var f=this;if(e)return this.cacheResult().__iterator(d,e);var g=a.__iterator(C,e),h=!0;return new D(function(){if(!h)return F();var a=g.next();if(a.done)return a;var e=a.value,i=e[0];e=e[1];if(!b.call(c,e,i,f)){h=!1;return F()}return d===C?a:E(d,i,e,a)})};return d}function ib(a,b,c,d){var e=M(a);e.__iterateUncached=function(e,f){var g=this;if(f)return this.cacheResult().__iterate(e,f);var h=!0,i=0;a.__iterate(function(a,f,j){if(!(h&&(h=b.call(c,a,f,j)))){i++;return e(a,d?f:i-1,g)}});return i};e.__iteratorUncached=function(e,f){var g=this;if(f)return this.cacheResult().__iterator(e,f);var h=a.__iterator(C,f),i=!0,j=0;return new D(function(){var a,f;do{a=h.next();if(a.done){if(d||e===B)return a;return e===ka?E(e,j++,void 0,a):E(e,j++,a.value[1],a)}var k=a.value;f=k[0];k=k[1];i&&(i=b.call(c,k,f,g))}while(i);return e===C?a:E(e,f,k,a)})};return e}function jb(a,b){var c=v(a);b=[a].concat(b).map(function(a){!u(a)?a=c?Da(a):Ea(Array.isArray(a)?a:[a]):c&&(a=z(a));return a}).filter(function(a){return a.size!==0});if(b.length===0)return a;if(b.length===1){var d=b[0];if(d===a||c&&v(d)||w(a)&&w(d))return d}d=new wa(b);c?d=d.toKeyedSeq():w(a)||(d=d.toSetSeq());d=d.flatten(!0);d.size=b.reduce(function(a,b){if(a!==void 0){b=b.size;if(b!==void 0)return a+b}},0);return d}function kb(a,b,c){var d=M(a);d.__iterateUncached=function(e,f){if(f)return this.cacheResult().__iterate(e,f);var g=0,h=!1;function i(a,j){a.__iterate(function(a,f){(!b||j<b)&&u(a)?i(a,j+1):(g++,e(a,c?f:g-1,d)===!1&&(h=!0));return!h},f)}i(a,0);return g};d.__iteratorUncached=function(d,e){if(e)return this.cacheResult().__iterator(d,e);var f=a.__iterator(d,e),g=[],h=0;return new D(function(){while(f){var a=f.next();if(a.done!==!1){f=g.pop();continue}var i=a.value;d===C&&(i=i[1]);if((!b||g.length<b)&&u(i))g.push(f),f=i.__iterator(d,e);else return c?a:E(d,h++,i,a)}return F()})};return d}function lb(a,b,c){var d=sb(a);return a.toSeq().map(function(e,f){return d(b.call(c,e,f,a))}).flatten(!0)}function mb(a,b){var c=M(a);c.size=a.size&&a.size*2-1;c.__iterateUncached=function(c,d){var e=this,f=0;a.__iterate(function(a){return(!f||c(b,f++,e)!==!1)&&c(a,f++,e)!==!1},d);return f};c.__iteratorUncached=function(c,d){var e=a.__iterator(B,d),f=0,g;return new D(function(){if(!g||f%2){g=e.next();if(g.done)return g}return f%2?E(c,f++,b):E(c,f++,g.value,g)})};return c}function nb(a,b,c){b||(b=ub);var d=v(a),e=0,f=a.toSeq().map(function(b,d){return[d,b,e++,c?c(b,d,a):b]}).valueSeq().toArray();f.sort(function(a,c){return b(a[3],c[3])||a[2]-c[2]}).forEach(d?function(a,b){f[b].length=2}:function(a,b){f[b]=a[1]});return d?H(f):w(a)?I(f):ua(f)}function ob(a,b,c){b||(b=ub);if(c){var d=a.toSeq().map(function(b,d){return[b,c(b,d,a)]}).reduce(function(a,c){return pb(b,a[1],c[1])?c:a});return d&&d[0]}return a.reduce(function(a,c){return pb(b,a,c)?c:a})}function pb(a,b,c){a=a(c,b);return a===0&&c!==b&&(c===void 0||c===null||c!==c)||a>0}function qb(a,b,c,d){a=M(a);var e=new wa(c).map(function(a){return a.size});a.size=d?e.max():e.min();a.__iterate=function(a,b){var c=this;b=this.__iterator(B,b);var d,e=0;while(!(d=b.next()).done)if(a(d.value,e++,c)===!1)break;return e};a.__iteratorUncached=function(a,e){var f=c.map(function(a){return a=y(a),qa(e?a.reverse():a)}),g=0,h=!1;return new D(function(){var c;h||(c=f.map(function(a){return a.next()}),h=d?c.every(function(a){return a.done}):c.some(function(a){return a.done}));return h?F():E(a,g++,b.apply(null,c.map(function(a){return a.value})))})};return a}function L(a,b){return a===b?a:Aa(a)?b:a.constructor(b)}function rb(a){if(a!==Object(a))throw new TypeError("Expected [K, V] tuple: "+a)}function sb(a){return v(a)?z:w(a)?ja:A}function M(a){return Object.create((v(a)?H:w(a)?I:ua).prototype)}function tb(){if(this._iter.cacheResult){this._iter.cacheResult();this.size=this._iter.size;return this}return G.prototype.cacheResult.call(this)}function ub(a,b){if(a===void 0&&b===void 0)return 0;if(a===void 0)return 1;return b===void 0?-1:a>b?1:a<b?-1:0}function N(a,b){b=b||0;var c=Math.max(0,a.length-b),d=new Array(c);for(var e=0;e<c;e++)d[e]=a[e+b];return d}function vb(a,b){if(!a)throw new Error(b)}function O(a){vb(a!==Infinity,"Cannot perform this action with an infinite size.")}function wb(a){if(ta(a)&&typeof a!=="string")return a;if(x(a))return a.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+a)}function xb(a){return a&&(a.constructor===Object||a.constructor===void 0)}function yb(a){return t(a)||Array.isArray(a)||xb(a)}function zb(a){try{return typeof a==="string"?JSON.stringify(a):String(a)}catch(b){return JSON.stringify(a)}}function Ab(a,b){return t(a)?a.has(b):yb(a)&&sa.call(a,b)}function Bb(a,b,c){return t(a)?a.get(b,c):Ab(a,b)?typeof a.get==="function"?a.get(b):a[b]:c}function Cb(a){if(Array.isArray(a))return N(a);var b={};for(var c in a)sa.call(a,c)&&(b[c]=a[c]);return b}function Db(a,b){if(!yb(a))throw new TypeError("Cannot update non-data-structure value: "+a);if(t(a)){if(!a.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+a);return a.remove(b)}if(!sa.call(a,b))return a;a=Cb(a);Array.isArray(a)?a.splice(b,1):delete a[b];return a}function Eb(a,b,c){if(!yb(a))throw new TypeError("Cannot update non-data-structure value: "+a);if(t(a)){if(!a.set)throw new TypeError("Cannot update immutable value without .set() method: "+a);return a.set(b,c)}if(sa.call(a,b)&&c===a[b])return a;a=Cb(a);a[b]=c;return a}function Fb(a,b,c,d){d||(d=c,c=void 0);a=Gb(t(a),a,wb(b),0,c,d);return a===g?c:a}function Gb(a,b,c,d,e,f){var h=b===g;if(d===c.length){var i=h?e:b,j=f(i);return j===i?b:j}if(!h&&!yb(b))throw new TypeError("Cannot update within non-data-structure value in path ["+c.slice(0,d).map(zb)+"]: "+b);i=c[d];j=h?g:Bb(b,i,g);c=Gb(j===g?a:t(j),j,c,d+1,e,f);return c===j?b:c===g?Db(b,i):Eb(h?a?S():{}:b,i,c)}function Hb(a,b,c){return Fb(a,b,g,function(){return c})}function Ib(a,b){return Hb(this,a,b)}function Jb(a,b){return Fb(a,b,function(){return g})}function Kb(a){return Jb(this,a)}function Lb(a,b,c,d){return Fb(a,[b],c,d)}function Mb(a,b,c){return arguments.length===1?a(this):Lb(this,a,b,c)}function Nb(a,b,c){return Fb(this,a,b,c)}function Ob(){var a=[],b=arguments.length;while(b--)a[b]=arguments[b];return Qb(this,a)}function Pb(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Qb(this,b,a)}function Qb(a,b,c){var d=[];for(var e=0;e<b.length;e++){var f=z(b[e]);f.size!==0&&d.push(f)}if(d.length===0)return a;return a.size===0&&!a.__ownerID&&d.length===1?a.constructor(d[0]):a.withMutations(function(a){var e=c?function(b,d){Lb(a,d,g,function(a){return a===g?b:c(a,b,d)})}:function(b,c){a.set(c,b)};for(var b=0;b<d.length;b++)d[b].forEach(e)})}function Rb(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Wb(a,b)}function Sb(a,b){var c=[],d=arguments.length-2;while(d-->0)c[d]=arguments[d+2];return Wb(b,c,a)}function Tb(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Vb(a,b)}function Ub(a,b){var c=[],d=arguments.length-2;while(d-->0)c[d]=arguments[d+2];return Vb(b,c,a)}function Vb(a,b,c){return Wb(a,b,Xb(c))}function Wb(a,b,c){if(!yb(a))throw new TypeError("Cannot merge into non-data-structure value: "+a);if(t(a))return a.mergeWith?a.mergeWith.apply(a,[c].concat(b)):a.concat.apply(a,b);var d=Array.isArray(a),e=a,f=d?ja:z;d=d?function(b){e===a&&(e=Cb(e)),e.push(b)}:function(b,d){var f=sa.call(e,d);b=f&&c?c(e[d],b,d):b;(!f||b!==e[d])&&(e===a&&(e=Cb(e)),e[d]=b)};for(var g=0;g<b.length;g++)f(b[g]).forEach(d);return e}function Xb(a){function b(c,d,e){return yb(c)&&yb(d)?Wb(c,[d],b):a?a(c,d,e):d}return b}function Yb(){var a=[],b=arguments.length;while(b--)a[b]=arguments[b];return Vb(this,a)}function Zb(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Vb(this,b,a)}function $b(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Fb(this,a,S(),function(a){return Wb(a,b)})}function ac(a){var b=[],c=arguments.length-1;while(c-->0)b[c]=arguments[c+1];return Fb(this,a,S(),function(a){return Vb(a,b)})}function bc(a){var b=this.asMutable();a(b);return b.wasAltered()?b.__ensureOwner(this.__ownerID):this}function cc(){return this.__ownerID?this:this.__ensureOwner(new l())}function dc(){return this.__ensureOwner()}function P(){return this.__altered}var ec=function(b){function a(a){return a===null||a===void 0?S():fc(a)&&!x(a)?a:S().withMutations(function(c){var d=b(a);O(d.size);d.forEach(function(a,b){return c.set(b,a)})})}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){var a=[],b=arguments.length;while(b--)a[b]=arguments[b];return S().withMutations(function(b){for(var c=0;c<a.length;c+=2){if(c+1>=a.length)throw new Error("Missing value for key: "+a[c]);b.set(a[c],a[c+1])}})};a.prototype.toString=function(){return this.__toString("Map {","}")};a.prototype.get=function(a,b){return this._root?this._root.get(0,void 0,a,b):b};a.prototype.set=function(a,b){return qc(this,a,b)};a.prototype.remove=function(a){return qc(this,a,g)};a.prototype.deleteAll=function(a){var b=y(a);return b.size===0?this:this.withMutations(function(a){b.forEach(function(b){return a.remove(b)})})};a.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._root=null;this.__hash=void 0;this.__altered=!0;return this}return S()};a.prototype.sort=function(a){return U(nb(this,a))};a.prototype.sortBy=function(a,b){return U(nb(this,b,a))};a.prototype.__iterator=function(a,b){return new lc(this,a,b)};a.prototype.__iterate=function(a,b){var c=this,d=0;this._root&&this._root.iterate(function(b){d++;return a(b[1],b[0],c)},b);return d};a.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){if(this.size===0)return S();this.__ownerID=a;this.__altered=!1;return this}return oc(this.size,this._root,a,this.__hash)};return a}(z);function fc(a){return!!(a&&a[gc])}ec.isMap=fc;var gc="@@__IMMUTABLE_MAP__@@",Q=ec.prototype;Q[gc]=!0;Q[b]=Q.remove;Q.removeAll=Q.deleteAll;Q.concat=Q.merge;Q.setIn=Ib;Q.removeIn=Q.deleteIn=Kb;Q.update=Mb;Q.updateIn=Nb;Q.merge=Ob;Q.mergeWith=Pb;Q.mergeDeep=Yb;Q.mergeDeepWith=Zb;Q.mergeIn=$b;Q.mergeDeepIn=ac;Q.withMutations=bc;Q.wasAltered=P;Q.asImmutable=dc;Q["@@transducer/init"]=Q.asMutable=cc;Q["@@transducer/step"]=function(a,b){return a.set(b[0],b[1])};Q["@@transducer/result"]=function(a){return a.asImmutable()};var hc=function(a,b){this.ownerID=a,this.entries=b};hc.prototype.get=function(a,b,c,d){a=this.entries;for(var b=0,e=a.length;b<e;b++)if(J(c,a[b][0]))return a[b][1];return d};hc.prototype.update=function(a,b,c,d,e,f,h){b=e===g;c=this.entries;var i=0,j=c.length;for(;i<j;i++)if(J(d,c[i][0]))break;var l=i<j;if(l?c[i][1]===e:b)return this;k(h);(b||!l)&&k(f);if(b&&c.length===1)return;if(!l&&!b&&c.length>=Bc)return uc(a,c,d,e);h=a&&a===this.ownerID;f=h?c:N(c);l?b?i===j-1?f.pop():f[i]=f.pop():f[i]=[d,e]:f.push([d,e]);if(h){this.entries=f;return this}return new hc(a,f)};var ic=function(a,b,c){this.ownerID=a,this.bitmap=b,this.nodes=c};ic.prototype.get=function(a,b,d,f){b===void 0&&(b=K(d));var g=1<<((a===0?b:b>>>a)&e),h=this.bitmap;return(h&g)===0?f:this.nodes[xc(h&g-1)].get(a+c,b,d,f)};ic.prototype.update=function(a,b,d,f,h,i,j){d===void 0&&(d=K(f));var k=(b===0?d:d>>>b)&e,l=1<<k,m=this.bitmap,n=(m&l)!==0;if(!n&&h===g)return this;var o=xc(m&l-1),p=this.nodes,q=n?p[o]:void 0;b=rc(q,a,b+c,d,f,h,i,j);if(b===q)return this;if(!n&&b&&p.length>=Cc)return wc(a,p,m,k,b);if(n&&!b&&p.length===2&&sc(p[o^1]))return p[o^1];if(n&&b&&p.length===1&&sc(b))return b;d=a&&a===this.ownerID;f=n?b?m:m^l:m|l;h=n?b?yc(p,o,b,d):Ac(p,o,d):zc(p,o,b,d);if(d){this.bitmap=f;this.nodes=h;return this}return new ic(a,f,h)};var jc=function(a,b,c){this.ownerID=a,this.count=b,this.nodes=c};jc.prototype.get=function(a,b,d,f){b===void 0&&(b=K(d));var g=(a===0?b:b>>>a)&e;g=this.nodes[g];return g?g.get(a+c,b,d,f):f};jc.prototype.update=function(a,b,d,f,h,i,j){d===void 0&&(d=K(f));var k=(b===0?d:d>>>b)&e,l=h===g,m=this.nodes,n=m[k];if(l&&!n)return this;l=rc(n,a,b+c,d,f,h,i,j);if(l===n)return this;b=this.count;if(!n)b++;else if(!l){b--;if(b<Dc)return vc(a,m,b,k)}d=a&&a===this.ownerID;f=yc(m,k,l,d);if(d){this.count=b;this.nodes=f;return this}return new jc(a,b,f)};var kc=function(a,b,c){this.ownerID=a,this.keyHash=b,this.entries=c};kc.prototype.get=function(a,b,c,d){a=this.entries;for(var b=0,e=a.length;b<e;b++)if(J(c,a[b][0]))return a[b][1];return d};kc.prototype.update=function(a,b,c,d,e,f,h){c===void 0&&(c=K(d));var i=e===g;if(c!==this.keyHash){if(i)return this;k(h);k(f);return tc(this,a,b,c,[d,e])}b=this.entries;c=0;var j=b.length;for(;c<j;c++)if(J(d,b[c][0]))break;var l=c<j;if(l?b[c][1]===e:i)return this;k(h);(i||!l)&&k(f);if(i&&j===2)return new R(a,this.keyHash,b[c^1]);h=a&&a===this.ownerID;f=h?b:N(b);l?i?c===j-1?f.pop():f[c]=f.pop():f[c]=[d,e]:f.push([d,e]);if(h){this.entries=f;return this}return new kc(a,this.keyHash,f)};var R=function(a,b,c){this.ownerID=a,this.keyHash=b,this.entry=c};R.prototype.get=function(a,b,c,d){return J(c,this.entry[0])?this.entry[1]:d};R.prototype.update=function(a,b,c,d,e,f,h){c=e===g;var i=J(d,this.entry[0]);if(i?e===this.entry[1]:c)return this;k(h);if(c){k(f);return}if(i){if(a&&a===this.ownerID){this.entry[1]=e;return this}return new R(a,this.keyHash,[d,e])}k(f);return tc(this,a,b,K(d),[d,e])};hc.prototype.iterate=kc.prototype.iterate=function(a,b){var c=this.entries;for(var d=0,e=c.length-1;d<=e;d++)if(a(c[b?e-d:d])===!1)return!1};ic.prototype.iterate=jc.prototype.iterate=function(a,b){var c=this.nodes;for(var d=0,e=c.length-1;d<=e;d++){var f=c[b?e-d:d];if(f&&f.iterate(a,b)===!1)return!1}};R.prototype.iterate=function(a,b){return a(this.entry)};var lc=function(b){function a(a,b,c){this._type=b,this._reverse=c,this._stack=a._root&&nc(a._root)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.next=function(){var a=this,b=this._type,c=this._stack;while(c){var d=c.node,e=c.index++,f;if(d.entry){if(e===0)return mc(b,d.entry)}else if(d.entries){f=d.entries.length-1;if(e<=f)return mc(b,d.entries[a._reverse?f-e:e])}else{f=d.nodes.length-1;if(e<=f){d=d.nodes[a._reverse?f-e:e];if(d){if(d.entry)return mc(b,d.entry);c=a._stack=nc(d,c)}continue}}c=a._stack=a._stack.__prev}return F()};return a}(D);function mc(a,b){return E(a,b[0],b[1])}function nc(a,b){return{node:a,index:0,__prev:b}}function oc(a,b,c,d){var e=Object.create(Q);e.size=a;e._root=b;e.__ownerID=c;e.__hash=d;e.__altered=!1;return e}var pc;function S(){return pc||(pc=oc(0))}function qc(a,b,c){var d,e;if(!a._root){if(c===g)return a;e=1;d=new hc(a.__ownerID,[[b,c]])}else{var f=j(h),k=j(i);d=rc(a._root,a.__ownerID,0,void 0,b,c,f,k);if(!k.value)return a;e=a.size+(f.value?c===g?-1:1:0)}if(a.__ownerID){a.size=e;a._root=d;a.__hash=void 0;a.__altered=!0;return a}return d?oc(e,d):S()}function rc(a,b,c,d,e,f,h,i){if(!a){if(f===g)return a;k(i);k(h);return new R(b,d,[e,f])}return a.update(b,c,d,e,f,h,i)}function sc(a){return a.constructor===R||a.constructor===kc}function tc(a,b,d,f,g){if(a.keyHash===f)return new kc(b,f,[a.entry,g]);var h=(d===0?a.keyHash:a.keyHash>>>d)&e,i=(d===0?f:f>>>d)&e;f=h===i?[tc(a,b,d+c,f,g)]:(d=new R(b,f,g),h<i?[a,d]:[d,a]);return new ic(b,1<<h|1<<i,f)}function uc(a,b,c,d){a||(a=new l());c=new R(a,K(c),[c,d]);for(var d=0;d<b.length;d++){var e=b[d];c=c.update(a,0,void 0,e[0],e[1])}return c}function vc(a,b,c,d){var e=0,f=0;c=new Array(c);for(var g=0,h=1,i=b.length;g<i;g++,h<<=1){var j=b[g];j!==void 0&&g!==d&&(e|=h,c[f++]=j)}return new ic(a,e,c)}function wc(a,b,c,e,f){var g=0,h=new Array(d);for(var i=0;c!==0;i++,c>>>=1)h[i]=c&1?b[g++]:void 0;h[e]=f;return new jc(a,g+1,h)}function xc(a){a-=a>>1&1431655765;a=(a&858993459)+(a>>2&858993459);a=a+(a>>4)&252645135;a+=a>>8;a+=a>>16;return a&127}function yc(a,b,c,d){d=d?a:N(a);d[b]=c;return d}function zc(a,b,c,d){var e=a.length+1;if(d&&b+1===e){a[b]=c;return a}d=new Array(e);var f=0;for(var g=0;g<e;g++)g===b?(d[g]=c,f=-1):d[g]=a[g+f];return d}function Ac(a,b,c){var d=a.length-1;if(c&&b===d){a.pop();return a}c=new Array(d);var e=0;for(var f=0;f<d;f++)f===b&&(e=1),c[f]=a[f+e];return c}var Bc=d/4,Cc=d/2,Dc=d/4,Ec=function(b){function a(a){var e=Mc();if(a===null||a===void 0)return e;if(Fc(a))return a;var f=b(a),g=f.size;if(g===0)return e;O(g);return g>0&&g<d?Kc(0,g,c,null,new Hc(f.toArray())):e.withMutations(function(a){a.setSize(g),f.forEach(function(b,c){return a.set(c,b)})})}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){return this(arguments)};a.prototype.toString=function(){return this.__toString("List [","]")};a.prototype.get=function(a,b){a=n(this,a);if(a>=0&&a<this.size){a+=this._origin;var c=Qc(this,a);return c&&c.array[a&e]}return b};a.prototype.set=function(a,b){return Nc(this,a,b)};a.prototype.remove=function(a){return this.has(a)?a===0?this.shift():a===this.size-1?this.pop():this.splice(a,1):this};a.prototype.insert=function(a,b){return this.splice(a,0,b)};a.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=this._origin=this._capacity=0;this._level=c;this._root=this._tail=null;this.__hash=void 0;this.__altered=!0;return this}return Mc()};a.prototype.push=function(){var a=arguments,b=this.size;return this.withMutations(function(c){Rc(c,0,b+a.length);for(var d=0;d<a.length;d++)c.set(b+d,a[d])})};a.prototype.pop=function(){return Rc(this,0,-1)};a.prototype.unshift=function(){var a=arguments;return this.withMutations(function(b){Rc(b,-a.length);for(var c=0;c<a.length;c++)b.set(c,a[c])})};a.prototype.shift=function(){return Rc(this,1)};a.prototype.concat=function(){var a=arguments,c=[];for(var d=0;d<arguments.length;d++){var e=a[d],f=b(typeof e!=="string"&&oa(e)?e:[e]);f.size!==0&&c.push(f)}if(c.length===0)return this;return this.size===0&&!this.__ownerID&&c.length===1?this.constructor(c[0]):this.withMutations(function(a){c.forEach(function(b){return b.forEach(function(b){return a.push(b)})})})};a.prototype.setSize=function(a){return Rc(this,0,a)};a.prototype.slice=function(a,b){var c=this.size;return p(a,b,c)?this:Rc(this,q(a,c),r(b,c))};a.prototype.__iterator=function(a,b){var c=b?this.size:0,d=Jc(this,b);return new D(function(){var e=d();return e===Ic?F():E(a,b?--c:c++,e)})};a.prototype.__iterate=function(a,b){var c=this,d=b?this.size:0,e=Jc(this,b),f;while((f=e())!==Ic)if(a(f,b?--d:d++,c)===!1)break;return d};a.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){if(this.size===0)return Mc();this.__ownerID=a;this.__altered=!1;return this}return Kc(this._origin,this._capacity,this._level,this._root,this._tail,a,this.__hash)};return a}(ja);function Fc(a){return!!(a&&a[Gc])}Ec.isList=Fc;var Gc="@@__IMMUTABLE_LIST__@@",T=Ec.prototype;T[Gc]=!0;T[b]=T.remove;T.merge=T.concat;T.setIn=Ib;T.deleteIn=T.removeIn=Kb;T.update=Mb;T.updateIn=Nb;T.mergeIn=$b;T.mergeDeepIn=ac;T.withMutations=bc;T.wasAltered=P;T.asImmutable=dc;T["@@transducer/init"]=T.asMutable=cc;T["@@transducer/step"]=function(a,b){return a.push(b)};T["@@transducer/result"]=function(a){return a.asImmutable()};var Hc=function(a,b){this.array=a,this.ownerID=b};Hc.prototype.removeBefore=function(a,b,d){if(d===b?1<<b:this.array.length===0)return this;var f=d>>>b&e;if(f>=this.array.length)return new Hc([],a);var g=f===0,h;if(b>0){var i=this.array[f];h=i&&i.removeBefore(a,b-c,d);if(h===i&&g)return this}if(g&&!h)return this;b=Pc(this,a);if(!g)for(var d=0;d<f;d++)b.array[d]=void 0;h&&(b.array[f]=h);return b};Hc.prototype.removeAfter=function(a,b,d){if(d===(b?1<<b:0)||this.array.length===0)return this;var f=d-1>>>b&e;if(f>=this.array.length)return this;var g;if(b>0){var h=this.array[f];g=h&&h.removeAfter(a,b-c,d);if(g===h&&f===this.array.length-1)return this}b=Pc(this,a);b.array.splice(f+1);g&&(b.array[f]=g);return b};var Ic={};function Jc(a,b){var e=a._origin,f=a._capacity,g=Sc(f),h=a._tail;return i(a._root,a._level,0);function i(a,b,c){return b===0?j(a,c):k(a,b,c)}function j(a,c){var i=c===g?h&&h.array:a&&a.array,j=c>e?0:e-c,k=f-c;k>d&&(k=d);return function(){if(j===k)return Ic;var a=b?--k:j++;return i&&i[a]}}function k(a,g,h){var j,k=a&&a.array,l=h>e?0:e-h>>g,m=(f-h>>g)+1;m>d&&(m=d);return function(){while(!0){if(j){var a=j();if(a!==Ic)return a;j=null}if(l===m)return Ic;a=b?--m:l++;j=i(k&&k[a],g-c,h+(a<<g))}}}}function Kc(b,c,d,e,f,g,a){var h=Object.create(T);h.size=c-b;h._origin=b;h._capacity=c;h._level=d;h._root=e;h._tail=f;h.__ownerID=g;h.__hash=a;h.__altered=!1;return h}var Lc;function Mc(){return Lc||(Lc=Kc(0,0,c))}function Nc(a,b,c){b=n(a,b);if(b!==b)return a;if(b>=a.size||b<0)return a.withMutations(function(a){b<0?Rc(a,b).set(0,c):Rc(a,0,b+1).set(b,c)});b+=a._origin;var d=a._tail,e=a._root,f=j(i);b>=Sc(a._capacity)?d=Oc(d,a.__ownerID,0,b,c,f):e=Oc(e,a.__ownerID,a._level,b,c,f);if(!f.value)return a;if(a.__ownerID){a._root=e;a._tail=d;a.__hash=void 0;a.__altered=!0;return a}return Kc(a._origin,a._capacity,a._level,e,d)}function Oc(a,b,d,f,g,h){var i=f>>>d&e,j=a&&i<a.array.length;if(!j&&g===void 0)return a;if(d>0){var l=a&&a.array[i];d=Oc(l,b,d-c,f,g,h);if(d===l)return a;f=Pc(a,b);f.array[i]=d;return f}if(j&&a.array[i]===g)return a;k(h);f=Pc(a,b);g===void 0&&i===f.array.length-1?f.array.pop():f.array[i]=g;return f}function Pc(a,b){return b&&a&&b===a.ownerID?a:new Hc(a?a.array.slice():[],b)}function Qc(a,b){if(b>=Sc(a._capacity))return a._tail;if(b<1<<a._level+c){var d=a._root;a=a._level;while(d&&a>0)d=d.array[b>>>a&e],a-=c;return d}}function Rc(a,b,d){b!==void 0&&(b|=0);d!==void 0&&(d|=0);var f=a.__ownerID||new l(),g=a._origin,h=a._capacity;b=g+b;d=d===void 0?h:d<0?h+d:g+d;if(b===g&&d===h)return a;if(b>=d)return a.clear();var i=a._level,j=a._root,k=0;while(b+k<0)j=new Hc(j&&j.array.length?[void 0,j]:[],f),i+=c,k+=1<<i;k&&(b+=k,g+=k,d+=k,h+=k);var m=Sc(h),n=Sc(d);while(n>=1<<i+c)j=new Hc(j&&j.array.length?[j]:[],f),i+=c;var o=a._tail,p=n<m?Qc(a,d-1):n>m?new Hc([],f):o;if(o&&n>m&&b<h&&o.array.length){j=Pc(j,f);var q=j;for(var r=i;r>c;r-=c){var s=m>>>r&e;q=q.array[s]=Pc(q.array[s],f)}q.array[m>>>c&e]=o}d<h&&(p=p&&p.removeAfter(f,0,d));if(b>=n)b-=n,d-=n,i=c,j=null,p=p&&p.removeBefore(f,0,b);else if(b>g||n<m){k=0;while(j){s=b>>>i&e;if(s!==n>>>i&e)break;s&&(k+=(1<<i)*s);i-=c;j=j.array[s]}j&&b>g&&(j=j.removeBefore(f,i,b-k));j&&n<m&&(j=j.removeAfter(f,i,n-k));k&&(b-=k,d-=k)}if(a.__ownerID){a.size=d-b;a._origin=b;a._capacity=d;a._level=i;a._root=j;a._tail=p;a.__hash=void 0;a.__altered=!0;return a}return Kc(b,d,i,j,p)}function Sc(a){return a<d?0:a-1>>>c<<c}var U=function(b){function a(a){return a===null||a===void 0?Wc():Tc(a)?a:Wc().withMutations(function(b){var c=z(a);O(c.size);c.forEach(function(a,c){return b.set(c,a)})})}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){return this(arguments)};a.prototype.toString=function(){return this.__toString("OrderedMap {","}")};a.prototype.get=function(a,b){a=this._map.get(a);return a!==void 0?this._list.get(a)[1]:b};a.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._map.clear();this._list.clear();return this}return Wc()};a.prototype.set=function(a,b){return Xc(this,a,b)};a.prototype.remove=function(a){return Xc(this,a,g)};a.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()};a.prototype.__iterate=function(a,b){var c=this;return this._list.__iterate(function(b){return b&&a(b[1],b[0],c)},b)};a.prototype.__iterator=function(a,b){return this._list.fromEntrySeq().__iterator(a,b)};a.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._map.__ensureOwner(a),c=this._list.__ensureOwner(a);if(!a){if(this.size===0)return Wc();this.__ownerID=a;this._map=b;this._list=c;return this}return Uc(b,c,a,this.__hash)};return a}(ec);function Tc(a){return fc(a)&&x(a)}U.isOrderedMap=Tc;U.prototype[ha]=!0;U.prototype[b]=U.prototype.remove;function Uc(b,c,d,a){var e=Object.create(U.prototype);e.size=b?b.size:0;e._map=b;e._list=c;e.__ownerID=d;e.__hash=a;return e}var Vc;function Wc(){return Vc||(Vc=Uc(S(),Mc()))}function Xc(b,c,e){var f=b._map,h=b._list,i=f.get(c),a=i!==void 0,j,k;if(e===g){if(!a)return b;h.size>=d&&h.size>=f.size*2?(k=h.filter(function(a,b){return a!==void 0&&i!==b}),j=k.toKeyedSeq().map(function(a){return a[0]}).flip().toMap(),b.__ownerID&&(j.__ownerID=k.__ownerID=b.__ownerID)):(j=f.remove(c),k=i===h.size-1?h.pop():h.set(i,void 0))}else if(a){if(e===h.get(i)[1])return b;j=f;k=h.set(i,[c,e])}else j=f.set(c,h.size),k=h.set(h.size,[c,e]);if(b.__ownerID){b.size=j.size;b._map=j;b._list=k;b.__hash=void 0;return b}return Uc(j,k)}var Yc=function(b){function a(a){return a===null||a===void 0?cd():Zc(a)?a:cd().pushAll(a)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){return this(arguments)};a.prototype.toString=function(){return this.__toString("Stack [","]")};a.prototype.get=function(a,b){var c=this._head;a=n(this,a);while(c&&a--)c=c.next;return c?c.value:b};a.prototype.peek=function(){return this._head&&this._head.value};a.prototype.push=function(){var a=arguments;if(arguments.length===0)return this;var b=this.size+arguments.length,c=this._head;for(var d=arguments.length-1;d>=0;d--)c={value:a[d],next:c};if(this.__ownerID){this.size=b;this._head=c;this.__hash=void 0;this.__altered=!0;return this}return ad(b,c)};a.prototype.pushAll=function(a){a=b(a);if(a.size===0)return this;if(this.size===0&&Zc(a))return a;O(a.size);var c=this.size,d=this._head;a.__iterate(function(a){c++,d={value:a,next:d}},!0);if(this.__ownerID){this.size=c;this._head=d;this.__hash=void 0;this.__altered=!0;return this}return ad(c,d)};a.prototype.pop=function(){return this.slice(1)};a.prototype.clear=function(){if(this.size===0)return this;if(this.__ownerID){this.size=0;this._head=void 0;this.__hash=void 0;this.__altered=!0;return this}return cd()};a.prototype.slice=function(a,c){if(p(a,c,this.size))return this;var d=q(a,this.size),e=r(c,this.size);if(e!==this.size)return b.prototype.slice.call(this,a,c);e=this.size-d;a=this._head;while(d--)a=a.next;if(this.__ownerID){this.size=e;this._head=a;this.__hash=void 0;this.__altered=!0;return this}return ad(e,a)};a.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;if(!a){if(this.size===0)return cd();this.__ownerID=a;this.__altered=!1;return this}return ad(this.size,this._head,a,this.__hash)};a.prototype.__iterate=function(a,b){var c=this;if(b)return new wa(this.toArray()).__iterate(function(b,d){return a(b,d,c)},b);b=0;var d=this._head;while(d){if(a(d.value,b++,c)===!1)break;d=d.next}return b};a.prototype.__iterator=function(a,b){if(b)return new wa(this.toArray()).__iterator(a,b);var c=0,d=this._head;return new D(function(){if(d){var b=d.value;d=d.next;return E(a,c++,b)}return F()})};return a}(ja);function Zc(a){return!!(a&&a[$c])}Yc.isStack=Zc;var $c="@@__IMMUTABLE_STACK__@@",V=Yc.prototype;V[$c]=!0;V.shift=V.pop;V.unshift=V.push;V.unshiftAll=V.pushAll;V.withMutations=bc;V.wasAltered=P;V.asImmutable=dc;V["@@transducer/init"]=V.asMutable=cc;V["@@transducer/step"]=function(a,b){return a.unshift(b)};V["@@transducer/result"]=function(a){return a.asImmutable()};function ad(b,c,d,a){var e=Object.create(V);e.size=b;e._head=c;e.__ownerID=d;e.__hash=a;e.__altered=!1;return e}var bd;function cd(){return bd||(bd=ad(0))}function dd(a,b){if(a===b)return!0;if(!u(b)||a.size!==void 0&&b.size!==void 0&&a.size!==b.size||a.__hash!==void 0&&b.__hash!==void 0&&a.__hash!==b.__hash||v(a)!==v(b)||w(a)!==w(b)||x(a)!==x(b))return!1;if(a.size===0&&b.size===0)return!0;var c=!ba(a);if(x(a)){var d=a.entries();return b.every(function(a,b){var e=d.next().value;return e&&J(e[1],a)&&(c||J(e[0],b))})&&d.next().done}var e=!1;if(a.size===void 0)if(b.size===void 0)typeof a.cacheResult==="function"&&a.cacheResult();else{e=!0;var f=a;a=b;b=f}f=!0;b=b.__iterate(function(b,d){if(c?!a.has(b):e?!J(b,a.get(d,g)):!J(a.get(d,g),b)){f=!1;return!1}});return f&&a.size===b}function W(a,b){var c=function(c){a.prototype[c]=b[c]};Object.keys(b).forEach(c);Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(b).forEach(c);return a}function ed(a){return yb(a)?G(a).map(ed).toJSON():a}var fd=function(b){function a(a){return a===null||a===void 0?ld():gd(a)&&!x(a)?a:ld().withMutations(function(c){var d=b(a);O(d.size);d.forEach(function(a){return c.add(a)})})}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){return this(arguments)};a.fromKeys=function(a){return this(z(a).keySeq())};a.intersect=function(b){b=y(b).toArray();return b.length?X.intersect.apply(a(b.pop()),b):ld()};a.union=function(b){b=y(b).toArray();return b.length?X.union.apply(a(b.pop()),b):ld()};a.prototype.toString=function(){return this.__toString("Set {","}")};a.prototype.has=function(a){return this._map.has(a)};a.prototype.add=function(a){return id(this,this._map.set(a,a))};a.prototype.remove=function(a){return id(this,this._map.remove(a))};a.prototype.clear=function(){return id(this,this._map.clear())};a.prototype.union=function(){var a=[],c=arguments.length;while(c--)a[c]=arguments[c];a=a.filter(function(a){return a.size!==0});if(a.length===0)return this;return this.size===0&&!this.__ownerID&&a.length===1?this.constructor(a[0]):this.withMutations(function(c){for(var d=0;d<a.length;d++)b(a[d]).forEach(function(a){return c.add(a)})})};a.prototype.intersect=function(){var a=[],c=arguments.length;while(c--)a[c]=arguments[c];if(a.length===0)return this;a=a.map(function(a){return b(a)});var d=[];this.forEach(function(b){a.every(function(a){return a.includes(b)})||d.push(b)});return this.withMutations(function(a){d.forEach(function(b){a.remove(b)})})};a.prototype.subtract=function(){var a=[],c=arguments.length;while(c--)a[c]=arguments[c];if(a.length===0)return this;a=a.map(function(a){return b(a)});var d=[];this.forEach(function(b){a.some(function(a){return a.includes(b)})&&d.push(b)});return this.withMutations(function(a){d.forEach(function(b){a.remove(b)})})};a.prototype.sort=function(a){return Bd(nb(this,a))};a.prototype.sortBy=function(a,b){return Bd(nb(this,b,a))};a.prototype.wasAltered=function(){return this._map.wasAltered()};a.prototype.__iterate=function(a,b){var c=this;return this._map.__iterate(function(b){return a(b,b,c)},b)};a.prototype.__iterator=function(a,b){return this._map.__iterator(a,b)};a.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._map.__ensureOwner(a);if(!a){if(this.size===0)return this.__empty();this.__ownerID=a;this._map=b;return this}return this.__make(b,a)};return a}(A);function gd(a){return!!(a&&a[hd])}fd.isSet=gd;var hd="@@__IMMUTABLE_SET__@@",X=fd.prototype;X[hd]=!0;X[b]=X.remove;X.merge=X.concat=X.union;X.withMutations=bc;X.asImmutable=dc;X["@@transducer/init"]=X.asMutable=cc;X["@@transducer/step"]=function(a,b){return a.add(b)};X["@@transducer/result"]=function(a){return a.asImmutable()};X.__empty=ld;X.__make=jd;function id(a,b){if(a.__ownerID){a.size=b.size;a._map=b;return a}return b===a._map?a:b.size===0?a.__empty():a.__make(b)}function jd(b,c){var a=Object.create(X);a.size=b?b.size:0;a._map=b;a.__ownerID=c;return a}var kd;function ld(){return kd||(kd=jd(S()))}var md=function(b){function a(b,c,d){if(!(this instanceof a))return new a(b,c,d);vb(d!==0,"Cannot step a Range by 0");b=b||0;c===void 0&&(c=Infinity);d=d===void 0?1:Math.abs(d);c<b&&(d=-d);this._start=b;this._end=c;this._step=d;this.size=Math.max(0,Math.ceil((c-b)/d-1)+1);if(this.size===0){if(nd)return nd;nd=this}}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.toString=function(){return this.size===0?"Range []":"Range [ "+this._start+"..."+this._end+(this._step!==1?" by "+this._step:"")+" ]"};a.prototype.get=function(a,b){return this.has(a)?this._start+n(this,a)*this._step:b};a.prototype.includes=function(a){a=(a-this._start)/this._step;return a>=0&&a<this.size&&a===Math.floor(a)};a.prototype.slice=function(b,c){if(p(b,c,this.size))return this;b=q(b,this.size);c=r(c,this.size);return c<=b?new a(0,0):new a(this.get(b,this._end),this.get(c,this._end),this._step)};a.prototype.indexOf=function(a){a=a-this._start;if(a%this._step===0){a=a/this._step;if(a>=0&&a<this.size)return a}return-1};a.prototype.lastIndexOf=function(a){return this.indexOf(a)};a.prototype.__iterate=function(a,b){var c=this,d=this.size,e=this._step,f=b?this._start+(d-1)*e:this._start,g=0;while(g!==d){if(a(f,b?d-++g:g++,c)===!1)break;f+=b?-e:e}return g};a.prototype.__iterator=function(a,b){var c=this.size,d=this._step,e=b?this._start+(c-1)*d:this._start,f=0;return new D(function(){if(f===c)return F();var g=e;e+=b?-d:d;return E(a,b?c-++f:f++,g)})};a.prototype.equals=function(b){return b instanceof a?this._start===b._start&&this._end===b._end&&this._step===b._step:dd(this,b)};return a}(I),nd;function od(a,b,c){b=wb(b);var d=0;while(d!==b.length){a=Bb(a,b[d++],g);if(a===g)return c}return a}function pd(a,b){return od(this,a,b)}function qd(a,b){return od(a,b,g)!==g}function Y(a){return qd(this,a)}function Z(){O(this.size);var a={};this.__iterate(function(b,c){a[c]=b});return a}y.isIterable=u;y.isKeyed=v;y.isIndexed=w;y.isAssociative=ba;y.isOrdered=x;y.Iterator=D;W(y,{toArray:function(){O(this.size);var a=new Array(this.size||0),b=v(this),c=0;this.__iterate(function(d,e){a[c++]=b?[e,d]:d});return a},toIndexedSeq:function(){return new Ya(this)},toJS:function(){return ed(this)},toKeyedSeq:function(){return new Xa(this,!0)},toMap:function(){return ec(this.toKeyedSeq())},toObject:Z,toOrderedMap:function(){return U(this.toKeyedSeq())},toOrderedSet:function(){return Bd(v(this)?this.valueSeq():this)},toSet:function(){return fd(v(this)?this.valueSeq():this)},toSetSeq:function(){return new Za(this)},toSeq:function(){return w(this)?this.toIndexedSeq():v(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Yc(v(this)?this.valueSeq():this)},toList:function(){return Ec(v(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(a,b){return this.size===0?a+b:a+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+b},concat:function(){var a=[],b=arguments.length;while(b--)a[b]=arguments[b];return L(this,jb(this,a))},includes:function(a){return this.some(function(b){return J(b,a)})},entries:function(){return this.__iterator(C)},every:function(a,b){O(this.size);var c=!0;this.__iterate(function(d,e,f){if(!a.call(b,d,e,f)){c=!1;return!1}});return c},filter:function(a,b){return L(this,db(this,a,b,!0))},find:function(a,b,c){a=this.findEntry(a,b);return a?a[1]:c},forEach:function(a,b){O(this.size);return this.__iterate(b?a.bind(b):a)},join:function(a){O(this.size);a=a!==void 0?""+a:",";var b="",c=!0;this.__iterate(function(d){c?c=!1:b+=a,b+=d!==null&&d!==void 0?d.toString():""});return b},keys:function(){return this.__iterator(ka)},map:function(a,b){return L(this,bb(this,a,b))},reduce:function(a,b,c){return rd(this,a,b,c,arguments.length<2,!1)},reduceRight:function(a,b,c){return rd(this,a,b,c,arguments.length<2,!0)},reverse:function(){return L(this,cb(this,!0))},slice:function(a,b){return L(this,gb(this,a,b,!0))},some:function(a,b){return!this.every(ud(a),b)},sort:function(a){return L(this,nb(this,a))},values:function(){return this.__iterator(B)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return this.size!==void 0?this.size===0:!this.some(function(){return!0})},count:function(a,b){return m(a?this.toSeq().filter(a,b):this)},countBy:function(a,b){return eb(this,a,b)},equals:function(a){return dd(this,a)},entrySeq:function(){var a=this;if(a._cache)return new wa(a._cache);var b=a.toSeq().map(td).toIndexedSeq();b.fromEntrySeq=function(){return a.toSeq()};return b},filterNot:function(a,b){return this.filter(ud(a),b)},findEntry:function(a,b,c){c=c;this.__iterate(function(d,e,f){if(a.call(b,d,e,f)){c=[e,d];return!1}});return c},findKey:function(a,b){a=this.findEntry(a,b);return a&&a[0]},findLast:function(a,b,c){return this.toKeyedSeq().reverse().find(a,b,c)},findLastEntry:function(a,b,c){return this.toKeyedSeq().reverse().findEntry(a,b,c)},findLastKey:function(a,b){return this.toKeyedSeq().reverse().findKey(a,b)},first:function(){return this.find(o)},flatMap:function(a,b){return L(this,lb(this,a,b))},flatten:function(a){return L(this,kb(this,a,!0))},fromEntrySeq:function(){return new $a(this)},get:function(a,b){return this.find(function(b,c){return J(c,a)},void 0,b)},getIn:pd,groupBy:function(a,b){return fb(this,a,b)},has:function(a){return this.get(a,g)!==g},hasIn:Y,isSubset:function(a){a=typeof a.includes==="function"?a:y(a);return this.every(function(b){return a.includes(b)})},isSuperset:function(a){a=typeof a.isSubset==="function"?a:y(a);return a.isSubset(this)},keyOf:function(a){return this.findKey(function(b){return J(b,a)})},keySeq:function(){return this.toSeq().map(sd).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},lastKeyOf:function(a){return this.toKeyedSeq().reverse().keyOf(a)},max:function(a){return ob(this,a)},maxBy:function(a,b){return ob(this,b,a)},min:function(a){return ob(this,a?vd(a):xd)},minBy:function(a,b){return ob(this,b?vd(b):xd,a)},rest:function(){return this.slice(1)},skip:function(a){return a===0?this:this.slice(Math.max(0,a))},skipLast:function(a){return a===0?this:this.slice(0,-Math.max(0,a))},skipWhile:function(a,b){return L(this,ib(this,a,b,!0))},skipUntil:function(a,b){return this.skipWhile(ud(a),b)},sortBy:function(a,b){return L(this,nb(this,b,a))},take:function(a){return this.slice(0,Math.max(0,a))},takeLast:function(a){return this.slice(-Math.max(0,a))},takeWhile:function(a,b){return L(this,hb(this,a,b))},takeUntil:function(a,b){return this.takeWhile(ud(a),b)},update:function(a){return a(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=yd(this))}});P=y.prototype;P[ea]=!0;P[na]=P.values;P.toJSON=P.toArray;P.__toStringMapper=zb;P.inspect=P.toSource=function(){return this.toString()};P.chain=P.flatMap;P.contains=P.includes;W(z,{flip:function(){return L(this,ab(this))},mapEntries:function(a,b){var c=this,d=0;return L(this,this.toSeq().map(function(e,f){return a.call(b,[f,e],d++,c)}).fromEntrySeq())},mapKeys:function(a,b){var c=this;return L(this,this.toSeq().flip().map(function(d,e){return a.call(b,d,e,c)}).flip())}});Y=z.prototype;Y[fa]=!0;Y[na]=P.entries;Y.toJSON=Z;Y.__toStringMapper=function(a,b){return zb(b)+": "+zb(a)};W(ja,{toKeyedSeq:function(){return new Xa(this,!1)},filter:function(a,b){return L(this,db(this,a,b,!1))},findIndex:function(a,b){a=this.findEntry(a,b);return a?a[0]:-1},indexOf:function(a){a=this.keyOf(a);return a===void 0?-1:a},lastIndexOf:function(a){a=this.lastKeyOf(a);return a===void 0?-1:a},reverse:function(){return L(this,cb(this,!1))},slice:function(a,b){return L(this,gb(this,a,b,!1))},splice:function(a,b){var c=arguments.length;b=Math.max(b||0,0);if(c===0||c===2&&!b)return this;a=q(a,a<0?this.count():this.size);var d=this.slice(0,a);return L(this,c===1?d:d.concat(N(arguments,2),this.slice(a+b)))},findLastIndex:function(a,b){a=this.findLastEntry(a,b);return a?a[0]:-1},first:function(){return this.get(0)},flatten:function(a){return L(this,kb(this,a,!1))},get:function(a,b){a=n(this,a);return a<0||this.size===Infinity||this.size!==void 0&&a>this.size?b:this.find(function(b,c){return c===a},void 0,b)},has:function(a){a=n(this,a);return a>=0&&(this.size!==void 0?this.size===Infinity||a<this.size:this.indexOf(a)!==-1)},interpose:function(a){return L(this,mb(this,a))},interleave:function(){var a=[this].concat(N(arguments)),b=qb(this.toSeq(),I.of,a),c=b.flatten(!0);b.size&&(c.size=b.size*a.length);return L(this,c)},keySeq:function(){return md(0,this.size)},last:function(){return this.get(-1)},skipWhile:function(a,b){return L(this,ib(this,a,b,!1))},zip:function(){var a=[this].concat(N(arguments));return L(this,qb(this,wd,a))},zipAll:function(){var a=[this].concat(N(arguments));return L(this,qb(this,wd,a,!0))},zipWith:function(a){var b=N(arguments);b[0]=this;return L(this,qb(this,a,b))}});Z=ja.prototype;Z[ga]=!0;Z[ha]=!0;W(A,{get:function(a,b){return this.has(a)?a:b},includes:function(a){return this.has(a)},keySeq:function(){return this.valueSeq()}});A.prototype.has=P.includes;A.prototype.contains=A.prototype.includes;W(H,z.prototype);W(I,ja.prototype);W(ua,A.prototype);function rd(a,b,c,d,e,f){O(a.size);a.__iterate(function(a,f,g){e?(e=!1,c=a):c=b.call(d,c,a,f,g)},f);return c}function sd(a,b){return b}function td(a,b){return[b,a]}function ud(a){return function(){return!a.apply(this,arguments)}}function vd(a){return function(){return-a.apply(this,arguments)}}function wd(){return N(arguments)}function xd(a,b){return a<b?1:a>b?-1:0}function yd(a){if(a.size===Infinity)return 0;var b=x(a),c=v(a),d=b?1:0;a=a.__iterate(c?b?function(a,b){d=31*d+Ad(K(a),K(b))|0}:function(a,b){d=d+Ad(K(a),K(b))|0}:b?function(a){d=31*d+K(a)|0}:function(a){d=d+K(a)|0});return zd(a,d)}function zd(a,b){b=Ha(b,3432918353);b=Ha(b<<15|b>>>-15,461845907);b=Ha(b<<13|b>>>-13,5);b=(b+3864292196|0)^a;b=Ha(b^b>>>16,2246822507);b=Ha(b^b>>>13,3266489909);b=Ia(b^b>>>16);return b}function Ad(a,b){return a^b+2654435769+(a<<6)+(a>>2)|0}var Bd=function(b){function a(a){return a===null||a===void 0?Gd():Cd(a)?a:Gd().withMutations(function(b){var c=A(a);O(c.size);c.forEach(function(a){return b.add(a)})})}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.of=function(){return this(arguments)};a.fromKeys=function(a){return this(z(a).keySeq())};a.prototype.toString=function(){return this.__toString("OrderedSet {","}")};return a}(fd);function Cd(a){return gd(a)&&x(a)}Bd.isOrderedSet=Cd;var Dd=Bd.prototype;Dd[ha]=!0;Dd.zip=Z.zip;Dd.zipWith=Z.zipWith;Dd.__empty=Gd;Dd.__make=Ed;function Ed(b,c){var a=Object.create(Dd);a.size=b?b.size:0;a._map=b;a.__ownerID=c;return a}var Fd;function Gd(){return Fd||(Fd=Ed(Wc()))}Y=function(a,b){var c,d=function(f){var g=this;if(f instanceof d)return f;if(!(this instanceof d))return new d(f);if(!c){c=!0;var h=Object.keys(a),i=e._indices={};e._name=b;e._keys=h;e._defaultValues=a;for(var j=0;j<h.length;j++){var k=h[j];i[k]=j;e[k]?typeof console==="object"&&emptyFunction&&!1:Kd(e,k)}}this.__ownerID=void 0;this._values=Ec().withMutations(function(a){a.setSize(g._keys.length),z(f).forEach(function(b,c){a.set(g._indices[c],b===g._defaultValues[c]?void 0:b)})})},e=d.prototype=Object.create($);e.constructor=d;return d};Y.prototype.toString=function(){var a=this,b=Id(this)+" { ",c=this._keys,d;for(var e=0,f=c.length;e!==f;e++)d=c[e],b+=(e?", ":"")+d+": "+zb(a.get(d));return b+" }"};Y.prototype.equals=function(a){return this===a||a&&this._keys===a._keys&&Jd(this).equals(Jd(a))};Y.prototype.hashCode=function(){return Jd(this).hashCode()};Y.prototype.has=function(a){return this._indices.hasOwnProperty(a)};Y.prototype.get=function(a,b){if(!this.has(a))return b;b=this._indices[a];b=this._values.get(b);return b===void 0?this._defaultValues[a]:b};Y.prototype.set=function(a,b){if(this.has(a)){a=this._values.set(this._indices[a],b===this._defaultValues[a]?void 0:b);if(a!==this._values&&!this.__ownerID)return Hd(this,a)}return this};Y.prototype.remove=function(a){return this.set(a)};Y.prototype.clear=function(){var a=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Hd(this,a)};Y.prototype.wasAltered=function(){return this._values.wasAltered()};Y.prototype.toSeq=function(){return Jd(this)};Y.prototype.toJS=function(){return ed(this)};Y.prototype.entries=function(){return this.__iterator(C)};Y.prototype.__iterator=function(a,b){return Jd(this).__iterator(a,b)};Y.prototype.__iterate=function(a,b){return Jd(this).__iterate(a,b)};Y.prototype.__ensureOwner=function(a){if(a===this.__ownerID)return this;var b=this._values.__ensureOwner(a);if(!a){this.__ownerID=a;this._values=b;return this}return Hd(this,b,a)};Y.isRecord=ca;Y.getDescriptiveName=Id;var $=Y.prototype;$[ia]=!0;$[b]=$.remove;$.deleteIn=$.removeIn=Kb;$.getIn=pd;$.hasIn=P.hasIn;$.merge=Ob;$.mergeWith=Pb;$.mergeIn=$b;$.mergeDeep=Yb;$.mergeDeepWith=Zb;$.mergeDeepIn=ac;$.setIn=Ib;$.update=Mb;$.updateIn=Nb;$.withMutations=bc;$.asMutable=cc;$.asImmutable=dc;$[na]=$.entries;$.toJSON=$.toObject=P.toObject;$.inspect=$.toSource=function(){return this.toString()};function Hd(a,b,c){a=Object.create(Object.getPrototypeOf(a));a._values=b;a.__ownerID=c;return a}function Id(a){return a._name||a.constructor.name||"Record"}function Jd(a){return Da(a._keys.map(function(b){return[b,a.get(b)]}))}function Kd(a,b){try{Object.defineProperty(a,b,{get:function(){return this.get(b)},set:function(a){vb(this.__ownerID,"Cannot set on an immutable record."),this.set(b,a)}})}catch(a){}}W=function(a){function b(a,c){if(!(this instanceof b))return new b(a,c);this._value=a;this.size=c===void 0?Infinity:Math.max(0,c);if(this.size===0){if(Ld)return Ld;Ld=this}}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.toString=function(){return this.size===0?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"};b.prototype.get=function(a,b){return this.has(a)?this._value:b};b.prototype.includes=function(a){return J(this._value,a)};b.prototype.slice=function(a,c){var d=this.size;return p(a,c,d)?this:new b(this._value,r(c,d)-q(a,d))};b.prototype.reverse=function(){return this};b.prototype.indexOf=function(a){return J(this._value,a)?0:-1};b.prototype.lastIndexOf=function(a){return J(this._value,a)?this.size:-1};b.prototype.__iterate=function(a,b){var c=this,d=this.size,e=0;while(e!==d)if(a(c._value,b?d-++e:e++,c)===!1)break;return e};b.prototype.__iterator=function(a,b){var c=this,d=this.size,e=0;return new D(function(){return e===d?F():E(a,b?d-++e:e++,c._value)})};b.prototype.equals=function(a){return a instanceof b?J(this._value,a._value):dd(a)};return b}(I);var Ld;function Md(a,b){return Nd([],b||Od,a,"",b&&b.length>2?[]:void 0,{"":a})}function Nd(a,b,c,d,e,f){var g=Array.isArray(c)?I:xb(c)?H:null;if(g){if(~a.indexOf(c))throw new TypeError("Cannot convert circular structure to Immutable");a.push(c);e&&d!==""&&e.push(d);f=b.call(f,d,g(c).map(function(d,f){return Nd(a,b,d,f,e,c)}),e&&e.slice());a.pop();e&&e.pop();return f}return c}function Od(a,b){return v(b)?b.toMap():b.toList()}Z="4.0.0-rc.9";b={version:Z,Collection:y,Iterable:y,Seq:G,Map:ec,OrderedMap:U,List:Ec,Stack:Yc,Set:fd,OrderedSet:Bd,Record:Y,Range:md,Repeat:W,is:J,fromJS:Md,hash:K,isImmutable:t,isCollection:u,isKeyed:v,isIndexed:w,isAssociative:ba,isOrdered:x,isValueObject:da,get:Bb,getIn:od,has:Ab,hasIn:qd,merge:Rb,mergeDeep:Tb,mergeWith:Sb,mergeDeepWith:Ub,remove:Db,removeIn:Jb,set:Eb,setIn:Hb,update:Lb,updateIn:Fb};Kb=y;a["default"]=b;a.version=Z;a.Collection=y;a.Iterable=Kb;a.Seq=G;a.Map=ec;a.OrderedMap=U;a.List=Ec;a.Stack=Yc;a.Set=fd;a.OrderedSet=Bd;a.Record=Y;a.Range=md;a.Repeat=W;a.is=J;a.fromJS=Md;a.hash=K;a.isImmutable=t;a.isCollection=u;a.isKeyed=v;a.isIndexed=w;a.isAssociative=ba;a.isOrdered=x;a.isValueObject=da;a.get=Bb;a.getIn=od;a.has=Ab;a.hasIn=qd;a.merge=Rb;a.mergeDeep=Tb;a.mergeWith=Sb;a.mergeDeepWith=Ub;a.remove=Db;a.removeIn=Jb;a.set=Eb;a.setIn=Hb;a.update=Lb;a.updateIn=Fb;Object.defineProperty(a,"__esModule",{value:!0})})}),null);
__d("FBMapStyle",["invariant","FBMapCircle","FBMapStyleUtils","immutable","immutable-v4-rc-9","warning"],(function(a,b,c,d,e,f,g){"use strict";var h=b("FBMapCircle").getCircleLayers,i=b("FBMapCircle").getCircleSource;a=b("FBMapStyleUtils").EMPTY_STYLE;var j=b("immutable-v4-rc-9").isImmutable,k=b("immutable").Record(babelHelpers["extends"]({},a,{sprite:void 0,glyphs:void 0})),l=function(a){var b={},c=!1;a.forEach(function(a){b[a]===void 0?b[a]=!0:c=!0});return c},m=function(a){var c={};Object.prototype.hasOwnProperty.call(a,"version")&&(c.version=a.version);Object.prototype.hasOwnProperty.call(a,"name")&&(c.name=a.name);Object.prototype.hasOwnProperty.call(a,"sprite")&&(c.sprite=a.sprite);Object.prototype.hasOwnProperty.call(a,"glyphs")&&(c.glyphs=a.glyphs);c.metadata=b("immutable").fromJS(a.metadata||{});c.sources=b("immutable").fromJS(a.sources||{});c.layers=b("immutable").fromJS(a.layers||[]);return k(c)},n=function(a){var b=a.layers.map(function(a){return a.get("id")});l(b)===!1||g(0,3164);a.layers.forEach(function(b){var c=b.get("source");b=b.get("type");b!=="background"&&(a.hasIn(["sources",c])||g(0,3165))})};c=function(){function a(b){this.$2=a.$1,j(b)?this.$2=b:b!=null&&(this.$2=m(b)),n(this.$2)}var c=a.prototype;c.isEmpty=function(){return this.getLayers().size===0&&this.getSources().size===0};c.merge=function(c){var d,e=c.filter(function(a){return a!=null}).map(function(b){b!=null||g(0,6350);if(b instanceof a)return b.$2;else return m(b)});e.unshift(this.$2);c=(c=a.$1).mergeWith.apply(c,[function(a,b,c){return(c==="sprite"||c==="glyphs")&&(b==null||b==="")?a:b}].concat(e));var f=e.filter(function(a){return a.get("name")!=null&&a.get("name")!=""}),h=f.map(function(a){return a.name}).join("-"),i=b("immutable").Map({}).withMutations(function(a){e.forEach(function(b){b=b.get("sources");b.forEach(function(b,c,d){a.has(c)&&g(0,3166),a.set(c,b)})})});f=e.map(function(a){return a.get("layers")});var j=(d=b("immutable").List([])).concat.apply(d,f),k=b("immutable").Map({}).withMutations(function(a){e.forEach(function(c){c=c.get("metadata");c.forEach(function(c,d,e){a.has(d)&&b("warning")(!0,"Merged styles contain duplicate metadata keys"),a.set(d,c)})})});c=c.withMutations(function(a){a.set("name",h),a.set("sources",i),a.set("layers",j),a.set("metadata",k)});n(c);return new a(c)};c.addGeoJSONSource=function(a,b,c){b=babelHelpers["extends"]({type:"geojson",data:b},c);return this.$3(a,b)};c.addRasterSource=function(a,b){return this.$3(a,b)};c.addRasterSourceLayer=function(a,b,c){b=this.addRasterSource(a,b);c.source===a||g(0,3167);return b.addLayers([c])};c.addCircle=function(a,b,c,d,e){return this.$3(a,i(b,c)).addLayers(h(a,d),e)};c.updateCircle=function(a,b,c){return this.$4(a,i(b,c))};c.updateGeoJSONSourceWithData=function(a,b,c){this.$2.hasIn(["sources",a])||g(0,3168);this.$2.get("sources").getIn([a,"type"])==="geojson"||g(0,3169);return this.$4(a,babelHelpers["extends"]({type:"geojson",data:b},c))};c.removeSource=function(a){return this.removeSources([a])};c.removeSources=function(a){return this.$6(a).$5(a)};c.$3=function(c,d){this.$2.hasIn(["sources",c])&&g(0,3170);c=this.$2.setIn(["sources",c],b("immutable").fromJS(d));return new a(c)};c.$4=function(c,d){this.$2.hasIn(["sources",c])||g(0,3168);c=this.$2.setIn(["sources",c],b("immutable").fromJS(d));return new a(c)};c.$5=function(c){var d=b("immutable").Set(c);c=this.$2.set("sources",this.getSources().filter(function(a,b){return!d.has(b)}));return new a(c)};c.addLayers=function(c,d){var e;d=d!=null?this.getLayerIndexX(d):this.getLayers().size;e=this.$2.set("layers",(e=this.getLayers()).splice.apply(e,[d,0].concat(c.map(function(a){return b("immutable").fromJS(a)}))));return new a(e)};c.moveLayersToLowestZPosition=function(b){var c=this.getLayers(),d=c.filter(function(a){return b.has(a.get("id"))}),e=c.filterNot(function(a){return b.has(a.get("id"))});d.reverse().forEach(function(a){e=e.unshift(a)});c=this.$2.set("layers",e);return new a(c)};c.$6=function(c){var d=b("immutable").Set(c);c=this.$2.set("layers",this.getLayers().filterNot(function(a){return d.has(a.get("source"))}));return new a(c)};c.getFilter=function(a){a=this.getLayerX(a).get("filter");return a==null?null:a.toJS()};c.getFilterX=function(a){a=this.getLayerX(a).get("filter");a!=null||g(0,3171);return a.toJS()};c.setFilter=function(c,d){c=this.$2.setIn(["layers",this.getLayerIndexX(c),"filter"],b("immutable").fromJS(d));return new a(c)};c.getPaintProperty=function(a,b){a=this.getLayerX(a).getIn(["paint",b]);return a==null?null:typeof a!=="object"?a:a.toJS()};c.setPaintProperty=function(c,d,e){c=this.$2.setIn(["layers",this.getLayerIndexX(c),"paint",d],b("immutable").fromJS(e));return new a(c)};c.getLayoutProperty=function(a,b){a=this.getLayerX(a).getIn(["layout",b]);return a==null?null:typeof a!=="object"?a:a.toJS()};c.setLayoutProperty=function(c,d,e){c=this.$2.setIn(["layers",this.getLayerIndexX(c),"layout",d],b("immutable").fromJS(e));return new a(c)};c.getLayerZoomRange=function(a){a=this.getLayerX(a);return[a.get("minzoom"),a.get("maxzoom")]};c.setLayerZoomRange=function(b,c,d){b=this.getLayerIndexX(b);c=this.$2.setIn(["layers",b,"minzoom"],c).setIn(["layers",b,"maxzoom"],d);return new a(c)};c.getSources=function(){return this.$2.sources};c.hasSource=function(a){return this.getSources().has(a)};c.getSource=function(a){return this.getSources().get(a)};c.getSourceX=function(a){a=this.getSource(a);a!=null||g(0,3172);return a};c.getLayers=function(){return this.$2.layers};c.hasLayer=function(a){return this.getLayer(a)!=null};c.getLayer=function(a){return this.$2.layers.find(function(b){return b.get("id")===a})};c.getLayerX=function(a){a=this.getLayer(a);a!=null||g(0,3173);return a};c.getLayerIndexX=function(a){var b=this.getLayers().findIndex(function(b){return b.get("id")===a});b>=0||g(0,3174);return b};c.getStyle=function(){return this.$2};c.toJS=function(){var a=babelHelpers["extends"]({},this.$2.toJS());Object.prototype.hasOwnProperty.call(a,"sprite")&&(a.sprite==null||a.sprite==="")&&delete a.sprite;Object.prototype.hasOwnProperty.call(a,"glyphs")&&(a.glyphs==null||a.glyphs==="")&&delete a.glyphs;return a};return a}();c.$1=k({});e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/Jrvok3YXo6e/
 */
__d("mapbox-gl-1.1.1",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g},i;function j(){(function(b,c){typeof g==="object"&&typeof h!=="undefined"?h.exports=c():typeof i==="function"&&i.amd?i(c):(b=b||self,b.mapboxgl=c())})(this,function(){var b,c,d;function a(a,e){if(!b)b=e;else if(!c)c=e;else{a="var sharedChunk = {}; ("+b+")(sharedChunk); ("+c+")(sharedChunk);";var f={};b(f);d=e(f);d.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))}}a(["exports"],function(a){function b(a,b){return a(b={exports:{}},b.exports),b.exports}var c=d;function d(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=d,this.p2x=c,this.p2y=d}d.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},d.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},d.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},d.prototype.solveCurveX=function(a,b){var c,d,e;for(void 0===b&&(b=1e-6),c=a,e=0;e<8;e++){if(d=this.sampleCurveX(c)-a,Math.abs(d)<b)return c;var f=this.sampleCurveDerivativeX(c);if(Math.abs(f)<1e-6)break;c-=d/f}if((c=a)<(f=0))return f;if(c>(e=1))return e;for(;f<e;){if(d=this.sampleCurveX(c),Math.abs(d-a)<b)return c;a>d?f=c:e=c,c=.5*(e-f)+f}return c},d.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))};var e=f;function f(a,b){this.x=a,this.y=b}function g(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}if("object"==typeof a&&null!==a&&null!==b){if("object"!=typeof b)return!1;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var d in a)if(!g(a[d],b[d]))return!1;return!0}return a===b}function h(a,b,d,e){var f=new c(a,b,d,e);return function(a){return f.solve(a)}}f.prototype={clone:function(){return new f(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,b){return this.clone()._rotateAround(a,b)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var b=a.x-this.x;a=a.y-this.y;return b*b+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,b){return Math.atan2(this.x*b-this.y*a,this.x*a+this.y*b)},_matMult:function(a){var b=a[0]*this.x+a[1]*this.y;a=a[2]*this.x+a[3]*this.y;return this.x=b,this.y=a,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=b*this.x-a*this.y;a=a*this.x+b*this.y;return this.x=c,this.y=a,this},_rotateAround:function(a,b){var c=Math.cos(a);a=Math.sin(a);var d=b.x+c*(this.x-b.x)-a*(this.y-b.y);a=b.y+a*(this.x-b.x)+c*(this.y-b.y);return this.x=d,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},f.convert=function(a){return a instanceof f?a:Array.isArray(a)?new f(a[0],a[1]):a};d=h(.25,.1,.25,1);function i(a,b,c){return Math.min(c,Math.max(b,a))}function j(a,b,c){var d=c-b;a=((a-b)%d+d)%d+b;return a===b?c:a}function k(a){for(var b=[],c=arguments.length-1;c-->0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}var l=1;function m(){return l++}function n(){return function a(b){return b?(b^16*Math.random()>>b/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function o(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function p(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})}function q(a,b){return-1!==a.indexOf(b,a.length-b.length)}function r(a,b,c){var d={};for(var e in a)d[e]=b.call(c||this,a[e],e,a);return d}function s(a,b,c){var d={};for(var e in a)b.call(c||this,a[e],e,a)&&(d[e]=a[e]);return d}function t(a){return Array.isArray(a)?a.map(t):"object"==typeof a&&a?r(a,t):a}var u={};function v(a){u[a]||("undefined"!=typeof console&&!1,u[a]=!0)}function w(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)}function x(a){for(var b=0,c=0,d=a.length,e=d-1,f=void 0,g=void 0;c<d;e=c++)f=a[c],b+=((g=a[e]).x-f.x)*(f.y+g.y);return b}function y(a){var b={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,c,d,e){a=d||e;return b[c]=!a||a.toLowerCase(),""}),b["max-age"]){a=parseInt(b["max-age"],10);isNaN(a)?delete b["max-age"]:b["max-age"]=a}return b}function z(a){try{a=self[a];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch(a){return!1}}var A,B,C,D=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),E=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,F=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,G={now:D,frame:function(a){var b=E(a);return{cancel:function(){return F(b)}}},getImageData:function(a){var b=self.document.createElement("canvas"),c=b.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return b.width=a.width,b.height=a.height,c.drawImage(a,0,0,a.width,a.height),c.getImageData(0,0,a.width,a.height)},resolveURL:function(a){return A||(A=self.document.createElement("a")),A.href=a,A.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio}},H={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},I={supported:!1,testSupport:function(a){if(J||!C)return;K?L(a):B=a}},J=!1,K=!1;function L(a){var b=a.createTexture();a.bindTexture(a.TEXTURE_2D,b);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,C),a.isContextLost())return;I.supported=!0}catch(a){}a.deleteTexture(b),J=!0}self.document&&((C=self.document.createElement("img")).onload=function(){B&&L(B),B=null,K=!0},C.onerror=function(){J=!0,B=null},C.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var M="01";D=function(a){this._transformRequestFn=a,this._createSkuToken()};D.prototype._createSkuToken=function(){var a=function(){for(var a="",b=0;b<10;b++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",M,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt},D.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},D.prototype.transformRequest=function(a,b){return this._transformRequestFn&&this._transformRequestFn(a,b)||{url:a}},D.prototype.normalizeStyleURL=function(a,b){return R(a,b)},D.prototype.normalizeGlyphsURL=function(a,b){return S(a,b)},D.prototype.normalizeSourceURL=function(a,b){return T(a,b)},D.prototype.normalizeSpriteURL=function(a,b,c,d){return ba(a,b,c,d)},D.prototype.normalizeTileURL=function(a,b,c){return this._isSkuTokenExpired()&&this._createSkuToken(),da(a,b,c,this._skuToken)},D.prototype.canonicalizeTileURL=function(a){return fa(a)},D.prototype.canonicalizeTileset=function(a,b){return ga(a,b)};var N="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes";function O(a,b){var c=ia(H.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,"/"!==c.path&&(a.path=""+c.path+a.path),!H.REQUIRE_ACCESS_TOKEN)return ja(a);if(!(b=b||H.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+N);if("s"===b[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+N);return a.params.push("access_token="+b),ja(a)}function P(a){return 0===a.indexOf("mapbox:")}var aa=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Q(a){return aa.test(a)}var R=function(a,b){if(!P(a))return a;a=ia(a);return a.path="/styles/v1"+a.path,O(a,b)},S=function(a,b){if(!P(a))return a;a=ia(a);return a.path="/fonts/v1"+a.path,O(a,b)},T=function(a,b){if(!P(a))return a;a=ia(a);return a.path="/v4/"+a.authority+".json",a.params.push("secure"),O(a,b)},ba=function(a,b,c,d){var e=ia(a);return P(a)?(e.path="/styles/v1"+e.path+"/sprite"+b+c,O(e,d)):(e.path+=""+b+c,ja(e))},ca=/(\.(png|jpg)\d*)(?=$)/,da=function(a,b,c,d){if(!b||!P(b))return a;b=ia(a);a=G.devicePixelRatio>=2||512===c?"@2x":"";c=I.supported?".webp":"$1";return b.path=b.path.replace(ca,""+a+c),b.path="/v4"+b.path,H.REQUIRE_ACCESS_TOKEN&&H.ACCESS_TOKEN&&d&&b.params.push("sku="+d),O(b)},ea=/\.[\w]+$/,fa=function(a){var b=ia(a);if(!b.path.match(/(^\/v4\/)/)||!b.path.match(ea))return a;a="mapbox://tiles/";a+=b.path.replace("/v4/","");b=b.params.filter(function(a){return!a.match(/^access_token=/)});return b.length&&(a+="?"+b.join("&")),a},ga=function(a,b){if(!P(b))return a.tiles||[];for(var b=[],c=0,a=a.tiles;c<a.length;c+=1){var d=a[c];d=fa(d);b.push(d)}return b},ha=/^(\w+):\/\/([^\/?]*)(\/[^?]+)?\??(.+)?/;function ia(a){a=a.match(ha);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function ja(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}function ka(a){if(!a)return null;a=a.split(".");if(!a||3!==a.length)return null;try{return JSON.parse((a=a[1],decodeURIComponent(self.atob(a).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(a){return null}}var la=function(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};la.prototype.getStorageKey=function(a){var b=ka(H.ACCESS_TOKEN);return b&&b.u?(b=b.u,b=self.btoa(encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,function(a,b){return String.fromCharCode(Number("0x"+b))}))):b=H.ACCESS_TOKEN||"",a?"mapbox.eventData."+a+":"+b:"mapbox.eventData:"+b},la.prototype.fetchEventData=function(){var a=z("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{a=self.localStorage.getItem(b);a&&(this.eventData=JSON.parse(a));b=self.localStorage.getItem(c);b&&(this.anonId=b)}catch(a){v("Unable to read from LocalStorage")}},la.prototype.saveEventData=function(){var a=z("localStorage"),b=this.getStorageKey(),c=this.getStorageKey("uuid");if(a)try{self.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(b,JSON.stringify(this.eventData))}catch(a){v("Unable to write to LocalStorage")}},la.prototype.processRequests=function(){},la.prototype.postEvent=function(a,b,c){var d=this;if(H.EVENTS_URL){var e=ia(H.EVENTS_URL);e.params.push("access_token="+(H.ACCESS_TOKEN||""));a={event:this.type,created:new Date(a).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.1.1",skuId:M,userId:this.anonId};b=b?k(a,b):a;a={url:ja(e),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};this.pendingRequest=Da(a,function(a){d.pendingRequest=null,c(a),d.saveEventData(),d.processRequests()})}},la.prototype.queueRequest=function(a){this.queue.push(a),this.processRequests()};var ma,na=function(a){function b(){a.call(this,"map.load"),this.success={},this.skuToken=""}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postMapLoadEvent=function(a,b,c){this.skuToken=c,H.EVENTS_URL&&H.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return P(a)||Q(a)})&&this.queueRequest({id:b,timestamp:Date.now()})},b.prototype.processRequests=function(){var a=this;if(!this.pendingRequest&&0!==this.queue.length){var b=this.queue.shift(),c=b.id;b=b.timestamp;c&&this.success[c]||(this.anonId||this.fetchEventData(),o(this.anonId)||(this.anonId=n()),this.postEvent(b,{skuToken:this.skuToken},function(b){b||c&&(a.success[c]=!0)}))}},b}(la);la=new(function(a){function b(){a.call(this,"appUserTurnstile")}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.postTurnstileEvent=function(a){H.EVENTS_URL&&H.ACCESS_TOKEN&&Array.isArray(a)&&a.some(function(a){return P(a)||Q(a)})&&this.queueRequest(Date.now())},b.prototype.processRequests=function(){var a=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var b=ka(H.ACCESS_TOKEN),c=b?b.u:H.ACCESS_TOKEN;b=c!==this.eventData.tokenU;o(this.anonId)||(this.anonId=n(),b=!0);var d=this.queue.shift();if(this.eventData.lastSuccess){var e=new Date(this.eventData.lastSuccess),f=new Date(d),g=(d-this.eventData.lastSuccess)/864e5;b=b||g>=1||g<-1||e.getDate()!==f.getDate()}else b=!0;if(!b)return this.processRequests();this.postEvent(d,{"enabled.telemetry":!1},function(b){b||(a.eventData.lastSuccess=d,a.eventData.tokenU=c)})}},b}(la))();la=la.postTurnstileEvent.bind(la);na=new na();na=na.postMapLoadEvent.bind(na);var oa="mapbox-tiles",pa=500,qa=50,ra=42e4;function sa(a,b,c){if(self.caches){var d={status:b.status,statusText:b.statusText,headers:new self.Headers()};b.headers.forEach(function(a,b){return d.headers.set(b,a)});var e=y(b.headers.get("Cache-Control")||"");e["no-store"]||(e["max-age"]&&d.headers.set("Expires",new Date(c+1e3*e["max-age"]).toUTCString()),new Date(d.headers.get("Expires")).getTime()-c<ra||function(a,b){if(void 0===ma)try{new Response(new ReadableStream()),ma=!0}catch(a){ma=!1}ma?b(a.body):a.blob().then(b)}(b,function(b){var c=new self.Response(b,d);self.caches.open(oa).then(function(b){return b.put(ta(a.url),c)})}))}}function ta(a){var b=a.indexOf("?");return b<0?a:a.slice(0,b)}function ua(a,b){if(!self.caches)return b(null);var c=ta(a.url);self.caches.open(oa)["catch"](b).then(function(a){a.match(c)["catch"](b).then(function(d){var e=function(a){if(!a)return!1;var b=new Date(a.headers.get("Expires"));a=y(a.headers.get("Cache-Control")||"");return b>Date.now()&&!a["no-cache"]}(d);a["delete"](c),e&&a.put(c,d.clone()),b(null,d,e)})})}var va=1/0,wa={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(wa);var xa=function(a){function b(b,c,d){401===c&&Q(d)&&(b+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),a.call(this,b),this.status=c,this.url=d,this.name=this.constructor.name,this.message=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},b}(Error);function ya(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}var za=ya()?function(){return self.worker&&self.worker.referrer}:function(){var a=self.location.origin;if(a&&"null"!==a&&"file://"!==a)return a+self.location.pathname};function Aa(a,b){var c,d=new self.AbortController(),e=new self.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:za(),signal:d.signal}),f=!1,g=!1,h=(c=e.url).indexOf("sku=")>0&&Q(c);"json"===a.type&&e.headers.set("Accept","application/json");c=function(c,d,f){if(!g){if(c&&"SecurityError"!==c.message&&v(c),d&&f)return i(d);var j=Date.now();self.fetch(e).then(function(c){if(c.ok){var d=h?c.clone():null;return i(c,d,j)}return b(new xa(c.statusText,c.status,a.url))})["catch"](function(a){20!==a.code&&b(new Error(a.message))})}};var i=function(c,d,h){("arrayBuffer"===a.type?c.arrayBuffer():"json"===a.type?c.json():c.text()).then(function(a){g||(d&&h&&sa(e,d,h),f=!0,b(null,a,c.headers.get("Cache-Control"),c.headers.get("Expires")))})["catch"](function(a){return b(new Error(a.message))})};return h?ua(e,c):c(null,null),{cancel:function(){g=!0,f||d.abort()}}}var Ba=function(a,b){if(!/^file:/.test(a.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return Aa(a,b);if(ya()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,b)}return function(a,b){var c=new self.XMLHttpRequest();for(var d in c.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(c.responseType="arraybuffer"),a.headers)c.setRequestHeader(d,a.headers[d]);return"json"===a.type&&c.setRequestHeader("Accept","application/json"),c.withCredentials="include"===a.credentials,c.onerror=function(){b(new Error(c.statusText))},c.onload=function(){if((c.status>=200&&c.status<300||0===c.status)&&null!==c.response){var d=c.response;if("json"===a.type)try{d=JSON.parse(c.response)}catch(a){return b(a)}b(null,d,c.getResponseHeader("Cache-Control"),c.getResponseHeader("Expires"))}else b(new xa(c.statusText,c.status,a.url))},c.send(a.body),{cancel:function(){return c.abort()}}}(a,b)},Ca=function(a,b){return Ba(k(a,{type:"arrayBuffer"}),b)},Da=function(a,b){return Ba(k(a,{method:"POST"}),b)},Ea,Fa;Ea=[],Fa=0;var Ga=function(a,b){if(Fa>=H.MAX_PARALLEL_IMAGE_REQUESTS){var c={requestParameters:a,callback:b,cancelled:!1,cancel:function(){this.cancelled=!0}};return Ea.push(c),c}Fa++;var d=!1,e=function(){if(!d)for(d=!0,Fa--;Ea.length&&Fa<H.MAX_PARALLEL_IMAGE_REQUESTS;){var a=Ea.shift(),b=a.requestParameters,c=a.callback;a.cancelled||(a.cancel=Ga(b,c).cancel)}},f=Ca(a,function(a,c,d,f){if(e(),a)b(a);else if(c){var g=new self.Image(),h=self.URL||self.webkitURL;g.onload=function(){b(null,g),h.revokeObjectURL(g.src)},g.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};a=new self.Blob([new Uint8Array(c)],{type:"image/png"});g.cacheControl=d,g.expires=f,g.src=c.byteLength?h.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}});return{cancel:function(){f.cancel(),e()}}};function Ha(a,b,c){c[a]&&-1!==c[a].indexOf(b)||(c[a]=c[a]||[],c[a].push(b))}function Ia(a,b,c){if(c&&c[a]){b=c[a].indexOf(b);-1!==b&&c[a].splice(b,1)}}var Ja=function(a,b){void 0===b&&(b={}),k(this,b),this.type=a},Ka=function(a){function b(b,c){void 0===c&&(c={}),a.call(this,"error",k({error:b},c))}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Ja),La=function(){};La.prototype.on=function(a,b){return this._listeners=this._listeners||{},Ha(a,b,this._listeners),this},La.prototype.off=function(a,b){return Ia(a,b,this._listeners),Ia(a,b,this._oneTimeListeners),this},La.prototype.once=function(a,b){return this._oneTimeListeners=this._oneTimeListeners||{},Ha(a,b,this._oneTimeListeners),this},La.prototype.fire=function(a,b){"string"==typeof a&&(a=new Ja(a,b||{}));b=a.type;if(this.listens(b)){a.target=this;for(var c=0,d=this._listeners&&this._listeners[b]?this._listeners[b].slice():[];c<d.length;c+=1)d[c].call(this,a);for(var d=0,c=this._oneTimeListeners&&this._oneTimeListeners[b]?this._oneTimeListeners[b].slice():[];d<c.length;d+=1){var e=c[d];Ia(b,e,this._oneTimeListeners),e.call(this,a)}e=this._eventedParent;e&&(k(a,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),e.fire(a))}else a instanceof Ka&&!1;return this},La.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)},La.prototype.setEventedParent=function(a,b){return this._eventedParent=a,this._eventedParentData=b,this};var U={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},"default":"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,"default":[-180,-85.051129,180,85.051129]},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},"default":"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number","default":18},attribution:{type:"string"},buffer:{type:"number","default":128,maximum:512,minimum:0},tolerance:{type:"number","default":.375},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean","default":!1},generateId:{type:"boolean","default":!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},"default":"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},"default":"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number","default":2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number","default":1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},"default":"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number","default":250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean","default":!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},"default":"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean","default":!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean","default":!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean","default":!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number","default":1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},"default":"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number","default":2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean","default":!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted","default":"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number","default":16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number","default":10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number","default":1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number","default":0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},"default":"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems","default":0,requires:[{"!":"text-offset"}],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:[{"!":"text-anchor"},{"!":"text-offset"},{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",requires:["text-field"],values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number","default":45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number","default":0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number","default":2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean","default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},"default":"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,"default":[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean","default":!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean","default":!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean","default":!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},"function":{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number","default":1,minimum:0},property:{type:"string","default":"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},"default":"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},"default":"rgb"},"default":{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},"var":{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},"case":{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},"typeof":{group:"Types"},string:{group:"Types"},number:{group:"Types"},"boolean":{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum","default":"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array","default":[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant","default":"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant","default":.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean","default":!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number","default":0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number","default":0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean","default":!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number","default":1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number","default":0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number","default":0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},"default":"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number","default":30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number","default":1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number","default":1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color","default":"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color","default":"#000000",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number","default":0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number","default":0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number","default":0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},"default":"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number","default":300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number","default":335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},"default":"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number","default":.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color","default":"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color","default":"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color","default":"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number","default":1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}},V=function(a,b,c,d){this.message=(a?a+": ":"")+c,d&&(this.identifier=d),null!=b&&b.__line__&&(this.line=b.__line__)};function Ma(a){var b=a.key;a=a.value;return a?[new V(b,a,"constants have been deprecated as of v8")]:[]}function Na(a){for(var b=[],c=arguments.length-1;c-->0;)b[c]=arguments[c+1];for(var d=0,e=b;d<e.length;d+=1){var f=e[d];for(var g in f)a[g]=f[g]}return a}function Oa(a){return a instanceof Number||a instanceof String||a instanceof Boolean}function Pa(a){return Oa(a)?a.valueOf():a}function Qa(a){if(Array.isArray(a))return a.map(Qa);if(a instanceof Object&&!Oa(a)){var b={};for(var c in a)b[c]=Qa(a[c]);return b}return Pa(a)}var Ra=function(a){function b(b,c){a.call(this,c),this.message=c,this.key=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Error),Sa=function(a,b){void 0===b&&(b=[]),this.parent=a,this.bindings={};for(var a=0,b=b;a<b.length;a+=1){var c=b[a],d=c[0];c=c[1];this.bindings[d]=c}};Sa.prototype.concat=function(a){return new Sa(this,a)},Sa.prototype.get=function(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(a+" not found in scope.")},Sa.prototype.has=function(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)};var Ta={kind:"null"},W={kind:"number"},Ua={kind:"string"},Va={kind:"boolean"},Wa={kind:"color"},Xa={kind:"object"},Ya={kind:"value"},Za={kind:"collator"},$a={kind:"formatted"};function ab(a,b){return{kind:"array",itemType:a,N:b}}function bb(a){if("array"===a.kind){var b=bb(a.itemType);return"number"==typeof a.N?"array<"+b+", "+a.N+">":"value"===a.itemType.kind?"array":"array<"+b+">"}return a.kind}var cb=[Ta,W,Ua,Va,Wa,$a,Xa,ab(Ya)];function db(a,b){if("error"===b.kind)return null;if("array"===a.kind){if("array"===b.kind&&(0===b.N&&"value"===b.itemType.kind||!db(a.itemType,b.itemType))&&("number"!=typeof a.N||a.N===b.N))return null}else{if(a.kind===b.kind)return null;if("value"===a.kind)for(var c=0,d=cb;c<d.length;c+=1)if(!db(d[c],b))return null}return"Expected "+bb(a)+" but found "+bb(b)+" instead."}var eb=b(function(a,b){var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function d(a){return(a=Math.round(a))<0?0:a>255?255:a}function e(a){return a<0?0:a>1?1:a}function f(a){return"%"===a[a.length-1]?d(parseFloat(a)/100*255):d(parseInt(a))}function g(a){return"%"===a[a.length-1]?e(parseFloat(a)/100):e(parseFloat(a))}function h(a,b,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(b-a)*c*6:2*c<1?b:3*c<2?a+(b-a)*(2/3-c)*6:a}try{b.parseCSSColor=function(a){var b;a=a.replace(/ /g,"").toLowerCase();if(a in c)return c[a].slice();if("#"===a[0])return 4===a.length?(b=parseInt(a.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:7===a.length&&(b=parseInt(a.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var j=a.indexOf("("),e=a.indexOf(")");if(-1!==j&&e+1===a.length){var i=a.substr(0,j);a=a.substr(j+1,e-(j+1)).split(",");e=1;switch(i){case"rgba":if(4!==a.length)return null;e=g(a.pop());case"rgb":return 3!==a.length?null:[f(a[0]),f(a[1]),f(a[2]),e];case"hsla":if(4!==a.length)return null;e=g(a.pop());case"hsl":if(3!==a.length)return null;j=(parseFloat(a[0])%360+360)%360/360;i=g(a[1]);a=g(a[2]);i=a<=.5?a*(i+1):a+i-a*i;a=2*a-i;return[d(255*h(a,i,j+1/3)),d(255*h(a,i,j)),d(255*h(a,i,j-1/3)),e];default:return null}}return null}}catch(a){}}).parseCSSColor,fb=function(a,b,c,d){void 0===d&&(d=1),this.r=a,this.g=b,this.b=c,this.a=d};fb.parse=function(a){if(a){if(a instanceof fb)return a;if("string"==typeof a){a=eb(a);if(a)return new fb(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3])}}},fb.prototype.toString=function(){var a=this.toArray(),b=a[0],c=a[1],d=a[2];a=a[3];return"rgba("+Math.round(b)+","+Math.round(c)+","+Math.round(d)+","+a+")"},fb.prototype.toArray=function(){var a=this.r,b=this.g,c=this.b,d=this.a;return 0===d?[0,0,0,0]:[255*a/d,255*b/d,255*c/d,d]},fb.black=new fb(0,0,0,1),fb.white=new fb(1,1,1,1),fb.transparent=new fb(0,0,0,0),fb.red=new fb(1,0,0,1);var gb=function(a,b,c){this.sensitivity=a?b?"variant":"case":b?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};gb.prototype.compare=function(a,b){return this.collator.compare(a,b)},gb.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var hb=function(a,b,c){this.text=a,this.scale=b,this.fontStack=c},ib=function(a){this.sections=a};function jb(a,b,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof b&&b>=0&&b<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:"Invalid rgba value ["+[a,b,c,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof d?[a,b,c,d]:[a,b,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function kb(a){if(null===a)return Ta;if("string"==typeof a)return Ua;if("boolean"==typeof a)return Va;if("number"==typeof a)return W;if(a instanceof fb)return Wa;if(a instanceof gb)return Za;if(a instanceof ib)return $a;if(Array.isArray(a)){for(var b,c=a.length,d=0,a=a;d<a.length;d+=1){var e=kb(a[d]);if(b){if(b===e)continue;b=Ya;break}b=e}return ab(b||Ya,c)}return Xa}function lb(a){var b=typeof a;return null===a?"":"string"===b||"number"===b||"boolean"===b?String(a):a instanceof fb||a instanceof ib?a.toString():JSON.stringify(a)}ib.fromString=function(a){return new ib([new hb(a,null,null)])},ib.prototype.toString=function(){return this.sections.map(function(a){return a.text}).join("")},ib.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text);var e={};d.fontStack&&(e["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(e["font-scale"]=d.scale),a.push(e)}return a};var mb=function(a,b){this.type=a,this.value=b};mb.parse=function(a,b){if(2!==a.length)return b.error("'literal' expression requires exactly one argument, but found "+(a.length-1)+" instead.");if(!function a(b){if(null===b)return!0;if("string"==typeof b)return!0;if("boolean"==typeof b)return!0;if("number"==typeof b)return!0;if(b instanceof fb)return!0;if(b instanceof gb)return!0;if(b instanceof ib)return!0;if(Array.isArray(b)){for(var c=0,d=b;c<d.length;c+=1)if(!a(d[c]))return!1;return!0}if("object"==typeof b){for(var e in b)if(!a(b[e]))return!1;return!0}return!1}(a[1]))return b.error("invalid value");a=a[1];var c=kb(a);b=b.expectedType;return"array"!==c.kind||0!==c.N||!b||"array"!==b.kind||"number"==typeof b.N&&0!==b.N||(c=b),new mb(c,a)},mb.prototype.evaluate=function(){return this.value},mb.prototype.eachChild=function(){},mb.prototype.possibleOutputs=function(){return[this.value]},mb.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof fb?["rgba"].concat(this.value.toArray()):this.value instanceof ib?this.value.serialize():this.value};var nb=function(a){this.name="ExpressionEvaluationError",this.message=a};nb.prototype.toJSON=function(){return this.message};var ob={string:Ua,number:W,"boolean":Va,object:Xa},pb=function(a,b){this.type=a,this.args=b};pb.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c=1,d=a[0];if("array"===d){var e;if(a.length>2){var f=a[1];if("string"!=typeof f||!(f in ob)||"object"===f)return b.error('The item type argument of "array" must be one of string, number, boolean',1);f=ob[f],c++}else f=Ya;if(a.length>3){if(null!==a[2]&&("number"!=typeof a[2]||a[2]<0||a[2]!==Math.floor(a[2])))return b.error('The length argument to "array" must be a positive integer literal',2);e=a[2],c++}f=ab(f,e)}else f=ob[d];for(var d=[];c<a.length;c++){var g=b.parse(a[c],c,Ya);if(!g)return null;d.push(g)}return new pb(f,d)},pb.prototype.evaluate=function(a){for(var b=0;b<this.args.length;b++){var c=this.args[b].evaluate(a);if(!db(this.type,kb(c)))return c;if(b===this.args.length-1)throw new nb("Expected value to be of type "+bb(this.type)+", but found "+bb(kb(c))+" instead.")}return null},pb.prototype.eachChild=function(a){this.args.forEach(a)},pb.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},pb.prototype.serialize=function(){var a=this.type,b=[a.kind];if("array"===a.kind){var c=a.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){b.push(c.kind);c=a.N;("number"==typeof c||this.args.length>1)&&b.push(c)}}return b.concat(this.args.map(function(a){return a.serialize()}))};var qb=function(a){this.type=$a,this.sections=a};qb.parse=function(a,b){if(a.length<3)return b.error("Expected at least two arguments.");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");for(var c=[],d=1;d<a.length-1;d+=2){var e=b.parse(a[d],1,Ya);if(!e)return null;var f=e.type.kind;if("string"!==f&&"value"!==f&&"null"!==f)return b.error("Formatted text type must be 'string', 'value', or 'null'.");f=a[d+1];if("object"!=typeof f||Array.isArray(f))return b.error("Format options argument must be an object.");var g=null;if(f["font-scale"]&&!(g=b.parse(f["font-scale"],1,W)))return null;var h=null;if(f["text-font"]&&!(h=b.parse(f["text-font"],1,ab(Ua))))return null;c.push({text:e,scale:g,font:h})}return new qb(c)},qb.prototype.evaluate=function(a){return new ib(this.sections.map(function(b){return new hb(lb(b.text.evaluate(a)),b.scale?b.scale.evaluate(a):null,b.font?b.font.evaluate(a).join(","):null)}))},qb.prototype.eachChild=function(a){for(var b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a(d.text),d.scale&&a(d.scale),d.font&&a(d.font)}},qb.prototype.possibleOutputs=function(){return[void 0]},qb.prototype.serialize=function(){for(var a=["format"],b=0,c=this.sections;b<c.length;b+=1){var d=c[b];a.push(d.text.serialize());var e={};d.scale&&(e["font-scale"]=d.scale.serialize()),d.font&&(e["text-font"]=d.font.serialize()),a.push(e)}return a};var rb={"to-boolean":Va,"to-color":Wa,"to-number":W,"to-string":Ua},sb=function(a,b){this.type=a,this.args=b};sb.parse=function(a,b){if(a.length<2)return b.error("Expected at least one argument.");var c=a[0];if(("to-boolean"===c||"to-string"===c)&&2!==a.length)return b.error("Expected one argument.");for(var c=rb[c],d=[],e=1;e<a.length;e++){var f=b.parse(a[e],e,Ya);if(!f)return null;d.push(f)}return new sb(c,d)},sb.prototype.evaluate=function(a){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(a));if("color"===this.type.kind){for(var b,c,d=0,e=this.args;d<e.length;d+=1){if(c=null,(b=e[d].evaluate(a))instanceof fb)return b;if("string"==typeof b){var f=a.parseColor(b);if(f)return f}else if(Array.isArray(b)&&!(c=b.length<3||b.length>4?"Invalid rbga value "+JSON.stringify(b)+": expected an array containing either three or four numeric values.":jb(b[0],b[1],b[2],b[3])))return new fb(b[0]/255,b[1]/255,b[2]/255,b[3])}throw new nb(c||"Could not parse color from value '"+("string"==typeof b?b:String(JSON.stringify(b)))+"'")}if("number"===this.type.kind){for(var f=null,e=0,d=this.args;e<d.length;e+=1){if(null===(f=d[e].evaluate(a)))return 0;var g=Number(f);if(!isNaN(g))return g}throw new nb("Could not convert "+JSON.stringify(f)+" to number.")}return"formatted"===this.type.kind?ib.fromString(lb(this.args[0].evaluate(a))):lb(this.args[0].evaluate(a))},sb.prototype.eachChild=function(a){this.args.forEach(a)},sb.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},sb.prototype.serialize=function(){if("formatted"===this.type.kind)return new qb([{text:this.args[0],scale:null,font:null}]).serialize();var a=["to-"+this.type.kind];return this.eachChild(function(b){a.push(b.serialize())}),a};var tb=["Unknown","Point","LineString","Polygon"],ub=function(){this.globals=null,this.feature=null,this.featureState=null,this._parseColorCache={}};ub.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ub.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?tb[this.feature.type]:this.feature.type:null},ub.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ub.prototype.parseColor=function(a){var b=this._parseColorCache[a];return b||(b=this._parseColorCache[a]=fb.parse(a)),b};var vb=function(a,b,c,d){this.name=a,this.type=b,this._evaluate=c,this.args=d};vb.prototype.evaluate=function(a){return this._evaluate(a,this.args)},vb.prototype.eachChild=function(a){this.args.forEach(a)},vb.prototype.possibleOutputs=function(){return[void 0]},vb.prototype.serialize=function(){return[this.name].concat(this.args.map(function(a){return a.serialize()}))},vb.parse=function(a,b){var c=a[0],d=vb.definitions[c];if(!d)return b.error('Unknown expression "'+c+'". If you wanted a literal array, use ["literal", [...]].',0);for(var e=Array.isArray(d)?d[0]:d.type,d=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,f=d.filter(function(b){b=b[0];return!Array.isArray(b)||b.length===a.length-1}),u=null,g=0,h=f;g<h.length;g+=1){var i=h[g],j=i[0];i=i[1];u=new Bb(b.registry,b.path,null,b.scope);for(var k=[],l=!1,m=1;m<a.length;m++){var s=a[m],t=Array.isArray(j)?j[m-1]:j.type;s=u.parse(s,1+k.length,t);if(!s){l=!0;break}k.push(s)}if(!l)if(Array.isArray(j)&&j.length!==k.length)u.error("Expected "+j.length+" arguments, but found "+k.length+" instead.");else{for(var t=0;t<k.length;t++){s=Array.isArray(j)?j[t]:j.type;m=k[t];u.concat(t+1).checkSubtype(s,m.type)}if(0===u.errors.length)return new vb(c,e,i,k)}}if(1===f.length)(l=b.errors).push.apply(l,u.errors);else{for(var s=(f.length?f:d).map(function(a){a=a[0];return a=a,Array.isArray(a)?"("+a.map(bb).join(", ")+")":"("+bb(a.type)+"...)"}).join(" | "),m=[],t=1;t<a.length;t++){j=b.parse(a[t],1+m.length);if(!j)return null;m.push(bb(j.type))}b.error("Expected arguments of type "+s+", but found ("+m.join(", ")+") instead.")}return null},vb.register=function(a,b){for(var c in vb.definitions=b,b)a[c]=vb};var wb=function(a,b,c){this.type=Za,this.locale=c,this.caseSensitive=a,this.diacriticSensitive=b};function xb(a){if(a instanceof vb){if("get"===a.name&&1===a.args.length)return!1;if("feature-state"===a.name)return!1;if("has"===a.name&&1===a.args.length)return!1;if("properties"===a.name||"geometry-type"===a.name||"id"===a.name)return!1;if(/^filter-/.test(a.name))return!1}var b=!0;return a.eachChild(function(a){b&&!xb(a)&&(b=!1)}),b}function yb(a){if(a instanceof vb&&"feature-state"===a.name)return!1;var b=!0;return a.eachChild(function(a){b&&!yb(a)&&(b=!1)}),b}function zb(a,b){if(a instanceof vb&&b.indexOf(a.name)>=0)return!1;var c=!0;return a.eachChild(function(a){c&&!zb(a,b)&&(c=!1)}),c}wb.parse=function(a,b){if(2!==a.length)return b.error("Expected one argument.");a=a[1];if("object"!=typeof a||Array.isArray(a))return b.error("Collator options argument must be an object.");var c=b.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,Va);if(!c)return null;var d=b.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,Va);if(!d)return null;var e=null;return a.locale&&!(e=b.parse(a.locale,1,Ua))?null:new wb(c,d,e)},wb.prototype.evaluate=function(a){return new gb(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)},wb.prototype.eachChild=function(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)},wb.prototype.possibleOutputs=function(){return[void 0]},wb.prototype.serialize=function(){var a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]};var Ab=function(a,b){this.type=b.type,this.name=a,this.boundExpression=b};Ab.parse=function(a,b){if(2!==a.length||"string"!=typeof a[1])return b.error("'var' expression requires exactly one string literal argument.");a=a[1];return b.scope.has(a)?new Ab(a,b.scope.get(a)):b.error('Unknown variable "'+a+'". Make sure "'+a+'" has been bound in an enclosing "let" expression before using it.',1)},Ab.prototype.evaluate=function(a){return this.boundExpression.evaluate(a)},Ab.prototype.eachChild=function(){},Ab.prototype.possibleOutputs=function(){return[void 0]},Ab.prototype.serialize=function(){return["var",this.name]};var Bb=function(a,b,c,d,e){void 0===b&&(b=[]),void 0===d&&(d=new Sa()),void 0===e&&(e=[]),this.registry=a,this.path=b,this.key=b.map(function(a){return"["+a+"]"}).join(""),this.scope=d,this.errors=e,this.expectedType=c};function Cb(a,b){for(var c,d,e=a.length-1,f=0,g=e,h=0;f<=g;)if(c=a[h=Math.floor((f+g)/2)],d=a[h+1],c<=b){if(h===e||b<d)return h;f=h+1}else{if(!(c>b))throw new nb("Input is not a number.");g=h-1}return 0}Bb.prototype.parse=function(a,b,c,d,e){return void 0===e&&(e={}),b?this.concat(b,c,d)._parse(a,e):this._parse(a,e)},Bb.prototype._parse=function(a,b){function c(a,b,c){return"assert"===c?new pb(b,[a]):"coerce"===c?new sb(b,[a]):a}if(null!==a&&"string"!=typeof a&&"boolean"!=typeof a&&"number"!=typeof a||(a=["literal",a]),Array.isArray(a)){if(0===a.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var d=a[0];if("string"!=typeof d)return this.error("Expression name must be a string, but found "+typeof d+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var e=this.registry[d];if(e){e=e.parse(a,this);if(!e)return null;if(this.expectedType){var f=this.expectedType,g=e.type;if("string"!==f.kind&&"number"!==f.kind&&"boolean"!==f.kind&&"object"!==f.kind&&"array"!==f.kind||"value"!==g.kind)if("color"!==f.kind&&"formatted"!==f.kind||"value"!==g.kind&&"string"!==g.kind){if(this.checkSubtype(f,g))return null}else e=c(e,f,b.typeAnnotation||"coerce");else e=c(e,f,b.typeAnnotation||"assert")}if(!(e instanceof mb)&&function a(b){if(b instanceof Ab)return a(b.boundExpression);if(b instanceof vb&&"error"===b.name)return!1;if(b instanceof wb)return!1;var c=b instanceof sb||b instanceof pb,d=!0;b.eachChild(function(b){d=c?d&&a(b):d&&b instanceof mb});return!d?!1:xb(b)&&zb(b,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(e)){g=new ub();try{e=new mb(e.type,e.evaluate(g))}catch(a){return this.error(a.message),null}}return e}return this.error('Unknown expression "'+d+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===a?this.error("'undefined' value invalid. Use null instead."):"object"==typeof a?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof a+" instead.")},Bb.prototype.concat=function(a,b,c){a="number"==typeof a?this.path.concat(a):this.path;c=c?this.scope.concat(c):this.scope;return new Bb(this.registry,a,b||null,c,this.errors)},Bb.prototype.error=function(a){for(var b=[],c=arguments.length-1;c-->0;)b[c]=arguments[c+1];var d=""+this.key+b.map(function(a){return"["+a+"]"}).join("");this.errors.push(new Ra(d,a))},Bb.prototype.checkSubtype=function(a,b){a=db(a,b);return a&&this.error(a),a};var Db=function(a,b,c){this.type=a,this.input=b,this.labels=[],this.outputs=[];for(var a=0,b=c;a<b.length;a+=1){c=b[a];var d=c[0];c=c[1];this.labels.push(d),this.outputs.push(c)}};function Eb(a,b,c){return a*(1-c)+b*c}Db.parse=function(a,b){if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");var c=b.parse(a[1],1,W);if(!c)return null;var d=[],e=null;b.expectedType&&"value"!==b.expectedType.kind&&(e=b.expectedType);for(var f=1;f<a.length;f+=2){var g=1===f?-1/0:a[f],h=a[f+1],j=f,i=f+1;if("number"!=typeof g)return b.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(d.length&&d[d.length-1][0]>=g)return b.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);j=b.parse(h,i,e);if(!j)return null;e=e||j.type,d.push([g,j])}return new Db(e,c,d)},Db.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;return d>=b[e-1]?c[e-1].evaluate(a):c[Cb(b,d)].evaluate(a)},Db.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},Db.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},Db.prototype.serialize=function(){for(var a=["step",this.input.serialize()],b=0;b<this.labels.length;b++)b>0&&a.push(this.labels[b]),a.push(this.outputs[b].serialize());return a};var Fb=Object.freeze({number:Eb,color:function(a,b,c){return new fb(Eb(a.r,b.r,c),Eb(a.g,b.g,c),Eb(a.b,b.b,c),Eb(a.a,b.a,c))},array:function(a,b,c){return a.map(function(a,d){return Eb(a,b[d],c)})}}),Gb=.95047,Hb=1,Ib=1.08883,Jb=4/29,Kb=6/29,Lb=3*Kb*Kb,Mb=Kb*Kb*Kb,Nb=Math.PI/180,Ob=180/Math.PI;function Pb(a){return a>Mb?Math.pow(a,1/3):a/Lb+Jb}function Qb(a){return a>Kb?a*a*a:Lb*(a-Jb)}function Rb(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Sb(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Tb(a){var b=Sb(a.r),c=Sb(a.g),d=Sb(a.b),e=Pb((.4124564*b+.3575761*c+.1804375*d)/Gb),f=Pb((.2126729*b+.7151522*c+.072175*d)/Hb);return{l:116*f-16,a:500*(e-f),b:200*(f-Pb((.0193339*b+.119192*c+.9503041*d)/Ib)),alpha:a.a}}function Ub(a){var b=(a.l+16)/116,c=isNaN(a.a)?b:b+a.a/500,d=isNaN(a.b)?b:b-a.b/200;return b=Hb*Qb(b),c=Gb*Qb(c),d=Ib*Qb(d),new fb(Rb(3.2404542*c-1.5371385*b-.4985314*d),Rb(-.969266*c+1.8760108*b+.041556*d),Rb(.0556434*c-.2040259*b+1.0572252*d),a.alpha)}function Vb(a,b,c){b=b-a;return a+c*(b>180||b<-180?b-360*Math.round(b/360):b)}var Wb={forward:Tb,reverse:Ub,interpolate:function(a,b,c){return{l:Eb(a.l,b.l,c),a:Eb(a.a,b.a,c),b:Eb(a.b,b.b,c),alpha:Eb(a.alpha,b.alpha,c)}}},Xb={forward:function(a){var b=Tb(a),c=b.l,d=b.a;b=b.b;var e=Math.atan2(b,d)*Ob;return{h:e<0?e+360:e,c:Math.sqrt(d*d+b*b),l:c,alpha:a.a}},reverse:function(a){var b=a.h*Nb,c=a.c;return Ub({l:a.l,a:Math.cos(b)*c,b:Math.sin(b)*c,alpha:a.alpha})},interpolate:function(a,b,c){return{h:Vb(a.h,b.h,c),c:Eb(a.c,b.c,c),l:Eb(a.l,b.l,c),alpha:Eb(a.alpha,b.alpha,c)}}},Yb=Object.freeze({lab:Wb,hcl:Xb}),Zb=function(a,b,c,d,e){this.type=a,this.operator=b,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(var a=0,b=e;a<b.length;a+=1){c=b[a];d=c[0];e=c[1];this.labels.push(d),this.outputs.push(e)}};function $b(a,b,c,d){d=d-c;a=a-c;return 0===d?0:1===b?a/d:(Math.pow(b,a)-1)/(Math.pow(b,d)-1)}Zb.interpolationFactor=function(a,b,d,e){var f=0;if("exponential"===a.name)f=$b(b,a.base,d,e);else if("linear"===a.name)f=$b(b,1,d,e);else if("cubic-bezier"===a.name){a=a.controlPoints;f=new c(a[0],a[1],a[2],a[3]).solve($b(b,1,d,e))}return f},Zb.parse=function(a,b){var c=a[0],d=a[1],e=a[2],f=a.slice(3);if(!Array.isArray(d)||0===d.length)return b.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){var g=d[1];if("number"!=typeof g)return b.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:g}}else{if("cubic-bezier"!==d[0])return b.error("Unknown interpolation type "+String(d[0]),1,0);g=d.slice(1);if(4!==g.length||g.some(function(a){return"number"!=typeof a||a<0||a>1}))return b.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:g}}if(a.length-1<4)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if((a.length-1)%2!=0)return b.error("Expected an even number of arguments.");if(!(e=b.parse(e,2,W)))return null;g=[];a=null;"interpolate-hcl"===c||"interpolate-lab"===c?a=Wa:b.expectedType&&"value"!==b.expectedType.kind&&(a=b.expectedType);for(var h=0;h<f.length;h+=2){var i=f[h],j=f[h+1],k=h+3,l=h+4;if("number"!=typeof i)return b.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(g.length&&g[g.length-1][0]>=i)return b.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);k=b.parse(j,l,a);if(!k)return null;a=a||k.type,g.push([i,k])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new Zb(a,c,d,e,g):b.error("Type "+bb(a)+" is not interpolatable.")},Zb.prototype.evaluate=function(a){var b=this.labels,c=this.outputs;if(1===b.length)return c[0].evaluate(a);var d=this.input.evaluate(a);if(d<=b[0])return c[0].evaluate(a);var e=b.length;if(d>=b[e-1])return c[e-1].evaluate(a);e=Cb(b,d);var f=b[e];b=b[e+1];d=Zb.interpolationFactor(this.interpolation,d,f,b);f=c[e].evaluate(a);b=c[e+1].evaluate(a);return"interpolate"===this.operator?Fb[this.type.kind.toLowerCase()](f,b,d):"interpolate-hcl"===this.operator?Xb.reverse(Xb.interpolate(Xb.forward(f),Xb.forward(b),d)):Wb.reverse(Wb.interpolate(Wb.forward(f),Wb.forward(b),d))},Zb.prototype.eachChild=function(a){a(this.input);for(var b=0,c=this.outputs;b<c.length;b+=1)a(c[b])},Zb.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))},Zb.prototype.serialize=function(){var a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var a=[this.operator,a,this.input.serialize()],b=0;b<this.labels.length;b++)a.push(this.labels[b],this.outputs[b].serialize());return a};var ac=function(a,b){this.type=a,this.args=b};ac.parse=function(a,b){if(a.length<2)return b.error("Expectected at least one argument.");var c=null,d=b.expectedType;d&&"value"!==d.kind&&(c=d);for(var e=[],f=0,a=a.slice(1);f<a.length;f+=1){var g=a[f];g=b.parse(g,1+e.length,c,void 0,{typeAnnotation:"omit"});if(!g)return null;c=c||g.type,e.push(g)}g=d&&e.some(function(a){return db(d,a.type)});return new ac(g?Ya:c,e)},ac.prototype.evaluate=function(a){for(var b=null,c=0,d=this.args;c<d.length;c+=1)if(null!==(b=d[c].evaluate(a)))break;return b},ac.prototype.eachChild=function(a){this.args.forEach(a)},ac.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.args.map(function(a){return a.possibleOutputs()}))},ac.prototype.serialize=function(){var a=["coalesce"];return this.eachChild(function(b){a.push(b.serialize())}),a};var bc=function(a,b){this.type=b.type,this.bindings=[].concat(a),this.result=b};bc.prototype.evaluate=function(a){return this.result.evaluate(a)},bc.prototype.eachChild=function(a){for(var b=0,c=this.bindings;b<c.length;b+=1)a(c[b][1]);a(this.result)},bc.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found "+(a.length-1)+" instead.");for(var c=[],d=1;d<a.length-1;d+=2){var e=a[d];if("string"!=typeof e)return b.error("Expected string, but found "+typeof e+" instead.",d);if(/[^a-zA-Z0-9_]/.test(e))return b.error("Variable names must contain only alphanumeric characters or '_'.",d);var f=b.parse(a[d+1],d+1);if(!f)return null;c.push([e,f])}e=b.parse(a[a.length-1],a.length-1,b.expectedType,c);return e?new bc(c,e):null},bc.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},bc.prototype.serialize=function(){for(var a=["let"],b=0,c=this.bindings;b<c.length;b+=1){var d=c[b],e=d[0];d=d[1];a.push(e,d.serialize())}return a.push(this.result.serialize()),a};var cc=function(a,b,c){this.type=a,this.index=b,this.input=c};cc.parse=function(a,b){if(3!==a.length)return b.error("Expected 2 arguments, but found "+(a.length-1)+" instead.");var c=b.parse(a[1],1,W);a=b.parse(a[2],2,ab(b.expectedType||Ya));if(!c||!a)return null;b=a.type;return new cc(b.itemType,c,a)},cc.prototype.evaluate=function(a){var b=this.index.evaluate(a);a=this.input.evaluate(a);if(b<0)throw new nb("Array index out of bounds: "+b+" < 0.");if(b>=a.length)throw new nb("Array index out of bounds: "+b+" > "+(a.length-1)+".");if(b!==Math.floor(b))throw new nb("Array index must be an integer, but found "+b+" instead.");return a[b]},cc.prototype.eachChild=function(a){a(this.index),a(this.input)},cc.prototype.possibleOutputs=function(){return[void 0]},cc.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var dc=function(a,b,c,d,e,f){this.inputType=a,this.type=b,this.input=c,this.cases=d,this.outputs=e,this.otherwise=f};dc.parse=function(a,b){if(a.length<5)return b.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(a.length%2!=1)return b.error("Expected an even number of arguments.");var c,d;b.expectedType&&"value"!==b.expectedType.kind&&(d=b.expectedType);for(var e={},f=[],g=2;g<a.length-1;g+=2){var h=a[g],l=a[g+1];Array.isArray(h)||(h=[h]);var i=b.concat(g);if(0===h.length)return i.error("Expected at least one branch label.");for(var j=0,h=h;j<h.length;j+=1){var k=h[j];if("number"!=typeof k&&"string"!=typeof k)return i.error("Branch labels must be numbers or strings.");if("number"==typeof k&&Math.abs(k)>Number.MAX_SAFE_INTEGER)return i.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof k&&Math.floor(k)!==k)return i.error("Numeric branch labels must be integer values.");if(c){if(i.checkSubtype(c,kb(k)))return null}else c=kb(k);if(void 0!==e[String(k)])return i.error("Branch labels must be unique.");e[String(k)]=f.length}k=b.parse(l,g,d);if(!k)return null;d=d||k.type,f.push(k)}h=b.parse(a[1],1,Ya);if(!h)return null;i=b.parse(a[a.length-1],a.length-1,d);return i?"value"!==h.type.kind&&b.concat(1).checkSubtype(c,h.type)?null:new dc(c,d,h,e,f,i):null},dc.prototype.evaluate=function(a){var b=this.input.evaluate(a);return(kb(b)===this.inputType&&this.outputs[this.cases[b]]||this.otherwise).evaluate(a)},dc.prototype.eachChild=function(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)},dc.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},dc.prototype.serialize=function(){for(var a=this,b=["match",this.input.serialize()],c=[],d={},e=0,f=Object.keys(this.cases).sort();e<f.length;e+=1){var g=f[e];void 0===(h=d[this.cases[g]])?(d[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[h][1].push(g)}for(var h=function(b){return"number"===a.inputType.kind?Number(b):b},g=0,f=c;g<f.length;g+=1){e=f[g];var h;e[0];d=e[1];1===d.length?b.push(h(d[0])):b.push(d.map(h)),b.push(this.outputs[outputIndex$1].serialize())}return b.push(this.otherwise.serialize()),b};var ec=function(a,b,c){this.type=a,this.branches=b,this.otherwise=c};function fc(a,b){return"=="===a||"!="===a?"boolean"===b.kind||"string"===b.kind||"number"===b.kind||"null"===b.kind||"value"===b.kind:"string"===b.kind||"number"===b.kind||"value"===b.kind}function gc(a,b,c,d){return 0===d.compare(b,c)}function hc(a,b,c){var d="=="!==a&&"!="!==a;return function(){function e(a,b,c){this.type=Va,this.lhs=a,this.rhs=b,this.collator=c,this.hasUntypedArgument="value"===a.type.kind||"value"===b.type.kind}return e.parse=function(a,b){if(3!==a.length&&4!==a.length)return b.error("Expected two or three arguments.");var c=a[0],f=b.parse(a[1],1,Ya);if(!f)return null;if(!fc(c,f.type))return b.concat(1).error('"'+c+"\" comparisons are not supported for type '"+bb(f.type)+"'.");var g=b.parse(a[2],2,Ya);if(!g)return null;if(!fc(c,g.type))return b.concat(2).error('"'+c+"\" comparisons are not supported for type '"+bb(g.type)+"'.");if(f.type.kind!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot compare types '"+bb(f.type)+"' and '"+bb(g.type)+"'.");d&&("value"===f.type.kind&&"value"!==g.type.kind?f=new pb(g.type,[f]):"value"!==f.type.kind&&"value"===g.type.kind&&(g=new pb(f.type,[g])));c=null;if(4===a.length){if("string"!==f.type.kind&&"string"!==g.type.kind&&"value"!==f.type.kind&&"value"!==g.type.kind)return b.error("Cannot use collator to compare non-string types.");if(!(c=b.parse(a[3],3,Za)))return null}return new e(f,g,c)},e.prototype.evaluate=function(e){var f=this.lhs.evaluate(e),g=this.rhs.evaluate(e);if(d&&this.hasUntypedArgument){var h=kb(f),i=kb(g);if(h.kind!==i.kind||"string"!==h.kind&&"number"!==h.kind)throw new nb('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+h.kind+", "+i.kind+") instead.")}if(this.collator&&!d&&this.hasUntypedArgument){h=kb(f);i=kb(g);if("string"!==h.kind||"string"!==i.kind)return b(e,f,g)}return this.collator?c(e,f,g,this.collator.evaluate(e)):b(e,f,g)},e.prototype.eachChild=function(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)},e.prototype.possibleOutputs=function(){return[!0,!1]},e.prototype.serialize=function(){var b=[a];return this.eachChild(function(a){b.push(a.serialize())}),b},e}()}ec.parse=function(a,b){if(a.length<4)return b.error("Expected at least 3 arguments, but found only "+(a.length-1)+".");if(a.length%2!=0)return b.error("Expected an odd number of arguments.");var c;b.expectedType&&"value"!==b.expectedType.kind&&(c=b.expectedType);for(var d=[],e=1;e<a.length-1;e+=2){var f=b.parse(a[e],e,Va);if(!f)return null;var g=b.parse(a[e+1],e+1,c);if(!g)return null;d.push([f,g]),c=c||g.type}f=b.parse(a[a.length-1],a.length-1,c);return f?new ec(c,d,f):null},ec.prototype.evaluate=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0];d=d[1];if(e.evaluate(a))return d.evaluate(a)}return this.otherwise.evaluate(a)},ec.prototype.eachChild=function(a){for(var b=0,c=this.branches;b<c.length;b+=1){var d=c[b],e=d[0];d=d[1];a(e),a(d)}a(this.otherwise)},ec.prototype.possibleOutputs=function(){var a;return(a=[]).concat.apply(a,this.branches.map(function(a){a[0];return a[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},ec.prototype.serialize=function(){var a=["case"];return this.eachChild(function(b){a.push(b.serialize())}),a};var ic=hc("==",function(a,b,c){return b===c},gc),X=hc("!=",function(a,b,c){return b!==c},function(a,b,c,d){return!gc(0,b,c,d)}),jc=hc("<",function(a,b,c){return b<c},function(a,b,c,d){return d.compare(b,c)<0}),Y=hc(">",function(a,b,c){return b>c},function(a,b,c,d){return d.compare(b,c)>0}),kc=hc("<=",function(a,b,c){return b<=c},function(a,b,c,d){return d.compare(b,c)<=0});hc=hc(">=",function(a,b,c){return b>=c},function(a,b,c,d){return d.compare(b,c)>=0});var lc=function(a,b,c,d,e){this.type=Ua,this.number=a,this.locale=b,this.currency=c,this.minFractionDigits=d,this.maxFractionDigits=e};lc.parse=function(a,b){if(3!==a.length)return b.error("Expected two arguments.");var c=b.parse(a[1],1,W);if(!c)return null;a=a[2];if("object"!=typeof a||Array.isArray(a))return b.error("NumberFormat options argument must be an object.");var d=null;if(a.locale&&!(d=b.parse(a.locale,1,Ua)))return null;var e=null;if(a.currency&&!(e=b.parse(a.currency,1,Ua)))return null;var f=null;if(a["min-fraction-digits"]&&!(f=b.parse(a["min-fraction-digits"],1,W)))return null;var g=null;return a["max-fraction-digits"]&&!(g=b.parse(a["max-fraction-digits"],1,W))?null:new lc(c,d,e,f,g)},lc.prototype.evaluate=function(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))},lc.prototype.eachChild=function(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)},lc.prototype.possibleOutputs=function(){return[void 0]},lc.prototype.serialize=function(){var a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]};var mc=function(a){this.type=W,this.input=a};mc.parse=function(a,b){if(2!==a.length)return b.error("Expected 1 argument, but found "+(a.length-1)+" instead.");a=b.parse(a[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?b.error("Expected argument of type string or array, but found "+bb(a.type)+" instead."):new mc(a):null},mc.prototype.evaluate=function(a){a=this.input.evaluate(a);if("string"==typeof a)return a.length;if(Array.isArray(a))return a.length;throw new nb("Expected value to be of type string or array, but found "+bb(kb(a))+" instead.")},mc.prototype.eachChild=function(a){a(this.input)},mc.prototype.possibleOutputs=function(){return[void 0]},mc.prototype.serialize=function(){var a=["length"];return this.eachChild(function(b){a.push(b.serialize())}),a};var nc={"==":ic,"!=":X,">":Y,"<":jc,">=":hc,"<=":kc,array:pb,at:cc,"boolean":pb,"case":ec,coalesce:ac,collator:wb,format:qb,interpolate:Zb,"interpolate-hcl":Zb,"interpolate-lab":Zb,length:mc,let:bc,literal:mb,match:dc,number:pb,"number-format":lc,object:pb,step:Db,string:pb,"to-boolean":sb,"to-color":sb,"to-number":sb,"to-string":sb,"var":Ab};function oc(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];c=c.evaluate(a),d=d.evaluate(a),e=e.evaluate(a);b=b?b.evaluate(a):1;a=jb(c,d,e,b);if(a)throw new nb(a);return new fb(c/255*b,d/255*b,e/255*b,b)}function pc(a,b){return a in b}function qc(a,b){b=b[a];return void 0===b?null:b}function rc(a){return{type:a}}function sc(a){return{result:"success",value:a}}function tc(a){return{result:"error",value:a}}function uc(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]}function vc(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function wc(a){return!!a.expression&&a.expression.interpolated}function xc(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function yc(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function zc(a){return a}function Ac(a,b,c){return void 0!==a?a:void 0!==b?b:void 0!==c?c:void 0}function Bc(a,b,c,d,e){return Ac(typeof c===e?d[c]:void 0,a["default"],b["default"])}function Cc(a,b,c){if("number"!==xc(c))return Ac(a["default"],b["default"]);b=a.stops.length;if(1===b)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[b-1][0])return a.stops[b-1][1];b=Cb(a.stops.map(function(a){return a[0]}),c);return a.stops[b][1]}function Dc(a,b,c){var d=void 0!==a.base?a.base:1;if("number"!==xc(c))return Ac(a["default"],b["default"]);var e=a.stops.length;if(1===e)return a.stops[0][1];if(c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[e-1][0])return a.stops[e-1][1];e=Cb(a.stops.map(function(a){return a[0]}),c);var f=function(a,b,c,d){d=d-c;a=a-c;return 0===d?0:1===b?a/d:(Math.pow(b,a)-1)/(Math.pow(b,d)-1)}(c,d,a.stops[e][0],a.stops[e+1][0]),g=a.stops[e][1],j=a.stops[e+1][1],h=Fb[b.type]||zc;if(a.colorSpace&&"rgb"!==a.colorSpace){var i=Yb[a.colorSpace];h=function(a,b){return i.reverse(i.interpolate(i.forward(a),i.forward(b),f))}}return"function"==typeof g.evaluate?{evaluate:function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var c=g.evaluate.apply(void 0,a),d=j.evaluate.apply(void 0,a);if(void 0!==c&&void 0!==d)return h(c,d,f)}}:h(g,j,f)}function Ec(a,b,c){return"color"===b.type?c=fb.parse(c):"formatted"===b.type?c=ib.fromString(c.toString()):xc(c)===b.type||"enum"===b.type&&b.values[c]||(c=void 0),Ac(c,a["default"],b["default"])}vb.register(nc,{error:[{kind:"error"},[Ua],function(a,b){b=b[0];throw new nb(b.evaluate(a))}],"typeof":[Ua,[Ya],function(a,b){return bb(kb(b[0].evaluate(a)))}],"to-rgba":[ab(W,4),[Wa],function(a,b){return b[0].evaluate(a).toArray()}],rgb:[Wa,[W,W,W],oc],rgba:[Wa,[W,W,W,W],oc],has:{type:Va,overloads:[[[Ua],function(a,b){return pc(b[0].evaluate(a),a.properties())}],[[Ua,Xa],function(a,b){var c=b[0];b=b[1];return pc(c.evaluate(a),b.evaluate(a))}]]},get:{type:Ya,overloads:[[[Ua],function(a,b){return qc(b[0].evaluate(a),a.properties())}],[[Ua,Xa],function(a,b){var c=b[0];b=b[1];return qc(c.evaluate(a),b.evaluate(a))}]]},"feature-state":[Ya,[Ua],function(a,b){return qc(b[0].evaluate(a),a.featureState||{})}],properties:[Xa,[],function(a){return a.properties()}],"geometry-type":[Ua,[],function(a){return a.geometryType()}],id:[Ya,[],function(a){return a.id()}],zoom:[W,[],function(a){return a.globals.zoom}],"heatmap-density":[W,[],function(a){return a.globals.heatmapDensity||0}],"line-progress":[W,[],function(a){return a.globals.lineProgress||0}],accumulated:[Ya,[],function(a){return void 0===a.globals.accumulated?null:a.globals.accumulated}],"+":[W,rc(W),function(a,b){for(var c=0,d=0,b=b;d<b.length;d+=1)c+=b[d].evaluate(a);return c}],"*":[W,rc(W),function(a,b){for(var c=1,d=0,b=b;d<b.length;d+=1)c*=b[d].evaluate(a);return c}],"-":{type:W,overloads:[[[W,W],function(a,b){var c=b[0];b=b[1];return c.evaluate(a)-b.evaluate(a)}],[[W],function(a,b){return-b[0].evaluate(a)}]]},"/":[W,[W,W],function(a,b){var c=b[0];b=b[1];return c.evaluate(a)/b.evaluate(a)}],"%":[W,[W,W],function(a,b){var c=b[0];b=b[1];return c.evaluate(a)%b.evaluate(a)}],ln2:[W,[],function(){return Math.LN2}],pi:[W,[],function(){return Math.PI}],e:[W,[],function(){return Math.E}],"^":[W,[W,W],function(a,b){var c=b[0];b=b[1];return Math.pow(c.evaluate(a),b.evaluate(a))}],sqrt:[W,[W],function(a,b){b=b[0];return Math.sqrt(b.evaluate(a))}],log10:[W,[W],function(a,b){b=b[0];return Math.log(b.evaluate(a))/Math.LN10}],ln:[W,[W],function(a,b){b=b[0];return Math.log(b.evaluate(a))}],log2:[W,[W],function(a,b){b=b[0];return Math.log(b.evaluate(a))/Math.LN2}],sin:[W,[W],function(a,b){b=b[0];return Math.sin(b.evaluate(a))}],cos:[W,[W],function(a,b){b=b[0];return Math.cos(b.evaluate(a))}],tan:[W,[W],function(a,b){b=b[0];return Math.tan(b.evaluate(a))}],asin:[W,[W],function(a,b){b=b[0];return Math.asin(b.evaluate(a))}],acos:[W,[W],function(a,b){b=b[0];return Math.acos(b.evaluate(a))}],atan:[W,[W],function(a,b){b=b[0];return Math.atan(b.evaluate(a))}],min:[W,rc(W),function(a,b){return Math.min.apply(Math,b.map(function(b){return b.evaluate(a)}))}],max:[W,rc(W),function(a,b){return Math.max.apply(Math,b.map(function(b){return b.evaluate(a)}))}],abs:[W,[W],function(a,b){b=b[0];return Math.abs(b.evaluate(a))}],round:[W,[W],function(a,b){b=b[0].evaluate(a);return b<0?-Math.round(-b):Math.round(b)}],floor:[W,[W],function(a,b){b=b[0];return Math.floor(b.evaluate(a))}],ceil:[W,[W],function(a,b){b=b[0];return Math.ceil(b.evaluate(a))}],"filter-==":[Va,[Ua,Ya],function(a,b){var c=b[0];b=b[1];return a.properties()[c.value]===b.value}],"filter-id-==":[Va,[Ya],function(a,b){b=b[0];return a.id()===b.value}],"filter-type-==":[Va,[Ua],function(a,b){b=b[0];return a.geometryType()===b.value}],"filter-<":[Va,[Ua,Ya],function(a,b){var c=b[0];b=b[1];a=a.properties()[c.value];c=b.value;return typeof a==typeof c&&a<c}],"filter-id-<":[Va,[Ya],function(a,b){b=b[0];a=a.id();b=b.value;return typeof a==typeof b&&a<b}],"filter->":[Va,[Ua,Ya],function(a,b){var c=b[0];b=b[1];a=a.properties()[c.value];c=b.value;return typeof a==typeof c&&a>c}],"filter-id->":[Va,[Ya],function(a,b){b=b[0];a=a.id();b=b.value;return typeof a==typeof b&&a>b}],"filter-<=":[Va,[Ua,Ya],function(a,b){var c=b[0];b=b[1];a=a.properties()[c.value];c=b.value;return typeof a==typeof c&&a<=c}],"filter-id-<=":[Va,[Ya],function(a,b){b=b[0];a=a.id();b=b.value;return typeof a==typeof b&&a<=b}],"filter->=":[Va,[Ua,Ya],function(a,b){var c=b[0];b=b[1];a=a.properties()[c.value];c=b.value;return typeof a==typeof c&&a>=c}],"filter-id->=":[Va,[Ya],function(a,b){b=b[0];a=a.id();b=b.value;return typeof a==typeof b&&a>=b}],"filter-has":[Va,[Ya],function(a,b){return b[0].value in a.properties()}],"filter-has-id":[Va,[],function(a){return null!==a.id()}],"filter-type-in":[Va,[ab(Ua)],function(a,b){return b[0].value.indexOf(a.geometryType())>=0}],"filter-id-in":[Va,[ab(Ya)],function(a,b){return b[0].value.indexOf(a.id())>=0}],"filter-in-small":[Va,[Ua,ab(Ya)],function(a,b){var c=b[0];return b[1].value.indexOf(a.properties()[c.value])>=0}],"filter-in-large":[Va,[Ua,ab(Ya)],function(a,b){var c=b[0];b=b[1];return function(a,b,c,d){for(;c<=d;){var e=c+d>>1;if(b[e]===a)return!0;b[e]>a?d=e-1:c=e+1}return!1}(a.properties()[c.value],b.value,0,b.value.length-1)}],all:{type:Va,overloads:[[[Va,Va],function(a,b){var c=b[0];b=b[1];return c.evaluate(a)&&b.evaluate(a)}],[rc(Va),function(a,b){for(var c=0,b=b;c<b.length;c+=1)if(!b[c].evaluate(a))return!1;return!0}]]},any:{type:Va,overloads:[[[Va,Va],function(a,b){var c=b[0];b=b[1];return c.evaluate(a)||b.evaluate(a)}],[rc(Va),function(a,b){for(var c=0,b=b;c<b.length;c+=1)if(b[c].evaluate(a))return!0;return!1}]]},"!":[Va,[Va],function(a,b){return!b[0].evaluate(a)}],"is-supported-script":[Va,[Ua],function(a,b){b=b[0];var c=a.globals&&a.globals.isSupportedScript;return!c||c(b.evaluate(a))}],upcase:[Ua,[Ua],function(a,b){return b[0].evaluate(a).toUpperCase()}],downcase:[Ua,[Ua],function(a,b){return b[0].evaluate(a).toLowerCase()}],concat:[Ua,rc(Ya),function(a,b){return b.map(function(b){return lb(b.evaluate(a))}).join("")}],"resolved-locale":[Ua,[Za],function(a,b){return b[0].evaluate(a).resolvedLocale()}]});var Fc=function(a,b){this.expression=a,this._warningHistory={},this._evaluator=new ub(),this._defaultValue=b?"color"===(a=b).type&&yc(a["default"])?new fb(0,0,0,0):"color"===a.type?fb.parse(a["default"])||null:void 0===a["default"]?null:a["default"]:null,this._enumValues=b&&"enum"===b.type?b.values:null};function Gc(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in nc}function Hc(a,b){var c=new Bb(nc,[],b?function(a){var b={color:Wa,string:Ua,number:W,"enum":Ua,"boolean":Va,formatted:$a};return"array"===a.type?ab(b[a.value]||Ya,a.length):b[a.type]}(b):void 0);a=c.parse(a,void 0,void 0,void 0,b&&"string"===b.type?{typeAnnotation:"coerce"}:void 0);return a?sc(new Fc(a,b)):tc(c.errors)}Fc.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._evaluator.globals=a,this._evaluator.feature=b,this._evaluator.featureState=c,this.expression.evaluate(this._evaluator)},Fc.prototype.evaluate=function(a,b,c){this._evaluator.globals=a,this._evaluator.feature=b||null,this._evaluator.featureState=c||null;try{a=this.expression.evaluate(this._evaluator);if(null==a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new nb("Expected value to be one of "+Object.keys(this._enumValues).map(function(a){return JSON.stringify(a)}).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,"undefined"!=typeof console&&!1),this._defaultValue}};var Ic=function(a,b){this.kind=a,this._styleExpression=b,this.isStateDependent="constant"!==a&&!yb(b.expression)};Ic.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c)},Ic.prototype.evaluate=function(a,b,c){return this._styleExpression.evaluate(a,b,c)};var Jc=function(a,b,c){this.kind=a,this.zoomStops=c.labels,this._styleExpression=b,this.isStateDependent="camera"!==a&&!yb(b.expression),c instanceof Zb&&(this.interpolationType=c.interpolation)};function Kc(a,b){if("error"===(a=Hc(a,b)).result)return a;var c=a.value.expression,d=xb(c);if(!d&&!uc(b))return tc([new Ra("","data expressions not supported")]);var e=zb(c,["zoom"]);if(!e&&!vc(b))return tc([new Ra("","zoom expressions not supported")]);c=function a(b){var c=null;if(b instanceof bc)c=a(b.result);else if(b instanceof ac)for(var d=0,e=b.args;d<e.length;d+=1){var f=e[d];if(c=a(f))break}else(b instanceof Db||b instanceof Zb)&&b.input instanceof vb&&"zoom"===b.input.name&&(c=b);if(c instanceof Ra)return c;b.eachChild(function(b){b=a(b);b instanceof Ra?c=b:!c&&b?c=new Ra("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):c&&b&&c!==b&&(c=new Ra("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))});return c}(c);return c||e?c instanceof Ra?tc([c]):c instanceof Zb&&!wc(b)?tc([new Ra("",'"interpolate" expressions cannot be used with this property')]):sc(c?new Jc(d?"camera":"composite",a.value,c):new Ic(d?"constant":"source",a.value)):tc([new Ra("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Jc.prototype.evaluateWithoutErrorHandling=function(a,b,c){return this._styleExpression.evaluateWithoutErrorHandling(a,b,c)},Jc.prototype.evaluate=function(a,b,c){return this._styleExpression.evaluate(a,b,c)},Jc.prototype.interpolationFactor=function(a,b,c){return this.interpolationType?Zb.interpolationFactor(this.interpolationType,a,b,c):0};var Lc=function(a,b){this._parameters=a,this._specification=b,Na(this,function a(b,c){var d,e,f,g="color"===c.type,h=b.stops&&"object"==typeof b.stops[0][0],o=h||void 0!==b.property;o=h||!o;var i=b.type||(wc(c)?"exponential":"interval");if(g&&((b=Na({},b)).stops&&(b.stops=b.stops.map(function(a){return[a[0],fb.parse(a[1])]})),b["default"]?b["default"]=fb.parse(b["default"]):b["default"]=fb.parse(c["default"])),b.colorSpace&&"rgb"!==b.colorSpace&&!Yb[b.colorSpace])throw new Error("Unknown color space: "+b.colorSpace);if("exponential"===i)d=Dc;else if("interval"===i)d=Cc;else if("categorical"===i){d=Bc,e=Object.create(null);for(var g=0,j=b.stops;g<j.length;g+=1){var k=j[g];e[k[0]]=k[1]}f=typeof b.stops[0][0]}else{if("identity"!==i)throw new Error('Unknown function type "'+i+'"');d=Ec}if(h){for(var k={},g=[],j=0;j<b.stops.length;j++){h=b.stops[j];var l=h[0].zoom;void 0===k[l]&&(k[l]={zoom:l,type:b.type,property:b.property,"default":b["default"],stops:[]},g.push(l)),k[l].stops.push([h[0].value,h[1]])}for(var n=[],l=0,h=g;l<h.length;l+=1){j=h[l];n.push([k[j].zoom,a(k[j],c)])}g={name:"linear"};return{kind:"composite",interpolationType:g,interpolationFactor:Zb.interpolationFactor.bind(void 0,g),zoomStops:n.map(function(a){return a[0]}),evaluate:function(a,d){a=a.zoom;return Dc({stops:n,base:b.base},c,a).evaluate(a,d)}}}if(o){j="exponential"===i?{name:"exponential",base:void 0!==b.base?b.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:Zb.interpolationFactor.bind(void 0,j),zoomStops:b.stops.map(function(a){return a[0]}),evaluate:function(a){a=a.zoom;return d(b,c,a,e,f)}}}return{kind:"source",evaluate:function(a,g){a=g&&g.properties?g.properties[b.property]:void 0;return void 0===a?Ac(b["default"],c["default"]):d(b,c,a,e,f)}}}(this._parameters,this._specification))};function Mc(a){var b=a.key,c=a.value,d=a.valueSpec||{},e=a.objectElementValidators||{},f=a.style;a=a.styleSpec;var g=[],l=xc(c);if("object"!==l)return[new V(b,c,"object expected, "+l+" found")];for(var h in c){l=h.split(".")[0];var i=d[l]||d["*"],j;if(e[l])j=e[l];else if(d[l])j=jd;else if(e["*"])j=e["*"];else{if(!d["*"]){g.push(new V(b,c[h],'unknown property "'+h+'"'));continue}j=jd}g=g.concat(j({key:(b?b+".":b)+h,value:c[h],valueSpec:i,style:f,styleSpec:a,object:c,objectKey:h},c))}for(var k in d)e[k]||d[k].required&&void 0===d[k]["default"]&&void 0===c[k]&&g.push(new V(b,c,'missing required property "'+k+'"'));return g}function Nc(a){var b=a.value,c=a.valueSpec,d=a.style,e=a.styleSpec,f=a.key;a=a.arrayElementValidator||jd;if("array"!==xc(b))return[new V(f,b,"array expected, "+xc(b)+" found")];if(c.length&&b.length!==c.length)return[new V(f,b,"array length "+c.length+" expected, length "+b.length+" found")];if(c["min-length"]&&b.length<c["min-length"])return[new V(f,b,"array length at least "+c["min-length"]+" expected, length "+b.length+" found")];var g={type:c.value,values:c.values};e.$version<7&&(g["function"]=c["function"]),"object"===xc(c.value)&&(g=c.value);for(var c=[],h=0;h<b.length;h++)c=c.concat(a({array:b,arrayIndex:h,value:b[h],valueSpec:g,style:d,styleSpec:e,key:f+"["+h+"]"}));return c}function Oc(a){var b=a.key,c=a.value;a=a.valueSpec;var d=xc(c);return"number"!==d?[new V(b,c,"number expected, "+d+" found")]:"minimum"in a&&c<a.minimum?[new V(b,c,c+" is less than the minimum value "+a.minimum)]:"maximum"in a&&c>a.maximum?[new V(b,c,c+" is greater than the maximum value "+a.maximum)]:[]}function Pc(a){var b,c,d,e=a.valueSpec,f=Pa(a.value.type),g={},h="categorical"!==f&&void 0===a.value.property,m=!h,i="array"===xc(a.value.stops)&&"array"===xc(a.value.stops[0])&&"object"===xc(a.value.stops[0][0]),j=Mc({key:a.key,value:a.value,valueSpec:a.styleSpec["function"],style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===f)return[new V(a.key,a.value,'identity function may not have a "stops" property')];var b=[],c=a.value;b=b.concat(Nc({key:a.key,value:c,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:k})),"array"===xc(c)&&0===c.length&&b.push(new V(a.key,c,"array must have at least one stop"));return b},"default":function(a){return jd({key:a.key,value:a.value,valueSpec:e,style:a.style,styleSpec:a.styleSpec})}}});return"identity"===f&&h&&j.push(new V(a.key,a.value,'missing required property "property"')),"identity"===f||a.value.stops||j.push(new V(a.key,a.value,'missing required property "stops"')),"exponential"===f&&a.valueSpec.expression&&!wc(a.valueSpec)&&j.push(new V(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(m&&!uc(a.valueSpec)?j.push(new V(a.key,a.value,"property functions not supported")):h&&!vc(a.valueSpec)&&j.push(new V(a.key,a.value,"zoom functions not supported"))),"categorical"!==f&&!i||void 0!==a.value.property||j.push(new V(a.key,a.value,'"property" property is required')),j;function k(a){var b=[],f=a.value,h=a.key;if("array"!==xc(f))return[new V(h,f,"array expected, "+xc(f)+" found")];if(2!==f.length)return[new V(h,f,"array length 2 expected, length "+f.length+" found")];if(i){if("object"!==xc(f[0]))return[new V(h,f,"object expected, "+xc(f[0])+" found")];if(void 0===f[0].zoom)return[new V(h,f,"object stop key must have zoom")];if(void 0===f[0].value)return[new V(h,f,"object stop key must have value")];if(d&&d>Pa(f[0].zoom))return[new V(h,f[0].zoom,"stop zoom values must appear in ascending order")];Pa(f[0].zoom)!==d&&(d=Pa(f[0].zoom),c=void 0,g={}),b=b.concat(Mc({key:h+"[0]",value:f[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:Oc,value:l}}))}else b=b.concat(l({key:h+"[0]",value:f[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec},f));return Gc(Qa(f[1]))?b.concat([new V(h+"[1]",f[1],"expressions are not allowed in function stops.")]):b.concat(jd({key:h+"[1]",value:f[1],valueSpec:e,style:a.style,styleSpec:a.styleSpec}))}function l(a,d){var h=xc(a.value),j=Pa(a.value);d=null!==a.value?a.value:d;if(b){if(h!==b)return[new V(a.key,d,h+" stop domain type must match previous stop domain type "+b)]}else b=h;if("number"!==h&&"string"!==h&&"boolean"!==h)return[new V(a.key,d,"stop domain value must be a number, string, or boolean")];if("number"!==h&&"categorical"!==f){var i="number expected, "+h+" found";return uc(e)&&void 0===f&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new V(a.key,d,i)]}return"categorical"!==f||"number"!==h||isFinite(j)&&Math.floor(j)===j?"categorical"!==f&&"number"===h&&void 0!==c&&j<c?[new V(a.key,d,"stop domain values must appear in ascending order")]:(c=j,"categorical"===f&&j in g?[new V(a.key,d,"stop domain values must be unique")]:(g[j]=!0,[])):[new V(a.key,d,"integer expected, found "+j)]}}function Qc(a){var b=("property"===a.expressionContext?Kc:Hc)(Qa(a.value),a.valueSpec);if("error"===b.result)return b.value.map(function(b){return new V(""+a.key+b.key,a.value,b.message)});b=b.value.expression||b.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&-1!==b.possibleOutputs().indexOf(void 0))return[new V(a.key,a.value,'Invalid data expression for "'+a.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===a.expressionContext&&"layout"===a.propertyType&&!yb(b))return[new V(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext&&!yb(b))return[new V(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!zb(b,["zoom","feature-state"]))return[new V(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!xb(b))return[new V(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Rc(a){var b=a.key,c=a.value;a=a.valueSpec;var d=[];return Array.isArray(a.values)?-1===a.values.indexOf(Pa(c))&&d.push(new V(b,c,"expected one of ["+a.values.join(", ")+"], "+JSON.stringify(c)+" found")):-1===Object.keys(a.values).indexOf(Pa(c))&&d.push(new V(b,c,"expected one of ["+Object.keys(a.values).join(", ")+"], "+JSON.stringify(c)+" found")),d}function Sc(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(var b=0,a=a.slice(1);b<a.length;b+=1){var c=a[b];if(!Sc(c)&&"boolean"!=typeof c)return!1}return!0;default:return!0}}Lc.deserialize=function(a){return new Lc(a._parameters,a._specification)},Lc.serialize=function(a){return{_parameters:a._parameters,_specification:a._specification}};var Tc={type:"boolean","default":!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Uc(a){if(null==a)return function(){return!0};Sc(a)||(a=Wc(a));var b=Hc(a,Tc);if("error"===b.result)throw new Error(b.value.map(function(a){return a.key+": "+a.message}).join(", "));return function(a,c){return b.value.evaluate(a,c)}}function Vc(a,b){return a<b?-1:a>b?1:0}function Wc(a){if(!a)return!0;var b,c=a[0];return a.length<=1?"any"!==c:"=="===c?Xc(a[1],a[2],"=="):"!="===c?$c(Xc(a[1],a[2],"==")):"<"===c||">"===c||"<="===c||">="===c?Xc(a[1],a[2],c):"any"===c?(b=a.slice(1),["any"].concat(b.map(Wc))):"all"===c?["all"].concat(a.slice(1).map(Wc)):"none"===c?["all"].concat(a.slice(1).map(Wc).map($c)):"in"===c?Yc(a[1],a.slice(2)):"!in"===c?$c(Yc(a[1],a.slice(2))):"has"===c?Zc(a[1]):"!has"!==c||$c(Zc(a[1]))}function Xc(a,b,c){switch(a){case"$type":return["filter-type-"+c,b];case"$id":return["filter-id-"+c,b];default:return["filter-"+c,a,b]}}function Yc(a,b){if(0===b.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",b]];case"$id":return["filter-id-in",["literal",b]];default:return b.length>200&&!b.some(function(a){return typeof a!=typeof b[0]})?["filter-in-large",a,["literal",b.sort(Vc)]]:["filter-in-small",a,["literal",b]]}}function Zc(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function $c(a){return["!",a]}function ad(a){return Sc(Qa(a.value))?Qc(Na({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function a(b){var c=b.value,d=b.key;if("array"!==xc(c))return[new V(d,c,"array expected, "+xc(c)+" found")];var e=b.styleSpec,f,g=[];if(c.length<1)return[new V(d,c,"filter array must have at least 1 element")];g=g.concat(Rc({key:d+"[0]",value:c[0],valueSpec:e.filter_operator,style:b.style,styleSpec:b.styleSpec}));switch(Pa(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&"$type"===Pa(c[1])&&g.push(new V(d,c,'"$type" cannot be use with operator "'+c[0]+'"'));case"==":case"!=":3!==c.length&&g.push(new V(d,c,'filter array for operator "'+c[0]+'" must have 3 elements'));case"in":case"!in":c.length>=2&&"string"!==(f=xc(c[1]))&&g.push(new V(d+"[1]",c[1],"string expected, "+f+" found"));for(var h=2;h<c.length;h++)f=xc(c[h]),"$type"===Pa(c[1])?g=g.concat(Rc({key:d+"["+h+"]",value:c[h],valueSpec:e.geometry_type,style:b.style,styleSpec:b.styleSpec})):"string"!==f&&"number"!==f&&"boolean"!==f&&g.push(new V(d+"["+h+"]",c[h],"string, number, or boolean expected, "+f+" found"));break;case"any":case"all":case"none":for(var e=1;e<c.length;e++)g=g.concat(a({key:d+"["+e+"]",value:c[e],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":f=xc(c[1]),2!==c.length?g.push(new V(d,c,'filter array for "'+c[0]+'" operator must have 2 elements')):"string"!==f&&g.push(new V(d+"[1]",c[1],"string expected, "+f+" found"))}return g}(a)}function bd(a,b){var c=a.key,d=a.style,e=a.styleSpec,f=a.value,g=a.objectKey,h=e[b+"_"+a.layerType];if(!h)return[];var j=g.match(/^(.*)-transition$/);if("paint"===b&&j&&h[j[1]]&&h[j[1]].transition)return jd({key:c,value:f,valueSpec:e.transition,style:d,styleSpec:e});var i;j=a.valueSpec||h[g];if(!j)return[new V(c,f,'unknown property "'+g+'"')];if("string"===xc(f)&&uc(j)&&!j.tokens&&(i=/^{([^}]+)}$/.exec(f)))return[new V(c,f,'"'+g+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(i[1])+" }`.")];h=[];return"symbol"===a.layerType&&("text-field"===g&&d&&!d.glyphs&&h.push(new V(c,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&yc(Qa(f))&&"identity"===Pa(f.type)&&h.push(new V(c,f,'"text-font" does not support identity functions'))),h.concat(jd({key:a.key,value:f,valueSpec:j,style:d,styleSpec:e,expressionContext:"property",propertyType:b,propertyKey:g}))}function cd(a){return bd(a,"paint")}function dd(a){return bd(a,"layout")}function ed(a){var b=[],c=a.value,d=a.key,e=a.style,f=a.styleSpec;c.type||c.ref||b.push(new V(d,c,'either "type" or "ref" is required'));var g,h=Pa(c.type),l=Pa(c.ref);if(c.id)for(var i=Pa(c.id),j=0;j<a.arrayIndex;j++){var k=e.layers[j];Pa(k.id)===i&&b.push(new V(d,c.id,'duplicate layer id "'+c.id+'", previously used at line '+k.id.__line__))}if("ref"in c)["type","source","source-layer","filter","layout"].forEach(function(a){a in c&&b.push(new V(d,c[a],'"'+a+'" is prohibited for ref layers'))}),e.layers.forEach(function(a){Pa(a.id)===l&&(g=a)}),g?g.ref?b.push(new V(d,c.ref,"ref cannot reference another ref layer")):h=Pa(g.type):b.push(new V(d,c.ref,'ref layer "'+l+'" not found'));else if("background"!==h)if(c.source){k=e.sources&&e.sources[c.source];i=k&&Pa(k.type);k?"vector"===i&&"raster"===h?b.push(new V(d,c.source,'layer "'+c.id+'" requires a raster source')):"raster"===i&&"raster"!==h?b.push(new V(d,c.source,'layer "'+c.id+'" requires a vector source')):"vector"!==i||c["source-layer"]?"raster-dem"===i&&"hillshade"!==h?b.push(new V(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==h||!c.paint||!c.paint["line-gradient"]||"geojson"===i&&k.lineMetrics||b.push(new V(d,c,'layer "'+c.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):b.push(new V(d,c,'layer "'+c.id+'" must specify a "source-layer"')):b.push(new V(d,c.source,'source "'+c.source+'" not found'))}else b.push(new V(d,c,'missing required property "source"'));return b=b.concat(Mc({key:d,value:c,valueSpec:f.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return jd({key:d+".type",value:c.type,valueSpec:f.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"})},filter:ad,layout:function(a){return Mc({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return dd(Na({layerType:h},a))}}})},paint:function(a){return Mc({layer:c,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return cd(Na({layerType:h},a))}}})}}}))}function fd(a){var b=a.value,c=a.key,d=a.styleSpec,e=a.style;if(!b.type)return[new V(c,b,'"type" is required')];var f=Pa(b.type);switch(f){case"vector":case"raster":case"raster-dem":if(f=Mc({key:c,value:b,valueSpec:d["source_"+f.replace("-","_")],style:a.style,styleSpec:d}),"url"in b)for(var g in b)["type","url","tileSize"].indexOf(g)<0&&f.push(new V(c+"."+g,b[g],'a source with a "url" property may not include a "'+g+'" property'));return f;case"geojson":if(f=Mc({key:c,value:b,valueSpec:d.source_geojson,style:e,styleSpec:d}),b.cluster)for(var i in b.clusterProperties){a=b.clusterProperties[i];var h=a[0];a=a[1];h="string"==typeof h?[h,["accumulated"],["get",i]]:h;f.push.apply(f,Qc({key:c+"."+i+".map",value:a,expressionContext:"cluster-map"})),f.push.apply(f,Qc({key:c+"."+i+".reduce",value:h,expressionContext:"cluster-reduce"}))}return f;case"video":return Mc({key:c,value:b,valueSpec:d.source_video,style:e,styleSpec:d});case"image":return Mc({key:c,value:b,valueSpec:d.source_image,style:e,styleSpec:d});case"canvas":return[new V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rc({key:c+".type",value:b.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:e,styleSpec:d})}}function gd(a){var b=a.value,c=a.styleSpec,d=c.light;a=a.style;var e=[],f=xc(b);if(void 0===b)return e;if("object"!==f)return e=e.concat([new V("light",b,"object expected, "+f+" found")]);for(var g in b){f=g.match(/^(.*)-transition$/);e=f&&d[f[1]]&&d[f[1]].transition?e.concat(jd({key:g,value:b[g],valueSpec:c.transition,style:a,styleSpec:c})):d[g]?e.concat(jd({key:g,value:b[g],valueSpec:d[g],style:a,styleSpec:c})):e.concat([new V(g,b[g],'unknown property "'+g+'"')])}return e}function hd(a){var b=a.value;a=a.key;var c=xc(b);return"string"!==c?[new V(a,b,"string expected, "+c+" found")]:[]}var id={"*":function(){return[]},array:Nc,"boolean":function(a){var b=a.value;a=a.key;var c=xc(b);return"boolean"!==c?[new V(a,b,"boolean expected, "+c+" found")]:[]},number:Oc,color:function(a){var b=a.key;a=a.value;var c=xc(a);return"string"!==c?[new V(b,a,"color expected, "+c+" found")]:null===eb(a)?[new V(b,a,'color expected, "'+a+'" found')]:[]},constants:Ma,"enum":Rc,filter:ad,"function":Pc,layer:ed,object:Mc,source:fd,light:gd,string:hd,formatted:function(a){return 0===hd(a).length?[]:Qc(a)}};function jd(a){var b=a.value,c=a.valueSpec,d=a.styleSpec;return c.expression&&yc(Pa(b))?Pc(a):c.expression&&Gc(Qa(b))?Qc(a):c.type&&id[c.type]?id[c.type](a):Mc(Na({},a,{valueSpec:c.type?d[c.type]:c}))}function kd(a){var b=a.value,c=a.key;a=hd(a);return a.length?a:(-1===b.indexOf("{fontstack}")&&a.push(new V(c,b,'"glyphs" url must include a "{fontstack}" token')),-1===b.indexOf("{range}")&&a.push(new V(c,b,'"glyphs" url must include a "{range}" token')),a)}function ld(a,b){b=b||U;var c=[];return c=c.concat(jd({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:kd,"*":function(){return[]}}})),a.constants&&(c=c.concat(Ma({key:"constants",value:a.constants,style:a,styleSpec:b}))),md(c)}function md(a){return[].concat(a).sort(function(a,b){return a.line-b.line})}function nd(a){return function(){for(var b=[],c=arguments.length;c--;)b[c]=arguments[c];return md(a.apply(this,b))}}ld.source=nd(fd),ld.light=nd(gd),ld.layer=nd(ed),ld.filter=nd(ad),ld.paintProperty=nd(cd),ld.layoutProperty=nd(dd);var od=ld;ic=od.light;var pd=od.paintProperty,qd=od.layoutProperty;function rd(a,b){var c=!1;if(b&&b.length)for(var d=0,b=b;d<b.length;d+=1){var e=b[d];a.fire(new Ka(new Error(e.message))),c=!0}return c}var sd=ud,td=3;function ud(a,b,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var e=new Int32Array(this.arrayBuffer);a=e[0],b=e[1],c=e[2],this.d=b+2*c;for(var f=0;f<this.d*this.d;f++){var g=e[td+f],h=e[td+f+1];d.push(g===h?null:e.subarray(g,h))}g=e[td+d.length];h=e[td+d.length+1];this.keys=e.subarray(g,h),this.bboxes=e.subarray(h),this.insert=this._insertReadonly}else{this.d=b+2*c;for(var f=0;f<this.d*this.d;f++)d.push([]);this.keys=[],this.bboxes=[]}this.n=b,this.extent=a,this.padding=c,this.scale=b/a,this.uid=0;g=c/b*a;this.min=-g,this.max=a+g}ud.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},ud.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ud.prototype._insertCell=function(a,b,c,d,e,f){this.cells[e].push(f)},ud.prototype.query=function(a,b,c,d,e){var f=this.min,g=this.max;if(a<=f&&b<=f&&g<=c&&g<=d&&!e)return Array.prototype.slice.call(this.keys);f=[];return this._forEachCell(a,b,c,d,this._queryCell,f,{},e),f},ud.prototype._queryCell=function(a,b,c,d,e,f,g,h){e=this.cells[e];if(null!==e)for(var i=this.keys,j=this.bboxes,k=0;k<e.length;k++){var l=e[k];if(void 0===g[l]){var n=4*l;(h?h(j[n+0],j[n+1],j[n+2],j[n+3]):a<=j[n+2]&&b<=j[n+3]&&c>=j[n+0]&&d>=j[n+1])?(g[l]=!0,f.push(i[l])):g[l]=!1}}},ud.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var p=this._convertToCellCoord(a),i=this._convertToCellCoord(b),j=this._convertToCellCoord(c),k=this._convertToCellCoord(d),p=p;p<=j;p++)for(var l=i;l<=k;l++){var o=this.d*l+p;if((!h||h(this._convertFromCellCoord(p),this._convertFromCellCoord(l),this._convertFromCellCoord(p+1),this._convertFromCellCoord(l+1)))&&e.call(this,a,b,c,d,o,f,g,h))return}},ud.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},ud.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},ud.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,b=td+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;d=new Int32Array(b+c+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var c=b,b=0;b<a.length;b++){var e=a[b];d[td+b]=c,d.set(e,c),c+=e.length}return d[td+a.length]=c,d.set(this.keys,c),c+=this.keys.length,d[td+a.length+1]=c,d.set(this.bboxes,c),c+=this.bboxes.length,d.buffer};var vd=self.ImageData,wd={};function Z(a,b,c){void 0===c&&(c={}),Object.defineProperty(b,"_classRegistryKey",{value:a,writeable:!1}),wd[a]={klass:b,omit:c.omit||[],shallow:c.shallow||[]}}for(var xd in Z("Object",Object),sd.serialize=function(a,b){a=a.toArrayBuffer();return b&&b.push(a),{buffer:a}},sd.deserialize=function(a){return new sd(a.buffer)},Z("Grid",sd),Z("Color",fb),Z("Error",Error),Z("StylePropertyFunction",Lc),Z("StyleExpression",Fc,{omit:["_evaluator"]}),Z("ZoomDependentExpression",Jc),Z("ZoomConstantExpression",Ic),Z("CompoundExpression",vb,{omit:["_evaluate"]}),nc)nc[xd]._classRegistryKey||Z("Expression_"+xd,nc[xd]);function yd(a,b){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(a instanceof ArrayBuffer)return b&&b.push(a),a;if(ArrayBuffer.isView(a)){var c=a;return b&&b.push(c.buffer),c}if(a instanceof vd)return b&&b.push(a.data.buffer),a;if(Array.isArray(a)){for(var c=[],d=0,e=a;d<e.length;d+=1){var f=e[d];c.push(yd(f,b))}return c}if("object"==typeof a){f=a.constructor;e=f._classRegistryKey;if(!e)throw new Error("can't serialize object of unregistered class");d=f.serialize?f.serialize(a,b):{};if(!f.serialize){for(var g in a)if(a.hasOwnProperty(g)&&!(wd[e].omit.indexOf(g)>=0)){c=a[g];d[g]=wd[e].shallow.indexOf(g)>=0?c:yd(c,b)}a instanceof Error&&(d.message=a.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==e&&(d.$name=e),d}throw new Error("can't serialize object of type "+typeof a)}function zd(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ArrayBuffer||ArrayBuffer.isView(a)||a instanceof vd)return a;if(Array.isArray(a))return a.map(zd);if("object"==typeof a){var b=a.$name||"Object",c=wd[b].klass;if(!c)throw new Error("can't deserialize unregistered class "+b);if(c.deserialize)return c.deserialize(a);for(var c=Object.create(c.prototype),d=0,e=Object.keys(a);d<e.length;d+=1){var f=e[d];if("$name"!==f){var g=a[f];c[f]=wd[b].shallow.indexOf(f)>=0?g:zd(g)}}return c}throw new Error("can't deserialize object of type "+typeof a)}var Ad=function(){this.first=!0};Ad.prototype.update=function(a,b){var c=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=b):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=b),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=c,!0))};var $={"Latin-1 Supplement":function(a){return a>=128&&a<=255},Arabic:function(a){return a>=1536&&a<=1791},"Arabic Supplement":function(a){return a>=1872&&a<=1919},"Arabic Extended-A":function(a){return a>=2208&&a<=2303},"Hangul Jamo":function(a){return a>=4352&&a<=4607},"Unified Canadian Aboriginal Syllabics":function(a){return a>=5120&&a<=5759},Khmer:function(a){return a>=6016&&a<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(a){return a>=6320&&a<=6399},"General Punctuation":function(a){return a>=8192&&a<=8303},"Letterlike Symbols":function(a){return a>=8448&&a<=8527},"Number Forms":function(a){return a>=8528&&a<=8591},"Miscellaneous Technical":function(a){return a>=8960&&a<=9215},"Control Pictures":function(a){return a>=9216&&a<=9279},"Optical Character Recognition":function(a){return a>=9280&&a<=9311},"Enclosed Alphanumerics":function(a){return a>=9312&&a<=9471},"Geometric Shapes":function(a){return a>=9632&&a<=9727},"Miscellaneous Symbols":function(a){return a>=9728&&a<=9983},"Miscellaneous Symbols and Arrows":function(a){return a>=11008&&a<=11263},"CJK Radicals Supplement":function(a){return a>=11904&&a<=12031},"Kangxi Radicals":function(a){return a>=12032&&a<=12255},"Ideographic Description Characters":function(a){return a>=12272&&a<=12287},"CJK Symbols and Punctuation":function(a){return a>=12288&&a<=12351},Hiragana:function(a){return a>=12352&&a<=12447},Katakana:function(a){return a>=12448&&a<=12543},Bopomofo:function(a){return a>=12544&&a<=12591},"Hangul Compatibility Jamo":function(a){return a>=12592&&a<=12687},Kanbun:function(a){return a>=12688&&a<=12703},"Bopomofo Extended":function(a){return a>=12704&&a<=12735},"CJK Strokes":function(a){return a>=12736&&a<=12783},"Katakana Phonetic Extensions":function(a){return a>=12784&&a<=12799},"Enclosed CJK Letters and Months":function(a){return a>=12800&&a<=13055},"CJK Compatibility":function(a){return a>=13056&&a<=13311},"CJK Unified Ideographs Extension A":function(a){return a>=13312&&a<=19903},"Yijing Hexagram Symbols":function(a){return a>=19904&&a<=19967},"CJK Unified Ideographs":function(a){return a>=19968&&a<=40959},"Yi Syllables":function(a){return a>=40960&&a<=42127},"Yi Radicals":function(a){return a>=42128&&a<=42191},"Hangul Jamo Extended-A":function(a){return a>=43360&&a<=43391},"Hangul Syllables":function(a){return a>=44032&&a<=55215},"Hangul Jamo Extended-B":function(a){return a>=55216&&a<=55295},"Private Use Area":function(a){return a>=57344&&a<=63743},"CJK Compatibility Ideographs":function(a){return a>=63744&&a<=64255},"Arabic Presentation Forms-A":function(a){return a>=64336&&a<=65023},"Vertical Forms":function(a){return a>=65040&&a<=65055},"CJK Compatibility Forms":function(a){return a>=65072&&a<=65103},"Small Form Variants":function(a){return a>=65104&&a<=65135},"Arabic Presentation Forms-B":function(a){return a>=65136&&a<=65279},"Halfwidth and Fullwidth Forms":function(a){return a>=65280&&a<=65519}};function Bd(a){for(var b=0,a=a;b<a.length;b+=1)if(Ed(a[b].charCodeAt(0)))return!0;return!1}function Cd(a){for(var b=0,a=a;b<a.length;b+=1)if(!Dd(a[b].charCodeAt(0)))return!1;return!0}function Dd(a){return!$.Arabic(a)&&!$["Arabic Supplement"](a)&&!$["Arabic Extended-A"](a)&&!$["Arabic Presentation Forms-A"](a)&&!$["Arabic Presentation Forms-B"](a)}function Ed(a){return 746===a||747===a||!(a<4352)&&(!!$["Bopomofo Extended"](a)||!!$.Bopomofo(a)||!(!$["CJK Compatibility Forms"](a)||a>=65097&&a<=65103)||!!$["CJK Compatibility Ideographs"](a)||!!$["CJK Compatibility"](a)||!!$["CJK Radicals Supplement"](a)||!!$["CJK Strokes"](a)||!(!$["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||!!$["CJK Unified Ideographs Extension A"](a)||!!$["CJK Unified Ideographs"](a)||!!$["Enclosed CJK Letters and Months"](a)||!!$["Hangul Compatibility Jamo"](a)||!!$["Hangul Jamo Extended-A"](a)||!!$["Hangul Jamo Extended-B"](a)||!!$["Hangul Jamo"](a)||!!$["Hangul Syllables"](a)||!!$.Hiragana(a)||!!$["Ideographic Description Characters"](a)||!!$.Kanbun(a)||!!$["Kangxi Radicals"](a)||!!$["Katakana Phonetic Extensions"](a)||!(!$.Katakana(a)||12540===a)||!(!$["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!$["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||!!$["Unified Canadian Aboriginal Syllabics"](a)||!!$["Unified Canadian Aboriginal Syllabics Extended"](a)||!!$["Vertical Forms"](a)||!!$["Yijing Hexagram Symbols"](a)||!!$["Yi Syllables"](a)||!!$["Yi Radicals"](a))}function Fd(a){return!(Ed(a)||function(a){return!!($["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||$["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||$["Letterlike Symbols"](a)||$["Number Forms"](a)||$["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||9003===a||a>=9085&&a<=9114||a>=9150&&a<=9165||9167===a||a>=9169&&a<=9179||a>=9186&&a<=9215)||$["Control Pictures"](a)&&9251!==a||$["Optical Character Recognition"](a)||$["Enclosed Alphanumerics"](a)||$["Geometric Shapes"](a)||$["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||$["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||$["CJK Symbols and Punctuation"](a)||$.Katakana(a)||$["Private Use Area"](a)||$["CJK Compatibility Forms"](a)||$["Small Form Variants"](a)||$["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||a>=9984&&a<=10087||a>=10102&&a<=10131||65532===a||65533===a)}(a))}function Gd(a,b){return!(!b&&(a>=1424&&a<=2303||$["Arabic Presentation Forms-A"](a)||$["Arabic Presentation Forms-B"](a)))&&!(a>=2304&&a<=3583||a>=3840&&a<=4255||$.Khmer(a))}var Hd,Id=!1,Jd=null,Kd=!1,Ld=new La(),Md={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Kd||null!=Md.applyArabicShaping}},Nd=function(a,b){this.zoom=a,b?(this.now=b.now,this.fadeDuration=b.fadeDuration,this.zoomHistory=b.zoomHistory,this.transition=b.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ad(),this.transition={})};Nd.prototype.isSupportedScript=function(a){return function(a,b){for(var c=0,a=a;c<a.length;c+=1)if(!Gd(a[c].charCodeAt(0),b))return!1;return!0}(a,Md.isLoaded())},Nd.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Nd.prototype.getCrossfadeParameters=function(){var a=this.zoom,b=a-Math.floor(a),c=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:b+(1-b)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*b}};var Od=function(a,b){this.property=a,this.value=b,this.expression=function(a,b){if(yc(a))return new Lc(a,b);if(Gc(a)){var c=Kc(a,b);if("error"===c.result)throw new Error(c.value.map(function(a){return a.key+": "+a.message}).join(", "));return c.value}var d=a;return"string"==typeof a&&"color"===b.type&&(d=fb.parse(a)),{kind:"constant",evaluate:function(){return d}}}(void 0===b?a.specification["default"]:b,a.specification)};Od.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Od.prototype.possiblyEvaluate=function(a){return this.property.possiblyEvaluate(this,a)};var Pd=function(a){this.property=a,this.value=new Od(a,void 0)};Pd.prototype.transitioned=function(a,b){return new Rd(this.property,this.value,b,k({},a.transition,this.transition),a.now)},Pd.prototype.untransitioned=function(){return new Rd(this.property,this.value,null,{},0)};var Qd=function(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)};Qd.prototype.getValue=function(a){return t(this._values[a].value.value)},Qd.prototype.setValue=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new Pd(this._values[a].property)),this._values[a].value=new Od(this._values[a].property,null===b?void 0:t(b))},Qd.prototype.getTransition=function(a){return t(this._values[a].transition)},Qd.prototype.setTransition=function(a,b){this._values.hasOwnProperty(a)||(this._values[a]=new Pd(this._values[a].property)),this._values[a].transition=t(b)||void 0},Qd.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e);e=this.getTransition(d);void 0!==e&&(a[d+"-transition"]=e)}return a},Qd.prototype.transitioned=function(a,b){for(var c=new Sd(this._properties),d=0,e=Object.keys(this._values);d<e.length;d+=1){var f=e[d];c._values[f]=this._values[f].transitioned(a,b._values[f])}return c},Qd.prototype.untransitioned=function(){for(var a=new Sd(this._properties),b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b];a._values[d]=this._values[d].untransitioned()}return a};var Rd=function(a,b,c,d,e){this.property=a,this.value=b,this.begin=e+d.delay||0,this.end=this.begin+d.duration||0,a.specification.transition&&(d.delay||d.duration)&&(this.prior=c)};Rd.prototype.possiblyEvaluate=function(a){var b=a.now||0,c=this.value.possiblyEvaluate(a),d=this.prior;if(d){if(b>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(b<this.begin)return d.possiblyEvaluate(a);b=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(d.possiblyEvaluate(a),c,function(a){if(a<=0)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(a<.5?c:3*(a-b)+c-.75)}(b))}return c};var Sd=function(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)};Sd.prototype.possiblyEvaluate=function(a){for(var b=new Vd(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b},Sd.prototype.hasTransition=function(){for(var a=0,b=Object.keys(this._values);a<b.length;a+=1){var c=b[a];if(this._values[c].prior)return!0}return!1};var Td=function(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)};Td.prototype.getValue=function(a){return t(this._values[a].value)},Td.prototype.setValue=function(a,b){this._values[a]=new Od(this._values[a].property,null===b?void 0:t(b))},Td.prototype.serialize=function(){for(var a={},b=0,c=Object.keys(this._values);b<c.length;b+=1){var d=c[b],e=this.getValue(d);void 0!==e&&(a[d]=e)}return a},Td.prototype.possiblyEvaluate=function(a){for(var b=new Vd(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var e=d[c];b._values[e]=this._values[e].possiblyEvaluate(a)}return b};var Ud=function(a,b,c){this.property=a,this.value=b,this.parameters=c};Ud.prototype.isConstant=function(){return"constant"===this.value.kind},Ud.prototype.constantOr=function(a){return"constant"===this.value.kind?this.value.value:a},Ud.prototype.evaluate=function(a,b){return this.property.evaluate(this.value,this.parameters,a,b)};var Vd=function(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)};Vd.prototype.get=function(a){return this._values[a]};X=function(a){this.specification=a};X.prototype.possiblyEvaluate=function(a,b){return a.expression.evaluate(b)},X.prototype.interpolate=function(a,b,c){var d=Fb[this.specification.type];return d?d(a,b,c):a};Y=function(a){this.specification=a};Y.prototype.possiblyEvaluate=function(a,b){return"constant"===a.expression.kind||"camera"===a.expression.kind?new Ud(this,{kind:"constant",value:a.expression.evaluate(b)},b):new Ud(this,a.expression,b)},Y.prototype.interpolate=function(a,b,c){if("constant"!==a.value.kind||"constant"!==b.value.kind)return a;if(void 0===a.value.value||void 0===b.value.value)return new Ud(this,{kind:"constant",value:void 0},a.parameters);var d=Fb[this.specification.type];return d?new Ud(this,{kind:"constant",value:d(a.value.value,b.value.value,c)},a.parameters):a},Y.prototype.evaluate=function(a,b,c,d){return"constant"===a.kind?a.value:a.evaluate(b,c,d)};jc=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(a,b){if(void 0===a.value)return new Ud(this,{kind:"constant",value:void 0},b);if("constant"===a.expression.kind){var c=a.expression.evaluate(b);c=this._calculate(c,c,c,b);return new Ud(this,{kind:"constant",value:c},b)}if("camera"===a.expression.kind){c=this._calculate(a.expression.evaluate({zoom:b.zoom-1}),a.expression.evaluate({zoom:b.zoom}),a.expression.evaluate({zoom:b.zoom+1}),b);return new Ud(this,{kind:"constant",value:c},b)}return new Ud(this,a.expression,b)},b.prototype.evaluate=function(a,b,c,d){if("source"===a.kind){var e=a.evaluate(b,c,d);return this._calculate(e,e,e,b)}return"composite"===a.kind?this._calculate(a.evaluate({zoom:Math.floor(b.zoom)-1},c,d),a.evaluate({zoom:Math.floor(b.zoom)},c,d),a.evaluate({zoom:Math.floor(b.zoom)+1},c,d),b):a.value},b.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},b.prototype.interpolate=function(a){return a},b}(Y);hc=function(a){this.specification=a};hc.prototype.possiblyEvaluate=function(a,b){if(void 0!==a.value){if("constant"===a.expression.kind){var c=a.expression.evaluate(b);return this._calculate(c,c,c,b)}return this._calculate(a.expression.evaluate(new Nd(Math.floor(b.zoom-1),b)),a.expression.evaluate(new Nd(Math.floor(b.zoom),b)),a.expression.evaluate(new Nd(Math.floor(b.zoom+1),b)),b)}},hc.prototype._calculate=function(a,b,c,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:a,to:b}:{from:c,to:b}},hc.prototype.interpolate=function(a){return a};kc=function(a){this.specification=a};kc.prototype.possiblyEvaluate=function(a,b){return!!a.expression.evaluate(b)},kc.prototype.interpolate=function(){return!1};oc=function(a){for(var b in this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},a){var c=a[b],d=this.defaultPropertyValues[b]=new Od(c,void 0);c=this.defaultTransitionablePropertyValues[b]=new Pd(c);this.defaultTransitioningPropertyValues[b]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[b]=d.possiblyEvaluate({})}};Z("DataDrivenProperty",Y),Z("DataConstantProperty",X),Z("CrossFadedDataDrivenProperty",jc),Z("CrossFadedProperty",hc),Z("ColorRampProperty",kc);rc=function(a){function b(b,c){if(a.call(this),this.id=b.id,this.type=b.type,this._featureFilter=function(){return!0},"custom"!==b.type&&(b=b,this.metadata=b.metadata,this.minzoom=b.minzoom,this.maxzoom=b.maxzoom,"background"!==b.type&&(this.source=b.source,this.sourceLayer=b["source-layer"],this.filter=b.filter),c.layout&&(this._unevaluatedLayout=new Td(c.layout)),c.paint)){for(var d in this._transitionablePaint=new Qd(c.paint),b.paint)this.setPaintProperty(d,b.paint[d],{validate:!1});for(var e in b.layout)this.setLayoutProperty(e,b.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},b.prototype.getLayoutProperty=function(a){return"visibility"===a?this.visibility:this._unevaluatedLayout.getValue(a)},b.prototype.setLayoutProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".layout."+a;if(this._validate(qd,d,a,b,c))return}"visibility"!==a?this._unevaluatedLayout.setValue(a,b):this.visibility=b},b.prototype.getPaintProperty=function(a){return q(a,"-transition")?this._transitionablePaint.getTransition(a.slice(0,-"-transition".length)):this._transitionablePaint.getValue(a)},b.prototype.setPaintProperty=function(a,b,c){if(void 0===c&&(c={}),null!=b){var d="layers."+this.id+".paint."+a;if(this._validate(pd,d,a,b,c))return!1}if(q(a,"-transition"))return this._transitionablePaint.setTransition(a.slice(0,-"-transition".length),b||void 0),!1;d=this._transitionablePaint._values[a];c="cross-faded-data-driven"===d.property.specification["property-type"];d=d.value.isDataDriven();return this._transitionablePaint.setValue(a,b),this._handleSpecialPaintPropertyUpdate(a),this._transitionablePaint._values[a].value.isDataDriven()||d||c},b.prototype._handleSpecialPaintPropertyUpdate=function(a){},b.prototype.isHidden=function(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||"none"===this.visibility},b.prototype.updateTransitions=function(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)},b.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},b.prototype.recalculate=function(a){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a)),this.paint=this._transitioningPaint.possiblyEvaluate(a)},b.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),s(a,function(a,b){return!(void 0===a||"layout"===b&&!Object.keys(a).length||"paint"===b&&!Object.keys(a).length)})},b.prototype._validate=function(a,b,c,d,e){return void 0===e&&(e={}),(!e||!1!==e.validate)&&rd(this,a.call(od,{key:b,layerType:this.type,objectKey:c,value:d,styleSpec:U,style:{glyphs:!0,sprite:!0}}))},b.prototype.is3D=function(){return!1},b.prototype.isTileClipped=function(){return!1},b.prototype.hasOffscreenPass=function(){return!1},b.prototype.resize=function(){},b.prototype.isStateDependent=function(){for(var a in this.paint._values){var b=this.paint.get(a);if(b instanceof Ud&&uc(b.property.specification)&&("source"===b.value.kind||"composite"===b.value.kind)&&b.value.isStateDependent)return!0}return!1},b}(La);var Wd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};fd=function(a,b){this._structArray=a,this._pos1=b*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8};gd=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xd(a,b){void 0===b&&(b=1);var c=0,d=0;return{members:a.map(function(a){var e;e=(e=a.type,Wd[e].BYTES_PER_ELEMENT);var f=c=Yd(c,Math.max(b,e)),g=a.components||1;return d=Math.max(d,e),c+=e*g,{name:a.name,type:a.type,components:g,offset:f}}),size:Yd(c,Math.max(d,b)),alignment:b}}function Yd(a,b){return Math.ceil(a/b)*b}gd.serialize=function(a,b){return a._trim(),b&&(a.isTransferred=!0,b.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}},gd.deserialize=function(a){var b=Object.create(this.prototype);return b.arrayBuffer=a.arrayBuffer,b.length=a.length,b.capacity=a.arrayBuffer.byteLength/b.bytesPerElement,b._refreshViews(),b},gd.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},gd.prototype.clear=function(){this.length=0},gd.prototype.resize=function(a){this.reserve(a),this.length=a},gd.prototype.reserve=function(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}},gd.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Zd=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.int16[d+0]=b,this.int16[d+1]=c,a},b}(gd);Zd.prototype.bytesPerElement=4,Z("StructArrayLayout2i4",Zd);var $d=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.int16[f+0]=b,this.int16[f+1]=c,this.int16[f+2]=d,this.int16[f+3]=e,a},b}(gd);$d.prototype.bytesPerElement=8,Z("StructArrayLayout4i8",$d);var ae=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(gd);ae.prototype.bytesPerElement=12,Z("StructArrayLayout2i4i12",ae);var be=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=4*a,i=8*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.uint8[i+4]=d,this.uint8[i+5]=e,this.uint8[i+6]=f,this.uint8[i+7]=g,a},b}(gd);be.prototype.bytesPerElement=8,Z("StructArrayLayout2i4ub8",be);var ce=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,j){var i=8*a;return this.uint16[i+0]=b,this.uint16[i+1]=c,this.uint16[i+2]=d,this.uint16[i+3]=e,this.uint16[i+4]=f,this.uint16[i+5]=g,this.uint16[i+6]=h,this.uint16[i+7]=j,a},b}(gd);ce.prototype.bytesPerElement=16,Z("StructArrayLayout8ui16",ce);var de=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h){var i=this.length;return this.resize(i+1),this.emplace(i,a,b,c,d,e,f,g,h)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,j){var i=8*a;return this.int16[i+0]=b,this.int16[i+1]=c,this.int16[i+2]=d,this.int16[i+3]=e,this.uint16[i+4]=f,this.uint16[i+5]=g,this.uint16[i+6]=h,this.uint16[i+7]=j,a},b}(gd);de.prototype.bytesPerElement=16,Z("StructArrayLayout4i4ui16",de);var ee=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.float32[e+0]=b,this.float32[e+1]=c,this.float32[e+2]=d,a},b}(gd);ee.prototype.bytesPerElement=12,Z("StructArrayLayout3f12",ee);var fe=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint32[c+0]=b,a},b}(gd);fe.prototype.bytesPerElement=4,Z("StructArrayLayout1ul4",fe);ed=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,l,i,j){var k=this.length;return this.resize(k+1),this.emplace(k,a,b,c,d,e,f,g,h,l,i,j)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,o,i,j,k){var l=12*a,n=6*a;return this.int16[l+0]=b,this.int16[l+1]=c,this.int16[l+2]=d,this.int16[l+3]=e,this.int16[l+4]=f,this.int16[l+5]=g,this.uint32[n+3]=h,this.uint16[l+8]=o,this.uint16[l+9]=i,this.int16[l+10]=j,this.int16[l+11]=k,a},b}(gd);ed.prototype.bytesPerElement=24,Z("StructArrayLayout6i1ul2ui2i24",ed);var ge=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f){var g=this.length;return this.resize(g+1),this.emplace(g,a,b,c,d,e,f)},b.prototype.emplace=function(a,b,c,d,e,f,g){var h=6*a;return this.int16[h+0]=b,this.int16[h+1]=c,this.int16[h+2]=d,this.int16[h+3]=e,this.int16[h+4]=f,this.int16[h+5]=g,a},b}(gd);ge.prototype.bytesPerElement=12,Z("StructArrayLayout2i2i2i12",ge);var he=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=12*a,g=3*a;return this.uint8[f+0]=b,this.uint8[f+1]=c,this.float32[g+1]=d,this.float32[g+2]=e,a},b}(gd);he.prototype.bytesPerElement=12,Z("StructArrayLayout2ub2f12",he);nd=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,s,i,j,k,l,p,q){var r=this.length;return this.resize(r+1),this.emplace(r,a,b,c,d,e,f,g,h,s,i,j,k,l,p,q)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,y,i,j,k,l,s,t,u){var v=22*a,w=11*a,x=44*a;return this.int16[v+0]=b,this.int16[v+1]=c,this.uint16[v+2]=d,this.uint16[v+3]=e,this.uint32[w+2]=f,this.uint32[w+3]=g,this.uint32[w+4]=h,this.uint16[v+10]=y,this.uint16[v+11]=i,this.uint16[v+12]=j,this.float32[w+7]=k,this.float32[w+8]=l,this.uint8[x+36]=s,this.uint8[x+37]=t,this.uint32[w+10]=u,a},b}(gd);nd.prototype.bytesPerElement=44,Z("StructArrayLayout2i2ui3ul3ui2f2ub1ul44",nd);ld=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d,e,f,g,h,y,i,j,k,l,s,t,u,v,w){var x=this.length;return this.resize(x+1),this.emplace(x,a,b,c,d,e,f,g,h,y,i,j,k,l,s,t,u,v,w)},b.prototype.emplace=function(a,b,c,d,e,f,g,h,C,i,j,k,l,u,v,w,x,y,z){var A=22*a,B=11*a;return this.int16[A+0]=b,this.int16[A+1]=c,this.int16[A+2]=d,this.int16[A+3]=e,this.int16[A+4]=f,this.int16[A+5]=g,this.uint16[A+6]=h,this.uint16[A+7]=C,this.uint16[A+8]=i,this.uint16[A+9]=j,this.uint16[A+10]=k,this.uint16[A+11]=l,this.uint16[A+12]=u,this.uint16[A+13]=v,this.uint16[A+14]=w,this.uint32[B+8]=x,this.float32[B+9]=y,this.float32[B+10]=z,a},b}(gd);ld.prototype.bytesPerElement=44,Z("StructArrayLayout6i9ui1ul2f44",ld);var ie=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.float32[c+0]=b,a},b}(gd);ie.prototype.bytesPerElement=4,Z("StructArrayLayout1f4",ie);ud=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.int16[e+0]=b,this.int16[e+1]=c,this.int16[e+2]=d,a},b}(gd);ud.prototype.bytesPerElement=6,Z("StructArrayLayout3i6",ud);var je=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=2*a,f=4*a;return this.uint32[e+0]=b,this.uint16[f+2]=c,this.uint16[f+3]=d,a},b}(gd);je.prototype.bytesPerElement=8,Z("StructArrayLayout1ul2ui8",je);var ke=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c){var d=this.length;return this.resize(d+1),this.emplace(d,a,b,c)},b.prototype.emplace=function(a,b,c,d){var e=3*a;return this.uint16[e+0]=b,this.uint16[e+1]=c,this.uint16[e+2]=d,a},b}(gd);ke.prototype.bytesPerElement=6,Z("StructArrayLayout3ui6",ke);var le=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.uint16[d+0]=b,this.uint16[d+1]=c,a},b}(gd);le.prototype.bytesPerElement=4,Z("StructArrayLayout2ui4",le);var me=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a){var b=this.length;return this.resize(b+1),this.emplace(b,a)},b.prototype.emplace=function(a,b){var c=1*a;return this.uint16[c+0]=b,a},b}(gd);me.prototype.bytesPerElement=2,Z("StructArrayLayout1ui2",me);var ne=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b){var c=this.length;return this.resize(c+1),this.emplace(c,a,b)},b.prototype.emplace=function(a,b,c){var d=2*a;return this.float32[d+0]=b,this.float32[d+1]=c,a},b}(gd);ne.prototype.bytesPerElement=8,Z("StructArrayLayout2f8",ne);var oe=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},b.prototype.emplaceBack=function(a,b,c,d){var e=this.length;return this.resize(e+1),this.emplace(e,a,b,c,d)},b.prototype.emplace=function(a,b,c,d,e){var f=4*a;return this.float32[f+0]=b,this.float32[f+1]=c,this.float32[f+2]=d,this.float32[f+3]=e,a},b}(gd);oe.prototype.bytesPerElement=16,Z("StructArrayLayout4f16",oe);var pe=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return c.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorPointX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorPointY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.x1.get=function(){return this._structArray.int16[this._pos2+2]},c.x1.set=function(a){this._structArray.int16[this._pos2+2]=a},c.y1.get=function(){return this._structArray.int16[this._pos2+3]},c.y1.set=function(a){this._structArray.int16[this._pos2+3]=a},c.x2.get=function(){return this._structArray.int16[this._pos2+4]},c.x2.set=function(a){this._structArray.int16[this._pos2+4]=a},c.y2.get=function(){return this._structArray.int16[this._pos2+5]},c.y2.set=function(a){this._structArray.int16[this._pos2+5]=a},c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.radius.get=function(){return this._structArray.int16[this._pos2+10]},c.radius.set=function(a){this._structArray.int16[this._pos2+10]=a},c.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},c.signedDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+11]=a},c.anchorPoint.get=function(){return new e(this.anchorPointX,this.anchorPointY)},Object.defineProperties(b.prototype,c),b}(fd);pe.prototype.size=24;var qe=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new pe(this,a)},b}(ed);Z("CollisionBoxArray",qe);var re=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.glyphStartIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},c.numGlyphs.set=function(a){this._structArray.uint16[this._pos2+3]=a},c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},c.vertexStartIndex.set=function(a){this._structArray.uint32[this._pos4+2]=a},c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},c.lineStartIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a},c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},c.lineLength.set=function(a){this._structArray.uint32[this._pos4+4]=a},c.segment.get=function(){return this._structArray.uint16[this._pos2+10]},c.segment.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},c.lowerSize.set=function(a){this._structArray.uint16[this._pos2+11]=a},c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},c.upperSize.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},c.lineOffsetX.set=function(a){this._structArray.float32[this._pos4+7]=a},c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},c.lineOffsetY.set=function(a){this._structArray.float32[this._pos4+8]=a},c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},c.writingMode.set=function(a){this._structArray.uint8[this._pos1+36]=a},c.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},c.hidden.set=function(a){this._structArray.uint8[this._pos1+37]=a},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a},Object.defineProperties(b.prototype,c),b}(fd);re.prototype.size=44;var se=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new re(this,a)},b}(nd);Z("PlacedSymbolArray",se);var te=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},radialTextOffset:{configurable:!0}};return c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a},c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a},c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},c.rightJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+2]=a},c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},c.centerJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+3]=a},c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},c.leftJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+4]=a},c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},c.verticalPlacedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+5]=a},c.key.get=function(){return this._structArray.uint16[this._pos2+6]},c.key.set=function(a){this._structArray.uint16[this._pos2+6]=a},c.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]},c.textBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+7]=a},c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]},c.textBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a},c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},c.iconBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a},c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},c.iconBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+10]=a},c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+11]},c.featureIndex.set=function(a){this._structArray.uint16[this._pos2+11]=a},c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+12]},c.numHorizontalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+12]=a},c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+13]},c.numVerticalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+13]=a},c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+14]},c.numIconVertices.set=function(a){this._structArray.uint16[this._pos2+14]=a},c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+8]},c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+8]=a},c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+9]},c.textBoxScale.set=function(a){this._structArray.float32[this._pos4+9]=a},c.radialTextOffset.get=function(){return this._structArray.float32[this._pos4+10]},c.radialTextOffset.set=function(a){this._structArray.float32[this._pos4+10]=a},Object.defineProperties(b.prototype,c),b}(fd);te.prototype.size=44;var ue=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new te(this,a)},b}(ld);Z("SymbolInstanceArray",ue);var ve=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={offsetX:{configurable:!0}};return c.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},c.offsetX.set=function(a){this._structArray.float32[this._pos4+0]=a},Object.defineProperties(b.prototype,c),b}(fd);ve.prototype.size=4;var we=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getoffsetX=function(a){return this.float32[1*a+0]},b.prototype.get=function(a){return new ve(this,a)},b}(ie);Z("GlyphOffsetArray",we);var xe=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return c.x.get=function(){return this._structArray.int16[this._pos2+0]},c.x.set=function(a){this._structArray.int16[this._pos2+0]=a},c.y.get=function(){return this._structArray.int16[this._pos2+1]},c.y.set=function(a){this._structArray.int16[this._pos2+1]=a},c.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},c.tileUnitDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+2]=a},Object.defineProperties(b.prototype,c),b}(fd);xe.prototype.size=6;var ye=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getx=function(a){return this.int16[3*a+0]},b.prototype.gety=function(a){return this.int16[3*a+1]},b.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]},b.prototype.get=function(a){return new xe(this,a)},b}(ud);Z("SymbolLineVertexArray",ye);var ze=function(a){function b(){a.apply(this,arguments)}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+0]=a},c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a},c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+3]=a},Object.defineProperties(b.prototype,c),b}(fd);ze.prototype.size=8;var Ae=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.get=function(a){return new ze(this,a)},b}(je);Z("FeatureIndexArray",Ae);var Be=Xd([{name:"a_pos",components:2,type:"Int16"}],4).members,Ce=function(a){void 0===a&&(a=[]),this.segments=a};function De(a,b){return 256*i(Math.floor(a),0,255)+(b=i(Math.floor(b),0,255))}Ce.prototype.prepareSegment=function(a,b,c,d){var e=this.segments[this.segments.length-1];return a>Ce.MAX_VERTEX_ARRAY_LENGTH&&v("Max vertices per segment is "+Ce.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+a),(!e||e.vertexLength+a>Ce.MAX_VERTEX_ARRAY_LENGTH||e.sortKey!==d)&&(e={vertexOffset:b.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==d&&(e.sortKey=d),this.segments.push(e)),e},Ce.prototype.get=function(){return this.segments},Ce.prototype.destroy=function(){for(var a=0,b=this.segments;a<b.length;a+=1){var c=b[a];for(var d in c.vaos)c.vaos[d].destroy()}},Ce.simpleSegment=function(a,b,c,d){return new Ce([{vertexOffset:a,primitiveOffset:b,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])},Ce.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Z("SegmentVector",Ce);var Ee=function(){this.ids=[],this.positions=[],this.indexed=!1};function Fe(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}Ee.prototype.add=function(a,b,c,d){this.ids.push(a),this.positions.push(b,c,d)},Ee.prototype.getPositions=function(a){for(var b=0,c=this.ids.length-1;b<c;){var d=b+c>>1;this.ids[d]>=a?c=d:b=d+1}for(var d=[];this.ids[b]===a;){c=this.positions[3*b];var e=this.positions[3*b+1],f=this.positions[3*b+2];d.push({index:c,start:e,end:f}),b++}return d},Ee.serialize=function(a,b){var c=new Float64Array(a.ids);a=new Uint32Array(a.positions);return function a(b,c,d,e){if(d>=e)return;var f=b[d+e>>1],g=d-1,h=e+1;for(;;){do g++;while(b[g]<f);do h--;while(b[h]>f);if(g>=h)break;Fe(b,g,h),Fe(c,3*g,3*h),Fe(c,3*g+1,3*h+1),Fe(c,3*g+2,3*h+2)}a(b,c,d,h);a(b,c,h+1,e)}(c,a,0,c.length-1),b.push(c.buffer,a.buffer),{ids:c,positions:a}},Ee.deserialize=function(a){var b=new Ee();return b.ids=a.ids,b.positions=a.positions,b.indexed=!0,b},Z("FeaturePositionMap",Ee);gd=function(a,b){this.gl=a.gl,this.location=b};ed=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))},b}(gd);var Ge=function(a){function b(b,c){a.call(this,b,c),this.current=0}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))},b}(gd);nd=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))},b}(gd);ld=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))},b}(gd);var He=function(a){function b(b,c){a.call(this,b,c),this.current=[0,0,0,0]}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))},b}(gd),Ie=function(a){function b(b,c){a.call(this,b,c),this.current=fb.transparent}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))},b}(gd),Je=new Float32Array(16);ud=function(a){function b(b,c){a.call(this,b,c),this.current=Je}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(var b=1;b<16;b++)if(a[b]!==this.current[b]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}},b}(gd);function Ke(a){return[De(255*a.r,255*a.g),De(255*a.b,255*a.a)]}var Le=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0};Le.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},Le.prototype.setConstantPatternPositions=function(){},Le.prototype.populatePaintArray=function(){},Le.prototype.updatePaintArray=function(){},Le.prototype.upload=function(){},Le.prototype.destroy=function(){},Le.prototype.setUniforms=function(a,b,c,d){b.set(d.constantOr(this.value))},Le.prototype.getBinding=function(a,b){return"color"===this.type?new Ie(a,b):new Ge(a,b)},Le.serialize=function(a){var b=a.value,c=a.names;a=a.type;return{value:yd(b),names:c,type:a}},Le.deserialize=function(a){var b=a.value,c=a.names;a=a.type;return new Le(zd(b),c,a)};var Me=function(a,b,c){this.value=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a}),this.type=c,this.maxValue=-1/0,this.patternPositions={patternTo:null,patternFrom:null}};Me.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+a})},Me.prototype.populatePaintArray=function(){},Me.prototype.updatePaintArray=function(){},Me.prototype.upload=function(){},Me.prototype.destroy=function(){},Me.prototype.setConstantPatternPositions=function(a,b){this.patternPositions.patternTo=a.tlbr,this.patternPositions.patternFrom=b.tlbr},Me.prototype.setUniforms=function(a,b,c,d,e){a=this.patternPositions;"u_pattern_to"===e&&a.patternTo&&b.set(a.patternTo),"u_pattern_from"===e&&a.patternFrom&&b.set(a.patternFrom)},Me.prototype.getBinding=function(a,b){return new He(a,b)};var Ne=function(a,b,c,d){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"a_"+a}),this.maxValue=-1/0,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?2:1,offset:0}}),this.paintVertexArray=new d()};Ne.prototype.defines=function(){return[]},Ne.prototype.setConstantPatternPositions=function(){},Ne.prototype.populatePaintArray=function(a,b){var c=this.paintVertexArray,d=c.length;c.reserve(a);b=this.expression.evaluate(new Nd(0),b,{});if("color"===this.type)for(var e=Ke(b),f=d;f<a;f++)c.emplaceBack(e[0],e[1]);else{for(var e=d;e<a;e++)c.emplaceBack(b);this.maxValue=Math.max(this.maxValue,b)}},Ne.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray;c=this.expression.evaluate({zoom:0},c,d);if("color"===this.type)for(var d=Ke(c),f=a;f<b;f++)e.emplace(f,d[0],d[1]);else{for(var d=a;d<b;d++)e.emplace(d,c);this.maxValue=Math.max(this.maxValue,c)}},Ne.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ne.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ne.prototype.setUniforms=function(a,b){b.set(0)},Ne.prototype.getBinding=function(a,b){return new Ge(a,b)};var Oe=function(a,b,c,d,e,f){this.expression=a,this.names=b,this.uniformNames=this.names.map(function(a){return"u_"+a+"_t"}),this.type=c,this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0;a=f;this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===c?4:2,offset:0}}),this.paintVertexArray=new a()};Oe.prototype.defines=function(){return[]},Oe.prototype.setConstantPatternPositions=function(){},Oe.prototype.populatePaintArray=function(a,b){var c=this.paintVertexArray,d=c.length;c.reserve(a);var e=this.expression.evaluate(new Nd(this.zoom),b,{});b=this.expression.evaluate(new Nd(this.zoom+1),b,{});if("color"===this.type)for(var f=Ke(e),g=Ke(b),h=d;h<a;h++)c.emplaceBack(f[0],f[1],g[0],g[1]);else{for(var f=d;f<a;f++)c.emplaceBack(e,b);this.maxValue=Math.max(this.maxValue,e,b)}},Oe.prototype.updatePaintArray=function(a,b,c,d){var e=this.paintVertexArray,f=this.expression.evaluate({zoom:this.zoom},c,d);c=this.expression.evaluate({zoom:this.zoom+1},c,d);if("color"===this.type)for(var d=Ke(f),h=Ke(c),g=a;g<b;g++)e.emplace(g,d[0],d[1],h[0],h[1]);else{for(var g=a;g<b;g++)e.emplace(g,f,c);this.maxValue=Math.max(this.maxValue,f,c)}},Oe.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Oe.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Oe.prototype.interpolationFactor=function(a){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(a),this.zoom,this.zoom+1):this.expression.interpolationFactor(a,this.zoom,this.zoom+1)},Oe.prototype.setUniforms=function(a,b,c){b.set(this.interpolationFactor(c.zoom))},Oe.prototype.getBinding=function(a,b){return new Ge(a,b)};var Pe=function(a,b,c,d,e,f,g){this.expression=a,this.names=b,this.type=c,this.uniformNames=this.names.map(function(a){return"u_"+a+"_t"}),this.useIntegerZoom=d,this.zoom=e,this.maxValue=-1/0,this.layerId=g,this.paintVertexAttributes=b.map(function(a){return{name:"a_"+a,type:"Uint16",components:4,offset:0}}),this.zoomInPaintVertexArray=new f(),this.zoomOutPaintVertexArray=new f()};Pe.prototype.defines=function(){return[]},Pe.prototype.setConstantPatternPositions=function(){},Pe.prototype.populatePaintArray=function(a,b,c){var d=this.zoomInPaintVertexArray,e=this.zoomOutPaintVertexArray,f=this.layerId,g=d.length;if(d.reserve(a),e.reserve(a),c&&b.patterns&&b.patterns[f]){b=b.patterns[f];f=b.min;var h=b.mid;b=b.max;f=c[f];h=c[h];c=c[b];if(!f||!h||!c)return;for(var b=g;b<a;b++)d.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1]),e.emplaceBack(h.tl[0],h.tl[1],h.br[0],h.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1])}},Pe.prototype.updatePaintArray=function(a,b,c,d,e){d=this.zoomInPaintVertexArray;var f=this.zoomOutPaintVertexArray,g=this.layerId;if(e&&c.patterns&&c.patterns[g]){c=c.patterns[g];g=c.min;var h=c.mid;c=c.max;g=e[g];h=e[h];e=e[c];if(!g||!h||!e)return;for(var c=a;c<b;c++)d.emplace(c,h.tl[0],h.tl[1],h.br[0],h.br[1],g.tl[0],g.tl[1],g.br[0],g.br[1]),f.emplace(c,h.tl[0],h.tl[1],h.br[0],h.br[1],e.tl[0],e.tl[1],e.br[0],e.br[1])}},Pe.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pe.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()},Pe.prototype.setUniforms=function(a,b){b.set(0)},Pe.prototype.getBinding=function(a,b){return new Ge(a,b)};var Qe=function(){this.binders={},this.cacheKey="",this._buffers=[],this._featureMap=new Ee(),this._bufferOffset=0};Qe.createDynamic=function(a,b,c){var d=new Qe(),e=[];for(var f in a.paint._values)if(c(f)){var g=a.paint.get(f);if(g instanceof Ud&&uc(g.property.specification)){var h=Se(f,a.type),k=g.property.specification.type,i=g.property.useIntegerZoom;if("cross-faded"===g.property.specification["property-type"]||"cross-faded-data-driven"===g.property.specification["property-type"])if("constant"===g.value.kind)d.binders[f]=new Me(g.value.value,h,k),e.push("/u_"+f);else{var j=Te(f,k,"source");d.binders[f]=new Pe(g.value,h,k,i,b,j,a.id),e.push("/a_"+f)}else if("constant"===g.value.kind)d.binders[f]=new Le(g.value.value,h,k),e.push("/u_"+f);else if("source"===g.value.kind){j=Te(f,k,"source");d.binders[f]=new Ne(g.value,h,k,j),e.push("/a_"+f)}else{j=Te(f,k,"composite");d.binders[f]=new Oe(g.value,h,k,i,b,j),e.push("/z_"+f)}}}return d.cacheKey=e.sort().join(""),d},Qe.prototype.populatePaintArrays=function(a,b,c,d){for(var e in this.binders)this.binders[e].populatePaintArray(a,b,d);void 0!==b.id&&this._featureMap.add(+b.id,c,this._bufferOffset,a),this._bufferOffset=a},Qe.prototype.setConstantPatternPositions=function(a,b){for(var c in this.binders)this.binders[c].setConstantPatternPositions(a,b)},Qe.prototype.updatePaintArrays=function(a,b,c,d){var e=!1;for(var f in a)for(var g=0,h=this._featureMap.getPositions(+f);g<h.length;g+=1){var m=h[g],i=b.feature(m.index);for(var j in this.binders){var k=this.binders[j];if(!(k instanceof Le||k instanceof Me)&&!0===k.expression.isStateDependent){var l=c.paint.get(j);k.expression=l.value,k.updatePaintArray(m.start,m.end,i,a[f],d),e=!0}}}return e},Qe.prototype.defines=function(){var a=[];for(var b in this.binders)a.push.apply(a,this.binders[b].defines());return a},Qe.prototype.getPaintVertexBuffers=function(){return this._buffers},Qe.prototype.getUniforms=function(a,b){var c=[];for(var d in this.binders)for(var e=this.binders[d],f=0,g=e.uniformNames;f<g.length;f+=1){var h=g[f];if(b[h]){var i=e.getBinding(a,b[h]);c.push({name:h,property:d,binding:i})}}return c},Qe.prototype.setUniforms=function(a,b,c,d){for(var e=0,b=b;e<b.length;e+=1){var f=b[e],g=f.name,h=f.property;f=f.binding;this.binders[h].setUniforms(a,f,d,c.get(h),g)}},Qe.prototype.updatePatternPaintBuffers=function(a){var b=[];for(var c in this.binders){var d=this.binders[c];if(d instanceof Pe){var e=2===a.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;e&&b.push(e)}else(d instanceof Ne||d instanceof Oe)&&d.paintVertexBuffer&&b.push(d.paintVertexBuffer)}this._buffers=b},Qe.prototype.upload=function(a){for(var b in this.binders)this.binders[b].upload(a);a=[];for(var c in this.binders){var d=this.binders[c];(d instanceof Ne||d instanceof Oe)&&d.paintVertexBuffer&&a.push(d.paintVertexBuffer)}this._buffers=a},Qe.prototype.destroy=function(){for(var a in this.binders)this.binders[a].destroy()};var Re=function(a,b,c,d){void 0===d&&(d=function(){return!0}),this.programConfigurations={};for(var e=0,b=b;e<b.length;e+=1){var f=b[e];this.programConfigurations[f.id]=Qe.createDynamic(f,c,d),this.programConfigurations[f.id].layoutAttributes=a}this.needsUpload=!1};function Se(a,b){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(b+"-","").replace(/-/g,"_")]}function Te(a,b,c){var d={color:{source:ne,composite:oe},number:{source:ie,composite:ne}};a=function(a){return{"line-pattern":{source:ce,composite:ce},"fill-pattern":{source:ce,composite:ce},"fill-extrusion-pattern":{source:ce,composite:ce}}[a]}(a);return a&&a[c]||d[b][c]}Re.prototype.populatePaintArrays=function(a,b,c,d){for(var e in this.programConfigurations)this.programConfigurations[e].populatePaintArrays(a,b,c,d);this.needsUpload=!0},Re.prototype.updatePaintArrays=function(a,b,c,d){for(var e=0,c=c;e<c.length;e+=1){var f=c[e];this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(a,b,f,d)||this.needsUpload}},Re.prototype.get=function(a){return this.programConfigurations[a]},Re.prototype.upload=function(a){if(this.needsUpload){for(var b in this.programConfigurations)this.programConfigurations[b].upload(a);this.needsUpload=!1}},Re.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()},Z("ConstantBinder",Le),Z("CrossFadedConstantBinder",Me),Z("SourceExpressionBinder",Ne),Z("CrossFadedCompositeBinder",Pe),Z("CompositeExpressionBinder",Oe),Z("ProgramConfiguration",Qe,{omit:["_buffers"]}),Z("ProgramConfigurationSet",Re);var Ue=8192,Ve=(fd=16,{min:-1*Math.pow(2,fd-1),max:Math.pow(2,fd-1)-1});function We(a){for(var b=Ue/a.extent,a=a.loadGeometry(),c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.length;e++){var f=d[e];f.x=Math.round(f.x*b),f.y=Math.round(f.y*b),(f.x<Ve.min||f.x>Ve.max||f.y<Ve.min||f.y>Ve.max)&&v("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return a}function Xe(a,b,c,d,e){a.emplaceBack(2*b+(d+1)/2,2*c+(e+1)/2)}var Ye=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Zd(),this.indexArray=new ke(),this.segments=new Ce(),this.programConfigurations=new Re(Be,a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function Ze(a,b){for(var c=0;c<a.length;c++)if(hf(b,a[c]))return!0;for(var c=0;c<b.length;c++)if(hf(a,b[c]))return!0;return!!cf(a,b)}function $e(a,b,c){return!!hf(a,b)||!!ef(b,a,c)}function af(a,b){if(1===a.length)return gf(b,a[0]);for(var c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.length;e++)if(hf(a,d[e]))return!0;for(var e=0;e<a.length;e++)if(gf(b,a[e]))return!0;for(var d=0;d<b.length;d++)if(cf(a,b[d]))return!0;return!1}function bf(a,b,c){if(a.length>1){if(cf(a,b))return!0;for(var d=0;d<b.length;d++)if(ef(b[d],a,c))return!0}for(var d=0;d<a.length;d++)if(ef(a[d],b,c))return!0;return!1}function cf(a,b){if(0===a.length||0===b.length)return!1;for(var c=0;c<a.length-1;c++)for(var d=a[c],e=a[c+1],f=0;f<b.length-1;f++)if(df(d,e,b[f],b[f+1]))return!0;return!1}function df(a,b,c,d){return w(a,c,d)!==w(b,c,d)&&w(a,b,c)!==w(a,b,d)}function ef(a,b,c){c=c*c;if(1===b.length)return a.distSqr(b[0])<c;for(var d=1;d<b.length;d++)if(ff(a,b[d-1],b[d])<c)return!0;return!1}function ff(a,b,c){var d=b.distSqr(c);if(0===d)return a.distSqr(b);d=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return d<0?a.distSqr(b):d>1?a.distSqr(c):a.distSqr(c.sub(b)._mult(d)._add(b))}function gf(a,b){for(var c,d,e,f=!1,g=0;g<a.length;g++)for(var h=0,i=(c=a[g]).length-1;h<c.length;i=h++)d=c[h],e=c[i],d.y>b.y!=e.y>b.y&&b.x<(e.x-d.x)*(b.y-d.y)/(e.y-d.y)+d.x&&(f=!f);return f}function hf(a,b){for(var c=!1,d=0,e=a.length-1;d<a.length;e=d++){var f=a[d],g=a[e];f.y>b.y!=g.y>b.y&&b.x<(g.x-f.x)*(b.y-f.y)/(g.y-f.y)+f.x&&(c=!c)}return c}function jf(a,b,c){var d=c[0],e=c[2];if(a.x<d.x&&b.x<d.x||a.x>e.x&&b.x>e.x||a.y<d.y&&b.y<d.y||a.y>e.y&&b.y>e.y)return!1;d=w(a,b,c[0]);return d!==w(a,b,c[1])||d!==w(a,b,c[2])||d!==w(a,b,c[3])}function kf(a,b,c){var d=b.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(b.id).binders[a].maxValue}function lf(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function mf(a,b,c,d,f){if(!b[0]&&!b[1])return a;b=e.convert(b)._mult(f);"viewport"===c&&b._rotate(-d);for(var f=[],c=0;c<a.length;c++){d=a[c];f.push(d.sub(b))}return f}Ye.prototype.populate=function(a,b){for(var c=0,a=a;c<a.length;c+=1){var d=a[c],e=d.feature,f=d.index;d=d.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nd(this.zoom),e)){var g=We(e);this.addFeature(e,g,f),b.featureIndex.insert(e,g,f,d,this.index)}}},Ye.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Ye.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ye.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ye.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Be),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Ye.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ye.prototype.addFeature=function(a,b,c){for(var d=0,b=b;d<b.length;d+=1)for(var e=0,f=b[d];e<f.length;e+=1){var g=f[e],j=g.x;g=g.y;if(!(j<0||j>=Ue||g<0||g>=Ue)){var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),i=h.vertexLength;Xe(this.layoutVertexArray,j,g,-1,-1),Xe(this.layoutVertexArray,j,g,1,-1),Xe(this.layoutVertexArray,j,g,1,1),Xe(this.layoutVertexArray,j,g,-1,1),this.indexArray.emplaceBack(i,i+1,i+2),this.indexArray.emplaceBack(i,i+3,i+2),h.vertexLength+=4,h.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,{})},Z("CircleBucket",Ye,{omit:["layers"]});var nf={paint:new oc({"circle-radius":new Y(U.paint_circle["circle-radius"]),"circle-color":new Y(U.paint_circle["circle-color"]),"circle-blur":new Y(U.paint_circle["circle-blur"]),"circle-opacity":new Y(U.paint_circle["circle-opacity"]),"circle-translate":new X(U.paint_circle["circle-translate"]),"circle-translate-anchor":new X(U.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new X(U.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new X(U.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Y(U.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Y(U.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Y(U.paint_circle["circle-stroke-opacity"])})},of="undefined"!=typeof Float32Array?Float32Array:Array;Math.PI;function pf(){var a=new of(9);return of!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function qf(){var a=new of(3);return of!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function rf(a,b,c){var d=new of(3);return d[0]=a,d[1]=b,d[2]=c,d}qf();function sf(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*b,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*b,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*b,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*b,a}!function(){var a;a=new of(4),of!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}();function tf(){var a=new of(4);return of!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}qf(),rf(1,0,0),rf(0,1,0),tf(),tf(),pf();!function(){var a;a=new of(2),of!=Float32Array&&(a[0]=0,a[1]=0),a}();je=function(a){function b(b){a.call(this,b,nf)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new Ye(a)},b.prototype.queryRadius=function(a){a=a;return kf("circle-radius",this,a)+kf("circle-stroke-width",this,a)+lf(this.paint.get("circle-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g,h){for(var e=mf(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,g),a=this.paint.get("circle-radius").evaluate(b,c)+this.paint.get("circle-stroke-width").evaluate(b,c),b="map"===this.paint.get("circle-pitch-alignment"),c=b?e:function(a,b){return a.map(function(a){return uf(a,b)})}(e,h),e=b?a*g:a,g=0,a=d;g<a.length;g+=1)for(var d=0,i=a[g];d<i.length;d+=1){var j=i[d],k=b?j:uf(j,h),l=e;j=sf([],[j.x,j.y,0,1],h);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?l*=j[3]/f.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(l*=f.cameraToCenterDistance/j[3]),$e(c,k,l))return!0}return!1},b}(rc);function uf(a,b){a=sf([],[a.x,a.y,0,1],b);return new e(a[0]/a[3],a[1]/a[3])}var vf=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(Ye);function wf(a,b,c,d){var e=b.width;b=b.height;if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*b*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(e*b*c);return a.width=e,a.height=b,a.data=d,a}function xf(a,b,c){var d=b.width;b=b.height;if(d!==a.width||b!==a.height){var e=wf({},{width:d,height:b},c);yf(a,e,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,b)},c),a.width=d,a.height=b,a.data=e.data}}function yf(a,b,c,d,e,f){if(0===e.width||0===e.height)return b;if(e.width>a.width||e.height>a.height||c.x>a.width-e.width||c.y>a.height-e.height)throw new RangeError("out of range source coordinates for image copy");if(e.width>b.width||e.height>b.height||d.x>b.width-e.width||d.y>b.height-e.height)throw new RangeError("out of range destination coordinates for image copy");for(var g=a.data,h=b.data,l=0;l<e.height;l++)for(var i=((c.y+l)*a.width+c.x)*f,j=((d.y+l)*b.width+d.x)*f,k=0;k<e.width*f;k++)h[j+k]=g[i+k];return b}Z("HeatmapBucket",vf,{omit:["layers"]});var zf=function(a,b){wf(this,a,1,b)};zf.prototype.resize=function(a){xf(this,a,1)},zf.prototype.clone=function(){return new zf({width:this.width,height:this.height},new Uint8Array(this.data))},zf.copy=function(a,b,c,d,e){yf(a,b,c,d,e,1)};var Af=function(a,b){wf(this,a,4,b)};Af.prototype.resize=function(a){xf(this,a,4)},Af.prototype.replace=function(a,b){b?this.data.set(a):a instanceof Uint8ClampedArray?this.data=new Uint8Array(a.buffer):this.data=a},Af.prototype.clone=function(){return new Af({width:this.width,height:this.height},new Uint8Array(this.data))},Af.copy=function(a,b,c,d,e){yf(a,b,c,d,e,4)},Z("AlphaImage",zf),Z("RGBAImage",Af);var Bf={paint:new oc({"heatmap-radius":new Y(U.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Y(U.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new X(U.paint_heatmap["heatmap-intensity"]),"heatmap-color":new kc(U.paint_heatmap["heatmap-color"]),"heatmap-opacity":new X(U.paint_heatmap["heatmap-opacity"])})};function Cf(a,b){for(var c=new Uint8Array(1024),d={},e=0,f=0;e<256;e++,f+=4){d[b]=e/255;var g=a.evaluate(d);c[f+0]=Math.floor(255*g.r/g.a),c[f+1]=Math.floor(255*g.g/g.a),c[f+2]=Math.floor(255*g.b/g.a),c[f+3]=Math.floor(255*g.a)}return new Af({width:256,height:1},c)}gd=function(a){function b(b){a.call(this,b,Bf),this._updateColorRamp()}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new vf(a)},b.prototype._handleSpecialPaintPropertyUpdate=function(a){"heatmap-color"===a&&this._updateColorRamp()},b.prototype._updateColorRamp=function(){var a=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Cf(a,"heatmapDensity"),this.colorRampTexture=null},b.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},b}(rc);var Df={paint:new oc({"hillshade-illumination-direction":new X(U.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new X(U.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new X(U.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new X(U.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new X(U.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new X(U.paint_hillshade["hillshade-accent-color"])})};fd=function(a){function b(b){a.call(this,b,Df)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},b}(rc);var Ef=Xd([{name:"a_pos",components:2,type:"Int16"}],4).members,Ff=Gf;qf=Gf;function Gf(a,b,c){c=c||2;var d,e,f,o,g,h=b&&b.length,i=h?b[0]*c:a.length,j=Hf(a,0,i,c,!0),k=[];if(!j||j.next===j.prev)return k;if(h&&(j=function(a,b,c,d){var e,f,g,h,i=[];for(e=0,f=b.length;e<f;e++)g=b[e]*d,h=e<f-1?b[e+1]*d:a.length,(g=Hf(a,g,h,d,!1))===g.next&&(g.steiner=!0),i.push(Rf(g));for(i.sort(Of),e=0;e<i.length;e++)Pf(i[e],c),c=If(c,c.next);return c}(a,b,j,c)),a.length>80*c){d=h=a[0],e=b=a[1];for(var l=c;l<i;l+=c)(f=a[l])<d&&(d=f),(o=a[l+1])<e&&(e=o),f>h&&(h=f),o>b&&(b=o);g=0!==(g=Math.max(h-d,b-e))?1/g:0}return Jf(j,k,c,d,e,g),k}function Hf(a,b,c,d,e){var f;if(e===bg(a,b,c,d)>0)for(e=b;e<c;e+=d)f=Zf(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=Zf(e,a[e],a[e+1],f);return f&&Vf(f,f.next)&&($f(f),f=f.next),f}function If(a,b){if(!a)return a;b||(b=a);var c;a=a;do if(c=!1,a.steiner||!Vf(a,a.next)&&0!==Uf(a.prev,a,a.next))a=a.next;else{if($f(a),(a=b=a.prev)===a.next)break;c=!0}while(c||a!==b);return b}function Jf(a,b,c,d,e,f,g){if(a){!g&&f&&(function(a,b,c,d){var e=a;do null===e.z&&(e.z=Qf(e.x,e.y,b,c,d)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next;while(e!==a);e.prevZ.nextZ=null,e.prevZ=null,(function(a){var b,c,d,e,f,g,h,i=1;do{for(c=a,a=null,f=null,g=0;c;){for(g++,d=c,h=0,b=0;b<i&&(h++,d=d.nextZ);b++);for(b=i;h>0||b>0&&d;)0!==h&&(0===b||!d||c.z<=d.z)?(e=c,c=c.nextZ,h--):(e=d,d=d.nextZ,b--),f?f.nextZ=e:a=e,e.prevZ=f,f=e;c=d}f.nextZ=null,i*=2}while(g>1)})(e)})(a,d,e,f);for(var h,j,i=a;a.prev!==a.next;)if(h=a.prev,j=a.next,f?Lf(a,d,e,f):Kf(a))b.push(h.i/c),b.push(a.i/c),b.push(j.i/c),$f(a),a=j.next,i=j.next;else if((a=j)===i){g?1===g?Jf(a=Mf(a,b,c),b,c,d,e,f,2):2===g&&Nf(a,b,c,d,e,f):Jf(If(a),b,c,d,e,f,1);break}}}function Kf(a){var b=a.prev,c=a,d=a.next;if(Uf(b,c,d)>=0)return!1;for(var e=a.next.next;e!==a.prev;){if(Sf(b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y)&&Uf(e.prev,e,e.next)>=0)return!1;e=e.next}return!0}function Lf(a,b,c,d){var e=a.prev,f=a,g=a.next;if(Uf(e,f,g)>=0)return!1;for(var h=e.x<f.x?e.x<g.x?e.x:g.x:f.x<g.x?f.x:g.x,k=e.y<f.y?e.y<g.y?e.y:g.y:f.y<g.y?f.y:g.y,i=e.x>f.x?e.x>g.x?e.x:g.x:f.x>g.x?f.x:g.x,j=e.y>f.y?e.y>g.y?e.y:g.y:f.y>g.y?f.y:g.y,h=Qf(h,k,b,c,d),k=Qf(i,j,b,c,d),i=a.prevZ,j=a.nextZ;i&&i.z>=h&&j&&j.z<=k;){if(i!==a.prev&&i!==a.next&&Sf(e.x,e.y,f.x,f.y,g.x,g.y,i.x,i.y)&&Uf(i.prev,i,i.next)>=0)return!1;if(i=i.prevZ,j!==a.prev&&j!==a.next&&Sf(e.x,e.y,f.x,f.y,g.x,g.y,j.x,j.y)&&Uf(j.prev,j,j.next)>=0)return!1;j=j.nextZ}for(;i&&i.z>=h;){if(i!==a.prev&&i!==a.next&&Sf(e.x,e.y,f.x,f.y,g.x,g.y,i.x,i.y)&&Uf(i.prev,i,i.next)>=0)return!1;i=i.prevZ}for(;j&&j.z<=k;){if(j!==a.prev&&j!==a.next&&Sf(e.x,e.y,f.x,f.y,g.x,g.y,j.x,j.y)&&Uf(j.prev,j,j.next)>=0)return!1;j=j.nextZ}return!0}function Mf(a,b,c){var d=a;do{var e=d.prev,f=d.next.next;!Vf(e,f)&&Wf(e,d,d.next,f)&&Xf(e,f)&&Xf(f,e)&&(b.push(e.i/c),b.push(d.i/c),b.push(f.i/c),$f(d),$f(d.next),d=a=f),d=d.next}while(d!==a);return d}function Nf(a,b,c,d,e,f){var g=a;do{for(var h=g.next.next;h!==g.prev;){if(g.i!==h.i&&Tf(g,h)){var i=Yf(g,h);return g=If(g,g.next),i=If(i,i.next),Jf(g,b,c,d,e,f),void Jf(i,b,c,d,e,f)}h=h.next}g=g.next}while(g!==a)}function Of(a,b){return a.x-b.x}function Pf(a,b){if(b=function(a,b){var c,d=b,e=a.x,f=a.y,g=-1/0;do{if(f<=d.y&&f>=d.next.y&&d.next.y!==d.y){var h=d.x+(f-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(h<=e&&h>g){if(g=h,h===e){if(f===d.y)return d;if(f===d.next.y)return d.next}c=d.x<d.next.x?d:d.next}}d=d.next}while(d!==b);if(!c)return null;if(e===g)return c.prev;var k;h=c;b=c.x;var i=c.y,j=1/0;d=c.next;for(;d!==h;)e>=d.x&&d.x>=b&&e!==d.x&&Sf(f<i?e:g,f,b,i,f<i?g:e,f,d.x,d.y)&&((k=Math.abs(f-d.y)/(e-d.x))<j||k===j&&d.x>c.x)&&Xf(d,a)&&(c=d,j=k),d=d.next;return c}(a,b)){b=Yf(b,a);If(b,b.next)}}function Qf(a,b,c,d,e){return 1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-c)*e)|a<<8))|a<<4))|a<<2))|a<<1)|(1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-d)*e)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function Rf(a){var b=a,c=a;do(b.x<c.x||b.x===c.x&&b.y<c.y)&&(c=b),b=b.next;while(b!==a);return c}function Sf(a,b,c,d,e,f,g,h){return(e-g)*(b-h)-(a-g)*(f-h)>=0&&(a-g)*(d-h)-(c-g)*(b-h)>=0&&(c-g)*(f-h)-(e-g)*(d-h)>=0}function Tf(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var c=a;do{if(c.i!==a.i&&c.next.i!==a.i&&c.i!==b.i&&c.next.i!==b.i&&Wf(c,c.next,a,b))return!0;c=c.next}while(c!==a);return!1}(a,b)&&Xf(a,b)&&Xf(b,a)&&function(a,b){var c=a,d=!1,e=(a.x+b.x)/2;b=(a.y+b.y)/2;do c.y>b!=c.next.y>b&&c.next.y!==c.y&&e<(c.next.x-c.x)*(b-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next;while(c!==a);return d}(a,b)}function Uf(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function Vf(a,b){return a.x===b.x&&a.y===b.y}function Wf(a,b,c,d){return!!(Vf(a,b)&&Vf(c,d)||Vf(a,d)&&Vf(c,b))||Uf(a,b,c)>0!=Uf(a,b,d)>0&&Uf(c,d,a)>0!=Uf(c,d,b)>0}function Xf(a,b){return Uf(a.prev,a,a.next)<0?Uf(a,b,a.next)>=0&&Uf(a,a.prev,b)>=0:Uf(a,b,a.prev)<0||Uf(a,a.next,b)<0}function Yf(a,b){var c=new ag(a.i,a.x,a.y),d=new ag(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,c.next=e,e.prev=c,d.next=c,c.prev=d,f.next=d,d.prev=f,d}function Zf(a,b,c,d){a=new ag(a,b,c);return d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a),a}function $f(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ag(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function bg(a,b,c,d){for(var e=0,b=b,f=c-d;b<c;b+=d)e+=(a[f]-a[b])*(a[b+1]+a[f+1]),f=b;return e}function cg(a,b,c,d,e){!function a(b,c,d,e,f){for(;e>d;){if(e-d>600){var g=e-d+1,h=c-d+1,k=Math.log(g),i=.5*Math.exp(2*k/3);k=.5*Math.sqrt(k*i*(g-i)/g)*(h-g/2<0?-1:1);var j=Math.max(d,Math.floor(c-h*i/g+k));h=Math.min(e,Math.floor(c+(g-h)*i/g+k));a(b,c,j,h,f)}i=b[c];g=d;k=e;for(dg(b,d,c),f(b[e],i)>0&&dg(b,d,e);g<k;){for(dg(b,g,k),g++,k--;f(b[g],i)<0;)g++;for(;f(b[k],i)>0;)k--}0===f(b[d],i)?dg(b,d,k):dg(b,++k,e),k<=c&&(d=k+1),c<=k&&(e=k-1)}}(a,b,c||0,d||a.length-1,e||eg)}function dg(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function eg(a,b){return a<b?-1:a>b?1:0}function fg(a,b){var c=a.length;if(c<=1)return[a];for(var d,e,f=[],g=0;g<c;g++){var h=x(a[g]);0!==h&&(a[g].area=Math.abs(h),void 0===e&&(e=h<0),e===h<0?(d&&f.push(d),d=[a[g]]):d.push(a[g]))}if(d&&f.push(d),b>1)for(var h=0;h<f.length;h++)f[h].length<=b||(cg(f[h],b,1,f[h].length-1,gg),f[h]=f[h].slice(0,b));return f}function gg(a,b){return b.area-a.area}function hg(a,b,c){for(var c=c.patternDependencies,d=!1,e=0,b=b;e<b.length;e+=1){var f=b[e].paint.get(a+"-pattern");f.isConstant()||(d=!0);f=f.constantOr(null);f&&(d=!0,c[f.to]=!0,c[f.from]=!0)}return d}function ig(a,b,c,d,e){for(var e=e.patternDependencies,f=0,b=b;f<b.length;f+=1){var j=b[f],g=j.paint.get(a+"-pattern").value;if("constant"!==g.kind){var h=g.evaluate({zoom:d-1},c,{}),i=g.evaluate({zoom:d},c,{});g=g.evaluate({zoom:d+1},c,{});e[h]=!0,e[i]=!0,e[g]=!0,c.patterns[j.id]={min:h,mid:i,max:g}}}return c}Gf.deviation=function(a,b,c,d){var e=b&&b.length,f=e?b[0]*c:a.length;f=Math.abs(bg(a,0,f,c));if(e)for(var e=0,i=b.length;e<i;e++){var g=b[e]*c,h=e<i-1?b[e+1]*c:a.length;f-=Math.abs(bg(a,g,h,c))}g=0;for(e=0;e<d.length;e+=3){h=d[e]*c;b=d[e+1]*c;i=d[e+2]*c;g+=Math.abs((a[h]-a[i])*(a[b+1]-a[h+1])-(a[h]-a[b])*(a[i+1]-a[h+1]))}return 0===f&&0===g?0:Math.abs((g-f)/f)},Gf.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var f=0;f<a[e].length;f++)for(var g=0;g<b;g++)c.vertices.push(a[e][f][g]);e>0&&(d+=a[e-1].length,c.holes.push(d))}return c},Ff["default"]=qf;var jg=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Zd(),this.indexArray=new ke(),this.indexArray2=new le(),this.programConfigurations=new Re(Ef,a.layers,a.zoom),this.segments=new Ce(),this.segments2=new Ce(),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};jg.prototype.populate=function(a,b){this.features=[],this.hasPattern=hg("fill",this.layers,b);for(var c=0,a=a;c<a.length;c+=1){var d=a[c],e=d.feature,f=d.index;d=d.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nd(this.zoom),e)){var h=We(e),g={sourceLayerIndex:d,index:f,geometry:h,properties:e.properties,type:e.type,patterns:{}};void 0!==e.id&&(g.id=e.id),this.hasPattern?this.features.push(ig("fill",this.layers,g,this.zoom,b)):this.addFeature(g,h,f,{}),b.featureIndex.insert(e,h,f,d,this.index)}}},jg.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},jg.prototype.addFeatures=function(a,b){for(var a=0,c=this.features;a<c.length;a+=1){var d=c[a],e=d.geometry;this.addFeature(d,e,d.index,b)}},jg.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},jg.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},jg.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ef),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0},jg.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},jg.prototype.addFeature=function(a,b,c,d){for(var e=0,b=fg(b,500);e<b.length;e+=1){for(var f=b[e],g=0,x=0,h=f;x<h.length;x+=1)g+=h[x].length;for(var h=this.segments.prepareSegment(g,this.layoutVertexArray,this.indexArray),x=h.vertexLength,i=[],j=[],k=0,l=f;k<l.length;k+=1){var t=l[k];if(0!==t.length){t!==f[0]&&j.push(i.length/2);var u=this.segments2.prepareSegment(t.length,this.layoutVertexArray,this.indexArray2),v=u.vertexLength;this.layoutVertexArray.emplaceBack(t[0].x,t[0].y),this.indexArray2.emplaceBack(v+t.length-1,v),i.push(t[0].x),i.push(t[0].y);for(var w=1;w<t.length;w++)this.layoutVertexArray.emplaceBack(t[w].x,t[w].y),this.indexArray2.emplaceBack(v+w-1,v+w),i.push(t[w].x),i.push(t[w].y);u.vertexLength+=t.length,u.primitiveLength+=t.length}}for(var v=Ff(i,j),w=0;w<v.length;w+=3)this.indexArray.emplaceBack(x+v[w],x+v[w+1],x+v[w+2]);h.vertexLength+=g,h.primitiveLength+=v.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},Z("FillBucket",jg,{omit:["layers","features"]});var kg={paint:new oc({"fill-antialias":new X(U.paint_fill["fill-antialias"]),"fill-opacity":new Y(U.paint_fill["fill-opacity"]),"fill-color":new Y(U.paint_fill["fill-color"]),"fill-outline-color":new Y(U.paint_fill["fill-outline-color"]),"fill-translate":new X(U.paint_fill["fill-translate"]),"fill-translate-anchor":new X(U.paint_fill["fill-translate-anchor"]),"fill-pattern":new jc(U.paint_fill["fill-pattern"])})};rf=function(a){function b(b){a.call(this,b,kg)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b);b=this.paint._values["fill-outline-color"];"constant"===b.value.kind&&void 0===b.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},b.prototype.createBucket=function(a){return new jg(a)},b.prototype.queryRadius=function(){return lf(this.paint.get("fill-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,e,f,g){return af(mf(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,g),d)},b.prototype.isTileClipped=function(){return!0},b}(rc);var lg=Xd([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,mg=ng;function ng(a,b,c,d,e){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=e,a.readFields(og,this,b)}function og(a,b,c){1==a?b.id=c.readVarint():2==a?(function(a,b){var c=a.readVarint()+a.pos;for(;a.pos<c;){var d=b._keys[a.readVarint()],e=b._values[a.readVarint()];b.properties[d]=e}})(c,b):3==a?b.type=c.readVarint():4==a&&(b._geometry=c.pos)}function pg(a){for(var b,c,d=0,e=0,f=a.length,g=f-1;e<f;g=e++)b=a[e],d+=((c=a[g]).x-b.x)*(b.y+c.y);return d}ng.types=["Unknown","Point","LineString","Polygon"],ng.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var b,c=a.readVarint()+a.pos,d=1,f=0,g=0,h=0,j=[];a.pos<c;){if(f<=0){var i=a.readVarint();d=7&i,f=i>>3}if(f--,1===d||2===d)g+=a.readSVarint(),h+=a.readSVarint(),1===d&&(b&&j.push(b),b=[]),b.push(new e(g,h));else{if(7!==d)throw new Error("unknown command "+d);b&&b.push(b[0].clone())}}return b&&j.push(b),j},ng.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var b=a.readVarint()+a.pos,c=1,d=0,e=0,f=0,g=1/0,h=-1/0,k=1/0,i=-1/0;a.pos<b;){if(d<=0){var j=a.readVarint();c=7&j,d=j>>3}if(d--,1===c||2===c)(e+=a.readSVarint())<g&&(g=e),e>h&&(h=e),(f+=a.readSVarint())<k&&(k=f),f>i&&(i=f);else if(7!==c)throw new Error("unknown command "+c)}return[g,k,h,i]},ng.prototype.toGeoJSON=function(a,b,c){var d,e=this.extent*Math.pow(2,c),f=this.extent*a,g=this.extent*b;c=this.loadGeometry();a=ng.types[this.type];function h(a){for(var b=0;b<a.length;b++){var c=a[b],d=180-360*(c.y+g)/e;a[b]=[360*(c.x+f)/e-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:b=[];for(d=0;d<c.length;d++)b[d]=c[d][0];h(c=b);break;case 2:for(d=0;d<c.length;d++)h(c[d]);break;case 3:for(c=function(a){var b=a.length;if(b<=1)return[a];for(var c,d,e=[],f=0;f<b;f++){var g=pg(a[f]);0!==g&&(void 0===d&&(d=g<0),d===g<0?(c&&e.push(c),c=[a[f]]):c.push(a[f]))}c&&e.push(c);return e}(c),d=0;d<c.length;d++)for(b=0;b<c[d].length;b++)h(c[d][b])}1===c.length?c=c[0]:a="Multi"+a;b={type:"Feature",geometry:{type:a,coordinates:c},properties:this.properties};return"id"in this&&(b.id=this.id),b};var qg=rg;function rg(a,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(sg,this,b),this.length=this._features.length}function sg(a,b,c){15===a?b.version=c.readVarint():1===a?b.name=c.readString():5===a?b.extent=c.readVarint():2===a?b._features.push(c.pos):3===a?b._keys.push(c.readString()):4===a&&b._values.push(function(a){var b=null,c=a.readVarint()+a.pos;for(;a.pos<c;){var d=a.readVarint()>>3;b=1===d?a.readString():2===d?a.readFloat():3===d?a.readDouble():4===d?a.readVarint64():5===d?a.readVarint():6===d?a.readSVarint():7===d?a.readBoolean():null}return b}(c))}function tg(a,b,c){if(3===a){a=new qg(c,c.readVarint()+c.pos);a.length&&(b[a.name]=a)}}rg.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];a=this._pbf.readVarint()+this._pbf.pos;return new mg(this._pbf,a,this.extent,this._keys,this._values)};var ug={VectorTile:function(a,b){this.layers=a.readFields(tg,{},b)},VectorTileFeature:mg,VectorTileLayer:qg},vg=ug.VectorTileFeature.types,wg=Math.pow(2,13);function xg(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,2*Math.floor(d*wg)+g,e*wg*2,f*wg*2,Math.round(h))}var yg=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new ae(),this.indexArray=new ke(),this.programConfigurations=new Re(lg,a.layers,a.zoom),this.segments=new Ce(),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function zg(a,b){return a.x===b.x&&(a.x<0||a.x>Ue)||a.y===b.y&&(a.y<0||a.y>Ue)}function Ag(a){return a.every(function(a){return a.x<0})||a.every(function(a){return a.x>Ue})||a.every(function(a){return a.y<0})||a.every(function(a){return a.y>Ue})}yg.prototype.populate=function(a,b){this.features=[],this.hasPattern=hg("fill-extrusion",this.layers,b);for(var c=0,a=a;c<a.length;c+=1){var d=a[c],e=d.feature,f=d.index;d=d.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nd(this.zoom),e)){var h=We(e),g={sourceLayerIndex:d,index:f,geometry:h,properties:e.properties,type:e.type,patterns:{}};void 0!==e.id&&(g.id=e.id),this.hasPattern?this.features.push(ig("fill-extrusion",this.layers,g,this.zoom,b)):this.addFeature(g,h,f,{}),b.featureIndex.insert(e,h,f,d,this.index,!0)}}},yg.prototype.addFeatures=function(a,b){for(var a=0,c=this.features;a<c.length;a+=1){var d=c[a],e=d.geometry;this.addFeature(d,e,d.index,b)}},yg.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},yg.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},yg.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},yg.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,lg),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},yg.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},yg.prototype.addFeature=function(a,b,c,d){for(var e=0,b=fg(b,500);e<b.length;e+=1){for(var f=b[e],g=0,x=0,h=f;x<h.length;x+=1)g+=h[x].length;for(var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),x=0,i=f;x<i.length;x+=1){var j=i[x];if(0!==j.length&&!Ag(j))for(var k=0,l=0;l<j.length;l++){var t=j[l];if(l>=1){var u=j[l-1];if(!zg(t,u)){h.vertexLength+4>Ce.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var v=t.sub(u)._perp()._unit(),w=u.dist(t);k+w>32768&&(k=0),xg(this.layoutVertexArray,t.x,t.y,v.x,v.y,0,0,k),xg(this.layoutVertexArray,t.x,t.y,v.x,v.y,0,1,k),k+=w,xg(this.layoutVertexArray,u.x,u.y,v.x,v.y,0,0,k),xg(this.layoutVertexArray,u.x,u.y,v.x,v.y,0,1,k);t=h.vertexLength;this.indexArray.emplaceBack(t,t+2,t+1),this.indexArray.emplaceBack(t+1,t+2,t+3),h.vertexLength+=4,h.primitiveLength+=2}}}}if(h.vertexLength+g>Ce.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(g,this.layoutVertexArray,this.indexArray)),"Polygon"===vg[a.type]){for(var w=[],u=[],v=h.vertexLength,t=0,l=f;t<l.length;t+=1){j=l[t];if(0!==j.length){j!==f[0]&&u.push(w.length/2);for(var k=0;k<j.length;k++){x=j[k];xg(this.layoutVertexArray,x.x,x.y,0,0,1,1,0),w.push(x.x),w.push(x.y)}}}for(var i=Ff(w,u),x=0;x<i.length;x+=3)this.indexArray.emplaceBack(v+i[x],v+i[x+2],v+i[x+1]);h.primitiveLength+=i.length/3,h.vertexLength+=g}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,c,d)},Z("FillExtrusionBucket",yg,{omit:["layers","features"]});var Bg={paint:new oc({"fill-extrusion-opacity":new X(U["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Y(U["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new X(U["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new X(U["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jc(U["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Y(U["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Y(U["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new X(U["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};tf=function(a){function b(b){a.call(this,b,Bg)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.createBucket=function(a){return new yg(a)},b.prototype.queryRadius=function(){return lf(this.paint.get("fill-extrusion-translate"))},b.prototype.is3D=function(){return!0},b.prototype.queryIntersectsFeature=function(a,b,c,d,f,g,h,i){f=mf(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,h);a=this.paint.get("fill-extrusion-height").evaluate(b,c);g=this.paint.get("fill-extrusion-base").evaluate(b,c);h=function(a,b,c,d){for(var c=[],f=0,a=a;f<a.length;f+=1){var g=a[f];g=[g.x,g.y,d,1];sf(g,g,b),c.push(new e(g[0]/g[3],g[1]/g[3]))}return c}(f,i,0,0);b=function(a,b,c,d){for(var f=[],g=[],h=d[8]*b,N=d[9]*b,i=d[10]*b,b=d[11]*b,j=d[8]*c,k=d[9]*c,l=d[10]*c,c=d[11]*c,n=0,a=a;n<a.length;n+=1){for(var p=a[n],u=[],x=[],B=0,p=p;B<p.length;B+=1){var C=p[B],G=C.x;C=C.y;var H=d[0]*G+d[4]*C+d[12],I=d[1]*G+d[5]*C+d[13],J=d[2]*G+d[6]*C+d[14];G=d[3]*G+d[7]*C+d[15];C=H+h;var K=I+N,L=J+i,M=G+b;H=H+j;I=I+k;J=J+l;G=G+c;C=new e(C/M,K/M);C.z=L/M,u.push(C);K=new e(H/G,I/G);K.z=J/G,x.push(K)}f.push(u),g.push(x)}return[f,g]}(d,g,a,i);return function(a,b,c){var d=1/0;af(c,b)&&(d=Dg(c,b[0]));for(var e=0;e<b.length;e++)for(var f=b[e],g=a[e],h=0;h<f.length-1;h++){var l=f[h],i=f[h+1],j=g[h],k=g[h+1];i=[l,i,k,j,l];Ze(c,i)&&(d=Math.min(d,Dg(c,i)))}return d!==1/0&&d}(b[0],b[1],h)},b}(rc);function Cg(a,b){return a.x*b.x+a.y*b.y}function Dg(a,b){if(1===a.length){var c=b[0],d=b[1],e=b[3];a=a[0];var f=d.sub(c),g=e.sub(c);a=a.sub(c);var h=Cg(f,f),i=Cg(f,g),j=Cg(g,g);f=Cg(a,f);a=Cg(a,g);g=h*j-i*i;j=(j*f-i*a)/g;h=(h*a-i*f)/g;a=1-j-h;return c.z*a+d.z*j+e.z*h}for(var i=1/0,f=0,g=b;f<g.length;f+=1){c=g[f];i=Math.min(i,c.z)}return i}var Eg=Xd([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Fg=ug.VectorTileFeature.types,Gg=63,Hg=Math.cos(Math.PI/180*37.5),Ig=.5,Jg=Math.pow(2,14)/Ig;function Kg(a,b,c,d,e,f,g){a.emplaceBack((b.x<<1)+(d?1:0),(b.y<<1)+(e?1:0),Math.round(Gg*c.x)+128,Math.round(Gg*c.y)+128,1+(0===f?0:f<0?-1:1)|(g*Ig&63)<<2,g*Ig>>6)}var Lg=function(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.features=[],this.hasPattern=!1,this.layoutVertexArray=new be(),this.indexArray=new ke(),this.programConfigurations=new Re(Eg,a.layers,a.zoom),this.segments=new Ce(),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id})};function Mg(a,b){return(a/b.tileTotal*(b.end-b.start)+b.start)*(Jg-1)}Lg.prototype.populate=function(a,b){this.features=[],this.hasPattern=hg("line",this.layers,b);for(var c=0,a=a;c<a.length;c+=1){var d=a[c],e=d.feature,f=d.index;d=d.sourceLayerIndex;if(this.layers[0]._featureFilter(new Nd(this.zoom),e)){var h=We(e),g={sourceLayerIndex:d,index:f,geometry:h,properties:e.properties,type:e.type,patterns:{}};void 0!==e.id&&(g.id=e.id),this.hasPattern?this.features.push(ig("line",this.layers,g,this.zoom,b)):this.addFeature(g,h,f,{}),b.featureIndex.insert(e,h,f,d,this.index)}}},Lg.prototype.update=function(a,b,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,b,this.stateDependentLayers,c)},Lg.prototype.addFeatures=function(a,b){for(var a=0,c=this.features;a<c.length;a+=1){var d=c[a],e=d.geometry;this.addFeature(d,e,d.index,b)}},Lg.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Lg.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lg.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Eg),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0},Lg.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lg.prototype.addFeature=function(a,b,c,d){for(var e=this.layers[0].layout,f=e.get("line-join").evaluate(a,{}),g=e.get("line-cap"),h=e.get("line-miter-limit"),e=e.get("line-round-limit"),i=0,b=b;i<b.length;i+=1){var j=b[i];this.addLine(j,a,f,g,h,e,c,d)}},Lg.prototype.addLine=function(a,b,c,d,e,f,g,h){var T=null;b.properties&&b.properties.hasOwnProperty("mapbox_clip_start")&&b.properties.hasOwnProperty("mapbox_clip_end")&&(T={start:b.properties.mapbox_clip_start,end:b.properties.mapbox_clip_end,tileTotal:void 0});for(var i="Polygon"===Fg[b.type],j=a.length;j>=2&&a[j-1].equals(a[j-2]);)j--;for(var k=0;k<j-1&&a[k].equals(a[k+1]);)k++;if(!(j<(i?3:2))){T&&(T.tileTotal=function(a,b,c){for(var d,e,f=0,b=b;b<c-1;b++)d=a[b],e=a[b+1],f+=d.dist(e);return f}(a,k,j)),"bevel"===c&&(e=1.05);var l=Ue/(512*this.overscaling)*15,q=a[k],s=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);this.distance=0;var y,E,F=d;d=i?"butt":d;var H=!0,J=void 0,K=void 0,L=void 0,M=void 0;this.e1=this.e2=this.e3=-1,i&&(y=a[j-2],M=q.sub(y)._unit()._perp());for(var q=k;q<j;q++)if(!(K=i&&q===j-1?a[k+1]:a[q+1])||!a[q].equals(K)){M&&(L=M),y&&(J=y),y=a[q],M=K?K.sub(y)._unit()._perp():L;var N=(L=L||M).add(M);0===N.x&&0===N.y||N._unit();var O=N.x*M.x+N.y*M.y,P=0!==O?1/O:1/0,aa=O<Hg&&J&&K;if(aa&&q>k){var Q=y.dist(J);if(Q>2*l){Q=y.sub(y.sub(J)._mult(l/Q)._round());this.distance+=Q.dist(J),this.addCurrentVertex(Q,this.distance,L.mult(1),0,0,!1,s,T),J=Q}}Q=J&&K;var R=Q?c:K?F:d;if(Q&&"round"===R&&(P<f?R="miter":P<=2&&(R="fakeround")),"miter"===R&&P>e&&(R="bevel"),"bevel"===R&&(P>2&&(R="flipbevel"),P<e&&(R="miter")),J&&(this.distance+=y.dist(J)),"miter"===R)N._mult(P),this.addCurrentVertex(y,this.distance,N,0,0,!1,s,T);else if("flipbevel"===R){if(P>100)N=M.clone().mult(-1);else{Q=L.x*M.y-L.y*M.x>0?-1:1;var S=P*L.add(M).mag()/L.sub(M).mag();N._perp()._mult(S*Q)}this.addCurrentVertex(y,this.distance,N,0,0,!1,s,T),this.addCurrentVertex(y,this.distance,N.mult(-1),0,0,!1,s,T)}else if("bevel"===R||"fakeround"===R){S=L.x*M.y-L.y*M.x>0;Q=-Math.sqrt(P*P-1);if(S?(P=0,E=Q):(E=0,P=Q),H||this.addCurrentVertex(y,this.distance,L,E,P,!1,s,T),"fakeround"===R){for(var Q=Math.floor(8*(.5-(O-.5))),O=void 0,ba=0;ba<Q;ba++)O=M.mult((ba+1)/(Q+1))._add(L)._unit(),this.addPieSliceVertex(y,this.distance,O,S,s,T);this.addPieSliceVertex(y,this.distance,N,S,s,T);for(var ba=Q-1;ba>=0;ba--)O=L.mult((ba+1)/(Q+1))._add(M)._unit(),this.addPieSliceVertex(y,this.distance,O,S,s,T)}K&&this.addCurrentVertex(y,this.distance,M,-E,-P,!1,s,T)}else"butt"===R?(H||this.addCurrentVertex(y,this.distance,L,0,0,!1,s,T),K&&this.addCurrentVertex(y,this.distance,M,0,0,!1,s,T)):"square"===R?(H||(this.addCurrentVertex(y,this.distance,L,1,1,!1,s,T),this.e1=this.e2=-1),K&&this.addCurrentVertex(y,this.distance,M,-1,-1,!1,s,T)):"round"===R&&(H||(this.addCurrentVertex(y,this.distance,L,0,0,!1,s,T),this.addCurrentVertex(y,this.distance,L,1,1,!0,s,T),this.e1=this.e2=-1),K&&(this.addCurrentVertex(y,this.distance,M,-1,-1,!0,s,T),this.addCurrentVertex(y,this.distance,M,0,0,!1,s,T)));if(aa&&q<j-1){N=y.dist(K);if(N>2*l){O=y.add(K.sub(y)._mult(l/N)._round());this.distance+=O.dist(y),this.addCurrentVertex(O,this.distance,M.mult(1),0,0,!1,s,T),y=O}}H=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,b,g,h)}},Lg.prototype.addCurrentVertex=function(a,b,c,d,e,f,g,h){var k,i=this.layoutVertexArray,j=this.indexArray;h&&(b=Mg(b,h)),k=c.clone(),d&&k._sub(c.perp()._mult(d)),Kg(i,a,k,f,!1,d,b),this.e3=g.vertexLength++,this.e1>=0&&this.e2>=0&&(j.emplaceBack(this.e1,this.e2,this.e3),g.primitiveLength++),this.e1=this.e2,this.e2=this.e3,k=c.mult(-1),e&&k._sub(c.perp()._mult(e)),Kg(i,a,k,f,!0,-e,b),this.e3=g.vertexLength++,this.e1>=0&&this.e2>=0&&(j.emplaceBack(this.e1,this.e2,this.e3),g.primitiveLength++),this.e1=this.e2,this.e2=this.e3,b>Jg/2&&!h&&(this.distance=0,this.addCurrentVertex(a,this.distance,c,d,e,f,g))},Lg.prototype.addPieSliceVertex=function(a,b,c,d,e,f){c=c.mult(d?-1:1);var g=this.layoutVertexArray,h=this.indexArray;f&&(b=Mg(b,f)),Kg(g,a,c,!1,d,0,b),this.e3=e.vertexLength++,this.e1>=0&&this.e2>=0&&(h.emplaceBack(this.e1,this.e2,this.e3),e.primitiveLength++),d?this.e2=this.e3:this.e1=this.e3},Z("LineBucket",Lg,{omit:["layers","features"]});Gf=new oc({"line-cap":new X(U.layout_line["line-cap"]),"line-join":new Y(U.layout_line["line-join"]),"line-miter-limit":new X(U.layout_line["line-miter-limit"]),"line-round-limit":new X(U.layout_line["line-round-limit"])});var Ng={paint:new oc({"line-opacity":new Y(U.paint_line["line-opacity"]),"line-color":new Y(U.paint_line["line-color"]),"line-translate":new X(U.paint_line["line-translate"]),"line-translate-anchor":new X(U.paint_line["line-translate-anchor"]),"line-width":new Y(U.paint_line["line-width"]),"line-gap-width":new Y(U.paint_line["line-gap-width"]),"line-offset":new Y(U.paint_line["line-offset"]),"line-blur":new Y(U.paint_line["line-blur"]),"line-dasharray":new hc(U.paint_line["line-dasharray"]),"line-pattern":new jc(U.paint_line["line-pattern"]),"line-gradient":new kc(U.paint_line["line-gradient"])}),layout:Gf},Og=new(function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.possiblyEvaluate=function(b,c){return c=new Nd(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),a.prototype.possiblyEvaluate.call(this,b,c)},b.prototype.evaluate=function(b,c,d,e){return c=k({},c,{zoom:Math.floor(c.zoom)}),a.prototype.evaluate.call(this,b,c,d,e)},b}(Y))(Ng.paint.properties["line-width"].specification);Og.useIntegerZoom=!0;qf=function(a){function b(b){a.call(this,b,Ng)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype._handleSpecialPaintPropertyUpdate=function(a){"line-gradient"===a&&this._updateGradient()},b.prototype._updateGradient=function(){var a=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Cf(a,"lineProgress"),this.gradientTexture=null},b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b),this.paint._values["line-floorwidth"]=Og.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,b)},b.prototype.createBucket=function(a){return new Lg(a)},b.prototype.queryRadius=function(a){a=a;var b=Pg(kf("line-width",this,a),kf("line-gap-width",this,a));a=kf("line-offset",this,a);return b/2+Math.abs(a)+lf(this.paint.get("line-translate"))},b.prototype.queryIntersectsFeature=function(a,b,c,d,f,g,h){f=mf(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,h);a=h/2*Pg(this.paint.get("line-width").evaluate(b,c),this.paint.get("line-gap-width").evaluate(b,c));g=this.paint.get("line-offset").evaluate(b,c);return g&&(d=function(a,b){for(var c=[],d=new e(0,0),f=0;f<a.length;f++){for(var g=a[f],h=[],l=0;l<g.length;l++){var i=g[l-1],j=g[l],k=g[l+1];i=0===l?d:j.sub(i)._unit()._perp();k=l===g.length-1?d:k.sub(j)._unit()._perp();i=i._add(k)._unit();k=i.x*k.x+i.y*k.y;i._mult(1/k),h.push(i._mult(b)._add(j))}c.push(h)}return c}(d,g*h)),function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d];if(a.length>=3)for(var f=0;f<e.length;f++)if(hf(a,e[f]))return!0;if(bf(a,e,c))return!0}return!1}(f,d,a)},b.prototype.isTileClipped=function(){return!0},b}(rc);function Pg(a,b){return b>0?b+2*a:a}var Qg=Xd([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),Rg=Xd([{name:"a_projected_pos",components:3,type:"Float32"}],4),Sg=(Xd([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xd([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Tg=(Xd([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Xd([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ug=Xd([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);Xd([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"}]),Xd([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"radialTextOffset"}]),Xd([{type:"Float32",name:"offsetX"}]),Xd([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Vg(a,b,c){return a.sections.forEach(function(a){a.text=function(a,b,c){b=b.layout.get("text-transform").evaluate(c,{});return"uppercase"===b?a=a.toLocaleUpperCase():"lowercase"===b&&(a=a.toLocaleLowerCase()),Md.applyArabicShaping&&(a=Md.applyArabicShaping(a)),a}(a.text,b,c)}),a}var Wg={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Xg=function(a){function b(b,c,d,e){a.call(this,b,c),this.angle=d,void 0!==e&&(this.segment=e)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.clone=function(){return new b(this.x,this.y,this.angle,this.segment)},b}(e);Z("Anchor",Xg);var Yg=256;function Zg(a,b){b=b.expression;if("constant"===b.kind)return{kind:"constant",layoutSize:b.evaluate(new Nd(a+1))};if("source"===b.kind)return{kind:"source"};for(var c=b.zoomStops,d=b.interpolationType,e=0;e<c.length&&c[e]<=a;)e++;for(var f=e=Math.max(0,e-1);f<c.length&&c[f]<a+1;)f++;f=Math.min(c.length-1,f);a=c[e];e=c[f];return"composite"===b.kind?{kind:"composite",minZoom:a,maxZoom:e,interpolationType:d}:{kind:"camera",minZoom:a,maxZoom:e,minSize:b.evaluate(new Nd(a)),maxSize:b.evaluate(new Nd(e)),interpolationType:d}}function $g(a,b,c){var d=b.uSize;b=b.uSizeT;var e=c.lowerSize;c=c.upperSize;return"source"===a.kind?e/Yg:"composite"===a.kind?Eb(e/Yg,c/Yg,b):d}function ah(a,b){var c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){var e=a.interpolationType,f=a.minZoom,g=a.maxZoom;e=e?i(Zb.interpolationFactor(e,b,f,g),0,1):0;"camera"===a.kind?d=Eb(a.minSize,a.maxSize,e):c=e}return{uSizeT:c,uSize:d}}rg=Object.freeze({getSizeData:Zg,evaluateSizeForFeature:$g,evaluateSizeForZoom:ah,SIZE_PACK_FACTOR:Yg});var bh=ug.VectorTileFeature.types,ch=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function dh(a,b,c,d,e,f,g,h){a.emplaceBack(b,c,Math.round(32*d),Math.round(32*e),f,g,h?h[0]:0,h?h[1]:0)}function eh(a,b,c){a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c),a.emplaceBack(b.x,b.y,c)}var fh=function(a){this.layoutVertexArray=new de(),this.indexArray=new ke(),this.programConfigurations=a,this.segments=new Ce(),this.dynamicLayoutVertexArray=new ee(),this.opacityVertexArray=new fe(),this.placedSymbolArray=new se()};fh.prototype.upload=function(a,b,c,d){c&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Qg.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Rg.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,ch,!0),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(a)},fh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Z("SymbolBuffers",fh);var gh=function(a,b,c){this.layoutVertexArray=new a(),this.layoutAttributes=b,this.indexArray=new c(),this.segments=new Ce(),this.collisionVertexArray=new he()};gh.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Sg.members,!0)},gh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Z("CollisionBuffers",gh);var hh=function(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(function(a){return a.id}),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1;var b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zg(this.zoom,b["text-size"]),this.iconSizeData=Zg(this.zoom,b["icon-size"]);b=this.layers[0].layout;var c=b.get("symbol-sort-key"),d=b.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==d&&void 0!==c.constantOr(1);c="viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey;this.sortFeaturesByY=c&&(b.get("text-allow-overlap")||b.get("icon-allow-overlap")||b.get("text-ignore-placement")||b.get("icon-ignore-placement")),this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id}),this.sourceID=a.sourceID};hh.prototype.createArrays=function(){this.text=new fh(new Re(Qg.members,this.layers,this.zoom,function(a){return/^text/.test(a)})),this.icon=new fh(new Re(Qg.members,this.layers,this.zoom,function(a){return/^icon/.test(a)})),this.collisionBox=new gh(ge,Tg.members,le),this.collisionCircle=new gh(ge,Ug.members,ke),this.glyphOffsetArray=new we(),this.lineVertexArray=new ye(),this.symbolInstances=new ue()},hh.prototype.calculateGlyphDependencies=function(a,b,c,d){for(var e=0;e<a.length;e++)if(b[a.charCodeAt(e)]=!0,c&&d){var f=Wg[a.charAt(e)];f&&(b[f.charCodeAt(0)]=!0)}},hh.prototype.populate=function(a,b){var c=this.layers[0],d=c.layout,e=d.get("text-font"),f=d.get("text-field"),g=d.get("icon-image");f=("constant"!==f.value.kind||f.value.value.toString().length>0)&&("constant"!==e.value.kind||e.value.value.length>0);g="constant"!==g.value.kind||g.value.value&&g.value.value.length>0;var h=d.get("symbol-sort-key");if(this.features=[],f||g){for(var i=b.iconDependencies,b=b.glyphDependencies,j=new Nd(this.zoom),k=0,a=a;k<a.length;k+=1){var l=a[k],r=l.feature,u=l.index;l=l.sourceLayerIndex;if(c._featureFilter(j,r)){var w=void 0;if(f){var x=c.getValueAndResolveTokens("text-field",r);w=Vg(x instanceof ib?x:ib.fromString(x),c,r)}x=void 0;if(g&&(x=c.getValueAndResolveTokens("icon-image",r)),w||x){var y=this.sortFeaturesByKey?h.evaluate(r,{}):void 0;u={text:w,icon:x,index:u,sourceLayerIndex:l,geometry:We(r),properties:r.properties,type:bh[r.type],sortKey:y};if(void 0!==r.id&&(u.id=r.id),this.features.push(u),x&&(i[x]=!0),w)for(var l=e.evaluate(r,{}).join(","),y="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),u=0,x=w.sections;u<x.length;u+=1){r=x[u];var z=Bd(w.toString()),A=r.fontStack||l;A=b[A]=b[A]||{};this.calculateGlyphDependencies(r.text,A,y,z)}}}}"line"===d.get("symbol-placement")&&(this.features=function(a){var b={},c={},d=[],e=0;function f(b){d.push(a[b]),e++}function g(a,b,e){var f=c[a];return delete c[a],c[b]=f,d[f].geometry[0].pop(),d[f].geometry[0]=d[f].geometry[0].concat(e[0]),f}function h(a,c,e){var f=b[c];return delete b[c],b[a]=f,d[f].geometry[0].shift(),d[f].geometry[0]=e[0].concat(d[f].geometry[0]),f}function t(a,b,c){c=c?b[0][b[0].length-1]:b[0][0];return a+":"+c.x+":"+c.y}for(var i=0;i<a.length;i++){var j=a[i],k=j.geometry;j=j.text?j.text.toString():null;if(j){var l=t(j,k),q=t(j,k,!0);if(l in c&&q in b&&c[l]!==b[q]){var r=h(l,q,k),s=g(l,q,d[r].geometry);delete b[l],delete c[q],c[t(j,d[s].geometry,!0)]=s,d[r].geometry=null}else l in c?g(l,q,k):q in b?h(l,q,k):(f(i),b[l]=e-1,c[q]=e-1)}else f(i)}return d.filter(function(a){return a.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(a,b){return a.sortKey-b.sortKey})}},hh.prototype.update=function(a,b,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,b,this.layers,c),this.icon.programConfigurations.updatePaintArrays(a,b,this.layers,c))},hh.prototype.isEmpty=function(){return 0===this.symbolInstances.length},hh.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},hh.prototype.upload=function(a){this.uploaded||(this.collisionBox.upload(a),this.collisionCircle.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},hh.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},hh.prototype.addToLineVertexArray=function(a,b){var c=this.lineVertexArray.length;if(void 0!==a.segment){for(var d=a.dist(b[a.segment+1]),e=a.dist(b[a.segment]),f={},g=a.segment+1;g<b.length;g++)f[g]={x:b[g].x,y:b[g].y,tileUnitDistanceFromAnchor:d},g<b.length-1&&(d+=b[g+1].dist(b[g]));for(var d=a.segment||0;d>=0;d--)f[d]={x:b[d].x,y:b[d].y,tileUnitDistanceFromAnchor:e},d>0&&(e+=b[d-1].dist(b[d]));for(var g=0;g<b.length;g++){a=f[g];this.lineVertexArray.emplaceBack(a.x,a.y,a.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}},hh.prototype.addSymbols=function(a,b,c,d,e,f,g,h,J,i){for(var e=a.indexArray,j=a.layoutVertexArray,k=a.dynamicLayoutVertexArray,l=a.segments.prepareSegment(4*b.length,a.layoutVertexArray,a.indexArray,f.sortKey),q=this.glyphOffsetArray.length,z=l.vertexLength,A=0,b=b;A<b.length;A+=1){var B=b[A],C=B.tl,D=B.tr,E=B.bl,F=B.br,G=B.tex,H=l.vertexLength,I=B.glyphOffset[1];dh(j,h.x,h.y,C.x,I+C.y,G.x,G.y,c),dh(j,h.x,h.y,D.x,I+D.y,G.x+G.w,G.y,c),dh(j,h.x,h.y,E.x,I+E.y,G.x,G.y+G.h,c),dh(j,h.x,h.y,F.x,I+F.y,G.x+G.w,G.y+G.h,c),eh(k,h,0),e.emplaceBack(H,H+1,H+2),e.emplaceBack(H+1,H+2,H+3),l.vertexLength+=4,l.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(B.glyphOffset[0])}a.placedSymbolArray.emplaceBack(h.x,h.y,q,this.glyphOffsetArray.length-q,z,J,i,h.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],g,!1,0),a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,f,f.index,{})},hh.prototype._addCollisionDebugVertex=function(a,b,c,d,e,f){return b.emplaceBack(0,0),a.emplaceBack(c.x,c.y,d,e,Math.round(f.x),Math.round(f.y))},hh.prototype.addCollisionDebugVertices=function(a,b,c,d,f,g,h,o){var i=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),j=i.vertexLength,k=f.layoutVertexArray,l=f.collisionVertexArray,n=h.anchorX;h=h.anchorY;if(this._addCollisionDebugVertex(k,l,g,n,h,new e(a,b)),this._addCollisionDebugVertex(k,l,g,n,h,new e(c,b)),this._addCollisionDebugVertex(k,l,g,n,h,new e(c,d)),this._addCollisionDebugVertex(k,l,g,n,h,new e(a,d)),i.vertexLength+=4,o){b=f.indexArray;b.emplaceBack(j,j+1,j+2),b.emplaceBack(j,j+2,j+3),i.primitiveLength+=2}else{c=f.indexArray;c.emplaceBack(j,j+1),c.emplaceBack(j+1,j+2),c.emplaceBack(j+2,j+3),c.emplaceBack(j+3,j),i.primitiveLength+=4}},hh.prototype.addDebugCollisionBoxes=function(a,b,c){for(var a=a;a<b;a++){var d=this.collisionBoxArray.get(a),e=d.x1,f=d.y1,g=d.x2,i=d.y2,h=d.radius>0;this.addCollisionDebugVertices(e,f,g,i,h?this.collisionCircle:this.collisionBox,d.anchorPoint,c,h)}},hh.prototype.generateCollisionDebugBuffers=function(){for(var a=0;a<this.symbolInstances.length;a++){var b=this.symbolInstances.get(a);this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b),this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b)}},hh.prototype._deserializeCollisionBoxesForSymbol=function(a,b,c,d,e){for(var f={},b=b;b<c;b++){var g=a.get(b);if(0===g.radius){f.textBox={x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2,anchorPointX:g.anchorPointX,anchorPointY:g.anchorPointY},f.textFeatureIndex=g.featureIndex;break}f.textCircles||(f.textCircles=[],f.textFeatureIndex=g.featureIndex);f.textCircles.push(g.anchorPointX,g.anchorPointY,g.radius,g.signedDistanceFromAnchor,1)}for(var g=d;g<e;g++){b=a.get(g);if(0===b.radius){f.iconBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},f.iconFeatureIndex=b.featureIndex;break}}return f},hh.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var b=0;b<this.symbolInstances.length;b++){var c=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,c.textBoxStartIndex,c.textBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex))}},hh.prototype.hasTextData=function(){return this.text.segments.get().length>0},hh.prototype.hasIconData=function(){return this.icon.segments.get().length>0},hh.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},hh.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},hh.prototype.addIndicesForPlacedTextSymbol=function(a){for(var a=this.text.placedSymbolArray.get(a),b=a.vertexStartIndex+4*a.numGlyphs,a=a.vertexStartIndex;a<b;a+=4)this.text.indexArray.emplaceBack(a,a+1,a+2),this.text.indexArray.emplaceBack(a+1,a+2,a+3)},hh.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var b=Math.sin(a),a=Math.cos(a),c=[],d=[],e=[],f=0;f<this.symbolInstances.length;++f){e.push(f);var g=this.symbolInstances.get(f);c.push(0|Math.round(b*g.anchorX+a*g.anchorY)),d.push(g.featureIndex)}return e.sort(function(a,b){return c[a]-c[b]||d[b]-d[a]}),e},hh.prototype.sortFeatures=function(a){var b=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var a=0,c=this.symbolInstanceIndexes;a<c.length;a+=1){var d=c[a],e=this.symbolInstances.get(d);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(function(a,c,d){a>=0&&d.indexOf(a)===c&&b.addIndicesForPlacedTextSymbol(a)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedTextSymbol(e.verticalPlacedTextSymbolIndex);e=this.icon.placedSymbolArray.get(d);if(e.numGlyphs){d=e.vertexStartIndex;this.icon.indexArray.emplaceBack(d,d+1,d+2),this.icon.indexArray.emplaceBack(d+1,d+2,d+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Z("SymbolBucket",hh,{omit:["layers","collisionBoxArray","features","compareText"]}),hh.MAX_GLYPHS=65535,hh.addDynamicAttributes=eh;jc=new oc({"symbol-placement":new X(U.layout_symbol["symbol-placement"]),"symbol-spacing":new X(U.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new X(U.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Y(U.layout_symbol["symbol-sort-key"]),"symbol-z-order":new X(U.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new X(U.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new X(U.layout_symbol["icon-ignore-placement"]),"icon-optional":new X(U.layout_symbol["icon-optional"]),"icon-rotation-alignment":new X(U.layout_symbol["icon-rotation-alignment"]),"icon-size":new Y(U.layout_symbol["icon-size"]),"icon-text-fit":new X(U.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new X(U.layout_symbol["icon-text-fit-padding"]),"icon-image":new Y(U.layout_symbol["icon-image"]),"icon-rotate":new Y(U.layout_symbol["icon-rotate"]),"icon-padding":new X(U.layout_symbol["icon-padding"]),"icon-keep-upright":new X(U.layout_symbol["icon-keep-upright"]),"icon-offset":new Y(U.layout_symbol["icon-offset"]),"icon-anchor":new Y(U.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new X(U.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new X(U.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new X(U.layout_symbol["text-rotation-alignment"]),"text-field":new Y(U.layout_symbol["text-field"]),"text-font":new Y(U.layout_symbol["text-font"]),"text-size":new Y(U.layout_symbol["text-size"]),"text-max-width":new Y(U.layout_symbol["text-max-width"]),"text-line-height":new X(U.layout_symbol["text-line-height"]),"text-letter-spacing":new Y(U.layout_symbol["text-letter-spacing"]),"text-justify":new Y(U.layout_symbol["text-justify"]),"text-radial-offset":new Y(U.layout_symbol["text-radial-offset"]),"text-variable-anchor":new X(U.layout_symbol["text-variable-anchor"]),"text-anchor":new Y(U.layout_symbol["text-anchor"]),"text-max-angle":new X(U.layout_symbol["text-max-angle"]),"text-rotate":new Y(U.layout_symbol["text-rotate"]),"text-padding":new X(U.layout_symbol["text-padding"]),"text-keep-upright":new X(U.layout_symbol["text-keep-upright"]),"text-transform":new Y(U.layout_symbol["text-transform"]),"text-offset":new Y(U.layout_symbol["text-offset"]),"text-allow-overlap":new X(U.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new X(U.layout_symbol["text-ignore-placement"]),"text-optional":new X(U.layout_symbol["text-optional"])});var ih={paint:new oc({"icon-opacity":new Y(U.paint_symbol["icon-opacity"]),"icon-color":new Y(U.paint_symbol["icon-color"]),"icon-halo-color":new Y(U.paint_symbol["icon-halo-color"]),"icon-halo-width":new Y(U.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Y(U.paint_symbol["icon-halo-blur"]),"icon-translate":new X(U.paint_symbol["icon-translate"]),"icon-translate-anchor":new X(U.paint_symbol["icon-translate-anchor"]),"text-opacity":new Y(U.paint_symbol["text-opacity"]),"text-color":new Y(U.paint_symbol["text-color"]),"text-halo-color":new Y(U.paint_symbol["text-halo-color"]),"text-halo-width":new Y(U.paint_symbol["text-halo-width"]),"text-halo-blur":new Y(U.paint_symbol["text-halo-blur"]),"text-translate":new X(U.paint_symbol["text-translate"]),"text-translate-anchor":new X(U.paint_symbol["text-translate-anchor"])}),layout:jc};kc=function(a){function b(b){a.call(this,b,ih)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.recalculate=function(b){a.prototype.recalculate.call(this,b),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},b.prototype.getValueAndResolveTokens=function(a,b){var c,d=this.layout.get(a).evaluate(b,{});a=this._unevaluatedLayout._values[a];return a.isDataDriven()||Gc(a.value)?d:(c=b.properties,d.replace(/{([^{}]+)}/g,function(a,b){return b in c?String(c[b]):""}))},b.prototype.createBucket=function(a){return new hh(a)},b.prototype.queryRadius=function(){return 0},b.prototype.queryIntersectsFeature=function(){return!1},b}(rc);var jh={paint:new oc({"background-color":new X(U.paint_background["background-color"]),"background-pattern":new hc(U.paint_background["background-pattern"]),"background-opacity":new X(U.paint_background["background-opacity"])})};Gf=function(a){function b(b){a.call(this,b,jh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(rc);var kh={paint:new oc({"raster-opacity":new X(U.paint_raster["raster-opacity"]),"raster-hue-rotate":new X(U.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new X(U.paint_raster["raster-brightness-min"]),"raster-brightness-max":new X(U.paint_raster["raster-brightness-max"]),"raster-saturation":new X(U.paint_raster["raster-saturation"]),"raster-contrast":new X(U.paint_raster["raster-contrast"]),"raster-resampling":new X(U.paint_raster["raster-resampling"]),"raster-fade-duration":new X(U.paint_raster["raster-fade-duration"])})};Y=function(a){function b(b){a.call(this,b,kh)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b}(rc);var lh=function(a){function b(b){a.call(this,b,{}),this.implementation=b}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},b.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},b.prototype.recalculate=function(){},b.prototype.updateTransitions=function(){},b.prototype.hasTransition=function(){},b.prototype.serialize=function(){},b.prototype.onAdd=function(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},b.prototype.onRemove=function(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},b}(rc),mh={circle:je,heatmap:gd,hillshade:fd,fill:rf,"fill-extrusion":tf,line:qf,symbol:kc,background:Gf,raster:Y};function nh(a){for(var b=0,c=0,d=0,e=a;d<e.length;d+=1){var f=e[d];b+=f.w*f.h,c=Math.max(c,f.w)}a.sort(function(a,b){return b.h-a.h});for(var f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(b/.95)),c),h:1/0}],e=0,d=0,c=0,a=a;c<a.length;c+=1)for(var g=a[c],h=f.length-1;h>=0;h--){var i=f[h];if(!(g.w>i.w||g.h>i.h)){if(g.x=i.x,g.y=i.y,d=Math.max(d,g.y+g.h),e=Math.max(e,g.x+g.w),g.w===i.w&&g.h===i.h){var j=f.pop();h<f.length&&(f[h]=j)}else g.h===i.h?(i.x+=g.w,i.w-=g.w):g.w===i.w?(i.y+=g.h,i.h-=g.h):(f.push({x:i.x+g.w,y:i.y,w:i.w-g.w,h:g.h}),i.y+=g.h,i.h-=g.h);break}}return{w:e,h:d,fill:b/(e*d)||0}}var oh=function(a,b){var c=b.pixelRatio;b=b.version;this.paddedRect=a,this.pixelRatio=c,this.version=b};jc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};jc.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},jc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},jc.tlbr.get=function(){return this.tl.concat(this.br)},jc.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(oh.prototype,jc);hc=function(a,b){var c={},d={};this.haveRenderCallbacks=[];var e=[];this.addImages(a,c,e),this.addImages(b,d,e);e=nh(e);var f=e.w;e=e.h;f=new Af({width:f||1,height:e||1});for(var g in a){e=a[g];var h=c[g].paddedRect;Af.copy(e.data,f,{x:0,y:0},{x:h.x+1,y:h.y+1},e.data)}for(var i in b){h=b[i];e=d[i].paddedRect;a=e.x+1;e=e.y+1;var j=h.data.width,k=h.data.height;Af.copy(h.data,f,{x:0,y:0},{x:a,y:e},h.data),Af.copy(h.data,f,{x:0,y:k-1},{x:a,y:e-1},{width:j,height:1}),Af.copy(h.data,f,{x:0,y:0},{x:a,y:e+k},{width:j,height:1}),Af.copy(h.data,f,{x:j-1,y:0},{x:a-1,y:e},{width:1,height:k}),Af.copy(h.data,f,{x:0,y:0},{x:a+j,y:e},{width:1,height:k})}this.image=f,this.iconPositions=c,this.patternPositions=d};hc.prototype.addImages=function(a,b,c){for(var d in a){var e=a[d],f={x:0,y:0,w:e.data.width+2,h:e.data.height+2};c.push(f),b[d]=new oh(f,e),e.hasRenderCallback&&this.haveRenderCallbacks.push(d)}},hc.prototype.patchUpdatedImages=function(a,b){for(var c in a.dispatchRenderCallbacks(this.haveRenderCallbacks),a.updatedImages)this.patchUpdatedImage(this.iconPositions[c],a.getImage(c),b),this.patchUpdatedImage(this.patternPositions[c],a.getImage(c),b)},hc.prototype.patchUpdatedImage=function(a,b,c){if(a&&b&&a.version!==b.version){a.version=b.version;a=a.tl;var d=a[0];a=a[1];c.update(b.data,void 0,{x:d,y:a})}},Z("ImagePosition",oh),Z("ImageAtlas",hc);var ph=self.HTMLImageElement,qh=self.HTMLCanvasElement,rh=self.HTMLVideoElement,sh=self.ImageData,th=function(a,b,c,d){this.context=a,this.format=c,this.texture=a.gl.createTexture(),this.update(b,d)};th.prototype.update=function(a,b,c){var d=a.width,e=a.height,f=!(this.size&&this.size[0]===d&&this.size[1]===e||c),g=this.context,h=g.gl;if(this.useMipmap=Boolean(b&&b.useMipmap),h.bindTexture(h.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===h.RGBA&&(!b||!1!==b.premultiply)),f)this.size=[d,e],a instanceof ph||a instanceof qh||a instanceof rh||a instanceof sh?h.texImage2D(h.TEXTURE_2D,0,this.format,this.format,h.UNSIGNED_BYTE,a):h.texImage2D(h.TEXTURE_2D,0,this.format,d,e,0,this.format,h.UNSIGNED_BYTE,a.data);else{g=c||{x:0,y:0};b=g.x;f=g.y;a instanceof ph||a instanceof qh||a instanceof rh||a instanceof sh?h.texSubImage2D(h.TEXTURE_2D,0,b,f,h.RGBA,h.UNSIGNED_BYTE,a):h.texSubImage2D(h.TEXTURE_2D,0,b,f,d,e,h.RGBA,h.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&h.generateMipmap(h.TEXTURE_2D)},th.prototype.bind=function(a,b,c){var d=this.context.gl;d.bindTexture(d.TEXTURE_2D,this.texture),c!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=d.LINEAR),a!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,c||a),this.filter=a),b!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,b),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,b),this.wrap=b)},th.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},th.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var uh=function(a,b,c,d,e){var f,g=8*e-d-1,k=(1<<g)-1,h=k>>1,i=-7;e=c?e-1:0;c=c?-1:1;var j=a[b+e];for(e+=c,f=j&(1<<-i)-1,j>>=-i,i+=g;i>0;f=256*f+a[b+e],e+=c,i-=8);for(g=f&(1<<-i)-1,f>>=-i,i+=d;i>0;g=256*g+a[b+e],e+=c,i-=8);if(0===f)f=1-h;else{if(f===k)return g?NaN:1/0*(j?-1:1);g+=Math.pow(2,d),f-=h}return(j?-1:1)*g*Math.pow(2,f-d)},vh=function(a,b,c,d,e,f){var g,h,n,i=8*f-e-1,j=(1<<i)-1,k=j>>1,l=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;f=d?0:f-1;d=d?1:-1;var m=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=j):(g=Math.floor(Math.log(b)/Math.LN2),b*(n=Math.pow(2,-g))<1&&(g--,n*=2),(b+=g+k>=1?l/n:l*Math.pow(2,1-k))*n>=2&&(g++,n/=2),g+k>=j?(h=0,g=j):g+k>=1?(h=(b*n-1)*Math.pow(2,e),g+=k):(h=b*Math.pow(2,k-1)*Math.pow(2,e),g=0));e>=8;a[c+f]=255&h,f+=d,h/=256,e-=8);for(g=g<<e|h,i+=e;i>0;a[c+f]=255&g,f+=d,g/=256,i-=8);a[c+f-d]|=128*m},wh=xh;function xh(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}xh.Varint=0,xh.Fixed64=1,xh.Bytes=2,xh.Fixed32=5;function yh(a){return a.type===xh.Bytes?a.readVarint()+a.pos:a.pos+1}function zh(a,b,c){return c?4294967296*b+(a>>>0):4294967296*(b>>>0)+(a>>>0)}function Ah(a,b,c){b=b<=16383?1:b<=2097151?2:b<=268435455?3:Math.floor(Math.log(b)/(7*Math.LN2));c.realloc(b);for(var d=c.pos-1;d>=a;d--)c.buf[d+b]=c.buf[d]}function Bh(a,b){for(var c=0;c<a.length;c++)b.writeVarint(a[c])}function Ch(a,b){for(var c=0;c<a.length;c++)b.writeSVarint(a[c])}function Dh(a,b){for(var c=0;c<a.length;c++)b.writeFloat(a[c])}function Eh(a,b){for(var c=0;c<a.length;c++)b.writeDouble(a[c])}function Fh(a,b){for(var c=0;c<a.length;c++)b.writeBoolean(a[c])}function Gh(a,b){for(var c=0;c<a.length;c++)b.writeFixed32(a[c])}function Hh(a,b){for(var c=0;c<a.length;c++)b.writeSFixed32(a[c])}function Ih(a,b){for(var c=0;c<a.length;c++)b.writeFixed64(a[c])}function Jh(a,b){for(var c=0;c<a.length;c++)b.writeSFixed64(a[c])}function Kh(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+16777216*a[b+3]}function Lh(a,b,c){a[c]=b,a[c+1]=b>>>8,a[c+2]=b>>>16,a[c+3]=b>>>24}function Mh(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16)+(a[b+3]<<24)}xh.prototype={destroy:function(){this.buf=null},readFields:function(a,b,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),e=d>>3,f=this.pos;this.type=7&d,a(e,b,this),this.pos===f&&this.skip(d)}return b},readMessage:function(a,b){return this.readFields(a,b,this.readVarint()+this.pos)},readFixed32:function(){var a=Kh(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Mh(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Kh(this.buf,this.pos)+4294967296*Kh(this.buf,this.pos+4);return this.pos+=8,a},readSFixed64:function(){var a=Kh(this.buf,this.pos)+4294967296*Mh(this.buf,this.pos+4);return this.pos+=8,a},readFloat:function(){var a=uh(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=uh(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var b,c,d=this.buf;return b=127&(c=d[this.pos++]),c<128?b:(b|=(127&(c=d[this.pos++]))<<7,c<128?b:(b|=(127&(c=d[this.pos++]))<<14,c<128?b:(b|=(127&(c=d[this.pos++]))<<21,c<128?b:function(a,b,c){var d,e,f=c.buf;if(e=f[c.pos++],d=(112&e)>>4,e<128)return zh(a,d,b);if(e=f[c.pos++],d|=(127&e)<<3,e<128)return zh(a,d,b);if(e=f[c.pos++],d|=(127&e)<<10,e<128)return zh(a,d,b);if(e=f[c.pos++],d|=(127&e)<<17,e<128)return zh(a,d,b);if(e=f[c.pos++],d|=(127&e)<<24,e<128)return zh(a,d,b);if(e=f[c.pos++],d|=(1&e)<<31,e<128)return zh(a,d,b);throw new Error("Expected varint not more than 10 bytes")}(b|=(15&d[this.pos])<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,b=function(a,b,c){var d="";b=b;for(;b<c;){var e,f,g,j=a[b],h=null,i=j>239?4:j>223?3:j>191?2:1;if(b+i>c)break;1===i?j<128&&(h=j):2===i?128==(192&(e=a[b+1]))&&(h=(31&j)<<6|63&e)<=127&&(h=null):3===i?(e=a[b+1],f=a[b+2],128==(192&e)&&128==(192&f)&&((h=(15&j)<<12|(63&e)<<6|63&f)<=2047||h>=55296&&h<=57343)&&(h=null)):4===i&&(e=a[b+1],f=a[b+2],g=a[b+3],128==(192&e)&&128==(192&f)&&128==(192&g)&&((h=(15&j)<<18|(63&e)<<12|(63&f)<<6|63&g)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,i=1):h>65535&&(h-=65536,d+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),d+=String.fromCharCode(h),b+=i}return d}(this.buf,this.pos,a);return this.pos=a,b},readBytes:function(){var a=this.readVarint()+this.pos,b=this.buf.subarray(this.pos,a);return this.pos=a,b},readPackedVarint:function(a,b){if(this.type!==xh.Bytes)return a.push(this.readVarint(b));var c=yh(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(b));return a},readPackedSVarint:function(a){if(this.type!==xh.Bytes)return a.push(this.readSVarint());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==xh.Bytes)return a.push(this.readBoolean());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==xh.Bytes)return a.push(this.readFloat());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==xh.Bytes)return a.push(this.readDouble());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==xh.Bytes)return a.push(this.readFixed32());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==xh.Bytes)return a.push(this.readSFixed32());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==xh.Bytes)return a.push(this.readFixed64());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==xh.Bytes)return a.push(this.readSFixed64());var b=yh(this);for(a=a||[];this.pos<b;)a.push(this.readSFixed64());return a},skip:function(a){a=7&a;if(a===xh.Varint)for(;this.buf[this.pos++]>127;);else if(a===xh.Bytes)this.pos=this.readVarint()+this.pos;else if(a===xh.Fixed32)this.pos+=4;else{if(a!==xh.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(a,b){this.writeVarint(a<<3|b)},realloc:function(a){for(var b=this.length||16;b<this.pos+a;)b*=2;if(b!==this.length){a=new Uint8Array(b);a.set(this.buf),this.buf=a,this.length=b}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Lh(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Lh(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Lh(this.buf,-1&a,this.pos),Lh(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Lh(this.buf,-1&a,this.pos),Lh(this.buf,Math.floor(a*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?(function(a,b){var c,d;a>=0?(c=a%4294967296|0,d=a/4294967296|0):(d=~(-a/4294967296),4294967295^(c=~(-a%4294967296))?c=c+1|0:(c=0,d=d+1|0));if(a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");b.realloc(10),(function(a,b,c){c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos++]=127&a|128,a>>>=7,c.buf[c.pos]=127&a})(c,0,b),(function(a,b){var c=(7&a)<<4;if(b.buf[b.pos++]|=c|((a>>>=3)?128:0),!a)return;if(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),!a)return;if(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),!a)return;if(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),!a)return;if(b.buf[b.pos++]=127&a|((a>>>=7)?128:0),!a)return;b.buf[b.pos++]=127&a})(d,b)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var b=this.pos;this.pos=function(a,b,c){for(var d,e,f=0;f<b.length;f++){if((d=b.charCodeAt(f))>55295&&d<57344){if(!e){d>56319||f+1===b.length?(a[c++]=239,a[c++]=191,a[c++]=189):e=d;continue}if(d<56320){a[c++]=239,a[c++]=191,a[c++]=189,e=d;continue}d=e-55296<<10|d-56320|65536,e=null}else e&&(a[c++]=239,a[c++]=191,a[c++]=189,e=null);d<128?a[c++]=d:(d<2048?a[c++]=d>>6|192:(d<65536?a[c++]=d>>12|224:(a[c++]=d>>18|240,a[c++]=d>>12&63|128),a[c++]=d>>6&63|128),a[c++]=63&d|128)}return c}(this.buf,a,this.pos);a=this.pos-b;a>=128&&Ah(b,a,this),this.pos=b-1,this.writeVarint(a),this.pos+=a},writeFloat:function(a){this.realloc(4),vh(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),vh(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var b=a.length;this.writeVarint(b),this.realloc(b);for(var c=0;c<b;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,b){this.pos++;var c=this.pos;a(b,this);a=this.pos-c;a>=128&&Ah(c,a,this),this.pos=c-1,this.writeVarint(a),this.pos+=a},writeMessage:function(a,b,c){this.writeTag(a,xh.Bytes),this.writeRawMessage(b,c)},writePackedVarint:function(a,b){b.length&&this.writeMessage(a,Bh,b)},writePackedSVarint:function(a,b){b.length&&this.writeMessage(a,Ch,b)},writePackedBoolean:function(a,b){b.length&&this.writeMessage(a,Fh,b)},writePackedFloat:function(a,b){b.length&&this.writeMessage(a,Dh,b)},writePackedDouble:function(a,b){b.length&&this.writeMessage(a,Eh,b)},writePackedFixed32:function(a,b){b.length&&this.writeMessage(a,Gh,b)},writePackedSFixed32:function(a,b){b.length&&this.writeMessage(a,Hh,b)},writePackedFixed64:function(a,b){b.length&&this.writeMessage(a,Ih,b)},writePackedSFixed64:function(a,b){b.length&&this.writeMessage(a,Jh,b)},writeBytesField:function(a,b){this.writeTag(a,xh.Bytes),this.writeBytes(b)},writeFixed32Field:function(a,b){this.writeTag(a,xh.Fixed32),this.writeFixed32(b)},writeSFixed32Field:function(a,b){this.writeTag(a,xh.Fixed32),this.writeSFixed32(b)},writeFixed64Field:function(a,b){this.writeTag(a,xh.Fixed64),this.writeFixed64(b)},writeSFixed64Field:function(a,b){this.writeTag(a,xh.Fixed64),this.writeSFixed64(b)},writeVarintField:function(a,b){this.writeTag(a,xh.Varint),this.writeVarint(b)},writeSVarintField:function(a,b){this.writeTag(a,xh.Varint),this.writeSVarint(b)},writeStringField:function(a,b){this.writeTag(a,xh.Bytes),this.writeString(b)},writeFloatField:function(a,b){this.writeTag(a,xh.Fixed32),this.writeFloat(b)},writeDoubleField:function(a,b){this.writeTag(a,xh.Fixed64),this.writeDouble(b)},writeBooleanField:function(a,b){this.writeVarintField(a,Boolean(b))}};var Nh=3;function Oh(a,b,c){1===a&&c.readMessage(Ph,b)}function Ph(a,b,c){if(3===a){a=c.readMessage(Qh,{});c=a.id;var d=a.bitmap,e=a.width,f=a.height,h=a.left,g=a.top;a=a.advance;b.push({id:c,bitmap:new zf({width:e+2*Nh,height:f+2*Nh},d),metrics:{width:e,height:f,left:h,top:g,advance:a}})}}function Qh(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}var Rh=Nh;rc=function(a,b,c){this.target=a,this.parent=b,this.mapId=c,this.callbacks={},this.callbackID=0,p(["receive"],this),this.target.addEventListener("message",this.receive,!1)};function Sh(a,b,c){c=2*Math.PI*6378137/256/Math.pow(2,c);return[a*c-2*Math.PI*6378137/2,b*c-2*Math.PI*6378137/2]}rc.prototype.send=function(a,b,c,d){var e=this,f=c?this.mapId+":"+this.callbackID++:null;c&&(this.callbacks[f]=c);var g=[];if(this.target.postMessage({targetMapId:d,sourceMapId:this.mapId,type:a,id:String(f),data:yd(b,g)},g),c)return{cancel:function(){e.callbacks[f]=null,e.target.postMessage({targetMapId:d,sourceMapId:e.mapId,type:"<cancel>",id:String(f)})}}},rc.prototype.receive=function(a){var b,c=this;a=a.data;var d=a.id;if(!a.targetMapId||this.mapId===a.targetMapId){var e=function(a,b){delete c.callbacks[d];var e=[];c.target.postMessage({sourceMapId:c.mapId,type:"<response>",id:String(d),error:a?yd(a):null,data:yd(b,e)},e)};if("<response>"===a.type||"<cancel>"===a.type)b=this.callbacks[a.id],delete this.callbacks[a.id],b&&a.error?b(zd(a.error)):b&&b(null,zd(a.data));else if(void 0!==a.id&&this.parent[a.type]){this.callbacks[a.id]=null;b=this.parent[a.type](a.sourceMapId,zd(a.data),e);b&&null===this.callbacks[a.id]&&(this.callbacks[a.id]=b.cancel)}else if(void 0!==a.id&&this.parent.getWorkerSource){b=a.type.split(".");var f=zd(a.data);this.parent.getWorkerSource(a.sourceMapId,b[0],f.source)[b[1]](f,e)}else this.parent[a.type](zd(a.data))}},rc.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var Th=function(a,b){a&&(b?this.setSouthWest(a).setNorthEast(b):4===a.length?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};Th.prototype.setNorthEast=function(a){return this._ne=a instanceof Uh?new Uh(a.lng,a.lat):Uh.convert(a),this},Th.prototype.setSouthWest=function(a){return this._sw=a instanceof Uh?new Uh(a.lng,a.lat):Uh.convert(a),this},Th.prototype.extend=function(a){var b,c,d=this._sw,e=this._ne;if(a instanceof Uh)b=a,c=a;else{if(!(a instanceof Th))return Array.isArray(a)?a.every(Array.isArray)?this.extend(Th.convert(a)):this.extend(Uh.convert(a)):this;if(b=a._sw,c=a._ne,!b||!c)return this}return d||e?(d.lng=Math.min(b.lng,d.lng),d.lat=Math.min(b.lat,d.lat),e.lng=Math.max(c.lng,e.lng),e.lat=Math.max(c.lat,e.lat)):(this._sw=new Uh(b.lng,b.lat),this._ne=new Uh(c.lng,c.lat)),this},Th.prototype.getCenter=function(){return new Uh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Th.prototype.getSouthWest=function(){return this._sw},Th.prototype.getNorthEast=function(){return this._ne},Th.prototype.getNorthWest=function(){return new Uh(this.getWest(),this.getNorth())},Th.prototype.getSouthEast=function(){return new Uh(this.getEast(),this.getSouth())},Th.prototype.getWest=function(){return this._sw.lng},Th.prototype.getSouth=function(){return this._sw.lat},Th.prototype.getEast=function(){return this._ne.lng},Th.prototype.getNorth=function(){return this._ne.lat},Th.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Th.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Th.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Th.convert=function(a){return!a||a instanceof Th?a:new Th(a)};var Uh=function(a,b){if(isNaN(a)||isNaN(b))throw new Error("Invalid LngLat object: ("+a+", "+b+")");if(this.lng=+a,this.lat=+b,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};function Vh(a){return 2*Math.PI*6378137*Math.cos(a*Math.PI/180)}function Wh(a){return(180+a)/360}function Xh(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Yh(a,b){return a/Vh(b)}function Zh(a){a=180-360*a;return 360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90}Uh.prototype.wrap=function(){return new Uh(j(this.lng,-180,180),this.lat)},Uh.prototype.toArray=function(){return[this.lng,this.lat]},Uh.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Uh.prototype.toBounds=function(a){void 0===a&&(a=0);a=360*a/40075017;var b=a/Math.cos(Math.PI/180*this.lat);return new Th(new Uh(this.lng-b,this.lat-a),new Uh(this.lng+b,this.lat+a))},Uh.convert=function(a){if(a instanceof Uh)return a;if(Array.isArray(a)&&(2===a.length||3===a.length))return new Uh(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"==typeof a&&null!==a)return new Uh(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var $h=function(a,b,c){void 0===c&&(c=0),this.x=+a,this.y=+b,this.z=+c};$h.fromLngLat=function(a,b){void 0===b&&(b=0);a=Uh.convert(a);return new $h(Wh(a.lng),Xh(a.lat),Yh(b,a.lat))},$h.prototype.toLngLat=function(){return new Uh(360*this.x-180,Zh(this.y))},$h.prototype.toAltitude=function(){return a=this.z,b=this.y,a*Vh(Zh(b));var a,b};var ai=function(a,b,c){this.z=a,this.x=b,this.y=c,this.key=di(0,a,b,c)};ai.prototype.equals=function(a){return this.z===a.z&&this.x===a.x&&this.y===a.y},ai.prototype.url=function(a,b){var c,d,e,f;d=(c=this.x,d=this.y,e=this.z,f=Sh(256*c,256*(d=Math.pow(2,e)-d-1),e),c=Sh(256*(c+1),256*(d+1),e),f[0]+","+f[1]+","+c[0]+","+c[1]);e=function(a,b,c){for(var d,e="",a=a;a>0;a--)e+=(b&(d=1<<a-1)?1:0)+(c&d?2:0);return e}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===b?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",e).replace("{bbox-epsg-3857}",d)},ai.prototype.getTilePoint=function(a){var b=Math.pow(2,this.z);return new e((a.x*b-this.x)*Ue,(a.y*b-this.y)*Ue)};var bi=function(a,b){this.wrap=a,this.canonical=b,this.key=di(a,b.z,b.x,b.y)},ci=function(a,b,c,d,e){this.overscaledZ=a,this.wrap=b,this.canonical=new ai(c,+d,+e),this.key=di(b,a,d,e)};function di(a,b,c,d){(a*=2)<0&&(a=-1*a-1);var e=1<<b;return 32*(e*e*a+e*d+c)+b}ci.prototype.equals=function(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)},ci.prototype.scaledTo=function(a){var b=this.canonical.z-a;return a>this.canonical.z?new ci(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ci(a,this.wrap,a,this.canonical.x>>b,this.canonical.y>>b)},ci.prototype.isChildOf=function(a){if(a.wrap!==this.wrap)return!1;var b=this.canonical.z-a.canonical.z;return 0===a.overscaledZ||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>b&&a.canonical.y===this.canonical.y>>b},ci.prototype.children=function(a){if(this.overscaledZ>=a)return[new ci(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];a=this.canonical.z+1;var b=2*this.canonical.x,c=2*this.canonical.y;return[new ci(a,this.wrap,a,b,c),new ci(a,this.wrap,a,b+1,c),new ci(a,this.wrap,a,b,c+1),new ci(a,this.wrap,a,b+1,c+1)]},ci.prototype.isLessThan=function(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))},ci.prototype.wrapped=function(){return new ci(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ci.prototype.unwrapTo=function(a){return new ci(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)},ci.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ci.prototype.toUnwrapped=function(){return new bi(this.wrap,this.canonical)},ci.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ci.prototype.getTilePoint=function(a){return this.canonical.getTilePoint(new $h(a.x-this.wrap,a.y))},Z("CanonicalTileID",ai),Z("OverscaledTileID",ci,{omit:["posMatrix"]});je=function(a,b,c){if(this.uid=a,b.height!==b.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return v('"'+c+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');a=this.dim=b.height;this.stride=this.dim+2,this.data=new Int32Array(this.stride*this.stride);for(var b=b.data,c="terrarium"===c?this._unpackTerrarium:this._unpackMapbox,d=0;d<a;d++)for(var e=0;e<a;e++){var f=4*(d*a+e);this.set(e,d,c(b[f],b[f+1],b[f+2]))}for(var f=0;f<a;f++)this.set(-1,f,this.get(0,f)),this.set(a,f,this.get(a-1,f)),this.set(f,-1,this.get(f,0)),this.set(f,a,this.get(f,a-1));this.set(-1,-1,this.get(0,0)),this.set(a,-1,this.get(a-1,0)),this.set(-1,a,this.get(0,a-1)),this.set(a,a,this.get(a-1,a-1))};je.prototype.set=function(a,b,c){this.data[this._idx(a,b)]=c+65536},je.prototype.get=function(a,b){return this.data[this._idx(a,b)]-65536},je.prototype._idx=function(a,b){if(a<-1||a>=this.dim+1||b<-1||b>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(b+1)*this.stride+(a+1)},je.prototype._unpackMapbox=function(a,b,c){return(256*a*256+256*b+c)/10-1e4},je.prototype._unpackTerrarium=function(a,b,c){return 256*a+b+c/256-32768},je.prototype.getPixels=function(){return new Af({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},je.prototype.backfillBorder=function(a,b,c){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");var d=b*this.dim,e=b*this.dim+this.dim,f=c*this.dim,g=c*this.dim+this.dim;switch(b){case-1:d=e-1;break;case 1:e=d+1}switch(c){case-1:f=g-1;break;case 1:g=f+1}for(var b=-b*this.dim,c=-c*this.dim,f=f;f<g;f++)for(var h=d;h<e;h++)this.set(h,f,a.get(h+b,f+c))},Z("DEMData",je);var ei=Xd([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),fi=function(a){this._stringToNumber={},this._numberToString=[];for(var b=0;b<a.length;b++){var c=a[b];this._stringToNumber[c]=b,this._numberToString[b]=c}};fi.prototype.encode=function(a){return this._stringToNumber[a]},fi.prototype.decode=function(a){return this._numberToString[a]};var gi=function(a,b,c,d){this.type="Feature",this._vectorTileFeature=a,a._z=b,a._x=c,a._y=d,this.properties=a.properties,null!=a.id&&(this.id=a.id)};gd={geometry:{configurable:!0}};gd.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},gd.geometry.set=function(a){this._geometry=a},gi.prototype.toJSON=function(){var a={geometry:this.geometry};for(var b in this)"_geometry"!==b&&"_vectorTileFeature"!==b&&(a[b]=this[b]);return a},Object.defineProperties(gi.prototype,gd);fd=function(){this.state={},this.stateChanges={},this.deletedStates={}};fd.prototype.updateState=function(a,b,c){b=String(b);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][b]=this.stateChanges[a][b]||{},k(this.stateChanges[a][b],c),null===this.deletedStates[a])for(var d in this.deletedStates[a]={},this.state[a])d!==b&&(this.deletedStates[a][d]=null);else if(this.deletedStates[a]&&null===this.deletedStates[a][b])for(var e in this.deletedStates[a][b]={},this.state[a][b])c[e]||(this.deletedStates[a][b][e]=null);else for(var f in c)this.deletedStates[a]&&this.deletedStates[a][b]&&null===this.deletedStates[a][b][f]&&delete this.deletedStates[a][b][f]},fd.prototype.removeFeatureState=function(a,b,c){if(!(null===this.deletedStates[a])){var d=String(b);if(this.deletedStates[a]=this.deletedStates[a]||{},c&&void 0!==b&&b>=0)null!==this.deletedStates[a][d]&&(this.deletedStates[a][d]=this.deletedStates[a][d]||{},this.deletedStates[a][d][c]=null);else if(void 0!==b&&b>=0)if(this.stateChanges[a]&&this.stateChanges[a][d])for(c in this.deletedStates[a][d]={},this.stateChanges[a][d])this.deletedStates[a][d][c]=null;else this.deletedStates[a][d]=null;else this.deletedStates[a]=null}},fd.prototype.getState=function(a,b){var c=String(b),d=this.state[a]||{},e=this.stateChanges[a]||{};d=k({},d[c],e[c]);if(null===this.deletedStates[a])return{};if(this.deletedStates[a]){e=this.deletedStates[a][b];if(null===e)return{};for(var f in e)delete d[f]}return d},fd.prototype.initializeTileState=function(a,b){a.setFeatureState(this.state,b)},fd.prototype.coalesceChanges=function(a,b){var c={};for(var d in this.stateChanges){this.state[d]=this.state[d]||{};var e={};for(var f in this.stateChanges[d])this.state[d][f]||(this.state[d][f]={}),k(this.state[d][f],this.stateChanges[d][f]),e[f]=this.state[d][f];c[d]=e}for(var g in this.deletedStates){this.state[g]=this.state[g]||{};e={};if(null===this.deletedStates[g])for(var p in this.state[g])e[p]={},this.state[g][p]={};else for(var h in this.deletedStates[g]){if(null===this.deletedStates[g][h])this.state[g][h]={};else for(var i=0,j=Object.keys(this.deletedStates[g][h]);i<j.length;i+=1){var l=j[i];delete this.state[g][h][l]}e[h]=this.state[g][h]}c[g]=c[g]||{},k(c[g],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(var o in a)a[o].setFeatureState(c,b)};rf=function(a,b,c){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=b||new sd(Ue,16,0),this.grid3D=new sd(Ue,16,0),this.featureIndexArray=c||new Ae()};function hi(a){for(var b=1/0,c=1/0,d=-1/0,e=-1/0,f=0,a=a;f<a.length;f+=1){var g=a[f];b=Math.min(b,g.x),c=Math.min(c,g.y),d=Math.max(d,g.x),e=Math.max(e,g.y)}return{minX:b,minY:c,maxX:d,maxY:e}}function ii(a,b){return b-a}rf.prototype.insert=function(a,b,c,d,e,f){a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,e);for(var c=f?this.grid3D:this.grid,d=0;d<b.length;d++){for(var e=b[d],f=[1/0,1/0,-1/0,-1/0],g=0;g<e.length;g++){var h=e[g];f[0]=Math.min(f[0],h.x),f[1]=Math.min(f[1],h.y),f[2]=Math.max(f[2],h.x),f[3]=Math.max(f[3],h.y)}f[0]<Ue&&f[1]<Ue&&f[2]>=0&&f[3]>=0&&c.insert(a,f[0],f[1],f[2],f[3])}},rf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ug.VectorTile(new wh(this.rawTileData)).layers,this.sourceLayerCoder=new fi(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},rf.prototype.query=function(a,b,c){var d=this;this.loadVTLayers();for(var f=a.params||{},g=Ue/a.tileSize/a.scale,h=Uc(f.filter),t=a.queryGeometry,i=a.queryPadding*g,j=hi(t),k=this.grid.query(j.minX-i,j.minY-i,j.maxX+i,j.maxY+i),j=hi(a.cameraQueryGeometry),j=this.grid3D.query(j.minX-i,j.minY-i,j.maxX+i,j.maxY+i,function(b,c,d,f){return function(a,b,c,d,f){for(var g=0,h=a;g<h.length;g+=1){var i=h[g];if(b<=i.x&&c<=i.y&&d>=i.x&&f>=i.y)return!0}i=[new e(b,c),new e(b,f),new e(d,f),new e(d,c)];if(a.length>2)for(var g=0,h=i;g<h.length;g+=1)if(hf(a,h[g]))return!0;for(var b=0;b<a.length-1;b++)if(jf(a[b],a[b+1],i))return!0;return!1}(a.cameraQueryGeometry,b-i,c-i,d+i,f+i)}),l=0,j=j;l<j.length;l+=1){var m=j[l];k.push(m)}k.sort(ii);for(var o,s={},m=function(e){e=k[e];if(e!==o){o=e;e=d.featureIndexArray.get(e);var i=null;d.loadMatchingFeature(s,e.bucketIndex,e.sourceLayerIndex,e.featureIndex,h,f.layers,b,function(b,e){i||(i=We(b));var f={};return b.id&&(f=c.getState(e.sourceLayer||"_geojsonTileLayer",b.id)),e.queryIntersectsFeature(t,b,f,i,d.z,a.transform,g,a.pixelPosMatrix)})}},j=0;j<k.length;j++)m(j);return s},rf.prototype.loadMatchingFeature=function(a,b,c,d,e,f,g,h){b=this.bucketLayerIDs[b];if(!f||function(a,b){for(var c=0;c<a.length;c++)if(b.indexOf(a[c])>=0)return!0;return!1}(f,b)){c=this.sourceLayerCoder.decode(c);c=this.vtLayers[c].feature(d);if(e(new Nd(this.tileID.overscaledZ),c))for(var e=0;e<b.length;e++){var i=b[e];if(!(f&&f.indexOf(i)<0)){var j=g[i];if(j){var k=!h||h(c,j);if(k){var l=new gi(c,this.z,this.x,this.y);l.layer=j.serialize();j=a[i];void 0===j&&(j=a[i]=[]),j.push({featureIndex:d,feature:l,intersectionZ:k})}}}}}},rf.prototype.lookupSymbolFeatures=function(a,b,c,d,e,f){var g={};this.loadVTLayers();for(var d=Uc(d),i=0,a=a;i<a.length;i+=1){var h=a[i];this.loadMatchingFeature(g,b,c,h,d,e,f)}return g},rf.prototype.hasLayer=function(a){for(var b=0,c=this.bucketLayerIDs;b<c.length;b+=1)for(var d=0,e=c[b];d<e.length;d+=1)if(a===e[d])return!0;return!1},Z("FeatureIndex",rf,{omit:["rawTileData","sourceLayerCoder"]});tf=function(a,b){this.tileID=a,this.uid=m(),this.uses=0,this.tileSize=b,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.expiredRequestCount=0,this.state="loading"};tf.prototype.registerFadeDuration=function(a){a=a+this.timeAdded;a<G.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)},tf.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},tf.prototype.loadVectorData=function(a,b,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){for(var d in a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(a,b){var c={};if(!b)return c;for(var d=function(){var a=f[e],d=a.layerIds.map(function(a){return b.getLayer(a)}).filter(Boolean);if(0!==d.length){a.layers=d,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(a){return d.filter(function(b){return b.id===a})[0]}));for(var g=0,h=d;g<h.length;g+=1){var i=h[g];c[i.id]=a}}},e=0,f=a;e<f.length;e+=1)d();return c}(a.buckets,b.style),this.hasSymbolBuckets=!1,this.buckets){var e=this.buckets[d];if(e instanceof hh){if(this.hasSymbolBuckets=!0,!c)break;e.justReloaded=!0}}for(var f in this.queryPadding=0,this.buckets){e=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(f).queryRadius(e))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new qe()},tf.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},tf.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},tf.prototype.getBucket=function(a){return this.buckets[a.id]},tf.prototype.upload=function(a){for(var b in this.buckets){var c=this.buckets[b];c.uploadPending()&&c.upload(a)}c=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new th(a,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new th(a,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)},tf.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)},tf.prototype.queryRenderedFeatures=function(a,b,c,d,e,f,g,h,i){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:d,scale:e,tileSize:this.tileSize,pixelPosMatrix:i,transform:g,params:f,queryPadding:this.queryPadding*h},a,b):{}},tf.prototype.querySourceFeatures=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var c=this.latestFeatureIndex.loadVTLayers(),d=b?b.sourceLayer:"";c=c._geojsonTileLayer||c[d];if(c)for(var d=Uc(b&&b.filter),b=this.tileID.canonical,e=b.z,i=b.x,b=b.y,f={z:e,x:i,y:b},g=0;g<c.length;g++){var h=c.feature(g);if(d(new Nd(this.tileID.overscaledZ),h)){h=new gi(h,e,i,b);h.tile=f,a.push(h)}}}},tf.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},tf.prototype.setMask=function(a,b){if(!g(this.mask,a)&&(this.mask=a,this.clearMask(),!g(a,{0:!0}))){var c=new $d(),d=new ke();this.segments=new Ce(),this.segments.prepareSegment(0,c,d);for(var f=Object.keys(a),h=0;h<f.length;h++){var k=a[+f[h]],i=Ue>>k.z;k=new e(k.x*i,k.y*i);i=new e(k.x+i,k.y+i);var j=this.segments.prepareSegment(4,c,d);c.emplaceBack(k.x,k.y,k.x,k.y),c.emplaceBack(i.x,k.y,i.x,k.y),c.emplaceBack(k.x,i.y,k.x,i.y),c.emplaceBack(i.x,i.y,i.x,i.y);k=j.vertexLength;d.emplaceBack(k,k+1,k+2),d.emplaceBack(k+1,k+2,k+3),j.vertexLength+=4,j.primitiveLength+=2}this.maskedBoundsBuffer=b.createVertexBuffer(c,ei.members),this.maskedIndexBuffer=b.createIndexBuffer(d)}},tf.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},tf.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},tf.prototype.setExpiryData=function(a){var b=this.expirationTime;if(a.cacheControl){var c=y(a.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){c=Date.now();a=!1;if(this.expirationTime>c)a=!1;else if(b)if(this.expirationTime<b)a=!0;else{b=this.expirationTime-b;b?this.expirationTime=c+Math.max(b,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},tf.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},tf.prototype.setFeatureState=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(a).length){var c=this.latestFeatureIndex.loadVTLayers();for(var d in this.buckets){var e=this.buckets[d],f=e.layers[0].sourceLayer||"_geojsonTileLayer",g=c[f];f=a[f];g&&f&&0!==Object.keys(f).length&&(e.update(f,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b&&b.style&&(this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(d).queryRadius(e))))}}},tf.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},tf.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()},tf.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},tf.prototype.setHoldDuration=function(a){this.symbolFadeHoldUntil=G.now()+a};var ji=24,ki={horizontal:1,vertical:2,horizontalOnly:3},li=function(){this.text="",this.sectionIndex=[],this.sections=[]};function mi(a,b,c,d,e,f,g,h,z,i){var j;a=li.fromFeature(a,c);i===ki.vertical&&a.verticalizePunctuation();c=Md.processBidirectionalText;var k=Md.processStyledBidirectionalText;if(c&&1===a.sections.length){j=[];for(var l=0,c=c(a.toString(),si(a,h,d,b));l<c.length;l+=1){var w=c[l],x=new li();x.text=w,x.sections=a.sections;for(var y=0;y<w.length;y++)x.sectionIndex.push(0);j.push(x)}}else if(k){j=[];for(var y=0,w=k(a.text,a.sectionIndex,si(a,h,d,b));y<w.length;y+=1){x=w[y];c=new li();c.text=x[0],c.sectionIndex=x[1],c.sections=a.sections,j.push(c)}}else j=function(a,b){for(var c=[],d=a.text,e=0,f=0,b=b;f<b.length;f+=1){var g=b[f];c.push(a.substring(e,g)),e=g}return e<d.length&&c.push(a.substring(e,d.length)),c}(a,si(a,h,d,b));l=[];k={positionedGlyphs:l,text:a.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:i,lineCount:j.length};return function(a,b,c,d,e,f,g,h){for(var F=0,i=-17,j=0,k=a.positionedGlyphs,f="right"===f?1:"left"===f?0:.5,l=0,w=c;l<w.length;l+=1){var x=w[l];x.trim();var y=x.getMaxScale();if(x.length()){for(var z=k.length,A=0;A<x.length();A++){var B=x.getSection(A),C=x.getCharCode(A),D=24*(y-B.scale),E=b[B.fontStack];E=E&&E[C];E&&(Ed(C)&&g!==ki.horizontal?(k.push({glyph:C,x:F,y:D,vertical:!0,scale:B.scale,fontStack:B.fontStack}),F+=ji*B.scale+h):(k.push({glyph:C,x:F,y:i+D,vertical:!1,scale:B.scale,fontStack:B.fontStack}),F+=E.metrics.advance*B.scale+h))}if(k.length!==z){C=F-h;j=Math.max(C,j),ui(k,b,z,k.length-1,f)}F=0,i+=d*y}else i+=d}D=ti(e);E=D.horizontalAlign;B=D.verticalAlign;!function(a,b,c,d,e,f,g){for(var b=(b-c)*e,c=(-d*g+.5)*f,e=0;e<a.length;e++)a[e].x+=b,a[e].y+=c}(k,f,E,B,j,d,c.length);x=i- -17;a.top+=-B*x,a.bottom=a.top+x,a.left+=-E*j,a.right=a.left+j}(k,b,j,e,f,g,i,h),!!l.length&&k}li.fromFeature=function(a,b){for(var c=new li(),d=0;d<a.sections.length;d++){var e=a.sections[d];c.sections.push({scale:e.scale||1,fontStack:e.fontStack||b}),c.text+=e.text;for(var f=0;f<e.text.length;f++)c.sectionIndex.push(d)}return c},li.prototype.length=function(){return this.text.length},li.prototype.getSection=function(a){return this.sections[this.sectionIndex[a]]},li.prototype.getCharCode=function(a){return this.text.charCodeAt(a)},li.prototype.verticalizePunctuation=function(){this.text=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c+1)||null,e=a.charCodeAt(c-1)||null;d&&Fd(d)&&!Wg[a[c+1]]||e&&Fd(e)&&!Wg[a[c-1]]||!Wg[a[c]]?b+=a[c]:b+=Wg[a[c]]}return b}(this.text)},li.prototype.trim=function(){for(var a=0,b=0;b<this.text.length&&ni[this.text.charCodeAt(b)];b++)a++;for(var b=this.text.length,c=this.text.length-1;c>=0&&c>=a&&ni[this.text.charCodeAt(c)];c--)b--;this.text=this.text.substring(a,b),this.sectionIndex=this.sectionIndex.slice(a,b)},li.prototype.substring=function(a,b){var c=new li();return c.text=this.text.substring(a,b),c.sectionIndex=this.sectionIndex.slice(a,b),c.sections=this.sections,c},li.prototype.toString=function(){return this.text},li.prototype.getMaxScale=function(){var a=this;return this.sectionIndex.reduce(function(b,c){return Math.max(b,a.sections[c].scale)},0)};var ni={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oi={};function pi(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function qi(a,b,c){var d=0;return 10===a&&(d-=1e4),c&&(d+=150),40!==a&&65288!==a||(d+=50),41!==b&&65289!==b||(d+=50),d}function ri(a,b,c,d,e,f){for(var g=null,h=pi(b,c,e,f),k=0,d=d;k<d.length;k+=1){var i=d[k],j=pi(b-i.x,c,e,f)+i.badness;j<=h&&(g=i,h=j)}return{index:a,x:b,priorBreak:g,badness:h}}function si(a,b,c,d){if(!c)return[];if(!a)return[];for(var j,e=[],c=function(a,b,c,d){for(var e=0,f=0;f<a.length();f++){var g=a.getSection(f),h=d[g.fontStack];h=h&&h[a.getCharCode(f)];h&&(e+=h.metrics.advance*g.scale+b)}return e/Math.max(1,Math.ceil(e/c))}(a,b,c,d),f=a.text.indexOf("\u200b")>=0,k=0,g=0;g<a.length();g++){var h=a.getSection(g),i=a.getCharCode(g),j=d[h.fontStack];j=j&&j[i];if(j&&!ni[i]&&(k+=j.metrics.advance*h.scale+b),g<a.length()-1){h=!!(!((j=i)<11904)&&($["Bopomofo Extended"](j)||$.Bopomofo(j)||$["CJK Compatibility Forms"](j)||$["CJK Compatibility Ideographs"](j)||$["CJK Compatibility"](j)||$["CJK Radicals Supplement"](j)||$["CJK Strokes"](j)||$["CJK Symbols and Punctuation"](j)||$["CJK Unified Ideographs Extension A"](j)||$["CJK Unified Ideographs"](j)||$["Enclosed CJK Letters and Months"](j)||$["Halfwidth and Fullwidth Forms"](j)||$.Hiragana(j)||$["Ideographic Description Characters"](j)||$["Kangxi Radicals"](j)||$["Katakana Phonetic Extensions"](j)||$.Katakana(j)||$["Vertical Forms"](j)||$["Yi Radicals"](j)||$["Yi Syllables"](j)));(oi[i]||h)&&e.push(ri(g+1,k,c,e,qi(i,a.getCharCode(g+1),h&&f),!1))}}return function a(b){return b?a(b.priorBreak).concat(b.index):[]}(ri(a.length(),k,c,e,0,!0))}function ti(a){var b=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":b=1;break;case"left":case"top-left":case"bottom-left":b=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:b,verticalAlign:c}}function ui(a,b,c,d,e){if(e){var f=a[d];b=b[f.fontStack];b=b&&b[f.glyph];if(b)for(var b=b.metrics.advance*f.scale,f=(a[d].x+b)*e,b=c;b<=d;b++)a[b].x-=f}}function vi(a,b,c){c=ti(c);var d=c.horizontalAlign;c=c.verticalAlign;var e=b[0];b=b[1];e=e-a.displaySize[0]*d;d=e+a.displaySize[0];b=b-a.displaySize[1]*c;return{image:a,top:b,bottom:b+a.displaySize[1],left:e,right:d}}function wi(a,b,c,d,e){if(void 0===b.segment)return!0;for(var f=b,b=b.segment+1,g=0;g>-c/2;){if(--b<0)return!1;g-=a[b].dist(f),f=a[b]}g+=a[b].dist(a[b+1]),b++;for(var f=[],h=0;g<c/2;){var i=a[b-1],j=a[b],k=a[b+1];if(!k)return!1;i=i.angleTo(j)-j.angleTo(k);for(i=Math.abs((i+3*Math.PI)%(2*Math.PI)-Math.PI),f.push({distance:g,angleDelta:i}),h+=i;g-f[0].distance>d;)h-=f.shift().angleDelta;if(h>e)return!1;b++,g+=j.dist(k)}return!0}function xi(a){for(var b=0,c=0;c<a.length-1;c++)b+=a[c].dist(a[c+1]);return b}function yi(a,b,c){return a?.6*b*c:0}function zi(a,b){return Math.max(a?a.right-a.left:0,b?b.right-b.left:0)}function Ai(a,b,c,d,e,f){for(var e=yi(c,e,f),c=zi(c,d)*f,d=0,f=xi(a)/2,g=0;g<a.length-1;g++){var h=a[g],i=a[g+1],j=h.dist(i);if(d+j>f){var k=(f-d)/j,l=Eb(h.x,i.x,k);k=Eb(h.y,i.y,k);l=new Xg(l,k,i.angleTo(h),g);return l._round(),!e||wi(a,l,c,e,b)?l:void 0}d+=j}}function Bi(a,b,c,d,e,f,g,h,k){var i=yi(d,f,g);d=zi(d,e);e=d*g;var j=0===a[0].x||a[0].x===k||0===a[0].y||a[0].y===k;return b-e<b/4&&(b=e+b/4),function a(b,c,d,e,f,g,h,C,i){var j=g/2,k=xi(b),l=0;c=c-d;var m=[];for(var v=0;v<b.length-1;v++){for(var w=b[v],x=b[v+1],y=w.dist(x),z=x.angleTo(w);c+d<l+y;){var A=((c+=d)-l)/y,B=Eb(w.x,x.x,A);A=Eb(w.y,x.y,A);if(B>=0&&B<i&&A>=0&&A<i&&c-j>=0&&c+j<=k){B=new Xg(B,A,z,v);B._round(),e&&!wi(b,B,g,e,f)||m.push(B)}}l+=y}C||m.length||h||(m=a(b,l/2,d,e,f,g,h,!0,i));return m}(a,j?b/2*h%b:(d/2+2*f)*g*h%b,b,i,c,e,j,!1,k)}oi[10]=!0,oi[32]=!0,oi[38]=!0,oi[40]=!0,oi[41]=!0,oi[43]=!0,oi[45]=!0,oi[47]=!0,oi[173]=!0,oi[183]=!0,oi[8203]=!0,oi[8208]=!0,oi[8211]=!0,oi[8231]=!0;var Ci=function(a,b,c,d,f,g,h,s,i,j,k,l){var p=h.top*s-i,q=h.bottom*s+i,r=h.left*s-i;h=h.right*s+i;if(this.boxStartIndex=a.length,j){i=q-p;j=h-r;i>0&&(i=Math.max(10*s,i),this._addLineCollisionCircles(a,b,c,c.segment,j,i,d,f,g,k))}else{if(l){s=new e(r,p);b=new e(h,p);j=new e(r,q);i=new e(h,q);k=l*Math.PI/180;s._rotate(k),b._rotate(k),j._rotate(k),i._rotate(k),r=Math.min(s.x,b.x,j.x,i.x),h=Math.max(s.x,b.x,j.x,i.x),p=Math.min(s.y,b.y,j.y,i.y),q=Math.max(s.y,b.y,j.y,i.y)}a.emplaceBack(c.x,c.y,r,p,h,q,d,f,g,0,0)}this.boxEndIndex=a.length};Ci.prototype._addLineCollisionCircles=function(a,b,c,d,e,f,g,h,z,i){var j=f/2,k=Math.floor(e/j)||1;i=1+.4*Math.log(i)/Math.LN2;i=Math.floor(k*i/2);var l=-f/2;c=c;d=d+1;var m=l,o=-e/2,p=o-e/4;do{if(--d<0){if(m>o)return;d=0;break}m-=b[d].dist(c),c=b[d]}while(m>p);for(var c=b[d].dist(b[d+1]),p=-i;p<k+i;p++){var t=p*j,u=o+t;if(t<0&&(u+=t),t>e&&(u+=t-e),!(u<m)){for(;m+c<u;){if(m+=c,++d+1>=b.length)return;c=b[d].dist(b[d+1])}t=u-m;var x=b[d];t=b[d+1].sub(x)._unit()._mult(t)._add(x)._round();x=Math.abs(u-l)<j?0:.8*(u-l);a.emplaceBack(t.x,t.y,-f/2,-f/2,f/2,f/2,g,h,z,f/2,x)}}};var Di=function(a,b){if(void 0===a&&(a=[]),void 0===b&&(b=Ei),this.data=a,this.length=this.data.length,this.compare=b,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};function Ei(a,b){return a<b?-1:a>b?1:0}function Fi(a,b,c){void 0===b&&(b=1),void 0===c&&(c=!1);for(var d=1/0,f=1/0,g=-1/0,h=-1/0,l=a[0],i=0;i<l.length;i++){var j=l[i];(!i||j.x<d)&&(d=j.x),(!i||j.y<f)&&(f=j.y),(!i||j.x>g)&&(g=j.x),(!i||j.y>h)&&(h=j.y)}j=g-d;i=h-f;l=Math.min(j,i);j=l/2;i=new Di([],Gi);if(0===l)return new e(d,f);for(var d=d;d<g;d+=l)for(var k=f;k<h;k+=l)i.push(new Hi(d+j,k+j,j,a));for(var k=function(a){for(var b=0,c=0,d=0,e=a[0],f=0,g=e.length,h=g-1;f<g;h=f++){var k=e[f],i=e[h],j=k.x*i.y-i.x*k.y;c+=(k.x+i.x)*j,d+=(k.y+i.y)*j,b+=3*j}return new Hi(c/b,d/b,0,a)}(a),f=i.length;i.length;){l=i.pop();(l.d>k.d||!k.d)&&(k=l,c&&!1),l.max-k.d<=b||(j=l.h/2,i.push(new Hi(l.p.x-j,l.p.y-j,j,a)),i.push(new Hi(l.p.x+j,l.p.y-j,j,a)),i.push(new Hi(l.p.x-j,l.p.y+j,j,a)),i.push(new Hi(l.p.x+j,l.p.y+j,j,a)),f+=4)}return c&&(!1,!1),k.p}function Gi(a,b){return b.max-a.max}function Hi(a,b,c,d){this.p=new e(a,b),this.h=c,this.d=function(a,b){for(var c=!1,d=1/0,e=0;e<b.length;e++)for(var f=b[e],g=0,h=f.length,k=h-1;g<h;k=g++){var i=f[g],j=f[k];i.y>a.y!=j.y>a.y&&a.x<(j.x-i.x)*(a.y-i.y)/(j.y-i.y)+i.x&&(c=!c),d=Math.min(d,ff(a,i,j))}return(c?1:-1)*Math.sqrt(d)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}Di.prototype.push=function(a){this.data.push(a),this.length++,this._up(this.length-1)},Di.prototype.pop=function(){if(0!==this.length){var a=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),a}},Di.prototype.peek=function(){return this.data[0]},Di.prototype._up=function(a){for(var b=this.data,c=this.compare,d=b[a];a>0;){var e=a-1>>1,f=b[e];if(c(d,f)>=0)break;b[a]=f,a=e}b[a]=d},Di.prototype._down=function(a){for(var b=this.data,c=this.compare,d=this.length>>1,e=b[a];a<d;){var f=1+(a<<1),g=b[f],h=f+1;if(h<this.length&&c(b[h],g)<0&&(f=h,g=b[h]),c(g,e)>=0)break;b[a]=g,a=f}b[a]=e};qf=b(function(a){a.exports=function(a,b){var c,d,e,f,g,i,h;for(c=3&a.length,d=a.length-c,b=b,f=3432918353,g=461845907,h=0;h<d;)i=255&a.charCodeAt(h)|(255&a.charCodeAt(++h))<<8|(255&a.charCodeAt(++h))<<16|(255&a.charCodeAt(++h))<<24,++h,b=27492+(65535&(e=5*(65535&(b=(b^=(65535&(i=(i=(65535&i)*f+(((i>>>16)*f&65535)<<16)&4294967295)<<15|i>>>17))*g+(((i>>>16)*g&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(e>>>16)&65535)<<16);switch(i=0,c){case 3:i^=(255&a.charCodeAt(h+2))<<16;case 2:i^=(255&a.charCodeAt(h+1))<<8;case 1:b^=(65535&(i=(i=(65535&(i^=255&a.charCodeAt(h)))*f+(((i>>>16)*f&65535)<<16)&4294967295)<<15|i>>>17))*g+(((i>>>16)*g&65535)<<16)&4294967295}return b^=a.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}});kc=b(function(a){a.exports=function(a,b){for(var c,d=a.length,b=b^d,e=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(e)|(255&a.charCodeAt(++e))<<8|(255&a.charCodeAt(++e))<<16|(255&a.charCodeAt(++e))<<24))+((1540483477*(c>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16),d-=4,++e;switch(d){case 3:b^=(255&a.charCodeAt(e+2))<<16;case 2:b^=(255&a.charCodeAt(e+1))<<8;case 1:b=1540483477*(65535&(b^=255&a.charCodeAt(e)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}});var Ii=qf;Gf=qf;Y=kc;Ii.murmur3=Gf,Ii.murmur2=Y;var Ji=7;function Ki(a,b){var c=0,d=0,e=b/Math.sqrt(2);switch(a){case"top-right":case"top-left":d=e-Ji;break;case"bottom-right":case"bottom-left":d=-e+Ji;break;case"bottom":d=-b+Ji;break;case"top":d=b-Ji}switch(a){case"top-right":case"bottom-right":c=-e;break;case"top-left":case"bottom-left":c=e;break;case"left":c=b;break;case"right":c=-b}return[c,d]}function Li(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mi(a,b,c,d,f,g,h){var da=g.layoutTextSize.evaluate(b,{}),i=g.layoutIconSize.evaluate(b,{}),j=g.textMaxSize.evaluate(b,{});void 0===j&&(j=da);var k=a.layers[0].layout,l=k.get("icon-offset").evaluate(b,{}),I=Pi(c.horizontal);da=da/24;var J=a.tilePixelRatio*da;da=a.tilePixelRatio*j/24;var K=a.tilePixelRatio*i;j=a.tilePixelRatio*k.get("symbol-spacing");var L=k.get("text-padding")*a.tilePixelRatio,M=k.get("icon-padding")*a.tilePixelRatio;i=k.get("text-max-angle")/180*Math.PI;var N="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),O="map"===k.get("icon-rotation-alignment")&&"point"!==k.get("symbol-placement");k=k.get("symbol-placement");var P=j/2,aa=function(j,i){i.x<0||i.x>=Ue||i.y<0||i.y>=Ue||(function(a,b,c,d,f,g,h,ja,i,j,k,l,I,J,K,L,M,N,O,P,aa){var Q,R,S=a.addToLineVertexArray(b,c),T=0,ba=0,ca=0,da={},ea=Ii(""),fa=(g.layout.get("text-radial-offset").evaluate(O,{})||0)*ji;for(var ga in d.horizontal){var ha=d.horizontal[ga];if(!Q){ea=Ii(ha.text);var ia=g.layout.get("text-rotate").evaluate(O,{});Q=new Ci(h,c,b,ja,i,j,ha,k,l,I,a.overscaling,ia)}ia=1===ha.lineCount;if(ba+=Oi(a,b,ha,g,I,O,J,S,d.vertical?ki.horizontal:ki.horizontalOnly,ia?Object.keys(d.horizontal):[ga],da,P,aa),ia)break}d.vertical&&(ca+=Oi(a,b,d.vertical,g,I,O,J,S,ki.vertical,["vertical"],da,P,aa));ha=Q?Q.boxStartIndex:a.collisionBoxArray.length;ia=Q?Q.boxEndIndex:a.collisionBoxArray.length;if(f){l=function(a,b,c,d,f,g){a=b.image;d=c.layout;var h=b.top-1/a.pixelRatio,i=b.left-1/a.pixelRatio,j=b.bottom+1/a.pixelRatio;b=b.right+1/a.pixelRatio;if("none"!==d.get("icon-text-fit")&&f){var k=b-i,l=j-h,p=d.get("text-size").evaluate(g,{})/24,w=f.left*p,x=f.right*p,y=f.top*p;x=x-w;f=f.bottom*p-y;p=d.get("icon-text-fit-padding")[0];var E=d.get("icon-text-fit-padding")[1],F=d.get("icon-text-fit-padding")[2],G=d.get("icon-text-fit-padding")[3],H="width"===d.get("icon-text-fit")?.5*(f-l):0,I="height"===d.get("icon-text-fit")?.5*(x-k):0;x="width"===d.get("icon-text-fit")||"both"===d.get("icon-text-fit")?x:k;k="height"===d.get("icon-text-fit")||"both"===d.get("icon-text-fit")?f:l;d=new e(w+I-G,y+H-p),f=new e(w+I+E+x,y+H-p),l=new e(w+I+E+x,y+H+F+k),p=new e(w+I-G,y+H+F+k)}else d=new e(i,h),f=new e(b,h),l=new e(b,j),p=new e(i,j);E=c.layout.get("icon-rotate").evaluate(g,{})*Math.PI/180;if(E){x=Math.sin(E);w=Math.cos(E);I=[w,-x,x,w];d._matMult(I),f._matMult(I),p._matMult(I),l._matMult(I)}return[{tl:d,tr:f,bl:p,br:l,tex:a.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,f,g,0,Pi(d.horizontal),O);I=g.layout.get("icon-rotate").evaluate(O,{});R=new Ci(h,c,b,ja,i,j,f,K,L,!1,a.overscaling,I),T=4*l.length;J=a.iconSizeData;P=null;"source"===J.kind?(P=[Yg*g.layout.get("icon-size").evaluate(O,{})])[0]>Ni&&v(a.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'):"composite"===J.kind&&((P=[Yg*aa.compositeIconSizes[0].evaluate(O,{}),Yg*aa.compositeIconSizes[1].evaluate(O,{})])[0]>Ni||P[1]>Ni)&&v(a.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".'),a.addSymbols(a.icon,l,P,N,M,O,!1,b,S.lineStartIndex,S.lineLength)}d=R?R.boxStartIndex:a.collisionBoxArray.length;h=R?R.boxEndIndex:a.collisionBoxArray.length;a.glyphOffsetArray.length>=hh.MAX_GLYPHS&&v("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");a.symbolInstances.emplaceBack(b.x,b.y,da.right>=0?da.right:-1,da.center>=0?da.center:-1,da.left>=0?da.left:-1,da.vertical||-1,ea,ha,ia,d,h,ja,ba,ca,T,0,k,fa)})(a,i,j,c,d,a.layers[0],a.collisionBoxArray,b.index,b.sourceLayerIndex,a.index,J,L,N,h,K,M,O,l,b,f,g)};if("line"===k)for(var Q=0,R=function(a,b,c,d,f){for(var g=[],h=0;h<a.length;h++)for(var m=a[h],i=void 0,j=0;j<m.length-1;j++){var k=m[j],l=m[j+1];k.x<b&&l.x<b||(k.x<b?k=new e(b,k.y+(l.y-k.y)*((b-k.x)/(l.x-k.x)))._round():l.x<b&&(l=new e(b,k.y+(l.y-k.y)*((b-k.x)/(l.x-k.x)))._round()),k.y<c&&l.y<c||(k.y<c?k=new e(k.x+(l.x-k.x)*((c-k.y)/(l.y-k.y)),c)._round():l.y<c&&(l=new e(k.x+(l.x-k.x)*((c-k.y)/(l.y-k.y)),c)._round()),k.x>=d&&l.x>=d||(k.x>=d?k=new e(d,k.y+(l.y-k.y)*((d-k.x)/(l.x-k.x)))._round():l.x>=d&&(l=new e(d,k.y+(l.y-k.y)*((d-k.x)/(l.x-k.x)))._round()),k.y>=f&&l.y>=f||(k.y>=f?k=new e(k.x+(l.x-k.x)*((f-k.y)/(l.y-k.y)),f)._round():l.y>=f&&(l=new e(k.x+(l.x-k.x)*((f-k.y)/(l.y-k.y)),f)._round()),i&&k.equals(i[i.length-1])||(i=[k],g.push(i)),i.push(l)))))}return g}(b.geometry,0,0,Ue,Ue);Q<R.length;Q+=1)for(var S=R[Q],T=0,ba=Bi(S,j,i,c.vertical||I,d,24,da,a.overscaling,Ue);T<ba.length;T+=1){var ca=ba[T];I&&Qi(a,I.text,P,ca)||aa(S,ca)}else if("line-center"===k)for(var ca=0,S=b.geometry;ca<S.length;ca+=1){T=S[ca];if(T.length>1){ba=Ai(T,i,c.vertical||I,d,24,da);ba&&aa(T,ba)}}else if("Polygon"===b.type)for(var Q=0,R=fg(b.geometry,0);Q<R.length;Q+=1){j=R[Q];P=Fi(j,16);aa(j[0],new Xg(P.x,P.y,0))}else if("LineString"===b.type)for(var k=0,T=b.geometry;k<T.length;k+=1){ba=T[k];aa(ba,new Xg(ba[0].x,ba[0].y,0))}else if("Point"===b.type)for(var S=0,ca=b.geometry;S<ca.length;S+=1)for(var i=0,I=ca[S];i<I.length;i+=1){da=I[i];aa([da],new Xg(da.x,da.y,0))}}var Ni=65535;function Oi(a,b,c,d,f,g,h,w,i,j,k,l,n){c=function(a,b,c,d,f,g,h){for(var a=d.layout.get("text-rotate").evaluate(g,{})*Math.PI/180,d=b.positionedGlyphs,g=[],i=0;i<d.length;i++){var j=d[i],k=h[j.fontStack];k=k&&k[j.glyph];if(k){var l=k.rect;if(l){var n=Rh+1,u=k.metrics.advance*j.scale/2,v=f?[j.x+u,j.y]:[0,0],w=f?[0,0]:[j.x+u+c[0],j.y+c[1]],y=(k.metrics.left-n)*j.scale-u+w[0];k=(-k.metrics.top-n)*j.scale+w[1];n=y+l.w*j.scale;w=k+l.h*j.scale;var z=new e(y,k);k=new e(n,k);y=new e(y,w);n=new e(n,w);if(f&&j.vertical){w=new e(-u,u);j=-Math.PI/2;u=new e(5,0);z._rotateAround(j,w)._add(u),k._rotateAround(j,w)._add(u),y._rotateAround(j,w)._add(u),n._rotateAround(j,w)._add(u)}if(a){j=Math.sin(a);w=Math.cos(a);u=[w,-j,j,w];z._matMult(u),k._matMult(u),y._matMult(u),n._matMult(u)}g.push({tl:z,tr:k,bl:y,br:n,tex:l,writingMode:b.writingMode,glyphOffset:v})}}}return g}(0,c,h,d,f,g,l);l=a.textSizeData;var u=null;"source"===l.kind?(u=[Yg*d.layout.get("text-size").evaluate(g,{})])[0]>Ni&&v(a.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'):"composite"===l.kind&&((u=[Yg*n.compositeTextSizes[0].evaluate(g,{}),Yg*n.compositeTextSizes[1].evaluate(g,{})])[0]>Ni||u[1]>Ni)&&v(a.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".'),a.addSymbols(a.text,c,u,h,f,g,i,b,w.lineStartIndex,w.lineLength);for(var d=0,l=j;d<l.length;d+=1)k[l[d]]=a.text.placedSymbolArray.length-1;return 4*c.length}function Pi(a){for(var b in a)return a[b];return null}function Qi(a,b,c,d){a=a.compareText;if(b in a){for(var e=a[b],f=e.length-1;f>=0;f--)if(d.dist(e[f])<c)return!0}else a[b]=[];return a[b].push(d),!1}a.Actor=rc,a.AlphaImage=zf,a.CanonicalTileID=ai,a.CollisionBoxArray=qe,a.Color=fb,a.DEMData=je,a.DataConstantProperty=X,a.DictionaryCoder=fi,a.EXTENT=Ue,a.ErrorEvent=Ka,a.EvaluationParameters=Nd,a.Event=Ja,a.Evented=La,a.FeatureIndex=rf,a.FillBucket=jg,a.FillExtrusionBucket=yg,a.ImageAtlas=hc,a.ImagePosition=oh,a.LineBucket=Lg,a.LngLat=Uh,a.LngLatBounds=Th,a.MercatorCoordinate=$h,a.ONE_EM=ji,a.OverscaledTileID=ci,a.Point=e,a.Point$1=e,a.ProgramConfiguration=Qe,a.Properties=oc,a.Protobuf=wh,a.RGBAImage=Af,a.RequestManager=D,a.ResourceType=wa,a.SegmentVector=Ce,a.SourceFeatureState=fd,a.StructArrayLayout1ui2=me,a.StructArrayLayout2i4=Zd,a.StructArrayLayout2ui4=le,a.StructArrayLayout3ui6=ke,a.StructArrayLayout4i8=$d,a.SymbolBucket=hh,a.Texture=th,a.Tile=tf,a.Transitionable=Qd,a.Uniform1f=Ge,a.Uniform1i=ed,a.Uniform2f=nd,a.Uniform3f=ld,a.Uniform4f=He,a.UniformColor=Ie,a.UniformMatrix4f=ud,a.UnwrappedTileID=bi,a.ValidationError=V,a.WritingMode=ki,a.ZoomHistory=Ad,a.addDynamicAttributes=eh,a.asyncAll=function(a,b,c){if(!a.length)return c(null,[]);var d=a.length,e=new Array(a.length),f=null;a.forEach(function(a,g){b(a,function(a,b){a&&(f=a),e[g]=b,0==--d&&c(f,e)})})},a.bezier=h,a.bindAll=p,a.browser=G,a.cacheEntryPossiblyAdded=function(a){++va>qa&&(a.send("enforceCacheSizeLimit",pa),va=0)},a.clamp=i,a.clearTileCache=function(a){var b=self.caches["delete"](oa);a&&b["catch"](a).then(function(){return a()})},a.clone=function(a){var b=new of(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},a.clone$1=t,a.config=H,a.create=function(){var a=new of(16);return of!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},a.create$1=pf,a.create$2=function(){var a=new of(4);return of!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},a.createCommonjsModule=b,a.createExpression=Hc,a.createLayout=Xd,a.createStyleLayer=function(a){return"custom"===a.type?new lh(a):new mh[a.type](a)},a.deepEqual=g,a.ease=d,a.emitValidationErrors=rd,a.endsWith=q,a.enforceCacheSizeLimit=function(a){self.caches&&self.caches.open(oa).then(function(b){b.keys().then(function(c){for(var d=0;d<c.length-a;d++)b["delete"](c[d])})})},a.evaluateRadialOffset=Ki,a.evaluateSizeForFeature=$g,a.evaluateSizeForZoom=ah,a.evented=Ld,a.extend=k,a.featureFilter=Uc,a.filterObject=s,a.fromRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);return a[0]=b,a[1]=c,a[2]=0,a[3]=-c,a[4]=b,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},a.getAnchorAlignment=ti,a.getAnchorJustification=Li,a.getArrayBuffer=Ca,a.getImage=Ga,a.getJSON=function(a,b){return Ba(k(a,{type:"json"}),b)},a.getReferrer=za,a.getVideo=function(a,b){var c,d,e=self.document.createElement("video");e.muted=!0,e.onloadstart=function(){b(null,e)};for(var f=0;f<a.length;f++){var g=self.document.createElement("source");c=a[f],void 0,(d=self.document.createElement("a")).href=c,(d.protocol!==self.document.location.protocol||d.host!==self.document.location.host)&&(e.crossOrigin="Anonymous"),g.src=a[f],e.appendChild(g)}return{cancel:function(){}}},a.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},a.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],T=b[6],i=b[7],j=b[8],k=b[9],l=b[10],q=b[11],E=b[12],F=b[13],G=b[14];b=b[15];var H=c*h-d*g,I=c*T-e*g,J=c*i-f*g,K=d*T-e*h,L=d*i-f*h,M=e*i-f*T,N=j*F-k*E,O=j*G-l*E,P=j*b-q*E,aa=k*G-l*F,Q=k*b-q*F,R=l*b-q*G,S=H*R-I*Q+J*aa+K*P-L*O+M*N;return S?(S=1/S,a[0]=(h*R-T*Q+i*aa)*S,a[1]=(e*Q-d*R-f*aa)*S,a[2]=(F*M-G*L+b*K)*S,a[3]=(l*L-k*M-q*K)*S,a[4]=(T*P-g*R-i*O)*S,a[5]=(c*R-e*P+f*O)*S,a[6]=(G*J-E*M-b*I)*S,a[7]=(j*M-l*J+q*I)*S,a[8]=(g*Q-h*P+i*N)*S,a[9]=(d*P-c*Q-f*N)*S,a[10]=(E*L-F*J+b*H)*S,a[11]=(k*J-j*L-q*H)*S,a[12]=(h*O-g*aa-T*N)*S,a[13]=(c*aa-d*O+e*N)*S,a[14]=(F*I-E*K-G*H)*S,a[15]=(j*K-k*I+l*H)*S,a):null},a.isChar=$,a.isMapboxURL=P,a.keysDifference=function(a,b){var c=[];for(var d in a)d in b||c.push(d);return c},a.makeRequest=Ba,a.mapObject=r,a.mercatorXfromLng=Wh,a.mercatorYfromLat=Xh,a.mercatorZfromAltitude=Yh,a.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],E=b[5],i=b[6],j=b[7],k=b[8],l=b[9],r=b[10],w=b[11],x=b[12],y=b[13],z=b[14];b=b[15];var A=c[0],B=c[1],C=c[2],D=c[3];return a[0]=A*d+B*h+C*k+D*x,a[1]=A*e+B*E+C*l+D*y,a[2]=A*f+B*i+C*r+D*z,a[3]=A*g+B*j+C*w+D*b,A=c[4],B=c[5],C=c[6],D=c[7],a[4]=A*d+B*h+C*k+D*x,a[5]=A*e+B*E+C*l+D*y,a[6]=A*f+B*i+C*r+D*z,a[7]=A*g+B*j+C*w+D*b,A=c[8],B=c[9],C=c[10],D=c[11],a[8]=A*d+B*h+C*k+D*x,a[9]=A*e+B*E+C*l+D*y,a[10]=A*f+B*i+C*r+D*z,a[11]=A*g+B*j+C*w+D*b,A=c[12],B=c[13],C=c[14],D=c[15],a[12]=A*d+B*h+C*k+D*x,a[13]=A*e+B*E+C*l+D*y,a[14]=A*f+B*i+C*r+D*z,a[15]=A*g+B*j+C*w+D*b,a},a.mvt=ug,a.number=Eb,a.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),j=1/(d-e),i=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*j,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*i,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*j,a[14]=(g+f)*i,a[15]=1,a},a.parseGlyphPBF=function(a){return new wh(a).readFields(Oh,[])},a.pbf=wh,a.performSymbolLayout=function(a,b,c,d,e,f){a.createArrays();var g=512*a.overscaling;a.tilePixelRatio=Ue/g,a.compareText={},a.iconsNeedLinear=!1;g=a.layers[0].layout;var S=a.layers[0]._unevaluatedLayout._values,h={};if("composite"===a.textSizeData.kind){var i=a.textSizeData,j=i.minZoom;i=i.maxZoom;h.compositeTextSizes=[S["text-size"].possiblyEvaluate(new Nd(j)),S["text-size"].possiblyEvaluate(new Nd(i))]}if("composite"===a.iconSizeData.kind){j=a.iconSizeData;i=j.minZoom;j=j.maxZoom;h.compositeIconSizes=[S["icon-size"].possiblyEvaluate(new Nd(i)),S["icon-size"].possiblyEvaluate(new Nd(j))]}h.layoutTextSize=S["text-size"].possiblyEvaluate(new Nd(a.zoom+1)),h.layoutIconSize=S["icon-size"].possiblyEvaluate(new Nd(a.zoom+1)),h.textMaxSize=S["text-size"].possiblyEvaluate(new Nd(18));for(var i=g.get("text-line-height")*ji,j="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),S=g.get("text-keep-upright"),k=0,l=a.features;k<l.length;k+=1){var m=l[k],n=g.get("text-font").evaluate(m,{}).join(","),o=c,p={horizontal:{},vertical:void 0},q=m.text,r=[0,0];if(q){var D=q.toString(),H=g.get("text-letter-spacing").evaluate(m,{})*ji;H=Cd(D)?H:0;var J=g.get("text-anchor").evaluate(m,{}),N=g.get("text-variable-anchor"),O=g.get("text-radial-offset").evaluate(m,{});N||(r=O?Ki(J,O*ji):g.get("text-offset").evaluate(m,{}).map(function(a){return a*ji}));O=j?"center":g.get("text-justify").evaluate(m,{});var P="point"===g.get("symbol-placement")?g.get("text-max-width").evaluate(m,{})*ji:0;if(!j&&N)for(var N="auto"===O?N.map(function(a){return Li(a)}):[O],aa=!1,Q=0;Q<N.length;Q++){var R=N[Q];if(!p.horizontal[R])if(aa)p.horizontal[R]=p.horizontal[0];else{var T=mi(q,b,n,P,i,"center",R,H,r,ki.horizontal);T&&(p.horizontal[R]=T,aa=1===T.lineCount)}}else{"auto"===O&&(O=Li(J));R=mi(q,b,n,P,i,J,O,H,r,ki.horizontal);R&&(p.horizontal[O]=R),Bd(D)&&j&&S&&(p.vertical=mi(q,b,n,P,i,J,O,H,r,ki.vertical))}}T=void 0;if(m.icon){aa=d[m.icon];aa&&(T=vi(e[m.icon],g.get("icon-offset").evaluate(m,{}),g.get("icon-anchor").evaluate(m,{})),void 0===a.sdfIcons?a.sdfIcons=aa.sdf:a.sdfIcons!==aa.sdf&&v("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),aa.pixelRatio!==a.pixelRatio?a.iconsNeedLinear=!0:0!==g.get("icon-rotate").constantOr(1)&&(a.iconsNeedLinear=!0))}(Object.keys(p.horizontal).length||T)&&Mi(a,m,p,T,o,h,r)}f&&a.generateCollisionDebugBuffers()},a.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);return a[0]=b/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=e&&e!==1/0?(c=1/(d-e),a[10]=(e+d)*c,a[14]=2*e*d*c):(a[10]=-1,a[14]=-2*d),a},a.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c},a.plugin=Md,a.polygonIntersectsPolygon=Ze,a.postMapLoadEvent=na,a.postTurnstileEvent=la,a.potpack=nh,a.rasterBoundsAttributes=ei,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=Z,a.registerForPluginAvailability=function(a){return Jd?a({pluginURL:Jd,completionCallback:Hd}):Ld.once("pluginAvailable",a),a},a.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];var g=Math.sin(c);c=Math.cos(c);return a[0]=d*c+f*g,a[1]=e*c+b*g,a[2]=d*-g+f*c,a[3]=e*-g+b*c,a},a.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],f=b[5],g=b[6],l=b[7],h=b[8],i=b[9],j=b[10],k=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=e*c+h*d,a[5]=f*c+i*d,a[6]=g*c+j*d,a[7]=l*c+k*d,a[8]=h*c-e*d,a[9]=i*c-f*d,a[10]=j*c-g*d,a[11]=k*c-l*d,a},a.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],f=b[1],g=b[2],l=b[3],h=b[4],i=b[5],j=b[6],k=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=e*c+h*d,a[1]=f*c+i*d,a[2]=g*c+j*d,a[3]=l*c+k*d,a[4]=h*c-e*d,a[5]=i*c-f*d,a[6]=j*c-g*d,a[7]=k*c-l*d,a},a.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*c,a[9]=b[9]*c,a[10]=b[10]*c,a[11]=b[11]*c,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},a.setCacheLimits=function(a,b){pa=a,qa=b},a.setRTLTextPlugin=function(a,b){if(Id)throw new Error("setRTLTextPlugin cannot be called multiple times.");Id=!0,Jd=G.resolveURL(a),Hd=function(a){a?(Id=!1,Jd=null,b&&b(a)):Kd=!0},Ld.fire(new Ja("pluginAvailable",{pluginURL:Jd,completionCallback:Hd}))},a.sphericalToCartesian=function(a){var b=a[0],c=a[1];a=a[2];return c+=90,c*=Math.PI/180,a*=Math.PI/180,{x:b*Math.cos(c)*Math.sin(a),y:b*Math.sin(c)*Math.sin(a),z:b*Math.cos(a)}},a.styleSpec=U,a.symbolSize=rg,a.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];return a[0]=d*c[0]+e*c[3]+b*c[6],a[1]=d*c[1]+e*c[4]+b*c[7],a[2]=d*c[2]+e*c[5]+b*c[8],a},a.transformMat4=sf,a.translate=function(a,b,c){var d,e,f,g,h,u,i,j,k,l,q,r,s=c[0],t=c[1];c=c[2];return b===a?(a[12]=b[0]*s+b[4]*t+b[8]*c+b[12],a[13]=b[1]*s+b[5]*t+b[9]*c+b[13],a[14]=b[2]*s+b[6]*t+b[10]*c+b[14],a[15]=b[3]*s+b[7]*t+b[11]*c+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],u=b[5],i=b[6],j=b[7],k=b[8],l=b[9],q=b[10],r=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=u,a[6]=i,a[7]=j,a[8]=k,a[9]=l,a[10]=q,a[11]=r,a[12]=d*s+h*t+k*c+b[12],a[13]=e*s+u*t+l*c+b[13],a[14]=f*s+i*t+q*c+b[14],a[15]=g*s+j*t+r*c+b[15]),a},a.uniqueId=m,a.validateCustomStyleLayer=function(a){var b=[],c=a.id;return void 0===c&&b.push({message:"layers."+c+': missing required property "id"'}),void 0===a.render&&b.push({message:"layers."+c+': missing required method "render"'}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&b.push({message:"layers."+c+': property "renderingMode" must be either "2d" or "3d"'}),b},a.validateLight=ic,a.validateStyle=od,a.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},a.vectorTile=ug,a.version="1.1.1",a.warnOnce=v,a.webpSupported=I,a.window=self,a.wrap=j});a(["./shared.js"],function(a){function b(a){var c=typeof a;if("number"===c||"boolean"===c||"string"===c||null==a)return JSON.stringify(a);if(Array.isArray(a)){for(var c="[",d=0,e=a;d<e.length;d+=1)c+=b(e[d])+",";return c+"]"}for(var d=Object.keys(a).sort(),e="{",c=0;c<d.length;c++)e+=JSON.stringify(d[c])+":"+b(a[d[c]])+",";return e+"}"}function c(c){for(var d="",e=0,f=a.refProperties;e<f.length;e+=1)d+="/"+b(c[f[e]]);return d}var d=function(a){this.keyCache={},a&&this.replace(a)};d.prototype.replace=function(a){this._layerConfigs={},this._layers={},this.update(a,[])},d.prototype.update=function(b,d){for(var e=this,f=0,b=b;f<b.length;f+=1){var g=b[f];this._layerConfigs[g.id]=g;var h=this._layers[g.id]=a.createStyleLayer(g);h._featureFilter=a.featureFilter(h.filter),this.keyCache[g.id]&&delete this.keyCache[g.id]}for(var h=0,g=d;h<g.length;h+=1){b=g[h];delete this.keyCache[b],delete this._layerConfigs[b],delete this._layers[b]}this.familiesBySource={};for(var f=0,d=function(a,b){for(var d={},e=0;e<a.length;e++){var f=b&&b[a[e].id]||c(a[e]);b&&(b[a[e].id]=f);var g=d[f];g||(g=d[f]=[]),g.push(a[e])}f=[];for(var h in d)f.push(d[h]);return f}(a.values(this._layerConfigs),this.keyCache);f<d.length;f+=1){b=d[f].map(function(a){return e._layers[a.id]});g=b[0];if("none"!==g.visibility){h=g.source||"";var i=this.familiesBySource[h];i||(i=this.familiesBySource[h]={});h=g.sourceLayer||"_geojsonTileLayer";g=i[h];g||(g=i[h]=[]),g.push(b)}}};var e=function(b){var c={},d=[];for(var e in b){var f=b[e],g=c[e]={};for(var h in f){var i=f[+h];if(i&&0!==i.bitmap.width&&0!==i.bitmap.height){var j={x:0,y:0,w:i.bitmap.width+2,h:i.bitmap.height+2};d.push(j),g[h]={rect:j,metrics:i.metrics}}}}j=a.potpack(d);i=j.w;g=j.h;f=new a.AlphaImage({width:i||1,height:g||1});for(var k in b){d=b[k];for(var l in d){j=d[+l];if(j&&0!==j.bitmap.width&&0!==j.bitmap.height){i=c[k][l].rect;a.AlphaImage.copy(j.bitmap,f,{x:0,y:0},{x:i.x+1,y:i.y+1},j.bitmap)}}}this.image=f,this.positions=c};a.register("GlyphAtlas",e);var f=function(b){this.tileID=new a.OverscaledTileID(b.tileID.overscaledZ,b.tileID.wrap,b.tileID.canonical.z,b.tileID.canonical.x,b.tileID.canonical.y),this.uid=b.uid,this.zoom=b.zoom,this.pixelRatio=b.pixelRatio,this.tileSize=b.tileSize,this.source=b.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=b.showCollisionBoxes,this.collectResourceTiming=!!b.collectResourceTiming,this.returnDependencies=!!b.returnDependencies};function g(b,c){for(var c=new a.EvaluationParameters(c),d=0,b=b;d<b.length;d+=1)b[d].recalculate(c)}f.prototype.parse=function(b,c,d,f){var h=this;this.status="parsing",this.data=b,this.collisionBoxArray=new a.CollisionBoxArray();var i=new a.DictionaryCoder(Object.keys(b.layers).sort()),j=new a.FeatureIndex(this.tileID);j.bucketLayerIDs=[];var k,l,q,x,y={},A={featureIndex:j,iconDependencies:{},patternDependencies:{},glyphDependencies:{}};c=c.familiesBySource[this.source];for(var B in c){var C=b.layers[B];if(C){1===C.version&&a.warnOnce('Vector tile source "'+this.source+'" layer "'+B+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var D=i.encode(B),E=[],F=0;F<C.length;F++){var G=C.feature(F);E.push({feature:G,index:F,sourceLayerIndex:D})}for(var G=0,F=c[B];G<F.length;G+=1){C=F[G];var H=C[0];H.minzoom&&this.zoom<Math.floor(H.minzoom)||!(H.maxzoom&&this.zoom>=H.maxzoom)&&("none"!==H.visibility&&(g(C,this.zoom),(y[H.id]=H.createBucket({index:j.bucketLayerIDs.length,layers:C,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:D,sourceID:this.source})).populate(E,A),j.bucketLayerIDs.push(C.map(function(a){return a.id}))))}}}H=a.mapObject(A.glyphDependencies,function(a){return Object.keys(a).map(Number)});Object.keys(H).length?d.send("getGlyphs",{uid:this.uid,stacks:H},function(a,b){k||(k=a,l=b,I.call(h))}):l={};C=Object.keys(A.iconDependencies);C.length?d.send("getImages",{icons:C},function(a,b){k||(k=a,q=b,I.call(h))}):q={};F=Object.keys(A.patternDependencies);function I(){if(k)return f(k);if(l&&q&&x){var b=new e(l),c=new a.ImageAtlas(q,x);for(var d in y){var h=y[d];h instanceof a.SymbolBucket?(g(h.layers,this.zoom),a.performSymbolLayout(h,l,b.positions,q,c.iconPositions,this.showCollisionBoxes)):h.hasPattern&&(h instanceof a.LineBucket||h instanceof a.FillBucket||h instanceof a.FillExtrusionBucket)&&(g(h.layers,this.zoom),h.addFeatures(A,c.patternPositions))}this.status="done",f(null,{buckets:a.values(y).filter(function(a){return!a.isEmpty()}),featureIndex:j,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:c,glyphMap:this.returnDependencies?l:null,iconMap:this.returnDependencies?q:null,glyphPositions:this.returnDependencies?b.positions:null})}}F.length?d.send("getImages",{icons:F},function(a,b){k||(k=a,x=b,I.call(h))}):x={},I.call(this)};var h="undefined"!=typeof performance,i={getEntriesByName:function(a){return!!(h&&performance&&performance.getEntriesByName)&&performance.getEntriesByName(a)},mark:function(a){return!!(h&&performance&&performance.mark)&&performance.mark(a)},measure:function(a,b,c){return!!(h&&performance&&performance.measure)&&performance.measure(a,b,c)},clearMarks:function(a){return!!(h&&performance&&performance.clearMarks)&&performance.clearMarks(a)},clearMeasures:function(a){return!!(h&&performance&&performance.clearMeasures)&&performance.clearMeasures(a)}},j=function(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},i.mark(this._marks.start)};function k(b,c){var d=a.getArrayBuffer(b.request,function(b,d,e,f){b?c(b):d&&c(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(d)),rawData:d,cacheControl:e,expires:f})});return function(){d.cancel(),c()}}j.prototype.finish=function(){i.mark(this._marks.end);var a=i.getEntriesByName(this._marks.measure);return 0===a.length&&(i.measure(this._marks.measure,this._marks.start,this._marks.end),a=i.getEntriesByName(this._marks.measure),i.clearMarks(this._marks.start),i.clearMarks(this._marks.end),i.clearMeasures(this._marks.measure)),a},i.Performance=j;var l=function(a,b,c){this.actor=a,this.layerIndex=b,this.loadVectorData=c||k,this.loading={},this.loaded={}};l.prototype.loadTile=function(b,c){var d=this,e=b.uid;this.loading||(this.loading={});var g=!!(b&&b.request&&b.request.collectResourceTiming)&&new i.Performance(b.request),h=this.loading[e]=new f(b);h.abort=this.loadVectorData(b,function(b,f){if(delete d.loading[e],b||!f)return h.status="done",d.loaded[e]=h,c(b);var i=f.rawData,j={};f.expires&&(j.expires=f.expires),f.cacheControl&&(j.cacheControl=f.cacheControl);var k={};if(g){b=g.finish();b&&(k.resourceTiming=JSON.parse(JSON.stringify(b)))}h.vectorTile=f.vectorTile,h.parse(f.vectorTile,d.layerIndex,d.actor,function(b,d){if(b||!d)return c(b);c(null,a.extend({rawTileData:i.slice(0)},d,j,k))}),d.loaded=d.loaded||{},d.loaded[e]=h})},l.prototype.reloadTile=function(a,b){var c=this.loaded,d=a.uid,e=this;if(c&&c[d]){var f=c[d];f.showCollisionBoxes=a.showCollisionBoxes;c=function(a,c){var d=f.reloadCallback;d&&(delete f.reloadCallback,f.parse(f.vectorTile,e.layerIndex,e.actor,d)),b(a,c)};"parsing"===f.status?f.reloadCallback=c:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.actor,c):c())}},l.prototype.abortTile=function(a,b){var c=this.loading;a=a.uid;c&&c[a]&&c[a].abort&&(c[a].abort(),delete c[a]),b()},l.prototype.removeTile=function(a,b){var c=this.loaded;a=a.uid;c&&c[a]&&delete c[a],b()};var m=function(){this.loaded={}};m.prototype.loadTile=function(b,c){var d=b.uid,e=b.encoding;b=b.rawImageData;b=new a.DEMData(d,b,e);this.loaded=this.loaded||{},this.loaded[d]=b,c(null,b)},m.prototype.removeTile=function(a){var b=this.loaded;a=a.uid;b&&b[a]&&delete b[a]};var n={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function o(a){var b=0;if(a&&a.length>0){b+=Math.abs(p(a[0]));for(var c=1;c<a.length;c++)b-=Math.abs(p(a[c]))}return b}function p(a){var b,c,d,e,f=0,g=a.length;if(g>2){for(e=0;e<g;e++)e===g-2?(b=g-2,c=g-1,d=0):e===g-1?(b=g-1,c=0,d=1):(b=e,c=e+1,d=e+2),b=a[b],c=a[c],f+=(q(a[d][0])-q(b[0]))*Math.sin(q(c[1]));f=f*n.RADIUS*n.RADIUS/2}return f}function q(a){return a*Math.PI/180}var r={geometry:function a(b){var c,d=0;switch(b.type){case"Polygon":return o(b.coordinates);case"MultiPolygon":for(c=0;c<b.coordinates.length;c++)d+=o(b.coordinates[c]);return d;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(c=0;c<b.geometries.length;c++)d+=a(b.geometries[c]);return d}},ring:p},s=function a(b,c){switch(b&&b.type||null){case"FeatureCollection":return b.features=b.features.map(t(a,c)),b;case"GeometryCollection":return b.geometries=b.geometries.map(t(a,c)),b;case"Feature":return b.geometry=a(b.geometry,c),b;case"Polygon":case"MultiPolygon":return function(a,b){"Polygon"===a.type?a.coordinates=u(a.coordinates,b):"MultiPolygon"===a.type&&(a.coordinates=a.coordinates.map(t(u,b)));return a}(b,c);default:return b}};function t(a,b){return function(c){return a(c,b)}}function u(a,b){b=!!b,a[0]=v(a[0],b);for(var c=1;c<a.length;c++)a[c]=v(a[c],!b);return a}function v(a,b){return function(a){return r.ring(a)>=0}(a)===b?a:a.reverse()}var w=a.vectorTile.VectorTileFeature.prototype.toGeoJSON,x=function(b){this._feature=b,this.extent=a.EXTENT,this.type=b.type,this.properties=b.tags,"id"in b&&!isNaN(b.id)&&(this.id=parseInt(b.id,10))};x.prototype.loadGeometry=function(){if(1===this._feature.type){for(var b=[],c=0,d=this._feature.geometry;c<d.length;c+=1){var e=d[c];b.push([new a.Point$1(e[0],e[1])])}return b}for(var e=[],d=0,c=this._feature.geometry;d<c.length;d+=1){for(var b=[],f=0,g=c[d];f<g.length;f+=1){var h=g[f];b.push(new a.Point$1(h[0],h[1]))}e.push(b)}return e},x.prototype.toGeoJSON=function(a,b,c){return w.call(this,a,b,c)};var y=function(b){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=b.length,this._features=b};y.prototype.feature=function(a){return new x(this._features[a])};j=a.vectorTile.VectorTileFeature;var z=A;function A(a,b){this.options=b||{},this.features=a,this.length=a.length}function B(a,b){this.id="number"==typeof a.id?a.id:void 0,this.type=a.type,this.rawGeometry=1===a.type?[a.geometry]:a.geometry,this.properties=a.tags,this.extent=b||4096}A.prototype.feature=function(a){return new B(this.features[a],this.options.extent)},B.prototype.loadGeometry=function(){var b=this.rawGeometry;this.geometry=[];for(var c=0;c<b.length;c++){for(var d=b[c],e=[],f=0;f<d.length;f++)e.push(new a.Point$1(d[f][0],d[f][1]));this.geometry.push(e)}return this.geometry},B.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,b=1/0,c=-1/0,d=1/0,e=-1/0,f=0;f<a.length;f++)for(var g=a[f],h=0;h<g.length;h++){var i=g[h];b=Math.min(b,i.x),c=Math.max(c,i.x),d=Math.min(d,i.y),e=Math.max(e,i.y)}return[b,d,c,e]},B.prototype.toGeoJSON=j.prototype.toGeoJSON;var C=E;A=E;j=function(a,b){b=b||{};var c={};for(var d in a)c[d]=new z(a[d].features,b),c[d].name=d,c[d].version=b.version,c[d].extent=b.extent;return E({layers:c})};var D=z;function E(b){var c=new a.pbf();return function(a,b){for(var c in a.layers)b.writeMessage(3,F,a.layers[c])}(b,c),c.finish()}function F(a,b){var c;b.writeVarintField(15,a.version||1),b.writeStringField(1,a.name||""),b.writeVarintField(5,a.extent||4096);var d={keys:[],values:[],keycache:{},valuecache:{}};for(c=0;c<a.length;c++)d.feature=a.feature(c),b.writeMessage(2,G,d);a=d.keys;for(c=0;c<a.length;c++)b.writeStringField(3,a[c]);a=d.values;for(c=0;c<a.length;c++)b.writeMessage(4,L,a[c])}function G(a,b){var c=a.feature;void 0!==c.id&&b.writeVarintField(1,c.id),b.writeMessage(2,H,a),b.writeVarintField(3,c.type),b.writeMessage(4,K,c)}function H(a,b){var c=a.feature,d=a.keys,e=a.values,f=a.keycache;a=a.valuecache;for(var g in c.properties){var h=f[g];void 0===h&&(d.push(g),h=d.length-1,f[g]=h),b.writeVarint(h);h=c.properties[g];var i=typeof h;"string"!==i&&"boolean"!==i&&"number"!==i&&(h=JSON.stringify(h));i=i+":"+h;var j=a[i];void 0===j&&(e.push(h),j=e.length-1,a[i]=j),b.writeVarint(j)}}function I(a,b){return(b<<3)+(7&a)}function J(a){return a<<1^a>>31}function K(a,b){for(var c=a.loadGeometry(),a=a.type,d=0,e=0,f=c.length,g=0;g<f;g++){var h=c[g],i=1;1===a&&(i=h.length),b.writeVarint(I(1,i));for(var i=3===a?h.length-1:h.length,j=0;j<i;j++){1===j&&1!==a&&b.writeVarint(I(2,i-1));var k=h[j].x-d,l=h[j].y-e;b.writeVarint(J(k)),b.writeVarint(J(l)),d+=k,e+=l}3===a&&b.writeVarint(I(7,1))}}function L(a,b){var c=typeof a;"string"===c?b.writeStringField(1,a):"boolean"===c?b.writeBooleanField(7,a):"number"===c&&(a%1!=0?b.writeDoubleField(3,a):a<0?b.writeSVarintField(6,a):b.writeVarintField(5,a))}function M(a,b,c,d,e,f){if(!(e-d<=c)){var g=d+e>>1;!function a(b,c,d,e,f,g){for(;f>e;){if(f-e>600){var h=f-e+1,i=d-e+1,j=Math.log(h),k=.5*Math.exp(2*j/3);j=.5*Math.sqrt(j*k*(h-k)/h)*(i-h/2<0?-1:1);var l=Math.max(e,Math.floor(d-i*k/h+j));i=Math.min(f,Math.floor(d+(h-i)*k/h+j));a(b,c,d,l,i,g)}k=c[2*d+g];h=e;j=f;for(N(b,c,e,d),c[2*f+g]>k&&N(b,c,e,f);h<j;){for(N(b,c,h,j),h++,j--;c[2*h+g]<k;)h++;for(;c[2*j+g]>k;)j--}c[2*e+g]===k?N(b,c,e,j):N(b,c,++j,f),j<=d&&(e=j+1),d<=j&&(f=j-1)}}(a,b,g,d,e,f%2),M(a,b,c,d,g-1,f+1),M(a,b,c,g+1,e,f+1)}}function N(a,b,c,d){O(a,c,d),O(b,2*c,2*d),O(b,2*c+1,2*d+1)}function O(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function P(a,b,c,d){a=a-c;c=b-d;return a*a+c*c}C.fromVectorTileJs=A,C.fromGeojsonVt=j,C.GeoJSONWrapper=D;var aa=function(a){return a[0]},Q=function(a){return a[1]},R=function(a,b,c,d,e){void 0===b&&(b=aa),void 0===c&&(c=Q),void 0===d&&(d=64),void 0===e&&(e=Float64Array),this.nodeSize=d,this.points=a;for(var f=a.length<65536?Uint16Array:Uint32Array,f=this.ids=new f(a.length),e=this.coords=new e(2*a.length),g=0;g<a.length;g++)f[g]=g,e[2*g]=b(a[g]),e[2*g+1]=c(a[g]);M(f,e,d,0,f.length-1,0)};R.prototype.range=function(a,b,c,d){return function(a,b,c,d,e,f,g){for(var h,i,j=[0,a.length-1,0],k=[];j.length;){var l=j.pop(),p=j.pop(),r=j.pop();if(p-r<=g)for(var s=r;s<=p;s++)h=b[2*s],i=b[2*s+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[s]);else{s=Math.floor((r+p)/2);h=b[2*s],i=b[2*s+1],h>=c&&h<=e&&i>=d&&i<=f&&k.push(a[s]);var t=(l+1)%2;(0===l?c<=h:d<=i)&&(j.push(r),j.push(s-1),j.push(t)),(0===l?e>=h:f>=i)&&(j.push(s+1),j.push(p),j.push(t))}}return k}(this.ids,this.coords,a,b,c,d,this.nodeSize)},R.prototype.within=function(a,b,c){return function(a,b,c,d,e,f){for(var g=[0,a.length-1,0],h=[],i=e*e;g.length;){var j=g.pop(),k=g.pop(),l=g.pop();if(k-l<=f)for(var n=l;n<=k;n++)P(b[2*n],b[2*n+1],c,d)<=i&&h.push(a[n]);else{n=Math.floor((l+k)/2);var r=b[2*n],s=b[2*n+1];P(r,s,c,d)<=i&&h.push(a[n]);var t=(j+1)%2;(0===j?c-e<=r:d-e<=s)&&(g.push(l),g.push(n-1),g.push(t)),(0===j?c+e>=r:d+e>=s)&&(g.push(n+1),g.push(k),g.push(t))}}return h}(this.ids,this.coords,a,b,c,this.nodeSize)};var S={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,map:function(a){return a}},T=function(a){this.options=ha(Object.create(S),a),this.trees=new Array(this.options.maxZoom+1)};function ba(a,b,c,d,e){return{x:a,y:b,zoom:1/0,id:c,parentId:-1,numPoints:d,properties:e}}function ca(a,b){a=a.geometry.coordinates;var c=a[0];a=a[1];return{x:fa(c),y:ga(a),zoom:1/0,index:b,parentId:-1}}function da(a){return{type:"Feature",id:a.id,properties:ea(a),geometry:{type:"Point",coordinates:[(b=a.x,360*(b-.5)),(b=a.y,a=(180-360*b)*Math.PI/180,360*Math.atan(Math.exp(a))/Math.PI-90)]}};var b}function ea(a){var b=a.numPoints,c=b>=1e4?Math.round(b/1e3)+"k":b>=1e3?Math.round(b/100)/10+"k":b;return ha(ha({},a.properties),{cluster:!0,cluster_id:a.id,point_count:b,point_count_abbreviated:c})}function fa(a){return a/360+.5}function ga(a){a=Math.sin(a*Math.PI/180);a=.5-.25*Math.log((1+a)/(1-a))/Math.PI;return a<0?0:a>1?1:a}function ha(a,b){for(var c in b)a[c]=b[c];return a}function ia(a){return a.x}function ja(a){return a.y}function ka(a,b,c,d,e,f){var g=e-c,h=f-d;if(0!==g||0!==h){var i=((a-c)*g+(b-d)*h)/(g*g+h*h);i>1?(c=e,d=f):i>0&&(c+=g*i,d+=h*i)}return(g=a-c)*g+(h=b-d)*h}function la(a,b,c,d){a={id:void 0===a?null:a,type:b,geometry:c,tags:d,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(a){var b=a.geometry,c=a.type;if("Point"===c||"MultiPoint"===c||"LineString"===c)ma(a,b);else if("Polygon"===c||"MultiLineString"===c)for(var d=0;d<b.length;d++)ma(a,b[d]);else if("MultiPolygon"===c)for(d=0;d<b.length;d++)for(var c=0;c<b[d].length;c++)ma(a,b[d][c])}(a),a}function ma(a,b){for(var c=0;c<b.length;c+=3)a.minX=Math.min(a.minX,b[c]),a.minY=Math.min(a.minY,b[c+1]),a.maxX=Math.max(a.maxX,b[c]),a.maxY=Math.max(a.maxY,b[c+1])}function na(a,b,c,d){if(b.geometry){var e=b.geometry.coordinates,f=b.geometry.type,g=Math.pow(c.tolerance/((1<<c.maxZoom)*c.extent),2),h=[],i=b.id;if(c.promoteId?i=b.properties[c.promoteId]:c.generateId&&(i=d||0),"Point"===f)oa(e,h);else if("MultiPoint"===f)for(var j=0;j<e.length;j++)oa(e[j],h);else if("LineString"===f)pa(e,h,g,!1);else if("MultiLineString"===f){if(c.lineMetrics){for(j=0;j<e.length;j++)h=[],pa(e[j],h,g,!1),a.push(la(i,"LineString",h,b.properties));return}qa(e,h,g,!1)}else if("Polygon"===f)qa(e,h,g,!0);else{if("MultiPolygon"!==f){if("GeometryCollection"===f){for(j=0;j<b.geometry.geometries.length;j++)na(a,{id:i,geometry:b.geometry.geometries[j],properties:b.properties},c,d);return}throw new Error("Input data is not a valid GeoJSON object.")}for(j=0;j<e.length;j++){d=[];qa(e[j],d,g,!0),h.push(d)}}a.push(la(i,f,h,b.properties))}}function oa(a,b){b.push(ra(a[0])),b.push(sa(a[1])),b.push(0)}function pa(a,b,c,d){for(var e,f,g=0,h=0;h<a.length;h++){var i=ra(a[h][0]),j=sa(a[h][1]);b.push(i),b.push(j),b.push(0),h>0&&(g+=d?(e*j-i*f)/2:Math.sqrt(Math.pow(i-e,2)+Math.pow(j-f,2))),e=i,f=j}i=b.length-3;b[2]=1,(function a(b,c,d,e){for(var f,g=e,h=d-c>>1,i=d-c,j=b[c],k=b[c+1],l=b[d],p=b[d+1],q=c+3;q<d;q+=3){var r=ka(b[q],b[q+1],j,k,l,p);if(r>g)f=q,g=r;else if(r===g){r=Math.abs(q-h);r<i&&(f=q,i=r)}}g>e&&(f-c>3&&a(b,c,f,e),b[f+2]=g,d-f>3&&a(b,f,d,e))})(b,0,i,c),b[i+2]=1,b.size=Math.abs(g),b.start=0,b.end=b.size}function qa(a,b,c,d){for(var e=0;e<a.length;e++){var f=[];pa(a[e],f,c,d),b.push(f)}}function ra(a){return a/360+.5}function sa(a){a=Math.sin(a*Math.PI/180);a=.5-.25*Math.log((1+a)/(1-a))/Math.PI;return a<0?0:a>1?1:a}function ta(a,b,c,d,e,f,g,h){if(d/=b,f>=(c/=b)&&g<d)return a;if(g<c||f>=d)return null;for(var b=[],g=0;g<a.length;g++){f=a[g];var i=f.geometry,j=f.type,k=0===e?f.minX:f.minY,l=0===e?f.maxX:f.maxY;if(k>=c&&l<d)b.push(f);else if(!(l<c||k>=d)){l=[];if("Point"===j||"MultiPoint"===j)ua(i,l,c,d,e);else if("LineString"===j)va(i,l,c,d,e,!1,h.lineMetrics);else if("MultiLineString"===j)xa(i,l,c,d,e,!1);else if("Polygon"===j)xa(i,l,c,d,e,!0);else if("MultiPolygon"===j)for(var k=0;k<i.length;k++){var p=[];xa(i[k],p,c,d,e,!0),p.length&&l.push(p)}if(l.length){if(h.lineMetrics&&"LineString"===j){for(k=0;k<l.length;k++)b.push(la(f.id,j,l[k],f.tags));continue}"LineString"!==j&&"MultiLineString"!==j||(1===l.length?(j="LineString",l=l[0]):j="MultiLineString"),"Point"!==j&&"MultiPoint"!==j||(j=3===l.length?"Point":"MultiPoint"),b.push(la(f.id,j,l,f.tags))}}}return b.length?b:null}function ua(a,b,c,d,e){for(var f=0;f<a.length;f+=3){var g=a[f+e];g>=c&&g<=d&&(b.push(a[f]),b.push(a[f+1]),b.push(a[f+2]))}}function va(a,b,c,d,e,f,g){for(var h,i,j=wa(a),k=0===e?za:Aa,l=a.start,v=0;v<a.length-3;v+=3){var w=a[v],x=a[v+1],y=a[v+2],z=a[v+3],A=a[v+4],B=0===e?w:x,C=0===e?z:A,D=!1;g&&(h=Math.sqrt(Math.pow(w-z,2)+Math.pow(x-A,2))),B<c?C>c&&(i=k(j,w,x,z,A,c),g&&(j.start=l+h*i)):B>d?C<d&&(i=k(j,w,x,z,A,d),g&&(j.start=l+h*i)):ya(j,w,x,y),C<c&&B>=c&&(i=k(j,w,x,z,A,c),D=!0),C>d&&B<=d&&(i=k(j,w,x,z,A,d),D=!0),!f&&D&&(g&&(j.end=l+h*i),b.push(j),j=wa(a)),g&&(l+=h)}C=a.length-3;w=a[C],x=a[C+1],y=a[C+2],(B=0===e?w:x)>=c&&B<=d&&ya(j,w,x,y),C=j.length-3,f&&C>=3&&(j[C]!==j[0]||j[C+1]!==j[1])&&ya(j,j[0],j[1],j[2]),j.length&&b.push(j)}function wa(a){var b=[];return b.size=a.size,b.start=a.start,b.end=a.end,b}function xa(a,b,c,d,e,f){for(var g=0;g<a.length;g++)va(a[g],b,c,d,e,f,!1)}function ya(a,b,c,d){a.push(b),a.push(c),a.push(d)}function za(a,b,c,d,e,f){d=(f-b)/(d-b);return a.push(f),a.push(c+(e-c)*d),a.push(1),d}function Aa(a,b,c,d,e,f){e=(f-c)/(e-c);return a.push(b+(d-b)*e),a.push(f),a.push(1),e}function Ba(a,b){for(var c=[],d=0;d<a.length;d++){var e,f=a[d],g=f.type;if("Point"===g||"MultiPoint"===g||"LineString"===g)e=Ca(f.geometry,b);else if("MultiLineString"===g||"Polygon"===g){e=[];for(var h=0;h<f.geometry.length;h++)e.push(Ca(f.geometry[h],b))}else if("MultiPolygon"===g)for(e=[],h=0;h<f.geometry.length;h++){for(var i=[],j=0;j<f.geometry[h].length;j++)i.push(Ca(f.geometry[h][j],b));e.push(i)}c.push(la(f.id,g,e,f.tags))}return c}function Ca(a,b){var c=[];c.size=a.size,void 0!==a.start&&(c.start=a.start,c.end=a.end);for(var d=0;d<a.length;d+=3)c.push(a[d]+b,a[d+1],a[d+2]);return c}function Da(a,b){if(a.transformed)return a;var c,d,e=1<<a.z,f=a.x,g=a.y;for(c=0;c<a.features.length;c++){var h=a.features[c],i=h.geometry,j=h.type;if(h.geometry=[],1===j)for(j=0;j<i.length;j+=2)h.geometry.push(Ea(i[j],i[j+1],b,e,f,g));else for(j=0;j<i.length;j++){var k=[];for(d=0;d<i[j].length;d+=2)k.push(Ea(i[j][d],i[j][d+1],b,e,f,g));h.geometry.push(k)}}return a.transformed=!0,a}function Ea(a,b,c,d,e,f){return[Math.round(c*(a*d-e)),Math.round(c*(b*d-f))]}function Fa(a,b,c,d,e){for(var f=b===e.maxZoom?0:e.tolerance/((1<<b)*e.extent),c={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:c,y:d,z:b,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},d=0;d<a.length;d++){c.numFeatures++,Ga(c,a[d],f,e);b=a[d].minX;var g=a[d].minY,h=a[d].maxX,i=a[d].maxY;b<c.minX&&(c.minX=b),g<c.minY&&(c.minY=g),h>c.maxX&&(c.maxX=h),i>c.maxY&&(c.maxY=i)}return c}function Ga(a,b,c,d){var e=b.geometry,f=b.type,g=[];if("Point"===f||"MultiPoint"===f)for(var h=0;h<e.length;h+=3)g.push(e[h]),g.push(e[h+1]),a.numPoints++,a.numSimplified++;else if("LineString"===f)Ha(g,e,a,c,!1,!1);else if("MultiLineString"===f||"Polygon"===f)for(h=0;h<e.length;h++)Ha(g,e[h],a,c,"Polygon"===f,0===h);else if("MultiPolygon"===f)for(var i=0;i<e.length;i++){var j=e[i];for(h=0;h<j.length;h++)Ha(g,j[h],a,c,!0,0===h)}if(g.length){j=b.tags||null;if("LineString"===f&&d.lineMetrics){for(var k in j={},b.tags)j[k]=b.tags[k];j.mapbox_clip_start=e.start/e.size,j.mapbox_clip_end=e.end/e.size}c={geometry:g,type:"Polygon"===f||"MultiPolygon"===f?3:"LineString"===f||"MultiLineString"===f?2:1,tags:j};null!==b.id&&(c.id=b.id),a.features.push(c)}}function Ha(a,b,c,d,e,f){var g=d*d;if(d>0&&b.size<(e?g:d))c.numPoints+=b.length/3;else{for(var h=[],i=0;i<b.length;i+=3)(0===d||b[i+2]>g)&&(c.numSimplified++,h.push(b[i]),h.push(b[i+1])),c.numPoints++;e&&(function(a,b){for(var c=0,d=0,e=a.length,f=e-2;d<e;f=d,d+=2)c+=(a[d]-a[f])*(a[d+1]+a[f+1]);if(c>0===b)for(d=0,e=a.length;d<e/2;d+=2){f=a[d];c=a[d+1];a[d]=a[e-2-d],a[d+1]=a[e-1-d],a[e-2-d]=f,a[e-1-d]=c}})(h,f),a.push(h)}}function Ia(a,b){var c=(b=this.options=function(a,b){for(var c in b)a[c]=b[c];return a}(Object.create(this.options),b)).debug;if(c&&console.time("preprocess data"),b.maxZoom<0||b.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(b.promoteId&&b.generateId)throw new Error("promoteId and generateId cannot be used together.");a=function(a,b){var c=[];if("FeatureCollection"===a.type)for(var d=0;d<a.features.length;d++)na(c,a.features[d],b,d);else"Feature"===a.type?na(c,a,b):na(c,{geometry:a},b);return c}(a,b);this.tiles={},this.tileCoords=[],c&&(console.timeEnd("preprocess data"),!1,console.time("generate tiles"),this.stats={},this.total=0),(a=function(a,b){var c=b.buffer/b.extent,d=a,e=ta(a,1,-1-c,c,0,-1,2,b),f=ta(a,1,1-c,2+c,0,-1,2,b);return(e||f)&&(d=ta(a,1,-c,1+c,0,-1,2,b)||[],e&&(d=Ba(e,1).concat(d)),f&&(d=d.concat(Ba(f,-1)))),d}(a,b)).length&&this.splitTile(a,0,0,0),c&&(a.length&&!1,console.timeEnd("generate tiles"),!1)}function Ja(a,b,c){return 32*((1<<a)*c+b)+a}function Ka(a,b){a=a.tileID.canonical;if(!this._geoJSONIndex)return b(null,null);a=this._geoJSONIndex.getTile(a.z,a.x,a.y);if(!a)return b(null,null);a=new y(a.features);var c=C(a);0===c.byteOffset&&c.byteLength===c.buffer.byteLength||(c=new Uint8Array(c)),b(null,{vectorTile:a,rawData:c.buffer})}T.prototype.load=function(a){var b=this.options,c=b.log,d=b.minZoom,e=b.maxZoom;b=b.nodeSize;c&&console.time("total time");var f="prepare "+a.length+" points";c&&console.time(f),this.points=a;for(var g=[],h=0;h<a.length;h++)a[h].geometry&&g.push(ca(a[h],h));this.trees[e+1]=new R(g,ia,ja,b,Float32Array),c&&console.timeEnd(f);for(var a=e;a>=d;a--){h=+Date.now();g=this._cluster(g,a),this.trees[a]=new R(g,ia,ja,b,Float32Array),c&&!1}return c&&console.timeEnd("total time"),this},T.prototype.getClusters=function(a,b){var c=((a[0]+180)%360+360)%360-180,d=Math.max(-90,Math.min(90,a[1])),e=180===a[2]?180:((a[2]+180)%360+360)%360-180,f=Math.max(-90,Math.min(90,a[3]));if(a[2]-a[0]>=360)c=-180,e=180;else if(c>e){a=this.getClusters([c,d,180,f],b);var g=this.getClusters([-180,d,e,f],b);return a.concat(g)}for(var a=this.trees[this._limitZoom(b)],g=[],b=0,c=a.range(fa(c),ga(f),fa(e),ga(d));b<c.length;b+=1){f=c[b];e=a.points[f];g.push(e.numPoints?da(e):this.points[e.index])}return g},T.prototype.getChildren=function(a){var b=a>>5,c=a%32,d="No cluster with the specified id.",e=this.trees[c];if(!e)throw new Error(d);b=e.points[b];if(!b)throw new Error(d);for(var c=this.options.radius/(this.options.extent*Math.pow(2,c-1)),f=[],g=0,b=e.within(b.x,b.y,c);g<b.length;g+=1){c=b[g];c=e.points[c];c.parentId===a&&f.push(c.numPoints?da(c):this.points[c.index])}if(0===f.length)throw new Error(d);return f},T.prototype.getLeaves=function(a,b,c){b=b||10,c=c||0;var d=[];return this._appendLeaves(d,a,b,c,0),d},T.prototype.getTile=function(a,b,c){var d=this.trees[this._limitZoom(a)];a=Math.pow(2,a);var e=this.options,f=e.extent;e=e.radius/f;f=(c-e)/a;var g=(c+1+e)/a,h={features:[]};return this._addTileFeatures(d.range((b-e)/a,f,(b+1+e)/a,g),d.points,b,c,a,h),0===b&&this._addTileFeatures(d.range(1-e/a,f,1,g),d.points,a,c,a,h),b===a-1&&this._addTileFeatures(d.range(0,f,e/a,g),d.points,-1,c,a,h),h.features.length?h:null},T.prototype.getClusterExpansionZoom=function(a){for(var b=a%32-1;b<=this.options.maxZoom;){var c=this.getChildren(a);if(b++,1!==c.length)break;a=c[0].properties.cluster_id}return b},T.prototype._appendLeaves=function(a,b,c,d,e){for(var f=0,b=this.getChildren(b);f<b.length;f+=1){var g=b[f],h=g.properties;if(h&&h.cluster?e+h.point_count<=d?e+=h.point_count:e=this._appendLeaves(a,h.cluster_id,c,d,e):e<d?e++:a.push(g),a.length===c)break}return e},T.prototype._addTileFeatures=function(a,b,c,d,e,f){for(var g=0,a=a;g<a.length;g+=1){var h=b[a[g]],i={type:1,geometry:[[Math.round(this.options.extent*(h.x*e-c)),Math.round(this.options.extent*(h.y*e-d))]],tags:h.numPoints?ea(h):this.points[h.index].properties};h=h.numPoints?h.id:this.points[h.index].id;void 0!==h&&(i.id=h),f.features.push(i)}},T.prototype._limitZoom=function(a){return Math.max(this.options.minZoom,Math.min(a,this.options.maxZoom+1))},T.prototype._cluster=function(a,b){for(var c=[],d=this.options,e=d.radius,f=d.extent,d=d.reduce,e=e/(f*Math.pow(2,b)),f=0;f<a.length;f++){var g=a[f];if(!(g.zoom<=b)){g.zoom=b;for(var h=this.trees[b+1],i=h.within(g.x,g.y,e),j=g.numPoints||1,k=g.x*j,l=g.y*j,s=d?this._map(g,!0):null,u=(f<<5)+(b+1),w=0,i=i;w<i.length;w+=1){var x=i[w];x=h.points[x];if(!(x.zoom<=b)){x.zoom=b;var y=x.numPoints||1;k+=x.x*y,l+=x.y*y,j+=y,x.parentId=u,d&&d(s,this._map(x))}}1===j?c.push(g):(g.parentId=u,c.push(ba(k/j,l/j,u,j,s)))}}return c},T.prototype._map=function(a,b){if(a.numPoints)return b?ha({},a.properties):a.properties;a=this.points[a.index].properties;var c=this.options.map(a);return b&&c===a?ha({},c):c},Ia.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ia.prototype.splitTile=function(a,b,c,d,e,f,g){for(var h=[a,b,c,d],i=this.options,j=i.debug;h.length;){d=h.pop(),c=h.pop(),b=h.pop(),a=h.pop();var k=1<<b,l=Ja(b,c,d),n=this.tiles[l];if(!n&&(j>1&&console.time("creation"),n=this.tiles[l]=Fa(a,b,c,d,i),this.tileCoords.push({z:b,x:c,y:d}),j)){j>1&&(!1,console.timeEnd("creation"));l="z"+b;this.stats[l]=(this.stats[l]||0)+1,this.total++}if(n.source=a,e){if(b===i.maxZoom||b===e)continue;l=1<<e-b;if(c!==Math.floor(f/l)||d!==Math.floor(g/l))continue}else if(b===i.indexMaxZoom||n.numPoints<=i.indexMaxPoints)continue;if(n.source=null,0!==a.length){j>1&&console.time("clipping");var o,v,z,A,B,C;l=.5*i.buffer/i.extent;var D=.5-l,E=.5+l,F=1+l;o=v=z=A=null,B=ta(a,k,c-l,c+E,0,n.minX,n.maxX,i),C=ta(a,k,c+D,c+F,0,n.minX,n.maxX,i),a=null,B&&(o=ta(B,k,d-l,d+E,1,n.minY,n.maxY,i),v=ta(B,k,d+D,d+F,1,n.minY,n.maxY,i),B=null),C&&(z=ta(C,k,d-l,d+E,1,n.minY,n.maxY,i),A=ta(C,k,d+D,d+F,1,n.minY,n.maxY,i),C=null),j>1&&console.timeEnd("clipping"),h.push(o||[],b+1,2*c,2*d),h.push(v||[],b+1,2*c,2*d+1),h.push(z||[],b+1,2*c+1,2*d),h.push(A||[],b+1,2*c+1,2*d+1)}}},Ia.prototype.getTile=function(a,b,c){var d=this.options,e=d.extent;d=d.debug;if(a<0||a>24)return null;var f=1<<a;f=Ja(a,b=(b%f+f)%f,c);if(this.tiles[f])return Da(this.tiles[f],e);d>1&&!1;for(var g,h=a,i=b,j=c;!g&&h>0;)h--,i=Math.floor(i/2),j=Math.floor(j/2),g=this.tiles[Ja(h,i,j)];return g&&g.source?(d>1&&!1,d>1&&console.time("drilling down"),this.splitTile(g.source,h,i,j,a,b,c),d>1&&console.timeEnd("drilling down"),this.tiles[f]?Da(this.tiles[f],e):null):null};var La=function(b){function c(a,c,d){b.call(this,a,c,Ka),d&&(this.loadGeoJSON=d)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadData=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=b,this._pendingLoadDataParams=a,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},c.prototype._loadData=function(){var b=this;if(this._pendingCallback&&this._pendingLoadDataParams){var c=this._pendingCallback,d=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var e=!!(d&&d.request&&d.request.collectResourceTiming)&&new i.Performance(d.request);this.loadGeoJSON(d,function(f,g){if(f||!g)return c(f);if("object"!=typeof g)return c(new Error("Input data given to '"+d.source+"' is not a valid GeoJSON object."));s(g,!0);try{b._geoJSONIndex=d.cluster?new T(function(b){var c=b.superclusterOptions;b=b.clusterProperties;if(!b||!c)return c;for(var d={},e={},f={accumulated:null,zoom:0},g={properties:null},h=Object.keys(b),i=0,j=h;i<j.length;i+=1){var k=j[i],l=b[k],o=l[0];l=l[1];l=a.createExpression(l);o=a.createExpression("string"==typeof o?[o,["accumulated"],["get",k]]:o);d[k]=l.value,e[k]=o.value}return c.map=function(a){g.properties=a;for(var a={},b=0,c=h;b<c.length;b+=1){var e=c[b];a[e]=d[e].evaluate(f,g)}return a},c.reduce=function(a,b){g.properties=b;for(var b=0,c=h;b<c.length;b+=1){var d=c[b];f.accumulated=a[d],a[d]=e[d].evaluate(f,g)}},c}(d)).load(g.features):function(a,b){return new Ia(a,b)}(g,d.geojsonVtOptions)}catch(a){return c(a)}b.loaded={};f={};if(e){g=e.finish();g&&(f.resourceTiming={},f.resourceTiming[d.source]=JSON.parse(JSON.stringify(g)))}c(null,f)})}},c.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},c.prototype.reloadTile=function(a,c){var d=this.loaded,e=a.uid;return d&&d[e]?b.prototype.reloadTile.call(this,a,c):this.loadTile(a,c)},c.prototype.loadGeoJSON=function(b,c){if(b.request)a.getJSON(b.request,c);else{if("string"!=typeof b.data)return c(new Error("Input data given to '"+b.source+"' is not a valid GeoJSON object."));try{return c(null,JSON.parse(b.data))}catch(a){return c(new Error("Input data given to '"+b.source+"' is not a valid GeoJSON object."))}}},c.prototype.removeSource=function(a,b){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),b()},c.prototype.getClusterExpansionZoom=function(a,b){b(null,this._geoJSONIndex.getClusterExpansionZoom(a.clusterId))},c.prototype.getClusterChildren=function(a,b){b(null,this._geoJSONIndex.getChildren(a.clusterId))},c.prototype.getClusterLeaves=function(a,b){b(null,this._geoJSONIndex.getLeaves(a.clusterId,a.limit,a.offset))},c}(l);A=function(b){var c=this;this.self=b,this.actor=new a.Actor(b,this),this.layerIndexes={},this.workerSourceTypes={vector:l,geojson:La},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(a,b){if(c.workerSourceTypes[a])throw new Error('Worker source with name "'+a+'" already registered.');c.workerSourceTypes[a]=b},this.self.registerRTLTextPlugin=function(b){if(a.plugin.isLoaded())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=b.applyArabicShaping,a.plugin.processBidirectionalText=b.processBidirectionalText,a.plugin.processStyledBidirectionalText=b.processStyledBidirectionalText}};return A.prototype.setReferrer=function(a,b){this.referrer=b},A.prototype.setLayers=function(a,b,c){this.getLayerIndex(a).replace(b),c()},A.prototype.updateLayers=function(a,b,c){this.getLayerIndex(a).update(b.layers,b.removedIds),c()},A.prototype.loadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).loadTile(b,c)},A.prototype.loadDEMTile=function(a,b,c){this.getDEMWorkerSource(a,b.source).loadTile(b,c)},A.prototype.reloadTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).reloadTile(b,c)},A.prototype.abortTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).abortTile(b,c)},A.prototype.removeTile=function(a,b,c){this.getWorkerSource(a,b.type,b.source).removeTile(b,c)},A.prototype.removeDEMTile=function(a,b){this.getDEMWorkerSource(a,b.source).removeTile(b)},A.prototype.removeSource=function(a,b,c){if(this.workerSources[a]&&this.workerSources[a][b.type]&&this.workerSources[a][b.type][b.source]){var d=this.workerSources[a][b.type][b.source];delete this.workerSources[a][b.type][b.source],void 0!==d.removeSource?d.removeSource(b,c):c()}},A.prototype.loadWorkerSource=function(a,b,c){try{this.self.importScripts(b.url),c()}catch(a){c(a.toString())}},A.prototype.loadRTLTextPlugin=function(b,c,d){try{a.plugin.isLoaded()||(this.self.importScripts(c),d(a.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+c)))}catch(a){d(a.toString())}},A.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];return b||(b=this.layerIndexes[a]=new d()),b},A.prototype.getWorkerSource=function(a,b,c){var d=this;if(this.workerSources[a]||(this.workerSources[a]={}),this.workerSources[a][b]||(this.workerSources[a][b]={}),!this.workerSources[a][b][c]){var e={send:function(b,c,e){d.actor.send(b,c,e,a)}};this.workerSources[a][b][c]=new this.workerSourceTypes[b](e,this.getLayerIndex(a))}return this.workerSources[a][b][c]},A.prototype.getDEMWorkerSource=function(a,b){return this.demWorkerSources[a]||(this.demWorkerSources[a]={}),this.demWorkerSources[a][b]||(this.demWorkerSources[a][b]=new m()),this.demWorkerSources[a][b]},A.prototype.enforceCacheSizeLimit=function(b,c){a.enforceCacheSizeLimit(c)},"undefined"!=typeof WorkerGlobalScope&&void 0!==a.window&&a.window instanceof WorkerGlobalScope&&(a.window.worker=new A(a.window)),A});a(["./shared.js"],function(a){var b=a.createCommonjsModule(function(a){function b(a){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a,b,c=new Blob([""],{type:"text/javascript"});c=URL.createObjectURL(c);try{b=new Worker(c),a=!0}catch(b){a=!1}b&&b.terminate();return URL.revokeObjectURL(c),a}()&&"Uint8ClampedArray"in window&&ArrayBuffer.isView&&function(a){void 0===c[a]&&(c[a]=function(a){var c=document.createElement("canvas"),d=Object.create(b.webGLContextAttributes);return d.failIfMajorPerformanceCaveat=a,c.probablySupportsContext?c.probablySupportsContext("webgl",d)||c.probablySupportsContext("experimental-webgl",d):c.supportsContext?c.supportsContext("webgl",d)||c.supportsContext("experimental-webgl",d):c.getContext("webgl",d)||c.getContext("experimental-webgl",d)}(a));return c[a]}(a&&a.failIfMajorPerformanceCaveat))}a.exports?a.exports=b:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=b);var c={};b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),c={create:function(b,c,d){b=a.window.document.createElement(b);return void 0!==c&&(b.className=c),d&&d.appendChild(b),b},createNS:function(b,c){return a.window.document.createElementNS(b,c)}},d=a.window.document.documentElement.style;function e(a){if(!d)return a[0];for(var b=0;b<a.length;b++)if(a[b]in d)return a[b];return a[0]}var f,g=e(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);c.disableDrag=function(){d&&g&&(f=d[g],d[g]="none")},c.enableDrag=function(){d&&g&&(d[g]=f)};var h=e(["transform","WebkitTransform"]);c.setTransform=function(a,b){a.style[h]=b};var i=!1;try{e=Object.defineProperty({},"passive",{get:function(){i=!0}});a.window.addEventListener("test",e,e),a.window.removeEventListener("test",e,e)}catch(a){i=!1}c.addEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&i?a.addEventListener(b,c,d):a.addEventListener(b,c,d.capture)},c.removeEventListener=function(a,b,c,d){void 0===d&&(d={}),"passive"in d&&i?a.removeEventListener(b,c,d):a.removeEventListener(b,c,d.capture)};var j=function(b){b.preventDefault(),b.stopPropagation(),a.window.removeEventListener("click",j,!0)};function k(a){var b=a.userImage;return b&&b.render&&b.render()?(a.data.replace(new Uint8Array(b.data.buffer)),!0):!1}c.suppressClick=function(){a.window.addEventListener("click",j,!0),a.window.setTimeout(function(){a.window.removeEventListener("click",j,!0)},0)},c.mousePos=function(b,c){var d=b.getBoundingClientRect();c=a.window.TouchEvent&&c instanceof a.window.TouchEvent?c.touches[0]:c;return new a.Point(c.clientX-d.left-b.clientLeft,c.clientY-d.top-b.clientTop)},c.touchPos=function(b,c){for(var d=b.getBoundingClientRect(),e=[],c="touchend"===c.type?c.changedTouches:c.touches,f=0;f<c.length;f++)e.push(new a.Point(c[f].clientX-d.left-b.clientLeft,c[f].clientY-d.top-b.clientTop));return e},c.mouseButton=function(b){return void 0!==a.window.InstallTrigger&&2===b.button&&b.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button},c.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var l=function(b){function c(){b.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.isLoaded=function(){return this.loaded},c.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var a=0,b=this.requestors;a<b.length;a+=1){var c=b[a],d=c.ids;c=c.callback;this._notify(d,c)}this.requestors=[]}},c.prototype.getImage=function(a){return this.images[a]},c.prototype.addImage=function(a,b){this.images[a]=b},c.prototype.updateImage=function(a,b){var c=this.images[a];b.version=c.version+1,this.images[a]=b,this.updatedImages[a]=!0},c.prototype.removeImage=function(a){var b=this.images[a];delete this.images[a],delete this.patterns[a],b.userImage&&b.userImage.onRemove&&b.userImage.onRemove()},c.prototype.listImages=function(){return Object.keys(this.images)},c.prototype.getImages=function(a,b){var c=!0;if(!this.isLoaded())for(var d=0,e=a;d<e.length;d+=1){var f=e[d];this.images[f]||(c=!1)}this.isLoaded()||c?this._notify(a,b):this.requestors.push({ids:a,callback:b})},c.prototype._notify=function(b,c){for(var d={},e=0,b=b;e<b.length;e+=1){var f=b[e];this.images[f]||this.fire(new a.Event("styleimagemissing",{id:f}));var g=this.images[f];g?d[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,hasRenderCallback:Boolean(g.userImage&&g.userImage.render)}:a.warnOnce('Image "'+f+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}c(null,d)},c.prototype.getPixelSize=function(){var a=this.atlasImage;return{width:a.width,height:a.height}},c.prototype.getPattern=function(b){var c=this.patterns[b],d=this.getImage(b);if(!d)return null;if(c&&c.position.version===d.version)return c.position;if(c)c.position.version=d.version;else{c={w:d.data.width+2,h:d.data.height+2,x:0,y:0};d=new a.ImagePosition(c,d);this.patterns[b]={bin:c,position:d}}return this._updatePatternAtlas(),this.patterns[b].position},c.prototype.bind=function(b){var c=b.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(b,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)},c.prototype._updatePatternAtlas=function(){var b=[];for(var c in this.patterns)b.push(this.patterns[c].bin);b=a.potpack(b);var d=b.w;b=b.h;var e=this.atlasImage;for(var f in e.resize({width:d||1,height:b||1}),this.patterns){d=this.patterns[f].bin;b=d.x+1;d=d.y+1;var g=this.images[f].data,h=g.width,i=g.height;a.RGBAImage.copy(g,e,{x:0,y:0},{x:b,y:d},{width:h,height:i}),a.RGBAImage.copy(g,e,{x:0,y:i-1},{x:b,y:d-1},{width:h,height:1}),a.RGBAImage.copy(g,e,{x:0,y:0},{x:b,y:d+i},{width:h,height:1}),a.RGBAImage.copy(g,e,{x:h-1,y:0},{x:b-1,y:d},{width:1,height:i}),a.RGBAImage.copy(g,e,{x:0,y:0},{x:b+h,y:d},{width:1,height:i})}this.dirty=!0},c.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},c.prototype.dispatchRenderCallbacks=function(a){for(var b=0,a=a;b<a.length;b+=1){var c=a[b];if(!this.callbackDispatchedThisFrame[c]){this.callbackDispatchedThisFrame[c]=!0;var d=this.images[c];k(d)&&this.updateImage(c,d)}}},c}(a.Evented);e=n;var m=1e20;function n(a,b,c,d,e,f){this.fontSize=a||24,this.buffer=void 0===b?3:b,this.cutoff=d||.25,this.fontFamily=e||"sans-serif",this.fontWeight=f||"normal",this.radius=c||8;a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(a,b,c,d,e,f,g){for(var h=0;h<b;h++){for(var i=0;i<c;i++)d[i]=a[i*b+h];for(p(d,e,f,g,c),i=0;i<c;i++)a[i*b+h]=e[i]}for(i=0;i<c;i++){for(h=0;h<b;h++)d[h]=a[i*b+h];for(p(d,e,f,g,b),h=0;h<b;h++)a[i*b+h]=Math.sqrt(e[h])}}function p(a,b,c,d,e){c[0]=0,d[0]=-m,d[1]=+m;for(var f=1,g=0;f<e;f++){for(var h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);h<=d[g];)g--,h=(a[f]+f*f-(a[c[g]]+c[g]*c[g]))/(2*f-2*c[g]);c[++g]=f,d[g]=h,d[g+1]=+m}for(f=0,g=0;f<e;f++){for(;d[g+1]<f;)g++;b[f]=(f-c[g])*(f-c[g])+a[c[g]]}}n.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),b=new Uint8ClampedArray(this.size*this.size),c=0;c<this.size*this.size;c++){var d=a.data[4*c+3]/255;this.gridOuter[c]=1===d?0:0===d?m:Math.pow(Math.max(0,.5-d),2),this.gridInner[c]=1===d?m:0===d?0:Math.pow(Math.max(0,d-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),c=0;c<this.size*this.size;c++){d=this.gridOuter[c]-this.gridInner[c];b[c]=Math.max(0,Math.min(255,Math.round(255-255*(d/this.radius+this.cutoff))))}return b};var q=function(a,b){this.requestManager=a,this.localIdeographFontFamily=b,this.entries={}};q.prototype.setURL=function(a){this.url=a},q.prototype.getGlyphs=function(b,c){var d=this,e=[];for(var f in b)for(var g=0,h=b[f];g<h.length;g+=1){var i=h[g];e.push({stack:f,id:i})}a.asyncAll(e,function(a,b){var c=a.stack,e=a.id,f=d.entries[c];f||(f=d.entries[c]={glyphs:{},requests:{}});a=f.glyphs[e];if(void 0===a)if(a=d._tinySDF(f,c,e))b(null,{stack:c,id:e,glyph:a});else{var g=Math.floor(e/256);if(256*g>65535)b(new Error("glyphs > 65535 not supported"));else{var h=f.requests[g];h||(h=f.requests[g]=[],q.loadGlyphRange(c,g,d.url,d.requestManager,function(a,b){if(b)for(var c in b)f.glyphs[+c]=b[+c];for(var d=0,e=h;d<e.length;d+=1)e[d](a,b);delete f.requests[g]})),h.push(function(a,d){a?b(a):d&&b(null,{stack:c,id:e,glyph:d[e]||null})})}}else b(null,{stack:c,id:e,glyph:a})},function(a,b){if(a)c(a);else if(b){for(var a={},d=0,b=b;d<b.length;d+=1){var e=b[d],f=e.stack,g=e.id;e=e.glyph;(a[f]||(a[f]={}))[g]=e&&{id:e.id,bitmap:e.bitmap.clone(),metrics:e.metrics}}c(null,a)}})},q.prototype._tinySDF=function(b,c,d){var e=this.localIdeographFontFamily;if(e&&(a.isChar["CJK Unified Ideographs"](d)||a.isChar["Hangul Syllables"](d)||a.isChar.Hiragana(d)||a.isChar.Katakana(d))){var f=b.tinySDF;if(!f){var g="400";/bold/i.test(c)?g="900":/medium/i.test(c)?g="500":/light/i.test(c)&&(g="200"),f=b.tinySDF=new q.TinySDF(24,3,8,.25,e,g)}return{id:d,bitmap:new a.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},q.loadGlyphRange=function(b,c,d,e,f){c=256*c;var g=c+255;e=e.transformRequest(e.normalizeGlyphsURL(d).replace("{fontstack}",b).replace("{range}",c+"-"+g),a.ResourceType.Glyphs);a.getArrayBuffer(e,function(b,c){if(b)f(b);else if(c){for(var b={},d=0,c=a.parseGlyphPBF(c);d<c.length;d+=1){var e=c[d];b[e.id]=e}f(null,b)}})},q.TinySDF=e;n=function(){this.specification=a.styleSpec.light.position};n.prototype.possiblyEvaluate=function(b,c){return a.sphericalToCartesian(b.expression.evaluate(c))},n.prototype.interpolate=function(b,c,d){return{x:a.number(b.x,c.x,d),y:a.number(b.y,c.y,d),z:a.number(b.z,c.z,d)}};var r=new a.Properties({anchor:new a.DataConstantProperty(a.styleSpec.light.anchor),position:new n(),color:new a.DataConstantProperty(a.styleSpec.light.color),intensity:new a.DataConstantProperty(a.styleSpec.light.intensity)}),s=function(b){function c(c){b.call(this),this._transitionable=new a.Transitionable(r),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getLight=function(){return this._transitionable.serialize()},c.prototype.setLight=function(b,c){if(void 0===c&&(c={}),!this._validate(a.validateLight,b,c))for(var d in b){c=b[d];a.endsWith(d,"-transition")?this._transitionable.setTransition(d.slice(0,-"-transition".length),c):this._transitionable.setValue(d,c)}},c.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},c.prototype.hasTransition=function(){return this._transitioning.hasTransition()},c.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},c.prototype._validate=function(b,c,d){return(!d||!1!==d.validate)&&a.emitValidationErrors(this,b.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.styleSpec})))},c}(a.Evented),t=function(a,b){this.width=a,this.height=b,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};t.prototype.getDash=function(a,b){var c=a.join(",")+String(b);return this.positions[c]||(this.positions[c]=this.addDash(a,b)),this.positions[c]},t.prototype.addDash=function(b,c){var d=c?7:0,e=2*d+1;if(this.nextRow+e>this.height)return a.warnOnce("LineAtlas out of space"),null;for(var f=0,g=0;g<b.length;g++)f+=b[g];for(var g=this.width/f,h=g/2,y=b.length%2==1,i=-d;i<=d;i++)for(var j=this.nextRow+d+i,j=this.width*j,z=y?-b[b.length-1]:0,k=b[0],l=1,r=0;r<this.width;r++){for(;k<r/g;)z=k,k+=b[l],y&&l===b.length-1&&(k+=b[0]),l++;var s=Math.abs(r-z*g),v=Math.abs(r-k*g);s=Math.min(s,v);v=l%2==1;if(c){var w=d?i/d*(h+1):0;if(v){var x=h-Math.abs(w);x=Math.sqrt(s*s+x*x)}else x=h-Math.sqrt(s*s+w*w)}else x=(v?1:-1)*s;this.data[3+4*(j+r)]=Math.max(0,Math.min(255,x+128))}w={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:f};return this.nextRow+=e,this.dirty=!0,w},t.prototype.bind=function(a){a=a.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data))};var u=function b(c,d){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=a.uniqueId();for(var c=this.workerPool.acquire(this.id),e=0;e<c.length;e++){var f=c[e];f=new b.Actor(f,d,this.id);f.name="Worker "+e,this.actors.push(f)}};function v(b,c,d){var e=function(e,f){if(e)return d(e);if(f){e=a.pick(f,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);f.vector_layers&&(e.vectorLayers=f.vector_layers,e.vectorLayerIds=e.vectorLayers.map(function(a){return a.id})),b.url&&(e.tiles=c.canonicalizeTileset(e,b.url)),d(null,e)}};return b.url?a.getJSON(c.transformRequest(c.normalizeSourceURL(b.url),a.ResourceType.Source),e):a.browser.frame(function(){return e(null,b)})}u.prototype.broadcast=function(b,c,d){d=d||function(){},a.asyncAll(this.actors,function(a,d){a.send(b,c,d)},d)},u.prototype.send=function(a,b,c,d){return("number"!=typeof d||isNaN(d))&&(d=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[d].send(a,b,c),d},u.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},u.Actor=a.Actor;var w=function(b,c,d){this.bounds=a.LngLatBounds.convert(this.validateBounds(b)),this.minzoom=c||0,this.maxzoom=d||24};w.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},w.prototype.contains=function(b){var c=Math.pow(2,b.z),d=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),e=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),f=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c);c=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return b.x>=d&&b.x<f&&b.y>=e&&b.y<c};e=function(b){function c(c,d,e,f){if(b.call(this),this.id=c,this.dispatcher=e,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,a.extend(this,a.pick(d,["url","scheme","tileSize"])),this._options=a.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=v(this._options,this.map._requestManager,function(c,d){b._tileJSONRequest=null,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new w(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles),a.postMapLoadEvent(d.tiles,b.map._getMapId(),b.map._requestManager._skuToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.loadTile=function(b,c){var d=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,null);d={request:this.map._requestManager.transformRequest(d,a.ResourceType.Tile),uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function e(d,e){return b.aborted?c(null):d&&404!==d.status?c(d):(e&&e.resourceTiming&&(b.resourceTiming=e.resourceTiming),this.map._refreshExpiredTiles&&e&&b.setExpiryData(e),b.loadVectorData(e,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void (b.reloadCallback&&(this.loadTile(b,b.reloadCallback),b.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,void 0===b.workerID||"expired"===b.state?b.workerID=this.dispatcher.send("loadTile",d,e.bind(this)):"loading"===b.state?b.reloadCallback=c:this.dispatcher.send("reloadTile",d,e.bind(this),b.workerID)},c.prototype.abortTile=function(a){this.dispatcher.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0,a.workerID)},c.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0,a.workerID)},c.prototype.hasTransition=function(){return!1},c}(a.Evented);n=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.dispatcher=e,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({},d),a.extend(this,a.pick(d,["url","scheme","tileSize"]))}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=v(this._options,this.map._requestManager,function(c,d){b._tileJSONRequest=null,c?b.fire(new a.ErrorEvent(c)):d&&(a.extend(b,d),d.bounds&&(b.tileBounds=new w(d.bounds,b.minzoom,b.maxzoom)),a.postTurnstileEvent(d.tiles),a.postMapLoadEvent(d.tiles,b.map._getMapId(),b.map._requestManager._skuToken),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),b.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},c.prototype.serialize=function(){return a.extend({},this._options)},c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},c.prototype.loadTile=function(b,c){var d=this,e=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._requestManager.transformRequest(e,a.ResourceType.Tile),function(e,f){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(e)b.state="errored",c(e);else if(f){d.map._refreshExpiredTiles&&b.setExpiryData(f),delete f.cacheControl,delete f.expires;e=d.map.painter.context;var g=e.gl;b.texture=d.map.painter.getTileTexture(f.width),b.texture?b.texture.update(f,{useMipmap:!0}):(b.texture=new a.Texture(e,f,g.RGBA,{useMipmap:!0}),b.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST),e.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax)),b.state="loaded",a.cacheEntryPossiblyAdded(d.dispatcher),c(null)}})},c.prototype.abortTile=function(a,b){a.request&&(a.request.cancel(),delete a.request),b()},c.prototype.unloadTile=function(a,b){a.texture&&this.map.painter.saveTileTexture(a.texture),b()},c.prototype.hasTransition=function(){return!1},c}(a.Evented);var x=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({},d),this.encoding=d.encoding||"mapbox"}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},c.prototype.loadTile=function(b,c){var d=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);b.request=a.getImage(this.map._requestManager.transformRequest(d,a.ResourceType.Tile),function(d,e){if(delete b.request,b.aborted)b.state="unloaded",c(null);else if(d)b.state="errored",c(d);else if(e){this.map._refreshExpiredTiles&&b.setExpiryData(e),delete e.cacheControl,delete e.expires;d=a.browser.getImageData(e);e={uid:b.uid,coord:b.tileID,source:this.id,rawImageData:d,encoding:this.encoding};b.workerID&&"expired"!==b.state||(b.workerID=this.dispatcher.send("loadDEMTile",e,function(a,d){a&&(b.state="errored",c(a)),d&&(b.dem=d,b.needsHillshadePrepare=!0,b.state="loaded",c(null))}.bind(this)))}}.bind(this)),b.neighboringTiles=this._getNeighboringTiles(b.tileID)},c.prototype._getNeighboringTiles=function(b){var c=b.canonical,d=Math.pow(2,c.z),e=(c.x-1+d)%d,f=0===c.x?b.wrap-1:b.wrap,g=(c.x+1+d)%d,h=c.x+1===d?b.wrap+1:b.wrap,i={};return i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y).key]={backfilled:!1},c.y>0&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y-1).key]={backfilled:!1}),c.y+1<d&&(i[new a.OverscaledTileID(b.overscaledZ,f,c.z,e,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,b.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},i[new a.OverscaledTileID(b.overscaledZ,h,c.z,g,c.y+1).key]={backfilled:!1}),i},c.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:a.uid,source:this.id},void 0,a.workerID)},c}(n),y=function(b){function c(c,d,e,f){b.call(this),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=e,this.setEventedParent(f),this._data=d.data,this._options=a.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution);c=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*c,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*c,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:a.EXTENT,radius:(d.clusterRadius||50)*c,log:!1},clusterProperties:d.clusterProperties},d.workerOptions)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(c){if(c)b.fire(new a.ErrorEvent(c));else{c={dataType:"source",sourceDataType:"metadata"};b._collectResourceTiming&&b._resourceTiming&&b._resourceTiming.length>0&&(c.resourceTiming=b._resourceTiming,b._resourceTiming=[]),b.fire(new a.Event("data",c))}})},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setData=function(b){var c=this;return this._data=b,this.fire(new a.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)c.fire(new a.ErrorEvent(b));else{b={dataType:"source",sourceDataType:"content"};c._collectResourceTiming&&c._resourceTiming&&c._resourceTiming.length>0&&(b.resourceTiming=c._resourceTiming,c._resourceTiming=[]),c.fire(new a.Event("data",b))}}),this},c.prototype.getClusterExpansionZoom=function(a,b){return this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},b,this.workerID),this},c.prototype.getClusterChildren=function(a,b){return this.dispatcher.send("geojson.getClusterChildren",{clusterId:a,source:this.id},b,this.workerID),this},c.prototype.getClusterLeaves=function(a,b,c,d){return this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:b,offset:c},d,this.workerID),this},c.prototype._updateWorkerData=function(b){var c=this,d=a.extend({},this.workerOptions),e=this._data;"string"==typeof e?(d.request=this.map._requestManager.transformRequest(a.browser.resolveURL(e),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(e),this.workerID=this.dispatcher.send(this.type+".loadData",d,function(a,e){c._removed||e&&e.abandoned||(c._loaded=!0,e&&e.resourceTiming&&e.resourceTiming[c.id]&&(c._resourceTiming=e.resourceTiming[c.id].slice(0)),c.dispatcher.send(c.type+".coalesce",{source:d.source},null,c.workerID),b(a))},this.workerID)},c.prototype.loadTile=function(b,c){var d=this,e=void 0===b.workerID?"loadTile":"reloadTile",f={type:this.type,uid:b.uid,tileID:b.tileID,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};b.workerID=this.dispatcher.send(e,f,function(a,f){return b.unloadVectorData(),b.aborted?c(null):a?c(a):(b.loadVectorData(f,d.map.painter,"reloadTile"===e),c(null))},this.workerID)},c.prototype.abortTile=function(a){a.aborted=!0},c.prototype.unloadTile=function(a){a.unloadVectorData(),this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)},c.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},c.prototype.serialize=function(){return a.extend({},this._options,{type:this.type,data:this._data})},c.prototype.hasTransition=function(){return!1},c}(a.Evented),z=function(b){function c(a,c,d,e){b.call(this),this.id=a,this.dispatcher=d,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(e),this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(b,c){var d=this;this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),function(e,f){e?d.fire(new a.ErrorEvent(e)):f&&(d.image=f,b&&(d.coordinates=b),c&&c(),d._finishLoading())})},c.prototype.updateImage=function(a){var b=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){b.texture=null}),this):this},c.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))},c.prototype.onAdd=function(a){this.map=a,this.load()},c.prototype.setCoordinates=function(b){var c=this;this.coordinates=b;b=b.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(b){for(var c=1/0,d=1/0,e=-1/0,f=-1/0,g=0,b=b;g<b.length;g+=1){var h=b[g];c=Math.min(c,h.x),d=Math.min(d,h.y),e=Math.max(e,h.x),f=Math.max(f,h.y)}h=e-c;g=f-d;b=Math.max(h,g);h=Math.max(0,Math.floor(-Math.log(b)/Math.LN2));g=Math.pow(2,h);return new a.CanonicalTileID(h,Math.floor((c+e)/2*g),Math.floor((d+f)/2*g))}(b),this.minzoom=this.maxzoom=this.tileID.z;b=b.map(function(a){return c.tileID.getTilePoint(a)._round()});return this._boundsArray=new a.StructArrayLayout4i8(),this._boundsArray.emplaceBack(b[0].x,b[0].y,0,0),this._boundsArray.emplaceBack(b[1].x,b[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(b[3].x,b[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(b[2].x,b[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this},c.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(b,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){b=this.tiles[d];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}}},c.prototype.loadTile=function(a,b){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},b(null)):(a.state="errored",b(null))},c.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return!1},c}(a.Evented),A=function(b){function c(a,c,d,e){b.call(this,a,c,d,e),this.roundZoom=!0,this.type="video",this.options=c}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){var b=this,c=this.options;this.urls=[];for(var d=0,c=c.urls;d<c.length;d+=1){var e=c[d];this.urls.push(this.map._requestManager.transformRequest(e,a.ResourceType.Source).url)}a.getVideo(this.urls,function(c,d){c?b.fire(new a.ErrorEvent(c)):d&&(b.video=d,b.video.loop=!0,b.video.addEventListener("playing",function(){b.map.triggerRepaint()}),b.map&&b.video.play(),b._finishLoading())})},c.prototype.getVideo=function(){return this.video},c.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},c.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var b=this.map.painter.context,c=b.gl;for(var d in this.boundsBuffer||(this.boundsBuffer=b.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(b,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this.tiles){b=this.tiles[d];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this.video&&!this.video.paused},c}(z),B=function(b){function c(c,d,e,f){b.call(this,c,d,e,f),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(function(a){return!Array.isArray(a)||2!==a.length||a.some(function(a){return"number"!=typeof a})})||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError("sources."+c,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},c.prototype.getCanvas=function(){return this.canvas},c.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},c.prototype.onRemove=function(){this.pause()},c.prototype.prepare=function(){var b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var c=this.map.painter.context,d=c.gl;for(var e in this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,a.rasterBoundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(b||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(c,this.canvas,d.RGBA,{premultiply:!0}),this.tiles){b=this.tiles[e];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}}},c.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},c.prototype.hasTransition=function(){return this._playing},c.prototype._hasInvalidDimensions=function(){for(var a=0,b=[this.canvas.width,this.canvas.height];a<b.length;a+=1){var c=b[a];if(isNaN(c)||c<=0)return!0}return!1},c}(z),C={vector:e,raster:n,"raster-dem":x,geojson:y,video:A,image:z,canvas:B},D=function(b,c,d,e){c=new C[c.type](b,c,d,e);if(c.id!==b)throw new Error("Expected Source id to be "+b+" instead of "+c.id);return a.bindAll(["load","abort","unload","serialize","prepare"],c),c};function E(b,c){var d=a.identity([]);return a.translate(d,d,[1,1,0]),a.scale(d,d,[.5*b.width,.5*b.height,1]),a.multiply(d,d,b.calculatePosMatrix(c.toUnwrapped()))}function F(a,b,c,d,e){var f=function(a,b,c){if(a)for(var d=0,a=a;d<a.length;d+=1){var e=b[a[d]];if(e&&e.source===c&&"fill-extrusion"===e.type)return!0}else for(var f in b){e=b[f];if(e.source===c&&"fill-extrusion"===e.type)return!0}return!1}(d&&d.layers,b,a.id),g=e.maxPitchScaleFactor();c=a.tilesIn(c,g,f);c.sort(G);for(var f=[],i=0,c=c;i<c.length;i+=1){var h=c[i];f.push({wrappedTileID:h.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(b,a._state,h.queryGeometry,h.cameraQueryGeometry,h.scale,d,e,g,E(a.transform,h.tileID))})}h=function(a){for(var b={},c={},d=0,a=a;d<a.length;d+=1){var e=a[d],f=e.queryResults;e=e.wrappedTileID;e=c[e]=c[e]||{};for(var k in f)for(var g=f[k],h=e[k]=e[k]||{},i=b[k]=b[k]||[],l=0,g=g;l<g.length;l+=1){var j=g[l];h[j.featureIndex]||(h[j.featureIndex]=!0,i.push(j))}}return b}(f);for(var j in h)h[j].forEach(function(b){b=b.feature;var c=a.getFeatureState(b.layer["source-layer"],b.id);b.source=b.layer.source,b.layer["source-layer"]&&(b.sourceLayer=b.layer["source-layer"]),b.state=c});return h}function G(a,b){a=a.tileID;b=b.tileID;return a.overscaledZ-b.overscaledZ||a.canonical.y-b.canonical.y||a.wrap-b.wrap||a.canonical.x-b.canonical.x}var H=function(a,b){this.max=a,this.onRemove=b,this.reset()};H.prototype.reset=function(){for(var a in this.data)for(var b=0,c=this.data[a];b<c.length;b+=1){var d=c[b];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},H.prototype.add=function(a,b,c){var d=this,e=a.wrapped().key;void 0===this.data[e]&&(this.data[e]=[]);var f={value:b,timeout:void 0};if(void 0!==c&&(f.timeout=setTimeout(function(){d.remove(a,f)},c)),this.data[e].push(f),this.order.push(e),this.order.length>this.max){b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this},H.prototype.has=function(a){return a.wrapped().key in this.data},H.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},H.prototype._getAndRemoveByKey=function(a){var b=this.data[a].shift();return b.timeout&&clearTimeout(b.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),b.value},H.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},H.prototype.remove=function(a,b){if(!this.has(a))return this;a=a.wrapped().key;b=void 0===b?0:this.data[a].indexOf(b);var c=this.data[a][b];return this.data[a].splice(b,1),c.timeout&&clearTimeout(c.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(c.value),this.order.splice(this.order.indexOf(a),1),this},H.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this};var I=function(a,b,c){this.context=a;var d=a.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(c),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};I.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},I.prototype.updateData=function(a){var b=this.context.gl;this.context.unbindVAO(),this.bind(),b.bufferSubData(b.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},I.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},K=function(a,b,c,d){this.length=b.length,this.attributes=c,this.itemSize=b.bytesPerElement,this.dynamicDraw=d,this.context=a;c=a.gl;this.buffer=c.createBuffer(),a.bindVertexBuffer.set(this.buffer),c.bufferData(c.ARRAY_BUFFER,b.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||delete b.arrayBuffer};K.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},K.prototype.updateData=function(a){var b=this.context.gl;this.bind(),b.bufferSubData(b.ARRAY_BUFFER,0,a.arrayBuffer)},K.prototype.enableAttributes=function(a,b){for(var c=0;c<this.attributes.length;c++){var d=this.attributes[c];d=b.attributes[d.name];void 0!==d&&a.enableVertexAttribArray(d)}},K.prototype.setVertexAttribPointers=function(a,b,c){for(var d=0;d<this.attributes.length;d++){var e=this.attributes[d],f=b.attributes[e.name];void 0!==f&&a.vertexAttribPointer(f,e.components,a[J[e.type]],!1,this.itemSize,e.offset+this.itemSize*(c||0))}},K.prototype.destroy=function(){var a=this.context.gl;this.buffer&&(a.deleteBuffer(this.buffer),delete this.buffer)};e=function(a){this.gl=a.gl,this["default"]=this.getDefault(),this.current=this["default"],this.dirty=!1};e.prototype.get=function(){return this.current},e.prototype.set=function(a){},e.prototype.getDefault=function(){return this["default"]},e.prototype.setDefault=function(){this.set(this["default"])};var L=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(e),M=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 1},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},b}(e),N=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},b}(e),O=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[!0,!0,!0,!0]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(e),P=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},b}(e),aa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 255},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},b}(e),Q=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},b.prototype.set=function(a){var b=this.current;(a.func!==b.func||a.ref!==b.ref||a.mask!==b.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},b}(e),R=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},b}(e),S=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.current=a,this.dirty=!1}},b}(e),T=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return[0,1]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},b}(e),ba=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.current=a,this.dirty=!1}},b}(e),ca=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.LESS},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},b}(e),da=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.BLEND):b.disable(b.BLEND),this.current=a,this.dirty=!1}},b}(e),ea=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},b}(e),fa=function(b){function c(){b.apply(this,arguments)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getDefault=function(){return a.Color.transparent},c.prototype.set=function(a){var b=this.current;(a.r!==b.r||a.g!==b.g||a.b!==b.b||a.a!==b.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},c}(e),ga=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.FUNC_ADD},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},b}(e),ha=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;a?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE),this.current=a,this.dirty=!1}},b}(e),ia=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.BACK},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},b}(e),ja=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.CCW},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},b}(e),ka=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},b}(e),la=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return this.gl.TEXTURE0},b.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},b}(e),ma=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},b.prototype.set=function(a){var b=this.current;(a[0]!==b[0]||a[1]!==b[1]||a[2]!==b[2]||a[3]!==b[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},b}(e),na=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},b}(e),oa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindRenderbuffer(b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(e),pa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindTexture(b.TEXTURE_2D,a),this.current=a,this.dirty=!1}},b}(e),qa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.bindBuffer(b.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},b}(e),ra=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},b}(e),sa=function(a){function b(b){a.call(this,b),this.vao=b.extVertexArrayObject}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},b}(e),ta=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return 4},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},b}(e),ua=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},b}(e),va=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return!1},b.prototype.set=function(a){if(a!==this.current||this.dirty){var b=this.gl;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},b}(e);n=function(a){function b(b,c){a.call(this,b),this.context=b,this.parent=c}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.getDefault=function(){return null},b}(e);var wa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.setDirty=function(){this.dirty=!0},b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},b}(n),xa=function(a){function b(){a.apply(this,arguments)}return a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b,b.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var b=this.gl;b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a),this.current=a,this.dirty=!1}},b}(n),ya=function(a,b,c){this.context=a,this.width=b,this.height=c;b=a.gl;c=this.framebuffer=b.createFramebuffer();this.colorAttachment=new wa(a,c),this.depthAttachment=new xa(a,c)};ya.prototype.destroy=function(){var a=this.context.gl,b=this.colorAttachment.get();b&&a.deleteTexture(b);b=this.depthAttachment.get();b&&a.deleteRenderbuffer(b),a.deleteFramebuffer(this.framebuffer)};var za=function(a,b,c){this.func=a,this.mask=b,this.range=c};za.ReadOnly=!1,za.ReadWrite=!0,za.disabled=new za(519,za.ReadOnly,[0,1]);var Aa=function(a,b,c,d,e,f){this.test=a,this.ref=b,this.mask=c,this.fail=d,this.depthFail=e,this.pass=f};Aa.disabled=new Aa({func:519,mask:0},0,0,7680,7680,7680);var Ba=function(a,b,c){this.blendFunction=a,this.blendColor=b,this.mask=c};Ba.Replace=[1,0],Ba.disabled=new Ba(Ba.Replace,a.Color.transparent,[!1,!1,!1,!1]),Ba.unblended=new Ba(Ba.Replace,a.Color.transparent,[!0,!0,!0,!0]),Ba.alphaBlended=new Ba([1,771],a.Color.transparent,[!0,!0,!0,!0]);var Ca=function(a,b,c){this.enable=a,this.mode=b,this.frontFace=c};Ca.disabled=new Ca(!1,1029,2305),Ca.backCCW=new Ca(!0,1029,2305);var Da=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new L(this),this.clearDepth=new M(this),this.clearStencil=new N(this),this.colorMask=new O(this),this.depthMask=new P(this),this.stencilMask=new aa(this),this.stencilFunc=new Q(this),this.stencilOp=new R(this),this.stencilTest=new S(this),this.depthRange=new T(this),this.depthTest=new ba(this),this.depthFunc=new ca(this),this.blend=new da(this),this.blendFunc=new ea(this),this.blendColor=new fa(this),this.blendEquation=new ga(this),this.cullFace=new ha(this),this.cullFaceSide=new ia(this),this.frontFace=new ja(this),this.program=new ka(this),this.activeTexture=new la(this),this.viewport=new ma(this),this.bindFramebuffer=new na(this),this.bindRenderbuffer=new oa(this),this.bindTexture=new pa(this),this.bindVertexBuffer=new qa(this),this.bindElementBuffer=new ra(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new sa(this),this.pixelStoreUnpack=new ta(this),this.pixelStoreUnpackPremultiplyAlpha=new ua(this),this.pixelStoreUnpackFlipY=new va(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&a.getExtension("OES_texture_half_float_linear")};Da.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Da.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Da.prototype.createIndexBuffer=function(a,b){return new I(this,a,b)},Da.prototype.createVertexBuffer=function(a,b,c){return new K(this,a,b,c)},Da.prototype.createRenderbuffer=function(a,b,c){var d=this.gl,e=d.createRenderbuffer();return this.bindRenderbuffer.set(e),d.renderbufferStorage(d.RENDERBUFFER,a,b,c),this.bindRenderbuffer.set(null),e},Da.prototype.createFramebuffer=function(a,b){return new ya(this,a,b)},Da.prototype.clear=function(a){var b=a.color;a=a.depth;var c=this.gl,d=0;b&&(d|=c.COLOR_BUFFER_BIT,this.clearColor.set(b),this.colorMask.set([!0,!0,!0,!0])),void 0!==a&&(d|=c.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),c.clear(d)},Da.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},Da.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},Da.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},Da.prototype.setColorMode=function(b){a.deepEqual(b.blendFunction,Ba.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(b.blendFunction),this.blendColor.set(b.blendColor)),this.colorMask.set(b.mask)},Da.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ea=function(b){function c(c,d,e){var f=this;b.call(this),this.id=c,this.dispatcher=e,this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&(f._sourceLoaded=!0),f._sourceLoaded&&!f._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(f.reload(),f.transform&&f.update(f.transform))}),this.on("error",function(){f._sourceErrored=!0}),this._source=D(c,d,e,this),this._tiles={},this._cache=new H(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._coveredTiles={},this._state=new a.SourceFeatureState()}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},c.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},c.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var b=this._tiles[a];if("loaded"!==b.state&&"errored"!==b.state)return!1}return!0},c.prototype.getSource=function(){return this._source},c.prototype.pause=function(){this._paused=!0},c.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},c.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)},c.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},c.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},c.prototype.serialize=function(){return this._source.serialize()},c.prototype.prepare=function(a){for(var b in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var c=this._tiles[b];c.upload(a),c.prepare(this.map.style.imageManager)}},c.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(Fa)},c.prototype.getRenderableIds=function(b){var c=this,d=[];for(var e in this._tiles)this._isIdRenderable(+e,b)&&d.push(+e);return b?d.sort(function(b,d){b=c._tiles[b].tileID;d=c._tiles[d].tileID;var e=new a.Point(b.canonical.x,b.canonical.y)._rotate(c.transform.angle),f=new a.Point(d.canonical.x,d.canonical.y)._rotate(c.transform.angle);return b.overscaledZ-d.overscaledZ||f.y-e.y||f.x-e.x}):d.sort(Fa)},c.prototype.hasRenderableParent=function(a){a=this.findLoadedParent(a,0);return!!a&&this._isIdRenderable(a.tileID.key)},c.prototype._isIdRenderable=function(a,b){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(b||!this._tiles[a].holdingForFade())},c.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var a in this._cache.reset(),this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")},c.prototype._reloadTile=function(a,b){var c=this._tiles[a];c&&("loading"!==c.state&&(c.state=b),this._loadTile(c,this._tileLoaded.bind(this,c,a,b)))},c.prototype._tileLoaded=function(b,c,d,e){if(e)return b.state="errored",void (404!==e.status?this._source.fire(new a.ErrorEvent(e,{tile:b})):this.update(this.transform));b.timeAdded=a.browser.now(),"expired"===d&&(b.refreshedUponExpiration=!0),this._setTileReloadTimer(c,b),"raster-dem"===this.getSource().type&&b.dem&&this._backfillDEM(b),this._state.initializeTileState(b,this.map?this.map.painter:null),this._source.fire(new a.Event("data",{dataType:"source",tile:b,coord:b.tileID}))},c.prototype._backfillDEM=function(a){for(var b=this.getRenderableIds(),c=0;c<b.length;c++){var d=b[c];if(a.neighboringTiles&&a.neighboringTiles[d]){d=this.getTileByID(d);e(a,d),e(d,a)}}function e(a,b){a.needsHillshadePrepare=!0;var c=b.tileID.canonical.x-a.tileID.canonical.x,d=b.tileID.canonical.y-a.tileID.canonical.y,e=Math.pow(2,a.tileID.canonical.z),f=b.tileID.key;0===c&&0===d||Math.abs(d)>1||(Math.abs(c)>1&&(1===Math.abs(c+e)?c+=e:1===Math.abs(c-e)&&(c-=e)),b.dem&&a.dem&&(a.dem.backfillBorder(b.dem,c,d),a.neighboringTiles&&a.neighboringTiles[f]&&(a.neighboringTiles[f].backfilled=!0)))}},c.prototype.getTile=function(a){return this.getTileByID(a.key)},c.prototype.getTileByID=function(a){return this._tiles[a]},c.prototype.getZoom=function(a){return a.zoom+a.scaleZoom(a.tileSize/this._source.tileSize)},c.prototype._retainLoadedChildren=function(a,b,c,d){for(var e in this._tiles){var f=this._tiles[e];if(!(d[e]||!f.hasData()||f.tileID.overscaledZ<=b||f.tileID.overscaledZ>c)){for(var g=f.tileID;f&&f.tileID.overscaledZ>b+1;){var h=f.tileID.scaledTo(f.tileID.overscaledZ-1);(f=this._tiles[h.key])&&f.hasData()&&(g=h)}for(var h=g;h.overscaledZ>b;)if(a[(h=h.scaledTo(h.overscaledZ-1)).key]){d[g.key]=g;break}}}},c.prototype.findLoadedParent=function(a,b){for(var c=a.overscaledZ-1;c>=b;c--){var d=a.scaledTo(c);if(!d)return;var e=String(d.key);e=this._tiles[e];if(e&&e.hasData())return e;if(this._cache.has(d))return this._cache.get(d)}},c.prototype.updateCacheSize=function(a){a=(Math.ceil(a.width/this._source.tileSize)+1)*(Math.ceil(a.height/this._source.tileSize)+1);a=Math.floor(5*a);a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,a):a;this._cache.setMaxSize(a)},c.prototype.handleWrapJump=function(a){var b=(a-(void 0===this._prevLng?a:this._prevLng))/360;b=Math.round(b);if(this._prevLng=a,b){a={};for(var c in this._tiles){var d=this._tiles[c];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+b),a[d.tileID.key]=d}for(var e in this._tiles=a,this._timers)clearTimeout(this._timers[e]),delete this._timers[e];for(var f in this._tiles){d=this._tiles[f];this._setTileReloadTimer(f,d)}}},c.prototype.update=function(b){var d=this;if(this.transform=b,this._sourceLoaded&&!this._paused){var e;this.updateCacheSize(b),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?e=b.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(b){return new a.OverscaledTileID(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)}):(e=b.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(e=e.filter(function(a){return d._source.hasTile(a)}))):e=[];b=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(b));var f=Math.max(b-c.maxOverzooming,this._source.minzoom),g=Math.max(b+c.maxUnderzooming,this._source.minzoom);e=this._updateRetainedTiles(e,b);if(Ga(this._source.type)){for(var s={},h={},i=0,j=Object.keys(e);i<j.length;i+=1){var t=j[i],k=e[t],l=this._tiles[t];if(l&&!(l.fadeEndTime&&l.fadeEndTime<=a.browser.now())){l=this.findLoadedParent(k,f);l&&(this._addTile(l.tileID),s[l.tileID.key]=l.tileID),h[t]=k}}for(var o in this._retainLoadedChildren(h,b,g,e),s)e[o]||(this._coveredTiles[o]=!0,e[o]=s[o])}for(var r in e)this._tiles[r].clearFadeHold();for(var l=0,t=a.keysDifference(this._tiles,e);l<t.length;l+=1){k=t[l];i=this._tiles[k];i.hasSymbolBuckets&&!i.holdingForFade()?i.setHoldDuration(this.map._fadeDuration):i.hasSymbolBuckets&&!i.symbolFadeFinished()||this._removeTile(k)}}},c.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},c.prototype._updateRetainedTiles=function(a,b){for(var d={},e={},f=Math.max(b-c.maxOverzooming,this._source.minzoom),g=Math.max(b+c.maxUnderzooming,this._source.minzoom),h={},i=0,l=a;i<l.length;i+=1){var j=l[i],k=this._addTile(j);d[j.key]=j,k.hasData()||b<this._source.maxzoom&&(h[j.key]=j)}this._retainLoadedChildren(h,b,g,d);for(var k=0,j=a;k<j.length;k+=1){l=j[k];i=this._tiles[l.key];if(!i.hasData()){if(b+1>this._source.maxzoom){h=l.children(this._source.maxzoom)[0];g=this.getTile(h);if(g&&g.hasData()){d[h.key]=h;continue}}else{a=l.children(this._source.maxzoom);if(d[a[0].key]&&d[a[1].key]&&d[a[2].key]&&d[a[3].key])continue}for(var g=i.wasRequested(),h=l.overscaledZ-1;h>=f;--h){a=l.scaledTo(h);if(e[a.key])break;if(e[a.key]=!0,!(i=this.getTile(a))&&g&&(i=this._addTile(a)),i&&(d[a.key]=a,g=i.wasRequested(),i.hasData()))break}}}return d},c.prototype._addTile=function(b){var c=this._tiles[b.key];if(c)return c;(c=this._cache.getAndRemove(b))&&(this._setTileReloadTimer(b.key,c),c.tileID=b,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[b.key]&&(clearTimeout(this._cacheTimers[b.key]),delete this._cacheTimers[b.key],this._setTileReloadTimer(b.key,c)));var d=Boolean(c);return d||(c=new a.Tile(b,this._source.tileSize*b.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,b.key,c.state))),c?(c.uses++,this._tiles[b.key]=c,d||this._source.fire(new a.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null},c.prototype._setTileReloadTimer=function(a,b){var c=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);b=b.getExpiryTimeout();b&&(this._timers[a]=setTimeout(function(){c._reloadTile(a,"expired"),delete c._timers[a]},b))},c.prototype._removeTile=function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),b.uses>0||(b.hasData()?this._cache.add(b.tileID,b,b.getExpiryTimeout()):(b.aborted=!0,this._abortTile(b),this._unloadTile(b))))},c.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},c.prototype.tilesIn=function(b,c,d){var e=this,f=[],g=this.transform;if(!g)return f;for(var d=d?g.getCameraQueryGeometry(b):b,h=b.map(function(a){return g.pointCoordinate(a)}),r=d.map(function(a){return g.pointCoordinate(a)}),i=this.getIds(),j=1/0,k=1/0,s=-1/0,l=-1/0,b=0,d=r;b<d.length;b+=1){var q=d[b];j=Math.min(j,q.x),k=Math.min(k,q.y),s=Math.max(s,q.x),l=Math.max(l,q.y)}for(var q=function(b){b=e._tiles[i[b]];if(!b.holdingForFade()){var d=b.tileID,m=Math.pow(2,g.zoom-b.tileID.overscaledZ),q=c*b.queryPadding*a.EXTENT/b.tileSize/m,t=[d.getTilePoint(new a.MercatorCoordinate(j,k)),d.getTilePoint(new a.MercatorCoordinate(s,l))];if(t[0].x-q<a.EXTENT&&t[0].y-q<a.EXTENT&&t[1].x+q>=0&&t[1].y+q>=0){t=h.map(function(a){return d.getTilePoint(a)});q=r.map(function(a){return d.getTilePoint(a)});f.push({tile:b,tileID:d,queryGeometry:t,cameraQueryGeometry:q,scale:m})}}},b=0;b<i.length;b++)q(b);return f},c.prototype.getVisibleCoordinates=function(a){for(var b=this,a=this.getRenderableIds(a).map(function(a){return b._tiles[a].tileID}),c=0,d=a;c<d.length;c+=1){var e=d[c];e.posMatrix=this.transform.calculatePosMatrix(e.toUnwrapped())}return a},c.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ga(this._source.type))for(var b in this._tiles){var c=this._tiles[b];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=a.browser.now())return!0}return!1},c.prototype.setFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.updateState(a,b,c)},c.prototype.removeFeatureState=function(a,b,c){a=a||"_geojsonTileLayer",this._state.removeFeatureState(a,b,c)},c.prototype.getFeatureState=function(a,b){return a=a||"_geojsonTileLayer",this._state.getState(a,b)},c}(a.Evented);function Fa(a,b){return a%32-b%32||b-a}function Ga(a){return"raster"===a||"image"===a||"video"===a}function Ha(){return new a.window.Worker($.workerUrl)}Ea.maxOverzooming=10,Ea.maxUnderzooming=3;var Ia=function(){this.active={}};Ia.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Ia.workerCount;)this.workers.push(new Ha());return this.active[a]=!0,this.workers.slice()},Ia.prototype.release=function(a){delete this.active[a],0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)};var Ja;x=Math.floor(a.browser.hardwareConcurrency/2);function Ka(b,c){var d={};for(var e in b)"ref"!==e&&(d[e]=b[e]);return a.refProperties.forEach(function(a){a in c&&(d[a]=c[a])}),d}function La(a){a=a.slice();for(var b=Object.create(null),c=0;c<a.length;c++)b[a[c].id]=a[c];for(var c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=Ka(a[c],b[a[c].ref]));return a}Ia.workerCount=Math.max(Math.min(x,6),1);var U={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function V(a,b,c){c.push({command:U.addSource,args:[a,b[a]]})}function Ma(a,b,c){b.push({command:U.removeSource,args:[a]}),c[a]=!0}function Na(a,b,c,d){Ma(a,c,d),V(a,b,c)}function Oa(b,c,d){var e;for(e in b[d])if(b[d].hasOwnProperty(e)&&"data"!==e&&!a.deepEqual(b[d][e],c[d][e]))return!1;for(e in c[d])if(c[d].hasOwnProperty(e)&&"data"!==e&&!a.deepEqual(b[d][e],c[d][e]))return!1;return!0}function Pa(b,c,d,e,f,g){var h;for(h in c=c||{},b=b||{})b.hasOwnProperty(h)&&(a.deepEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}));for(h in c)c.hasOwnProperty(h)&&!b.hasOwnProperty(h)&&(a.deepEqual(b[h],c[h])||d.push({command:g,args:[e,h,c[h],f]}))}function Qa(a){return a.id}function Ra(a,b){return a[b.id]=b,a}function Sa(b,c){if(!b)return[{command:U.setStyle,args:[c]}];var d=[];try{if(!a.deepEqual(b.version,c.version))return[{command:U.setStyle,args:[c]}];a.deepEqual(b.center,c.center)||d.push({command:U.setCenter,args:[c.center]}),a.deepEqual(b.zoom,c.zoom)||d.push({command:U.setZoom,args:[c.zoom]}),a.deepEqual(b.bearing,c.bearing)||d.push({command:U.setBearing,args:[c.bearing]}),a.deepEqual(b.pitch,c.pitch)||d.push({command:U.setPitch,args:[c.pitch]}),a.deepEqual(b.sprite,c.sprite)||d.push({command:U.setSprite,args:[c.sprite]}),a.deepEqual(b.glyphs,c.glyphs)||d.push({command:U.setGlyphs,args:[c.glyphs]}),a.deepEqual(b.transition,c.transition)||d.push({command:U.setTransition,args:[c.transition]}),a.deepEqual(b.light,c.light)||d.push({command:U.setLight,args:[c.light]});var e={},f=[];!function(b,c,d,e){var f;for(f in c=c||{},b=b||{})b.hasOwnProperty(f)&&(c.hasOwnProperty(f)||Ma(f,d,e));for(f in c)c.hasOwnProperty(f)&&(b.hasOwnProperty(f)?a.deepEqual(b[f],c[f])||("geojson"===b[f].type&&"geojson"===c[f].type&&Oa(b,c,f)?d.push({command:U.setGeoJSONSourceData,args:[f,c[f].data]}):Na(f,c,d,e)):V(f,c,d))}(b.sources,c.sources,f,e);var g=[];b.layers&&b.layers.forEach(function(a){e[a.source]?d.push({command:U.removeLayer,args:[a.id]}):g.push(a)}),d=d.concat(f),(function(b,c,d){c=c||[];var e,f,g,h,i,j=(b=b||[]).map(Qa),k=c.map(Qa);b=b.reduce(Ra,{});c=c.reduce(Ra,{});var l=j.slice(),m=Object.create(null);for(e=0,f=0;e<j.length;e++)g=j[e],c.hasOwnProperty(g)?f++:(d.push({command:U.removeLayer,args:[g]}),l.splice(l.indexOf(g,f),1));for(e=0,f=0;e<k.length;e++)g=k[k.length-1-e],l[l.length-1-e]!==g&&(b.hasOwnProperty(g)?(d.push({command:U.removeLayer,args:[g]}),l.splice(l.lastIndexOf(g,l.length-f),1)):f++,j=l[l.length-e],d.push({command:U.addLayer,args:[c[g],j]}),l.splice(l.length-e,0,g),m[g]=!0);for(e=0;e<k.length;e++)if(f=b[g=k[e]],h=c[g],!m[g]&&!a.deepEqual(f,h))if(a.deepEqual(f.source,h.source)&&a.deepEqual(f["source-layer"],h["source-layer"])&&a.deepEqual(f.type,h.type)){for(i in Pa(f.layout,h.layout,d,g,null,U.setLayoutProperty),Pa(f.paint,h.paint,d,g,null,U.setPaintProperty),a.deepEqual(f.filter,h.filter)||d.push({command:U.setFilter,args:[g,h.filter]}),a.deepEqual(f.minzoom,h.minzoom)&&a.deepEqual(f.maxzoom,h.maxzoom)||d.push({command:U.setLayerZoomRange,args:[g,h.minzoom,h.maxzoom]}),f)f.hasOwnProperty(i)&&"layout"!==i&&"paint"!==i&&"filter"!==i&&"metadata"!==i&&"minzoom"!==i&&"maxzoom"!==i&&(0===i.indexOf("paint.")?Pa(f[i],h[i],d,g,i.slice(6),U.setPaintProperty):a.deepEqual(f[i],h[i])||d.push({command:U.setLayerProperty,args:[g,i,h[i]]}));for(i in h)h.hasOwnProperty(i)&&!f.hasOwnProperty(i)&&"layout"!==i&&"paint"!==i&&"filter"!==i&&"metadata"!==i&&"minzoom"!==i&&"maxzoom"!==i&&(0===i.indexOf("paint.")?Pa(f[i],h[i],d,g,i.slice(6),U.setPaintProperty):a.deepEqual(f[i],h[i])||d.push({command:U.setLayerProperty,args:[g,i,h[i]]}))}else d.push({command:U.removeLayer,args:[g]}),j=l[l.lastIndexOf(g)+1],d.push({command:U.addLayer,args:[h,j]})})(g,c.layers,d)}catch(a){!1,d=[{command:U.setStyle,args:[c]}]}return d}var Ta=function(a,b,c){var d=this.boxCells=[],e=this.circleCells=[];this.xCellCount=Math.ceil(a/c),this.yCellCount=Math.ceil(b/c);for(var c=0;c<this.xCellCount*this.yCellCount;c++)d.push([]),e.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=b,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/b,this.boxUid=0,this.circleUid=0};function W(b,c,d,e,f){var g=a.create();return c?(a.scale(g,g,[1/f,1/f,1]),d||a.rotateZ(g,g,e.angle)):a.multiply(g,e.labelPlaneMatrix,b),g}function Ua(b,c,d,e,f){if(c){c=a.clone(b);return a.scale(c,c,[f,f,1]),d||a.rotateZ(c,c,-e.angle),c}return e.glCoordMatrix}function Va(b,c){b=[b.x,b.y,0,1];eb(b,b,c);c=b[3];return{point:new a.Point(b[0]/c,b[1]/c),signedDistanceFromCamera:c}}function Wa(a,b){var c=a[0]/a[3];a=a[1]/a[3];return c>=-b[0]&&c<=b[0]&&a>=-b[1]&&a<=b[1]}function Xa(b,c,d,e,f,g,h,i){var C=e?b.textSizeData:b.iconSizeData,j=a.evaluateSizeForZoom(C,d.transform.zoom),k=[256/d.width*2+1,256/d.height*2+1],l=e?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;l.clear();for(var D=b.lineVertexArray,r=e?b.text.placedSymbolArray:b.icon.placedSymbolArray,t=d.transform.width/d.transform.height,u=!1,x=0;x<r.length;x++){var y=r.get(x);if(y.hidden||y.writingMode===a.WritingMode.vertical&&!u)db(y.numGlyphs,l);else{u=!1;var E=[y.anchorX,y.anchorY,0,1];if(a.transformMat4(E,E,c),Wa(E,k)){E=.5+E[3]/d.transform.cameraToCenterDistance*.5;var z=a.evaluateSizeForFeature(C,j,y);z=h?z*E:z/E;E=new a.Point(y.anchorX,y.anchorY);var A=Va(E,f).point,B={},F=$a(y,z,!1,i,c,f,g,b.glyphOffsetArray,D,l,A,E,B,t);u=F.useVertical,(F.notEnoughRoom||u||F.needsFlipping&&$a(y,z,!0,i,c,f,g,b.glyphOffsetArray,D,l,A,E,B,t).notEnoughRoom)&&db(y.numGlyphs,l)}else db(y.numGlyphs,l)}}e?b.text.dynamicLayoutVertexBuffer.updateData(l):b.icon.dynamicLayoutVertexBuffer.updateData(l)}function Ya(a,b,c,d,e,f,g,h,i,q,j,k){var l=h.glyphStartIndex+h.numGlyphs,r=h.lineStartIndex,o=h.lineStartIndex+h.lineLength,p=b.getoffsetX(h.glyphStartIndex);b=b.getoffsetX(l-1);l=bb(a*p,c,d,e,f,g,h.segment,r,o,i,q,j,k);if(!l)return null;p=bb(a*b,c,d,e,f,g,h.segment,r,o,i,q,j,k);return p?{first:l,last:p}:null}function Za(b,c,d,e){return b===a.WritingMode.horizontal&&Math.abs(d.y-c.y)>Math.abs(d.x-c.x)*e?{useVertical:!0}:(b===a.WritingMode.vertical?c.y<d.y:c.x>d.x)?{needsFlipping:!0}:null}function $a(b,c,d,e,f,g,h,i,A,j,k,l,B,n){c=c/24;var o=b.lineOffsetX*c,v=b.lineOffsetY*c;if(b.numGlyphs>1){var C=b.glyphStartIndex+b.numGlyphs,w=b.lineStartIndex,x=b.lineStartIndex+b.lineLength,y=Ya(c,i,o,v,d,k,l,b,A,g,B,!1);if(!y)return{notEnoughRoom:!0};var z=Va(y.first.point,h).point;h=Va(y.last.point,h).point;if(e&&!d){z=Za(b.writingMode,z,h,n);if(z)return z}h=[y.first];for(var z=b.glyphStartIndex+1;z<C-1;z++)h.push(bb(c*i.getoffsetX(z),o,v,d,k,l,b.segment,w,x,A,g,B,!1));h.push(y.last)}else{if(e&&!d){z=Va(l,f).point;x=b.lineStartIndex+b.segment+1;w=new a.Point(A.getx(x),A.gety(x));C=Va(w,f);y=C.signedDistanceFromCamera>0?C.point:ab(l,w,z,1,f);e=Za(b.writingMode,z,y,n);if(e)return e}x=bb(c*i.getoffsetX(b.glyphStartIndex),o,v,d,k,l,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,A,g,B,!1);if(!x)return{notEnoughRoom:!0};h=[x]}for(var C=0,w=h;C<w.length;C+=1){f=w[C];a.addDynamicAttributes(j,f.point,f.angle)}return{}}function ab(a,b,c,d,e){a=Va(a.add(a.sub(b)._unit()),e).point;b=c.sub(a);return c.add(b._mult(d/b.mag()))}function bb(b,c,d,e,f,g,h,i,u,j,k,l,x){b=e?b-c:b+c;c=b>0?1:-1;var m=0;e&&(c*=-1,m=Math.PI),c<0&&(m+=Math.PI);for(var e=c>0?i+h:i+h+1,h=e,y=f,f=f,n=0,p=0,b=Math.abs(b);n+p<=b;){if((e+=c)<i||e>=u)return null;if(f=y,void 0===(y=l[e])){var q=new a.Point(j.getx(e),j.gety(e)),r=Va(q,k);if(r.signedDistanceFromCamera>0)y=l[e]=r.point;else{r=e-c;y=ab(0===n?g:new a.Point(j.getx(r),j.gety(r)),q,f,b-n+1,k)}}n+=p,p=f.dist(y)}r=(b-n)/p;q=y.sub(f);u=q.mult(r)._add(f);return u._add(q._unit()._perp()._mult(d*c)),{point:u,angle:m+Math.atan2(y.y-f.y,y.x-f.x),tileDistance:x?{prevTileDistance:e-c===h?0:j.gettileUnitDistanceFromAnchor(e-c),lastSegmentViewportDistance:b-n}:null}}Ta.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ta.prototype.insert=function(a,b,c,d,e){this._forEachCell(b,c,d,e,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(b),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(e)},Ta.prototype.insertCircle=function(a,b,c,d){this._forEachCell(b-d,c-d,b+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(b),this.circles.push(c),this.circles.push(d)},Ta.prototype._insertBoxCell=function(a,b,c,d,e,f){this.boxCells[e].push(f)},Ta.prototype._insertCircleCell=function(a,b,c,d,e,f){this.circleCells[e].push(f)},Ta.prototype._query=function(a,b,c,d,e,f){if(c<0||a>this.width||d<0||b>this.height)return!e&&[];var g=[];if(a<=0&&b<=0&&this.width<=c&&this.height<=d){if(e)return!0;for(var h=0;h<this.boxKeys.length;h++)g.push({key:this.boxKeys[h],x1:this.bboxes[4*h],y1:this.bboxes[4*h+1],x2:this.bboxes[4*h+2],y2:this.bboxes[4*h+3]});for(var h=0;h<this.circleKeys.length;h++){var k=this.circles[3*h],i=this.circles[3*h+1],j=this.circles[3*h+2];g.push({key:this.circleKeys[h],x1:k-j,y1:i-j,x2:k+j,y2:i+j})}return f?g.filter(f):g}k={hitTest:e,seenUids:{box:{},circle:{}}};return this._forEachCell(a,b,c,d,this._queryCell,g,k,f),e?g.length>0:g},Ta.prototype._queryCircle=function(a,b,c,d,e){var f=a-c,g=a+c,h=b-c,i=b+c;if(g<0||f>this.width||i<0||h>this.height)return!d&&[];var j=[];a={hitTest:d,circle:{x:a,y:b,radius:c},seenUids:{box:{},circle:{}}};return this._forEachCell(f,h,g,i,this._queryCellCircle,j,a,e),d?j.length>0:j},Ta.prototype.query=function(a,b,c,d,e){return this._query(a,b,c,d,!1,e)},Ta.prototype.hitTest=function(a,b,c,d,e){return this._query(a,b,c,d,!0,e)},Ta.prototype.hitTestCircle=function(a,b,c,d){return this._queryCircle(a,b,c,!0,d)},Ta.prototype._queryCell=function(a,b,c,d,e,f,g,h){var i=g.seenUids,o=this.boxCells[e];if(null!==o)for(var j=this.bboxes,k=0,o=o;k<o.length;k+=1){var p=o[k];if(!i.box[p]){i.box[p]=!0;var l=4*p;if(a<=j[l+2]&&b<=j[l+3]&&c>=j[l+0]&&d>=j[l+1]&&(!h||h(this.boxKeys[p]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[p],x1:j[l],y1:j[l+1],x2:j[l+2],y2:j[l+3]})}}}p=this.circleCells[e];if(null!==p)for(var l=this.circles,k=0,o=p;k<o.length;k+=1){j=o[k];if(!i.circle[j]){i.circle[j]=!0;e=3*j;if(this._circleAndRectCollide(l[e],l[e+1],l[e+2],a,b,c,d)&&(!h||h(this.circleKeys[j]))){if(g.hitTest)return f.push(!0),!0;p=l[e];var n=l[e+1];e=l[e+2];f.push({key:this.circleKeys[j],x1:p-e,y1:n-e,x2:p+e,y2:n+e})}}}},Ta.prototype._queryCellCircle=function(a,b,c,d,e,f,g,h){a=g.circle;b=g.seenUids;c=this.boxCells[e];if(null!==c)for(var d=this.bboxes,g=0,c=c;g<c.length;g+=1){var i=c[g];if(!b.box[i]){b.box[i]=!0;var j=4*i;if(this._circleAndRectCollide(a.x,a.y,a.radius,d[j+0],d[j+1],d[j+2],d[j+3])&&(!h||h(this.boxKeys[i])))return f.push(!0),!0}}j=this.circleCells[e];if(null!==j)for(var i=this.circles,c=0,d=j;c<d.length;c+=1){g=d[c];if(!b.circle[g]){b.circle[g]=!0;e=3*g;if(this._circlesCollide(i[e],i[e+1],i[e+2],a.x,a.y,a.radius)&&(!h||h(this.circleKeys[g])))return f.push(!0),!0}}},Ta.prototype._forEachCell=function(a,b,c,d,e,f,g,h){for(var i=this._convertToXCellCoord(a),n=this._convertToYCellCoord(b),j=this._convertToXCellCoord(c),k=this._convertToYCellCoord(d),i=i;i<=j;i++)for(var o=n;o<=k;o++){var l=this.xCellCount*o+i;if(e.call(this,a,b,c,d,l,f,g,h))return}},Ta.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},Ta.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},Ta.prototype._circlesCollide=function(a,b,c,d,e,f){d=d-a;a=e-b;e=c+f;return e*e>d*d+a*a},Ta.prototype._circleAndRectCollide=function(a,b,c,d,e,f,g){f=(f-d)/2;a=Math.abs(a-(d+f));if(a>f+c)return!1;d=(g-e)/2;g=Math.abs(b-(e+d));if(g>d+c)return!1;if(a<=f||g<=d)return!0;b=a-f;e=g-d;return b*b+e*e<=c*c};var cb=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function db(a,b){for(var c=0;c<a;c++){var d=b.length;b.resize(d+4),b.float32.set(cb,3*d)}}function eb(a,b,c){var d=b[0];b=b[1];return a[0]=c[0]*d+c[4]*b+c[12],a[1]=c[1]*d+c[5]*b+c[13],a[3]=c[3]*d+c[7]*b+c[15],a}var fb=function(a,b,c){void 0===b&&(b=new Ta(a.width+200,a.height+200,25)),void 0===c&&(c=new Ta(a.width+200,a.height+200,25)),this.transform=a,this.grid=b,this.ignoredGrid=c,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function gb(a,b,c){a[b+4]=c?1:0}function hb(b,c,d){return c*(a.EXTENT/(b.tileSize*Math.pow(2,d-b.tileID.overscaledZ)))}fb.prototype.placeCollisionBox=function(a,b,c,d,e){d=this.projectAndGetPerspectiveRatio(d,a.anchorPointX,a.anchorPointY);c=c*d.perspectiveRatio;var f=a.x1*c+d.point.x,g=a.y1*c+d.point.y,h=a.x2*c+d.point.x;a=a.y2*c+d.point.y;return!this.isInsideGrid(f,g,h,a)||!b&&this.grid.hitTest(f,g,h,a,e)?{box:[],offscreen:!1}:{box:[f,g,h,a],offscreen:this.isOffscreen(f,g,h,a)}},fb.prototype.approximateTileDistance=function(a,b,c,d,e){e=e?1:d/this.pitchfactor;d=a.lastSegmentViewportDistance*c;return a.prevTileDistance+d+(e-1)*d*Math.abs(Math.sin(b))},fb.prototype.placeCollisionCircles=function(b,c,d,e,f,g,h,i,v,j,k,l,w){var q=[],r=this.projectAnchor(v,f.anchorX,f.anchorY),s=i/24,t=f.lineOffsetX*i;i=f.lineOffsetY*i;var x=new a.Point(f.anchorX,f.anchorY);s=Ya(s,h,t,i,!1,Va(x,j).point,x,f,g,j,{},!0);h=!1;t=!1;i=!0;x=r.perspectiveRatio*e;f=1/(e*d);g=0;j=0;s&&(g=this.approximateTileDistance(s.first.tileDistance,s.first.angle,f,r.cameraDistance,l),j=this.approximateTileDistance(s.last.tileDistance,s.last.angle,f,r.cameraDistance,l));for(var e=0;e<b.length;e+=5){d=b[e];f=b[e+1];r=b[e+2];l=b[e+3];if(!s||l<-g||l>j)gb(b,e,!1);else{l=this.projectPoint(v,d,f);d=r*x;if(q.length>0){f=l.x-q[q.length-4];r=l.y-q[q.length-3];if(d*d*2>f*f+r*r&&e+8<b.length){f=b[e+8];if(f>-g&&f<j){gb(b,e,!1);continue}}}r=e/5;q.push(l.x,l.y,d,r),gb(b,e,!0);f=l.x-d;r=l.y-d;var u=l.x+d,y=l.y+d;if(i=i&&this.isOffscreen(f,r,u,y),t=t||this.isInsideGrid(f,r,u,y),!c&&this.grid.hitTestCircle(l.x,l.y,d,w)){if(!k)return{circles:[],offscreen:!1};h=!0}}}return{circles:h||!t?[]:q,offscreen:i}},fb.prototype.queryRenderedSymbols=function(b){if(0===b.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var c=[],d=1/0,e=1/0,f=-1/0,g=-1/0,h=0,b=b;h<b.length;h+=1){var i=b[h];i=new a.Point(i.x+100,i.y+100);d=Math.min(d,i.x),e=Math.min(e,i.y),f=Math.max(f,i.x),g=Math.max(g,i.y),c.push(i)}for(var i={},b={},h=0,d=this.grid.query(d,e,f,g).concat(this.ignoredGrid.query(d,e,f,g));h<d.length;h+=1){e=d[h];f=e.key;if(void 0===i[f.bucketInstanceId]&&(i[f.bucketInstanceId]={}),!i[f.bucketInstanceId][f.featureIndex]){g=[new a.Point(e.x1,e.y1),new a.Point(e.x2,e.y1),new a.Point(e.x2,e.y2),new a.Point(e.x1,e.y2)];a.polygonIntersectsPolygon(c,g)&&(i[f.bucketInstanceId][f.featureIndex]=!0,void 0===b[f.bucketInstanceId]&&(b[f.bucketInstanceId]=[]),b[f.bucketInstanceId].push(f.featureIndex))}}return b},fb.prototype.insertCollisionBox=function(a,b,c,d,e){c={bucketInstanceId:c,featureIndex:d,collisionGroupID:e};(b?this.ignoredGrid:this.grid).insert(c,a[0],a[1],a[2],a[3])},fb.prototype.insertCollisionCircles=function(a,b,c,d,e){for(var b=b?this.ignoredGrid:this.grid,c={bucketInstanceId:c,featureIndex:d,collisionGroupID:e},d=0;d<a.length;d+=4)b.insertCircle(c,a[d],a[d+1],a[d+2])},fb.prototype.projectAnchor=function(a,b,c){b=[b,c,0,1];return eb(b,b,a),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5,cameraDistance:b[3]}},fb.prototype.projectPoint=function(b,c,d){c=[c,d,0,1];return eb(c,c,b),new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100)},fb.prototype.projectAndGetPerspectiveRatio=function(b,c,d){c=[c,d,0,1];return eb(c,c,b),{point:new a.Point((c[0]/c[3]+1)/2*this.transform.width+100,(-c[1]/c[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/c[3]*.5}},fb.prototype.isOffscreen=function(a,b,c,d){return c<100||a>=this.screenRightBoundary||d<100||b>this.screenBottomBoundary},fb.prototype.isInsideGrid=function(a,b,c,d){return c>=0&&a<this.gridRightBoundary&&d>=0&&b<this.gridBottomBoundary};var ib=function(a,b,c,d){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?b:-b))):d&&c?1:0,this.placed=c};ib.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var jb=function(a,b,c,d,e){this.text=new ib(a?a.text:null,b,c,e),this.icon=new ib(a?a.icon:null,b,d,e)};jb.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var kb=function(a,b,c){this.text=a,this.icon=b,this.skipFade=c},lb=function(a,b,c,d,e){this.bucketInstanceId=a,this.featureIndex=b,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=e},mb=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function nb(b,c,d,e,f){var g=a.getAnchorAlignment(b);c=-(g.horizontalAlign-.5)*c;g=-(g.verticalAlign-.5)*d;d=a.evaluateRadialOffset(b,e);return new a.Point(c+d[0]*f,g+d[1]*f)}mb.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var b=++this.maxGroupID;this.collisionGroups[a]={ID:b,predicate:function(a){return a.collisionGroupID===b}}}return this.collisionGroups[a]};var ob=function(a,b,c,d){this.transform=a.clone(),this.collisionIndex=new fb(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new mb(c),this.prevPlacement=d,d&&(d.prevPlacement=void 0)};function pb(a,b,c,d,e){a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0),a.emplaceBack(b?1:0,c?1:0,d||0,e||0)}ob.prototype.placeLayerTile=function(b,c,d,e){var f=c.getBucket(b),g=c.latestFeatureIndex;if(f&&g&&b.id===f.layerIds[0]){b=c.collisionBoxArray;var h=f.layers[0].layout,l=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),i=c.tileSize/a.EXTENT,j=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),k=W(j,"map"===h.get("text-pitch-alignment"),"map"===h.get("text-rotation-alignment"),this.transform,hb(c,1,this.transform.zoom));h=W(j,"map"===h.get("icon-pitch-alignment"),"map"===h.get("icon-rotation-alignment"),this.transform,hb(c,1,this.transform.zoom));this.retainedQueryData[f.bucketInstanceId]=new lb(f.bucketInstanceId,g,f.sourceLayerIndex,f.index,c.tileID),this.placeLayerBucket(f,j,k,h,l,i,d,c.holdingForFade(),e,b)}},ob.prototype.attemptAnchorPlacement=function(b,c,d,e,f,g,h,i,s,j,k,l,t,p){var q,r=nb(b,d,e,f,g);c=this.collisionIndex.placeCollisionBox(function(b,c,d,e,f,g){var h=b.x1,i=b.x2,l=b.y1,j=b.y2,k=b.anchorPointX;b=b.anchorPointY;c=new a.Point(c,d);return e&&c._rotate(f?g:-g),{x1:h+c.x,y1:l+c.y,x2:i+c.x,y2:j+c.y,anchorPointX:k,anchorPointY:b}}(c,r.x,r.y,h,i,this.transform.angle),l,s,j,k.predicate);if(c.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[t.crossTileID]&&this.prevPlacement.placements[t.crossTileID]&&this.prevPlacement.placements[t.crossTileID].text&&(q=this.prevPlacement.variableOffsets[t.crossTileID].anchor),this.variableOffsets[t.crossTileID]={radialOffset:f,width:d,height:e,anchor:b,textBoxScale:g,prevAnchor:q},this.markUsedJustification(p,b,t),c},ob.prototype.placeLayerBucket=function(b,c,d,e,f,g,h,i,O,j){var k=this,l=b.layers[0].layout,P=a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),G=l.get("text-optional"),I=l.get("icon-optional"),J=l.get("text-allow-overlap");e=l.get("icon-allow-overlap");var K=J&&(e||!b.hasIconData()||I),aa=e&&(J||!b.hasTextData()||G),L=this.collisionGroups.get(b.sourceID),M="map"===l.get("text-rotation-alignment"),N="map"===l.get("text-pitch-alignment");e="viewport-y"===l.get("symbol-z-order");!b.collisionArrays&&j&&b.deserializeCollisionBoxes(j);j=function(e,j){if(!O[e.crossTileID])if(i)k.placements[e.crossTileID]=new kb(!1,!1,!1);else{var m=!1,n=!1,o=!0,q=null,ea=null,fa=null,r=0,s=0;j.textFeatureIndex&&(r=j.textFeatureIndex);var t=j.textBox;if(t)if(l.get("text-variable-anchor")){var Q=t.x2-t.x1,R=t.y2-t.y1,S=e.textBoxScale,T=l.get("text-variable-anchor");if(k.prevPlacement&&k.prevPlacement.variableOffsets[e.crossTileID]){var ba=k.prevPlacement.variableOffsets[e.crossTileID];T[0]!==ba.anchor&&(T=T.filter(function(a){return a!==ba.anchor})).unshift(ba.anchor)}for(var ca=0,T=T;ca<T.length;ca+=1){var da=T[ca];if(q=k.attemptAnchorPlacement(da,t,Q,R,e.radialTextOffset,S,M,N,g,c,L,J,e,b)){m=!0;break}}if(!k.variableOffsets[e.crossTileID]&&k.prevPlacement){da=k.prevPlacement.variableOffsets[e.crossTileID];da&&(k.variableOffsets[e.crossTileID]=da,k.markUsedJustification(b,da.anchor,e))}}else m=(q=k.collisionIndex.placeCollisionBox(t,l.get("text-allow-overlap"),g,c,L.predicate)).box.length>0;o=q&&q.offscreen;ca=j.textCircles;if(ca){Q=b.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex);R=a.evaluateSizeForFeature(b.textSizeData,P,Q);ea=k.collisionIndex.placeCollisionCircles(ca,l.get("text-allow-overlap"),f,g,Q,b.lineVertexArray,b.glyphOffsetArray,R,c,d,h,N,L.predicate),m=l.get("text-allow-overlap")||ea.circles.length>0,o=o&&ea.offscreen}j.iconFeatureIndex&&(s=j.iconFeatureIndex),j.iconBox&&(n=(fa=k.collisionIndex.placeCollisionBox(j.iconBox,l.get("icon-allow-overlap"),g,c,L.predicate)).box.length>0,o=o&&fa.offscreen);T=G||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices;S=I||0===e.numIconVertices;T||S?S?T||(n=n&&m):m=n&&m:n=m=n&&m,m&&q&&k.collisionIndex.insertCollisionBox(q.box,l.get("text-ignore-placement"),b.bucketInstanceId,r,L.ID),n&&fa&&k.collisionIndex.insertCollisionBox(fa.box,l.get("icon-ignore-placement"),b.bucketInstanceId,s,L.ID),m&&ea&&k.collisionIndex.insertCollisionCircles(ea.circles,l.get("text-ignore-placement"),b.bucketInstanceId,r,L.ID),k.placements[e.crossTileID]=new kb(m||K,n||aa,o||b.justReloaded),O[e.crossTileID]=!0}};if(e)for(var e=b.getSortedSymbolIndexes(this.transform.angle),Q=e.length-1;Q>=0;--Q){var R=e[Q];j(b.symbolInstances.get(R),b.collisionArrays[R])}else for(var R=0;R<b.symbolInstances.length;++R)j(b.symbolInstances.get(R),b.collisionArrays[R]);b.justReloaded=!1},ob.prototype.markUsedJustification=function(b,c,d){var e={left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex};c=e[a.getAnchorJustification(c)];for(var f in e){var g=e[f];g>=0&&(b.text.placedSymbolArray.get(g).crossTileID=c>=0&&g!==c?0:d.crossTileID)}},ob.prototype.commit=function(a){this.commitTime=a;var b=this.prevPlacement,c=!1,d=b&&0!==this.fadeDuration?(this.commitTime-b.commitTime)/this.fadeDuration:1,e=b?b.opacities:{},f=b?b.variableOffsets:{};for(var g in this.placements){var h=this.placements[g],i=e[g];i?(this.opacities[g]=new jb(i,d,h.text,h.icon),c=c||h.text!==i.text.placed||h.icon!==i.icon.placed):(this.opacities[g]=new jb(null,d,h.text,h.icon,h.skipFade),c=c||h.text||h.icon)}for(var k in e){i=e[k];if(!this.opacities[k]){h=new jb(i,d,!1,!1);h.isHidden()||(this.opacities[k]=h,c=c||i.text.placed||i.icon.placed)}}for(var j in f)this.variableOffsets[j]||!this.opacities[j]||this.opacities[j].isHidden()||(this.variableOffsets[j]=f[j]);c?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=b?b.lastPlacementChangeTime:a)},ob.prototype.updateLayerOpacities=function(a,b){for(var c={},d=0,b=b;d<b.length;d+=1){var e=b[d],f=e.getBucket(a);f&&e.latestFeatureIndex&&a.id===f.layerIds[0]&&this.updateBucketOpacities(f,c,e.collisionBoxArray)}},ob.prototype.updateBucketOpacities=function(b,c,d){b.hasTextData()&&b.text.opacityVertexArray.clear(),b.hasIconData()&&b.icon.opacityVertexArray.clear(),b.hasCollisionBoxData()&&b.collisionBox.collisionVertexArray.clear(),b.hasCollisionCircleData()&&b.collisionCircle.collisionVertexArray.clear();var e=b.layers[0].layout,f=new jb(null,0,!1,!1,!0),g=e.get("text-allow-overlap"),h=e.get("icon-allow-overlap"),i=e.get("text-variable-anchor"),w="map"===e.get("text-rotation-alignment"),j="map"===e.get("text-pitch-alignment");h=new jb(null,0,g&&(h||!b.hasIconData()||e.get("icon-optional")),h&&(g||!b.hasTextData()||e.get("text-optional")),!0);!b.collisionArrays&&d&&(b.hasCollisionBoxData()||b.hasCollisionCircleData())&&b.deserializeCollisionBoxes(d);for(var g=0;g<b.symbolInstances.length;g++){e=b.symbolInstances.get(g);d=e.numHorizontalGlyphVertices;var k=e.numVerticalGlyphVertices,l=e.crossTileID,m=c[l],s=this.opacities[l];m?s=f:s||(s=h,this.opacities[l]=s),c[l]=!0;var x=d>0||k>0,t=e.numIconVertices>0;if(x){for(var x=xb(s.text),d=(d+k)/4,k=0;k<d;k++)b.text.opacityVertexArray.emplaceBack(x);var u=s.text.isHidden()?1:0;[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex,e.verticalPlacedTextSymbolIndex].forEach(function(a){a>=0&&(b.text.placedSymbolArray.get(a).hidden=u)});k=this.variableOffsets[e.crossTileID];k&&this.markUsedJustification(b,k.anchor,e)}if(t){for(var x=xb(s.icon),d=0;d<e.numIconVertices/4;d++)b.icon.opacityVertexArray.emplaceBack(x);b.icon.placedSymbolArray.get(g).hidden=s.icon.isHidden()}if(b.hasCollisionBoxData()||b.hasCollisionCircleData()){k=b.collisionArrays[g];if(k){if(k.textBox){t=new a.Point(0,0);x=!0;if(i){d=this.variableOffsets[l];d?(t=nb(d.anchor,d.width,d.height,d.radialOffset,d.textBoxScale),w&&t._rotate(j?this.transform.angle:-this.transform.angle)):x=!1}pb(b.collisionBox.collisionVertexArray,s.text.placed,!x,t.x,t.y)}k.iconBox&&pb(b.collisionBox.collisionVertexArray,s.icon.placed,!1);e=k.textCircles;if(e&&b.hasCollisionCircleData())for(var l=0;l<e.length;l+=5){d=m||0===e[l+4];pb(b.collisionCircle.collisionVertexArray,s.text.placed,d)}}}}b.sortFeatures(this.transform.angle),this.retainedQueryData[b.bucketInstanceId]&&(this.retainedQueryData[b.bucketInstanceId].featureSortOrder=b.featureSortOrder),b.hasTextData()&&b.text.opacityVertexBuffer&&b.text.opacityVertexBuffer.updateData(b.text.opacityVertexArray),b.hasIconData()&&b.icon.opacityVertexBuffer&&b.icon.opacityVertexBuffer.updateData(b.icon.opacityVertexArray),b.hasCollisionBoxData()&&b.collisionBox.collisionVertexBuffer&&b.collisionBox.collisionVertexBuffer.updateData(b.collisionBox.collisionVertexArray),b.hasCollisionCircleData()&&b.collisionCircle.collisionVertexBuffer&&b.collisionCircle.collisionVertexBuffer.updateData(b.collisionCircle.collisionVertexArray)},ob.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration},ob.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},ob.prototype.stillRecent=function(a){return this.commitTime+this.fadeDuration>a},ob.prototype.setStale=function(){this.stale=!0};var qb=Math.pow(2,25),rb=Math.pow(2,24),sb=Math.pow(2,17),tb=Math.pow(2,16),ub=Math.pow(2,9),vb=Math.pow(2,8),wb=Math.pow(2,1);function xb(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var b=a.placed?1:0;a=Math.floor(127*a.opacity);return a*qb+b*rb+a*sb+b*tb+a*ub+b*vb+a*wb+b}var yb=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};yb.prototype.continuePlacement=function(a,b,c,d,e){for(;this._currentTileIndex<a.length;){var f=a[this._currentTileIndex];if(b.placeLayerTile(d,f,c,this._seenCrossTileIDs),this._currentTileIndex++,e())return!0}};var zb=function(a,b,c,d,e,f,g){this.placement=new ob(a,e,f,g),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=d,this._done=!1};zb.prototype.isDone=function(){return this._done},zb.prototype.continuePlacement=function(b,c,d){for(var e=this,f=a.browser.now(),g=function(){var b=a.browser.now()-f;return!e._forceFullPlacement&&b>2};this._currentPlacementIndex>=0;){var h=c[b[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===h.type&&(!h.minzoom||h.minzoom<=i)&&(!h.maxzoom||h.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new yb()),this._inProgressLayer.continuePlacement(d[h.source],this.placement,this._showCollisionBoxes,h,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},zb.prototype.commit=function(a){return this.placement.commit(a),this.placement};var Ab=512/a.EXTENT/2,Bb=function(a,b,c){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=c;for(var c=0;c<b.length;c++){var d=b.get(c),e=d.key;this.indexedSymbolInstances[e]||(this.indexedSymbolInstances[e]=[]),this.indexedSymbolInstances[e].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,a)})}};Bb.prototype.getScaledCoordinates=function(b,c){var d=c.canonical.z-this.tileID.canonical.z;d=Ab/Math.pow(2,d);return{x:Math.floor((c.canonical.x*a.EXTENT+b.anchorX)*d),y:Math.floor((c.canonical.y*a.EXTENT+b.anchorY)*d)}},Bb.prototype.findMatches=function(a,b,c){for(var d=this.tileID.canonical.z<b.canonical.z?1:Math.pow(2,this.tileID.canonical.z-b.canonical.z),e=0;e<a.length;e++){var f=a.get(e);if(!f.crossTileID){var g=this.indexedSymbolInstances[f.key];if(g)for(var h=this.getScaledCoordinates(f,b),i=0,g=g;i<g.length;i+=1){var j=g[i];if(Math.abs(j.coord.x-h.x)<=d&&Math.abs(j.coord.y-h.y)<=d&&!c[j.crossTileID]){c[j.crossTileID]=!0,f.crossTileID=j.crossTileID;break}}}}};var Cb=function(){this.maxCrossTileID=0};Cb.prototype.generate=function(){return++this.maxCrossTileID};var Db=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Db.prototype.handleWrapJump=function(a){var b=Math.round((a-this.lng)/360);if(0!==b)for(var c in this.indexes){var d=this.indexes[c],e={};for(var f in d){var g=d[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+b),e[g.tileID.key]=g}this.indexes[c]=e}this.lng=a},Db.prototype.addBucket=function(a,b,c){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===b.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var d=0;d<b.symbolInstances.length;d++)b.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});d=this.usedCrossTileIDs[a.overscaledZ];for(var e in this.indexes){var f=this.indexes[e];if(Number(e)>a.overscaledZ)for(var g in f){var h=f[g];h.tileID.isChildOf(a)&&h.findMatches(b.symbolInstances,a,d)}else{h=f[a.scaledTo(Number(e)).key];h&&h.findMatches(b.symbolInstances,a,d)}}for(var f=0;f<b.symbolInstances.length;f++){h=b.symbolInstances.get(f);h.crossTileID||(h.crossTileID=c.generate(),d[h.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new Bb(a,b.symbolInstances,b.bucketInstanceId),!0},Db.prototype.removeBucketCrossTileIDs=function(a,b){for(var c in b.indexedSymbolInstances)for(var d=0,e=b.indexedSymbolInstances[c];d<e.length;d+=1){var f=e[d];delete this.usedCrossTileIDs[a][f.crossTileID]}},Db.prototype.removeStaleBuckets=function(a){var b=!1;for(var c in this.indexes){var d=this.indexes[c];for(var e in d)a[d[e].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[e]),delete d[e],b=!0)}return b};var Eb=function(){this.layerIndexes={},this.crossTileIDs=new Cb(),this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Eb.prototype.addLayer=function(a,b,c){var d=this.layerIndexes[a.id];void 0===d&&(d=this.layerIndexes[a.id]=new Db());var e=!1,f={};d.handleWrapJump(c);for(var c=0,b=b;c<b.length;c+=1){var g=b[c],h=g.getBucket(a);h&&a.id===h.layerIds[0]&&(h.bucketInstanceId||(h.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(g.tileID,h,this.crossTileIDs)&&(e=!0),f[h.bucketInstanceId]=!0)}return d.removeStaleBuckets(f)&&(e=!0),e},Eb.prototype.pruneUnusedLayers=function(a){var b={};for(var c in a.forEach(function(a){b[a]=!0}),this.layerIndexes)b[c]||delete this.layerIndexes[c]};var Fb=function(b,c){return a.emitValidationErrors(b,c&&c.filter(function(a){return"source.canvas"!==a.identifier}))},Gb=a.pick(U,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Hb=a.pick(U,["setCenter","setZoom","setBearing","setPitch"]),Ib=function(b){function c(d,e){var f=this;void 0===e&&(e={}),b.call(this),this.map=d,this.dispatcher=new u((Ja||(Ja=new Ia()),Ja),this),this.imageManager=new l(),this.imageManager.setEventedParent(this),this.glyphManager=new q(d._requestManager,e.localIdeographFontFamily),this.lineAtlas=new t(256,512),this.crossTileSymbolIndex=new Eb(),this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory(),this._loaded=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());var g=this;this._rtlTextPluginCallback=c.registerForPluginAvailability(function(a){for(var b in g.dispatcher.broadcast("loadRTLTextPlugin",a.pluginURL,a.completionCallback),g.sourceCaches)g.sourceCaches[b].reload()}),this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType){a=f.sourceCaches[a.sourceId];if(a){a=a.getSource();if(a&&a.vectorLayerIds)for(var b in f._layers){var c=f._layers[b];c.source===a.id&&f._validateLayer(c)}}}})}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.loadURL=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"}));var e="boolean"==typeof c.validate?c.validate:!a.isMapboxURL(b);b=this.map._requestManager.normalizeStyleURL(b,c.accessToken);c=this.map._requestManager.transformRequest(b,a.ResourceType.Style);this._request=a.getJSON(c,function(b,c){d._request=null,b?d.fire(new a.ErrorEvent(b)):c&&d._load(c,e)})},c.prototype.loadJSON=function(b,c){var d=this;void 0===c&&(c={}),this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.browser.frame(function(){d._request=null,d._load(b,!1!==c.validate)})},c.prototype._load=function(b,c){var d=this;if(!c||!Fb(this,a.validateStyle(b))){for(var e in this._loaded=!0,this.stylesheet=b,b.sources)this.addSource(e,b.sources[e],{validate:!1});b.sprite?this._spriteRequest=function(b,c,d){var e,f,g,h=a.browser.devicePixelRatio>1?"@2x":"",i=a.getJSON(c.transformRequest(c.normalizeSpriteURL(b,h,".json"),a.ResourceType.SpriteJSON),function(a,b){i=null,g||(g=a,e=b,j())}),k=a.getImage(c.transformRequest(c.normalizeSpriteURL(b,h,".png"),a.ResourceType.SpriteImage),function(a,b){k=null,g||(g=a,f=b,j())});function j(){if(g)d(g);else if(e&&f){var b=a.browser.getImageData(f),c={};for(var h in e){var i=e[h],o=i.width,j=i.height,k=i.x,l=i.y,p=i.sdf;i=i.pixelRatio;var m=new a.RGBAImage({width:o,height:j});a.RGBAImage.copy(b,m,{x:k,y:l},{x:0,y:0},{width:o,height:j}),c[h]={data:m,pixelRatio:i,sdf:p}}d(null,c)}}return{cancel:function(){i&&(i.cancel(),i=null),k&&(k.cancel(),k=null)}}}(b.sprite,this.map._requestManager,function(b,c){if(d._spriteRequest=null,b)d.fire(new a.ErrorEvent(b));else if(c)for(var e in c)d.imageManager.addImage(e,c[e]);d.imageManager.setLoaded(!0),d.fire(new a.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs);c=La(this.stylesheet.layers);this._order=c.map(function(a){return a.id}),this._layers={};for(var b=0,c=c;b<c.length;b+=1){var f=c[b];(f=a.createStyleLayer(f)).setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=f}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new s(this.stylesheet.light),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}},c.prototype._validateLayer=function(b){var c=this.sourceCaches[b.source];if(c){var d=b.sourceLayer;if(d){c=c.getSource();("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(d))&&this.fire(new a.ErrorEvent(new Error('Source layer "'+d+'" does not exist on source "'+c.id+'" as specified by style layer "'+b.id+'"')))}}},c.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},c.prototype._serializeLayers=function(a){for(var b=[],c=0,a=a;c<a.length;c+=1){var d=a[c];d=this._layers[d];"custom"!==d.type&&b.push(d.serialize())}return b},c.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var b in this._layers)if(this._layers[b].hasTransition())return!0;return!1},c.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},c.prototype.update=function(b){if(this._loaded){var c=this._changed;if(this._changed){var d=Object.keys(this._updatedLayers),e=Object.keys(this._removedLayers);for(var f in(d.length||e.length)&&this._updateWorkerLayers(d,e),this._updatedSources){d=this._updatedSources[f];"reload"===d?this._reloadSource(f):"clear"===d&&this._clearSource(f)}for(var g in this._updatedPaintProps)this._layers[g].updateTransitions(b);this.light.updateTransitions(b),this._resetUpdates()}for(var h in this.sourceCaches)this.sourceCaches[h].used=!1;for(var e=0,d=this._order;e<d.length;e+=1){var i=d[e];i=this._layers[i];i.recalculate(b),!i.isHidden(b.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}this.light.recalculate(b),this.z=b.zoom,c&&this.fire(new a.Event("data",{dataType:"style"}))}},c.prototype._updateWorkerLayers=function(a,b){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:b})},c.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},c.prototype.setState=function(b){var c=this;if(this._checkLoaded(),Fb(this,a.validateStyle(b)))return!1;(b=a.clone$1(b)).layers=La(b.layers);var d=Sa(this.serialize(),b).filter(function(a){return!(a.command in Hb)});if(0===d.length)return!1;var e=d.filter(function(a){return!(a.command in Gb)});if(e.length>0)throw new Error("Unimplemented: "+e.map(function(a){return a.command}).join(", ")+".");return d.forEach(function(a){"setTransition"!==a.command&&c[a.command].apply(c,a.args)}),this.stylesheet=b,!0},c.prototype.addImage=function(b,c){if(this.getImage(b))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(b,c),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.updateImage=function(a,b){this.imageManager.updateImage(a,b)},c.prototype.getImage=function(a){return this.imageManager.getImage(a)},c.prototype.removeImage=function(b){if(!this.getImage(b))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(b),this.fire(new a.Event("data",{dataType:"style"}))},c.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},c.prototype.addSource=function(b,c,d){var e=this;if(void 0===d&&(d={}),this._checkLoaded(),void 0!==this.sourceCaches[b])throw new Error("There is already a source with this ID");if(!c.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(c).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(c.type)>=0)||!this._validate(a.validateStyle.source,"sources."+b,c,null,d)){this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);var f=this.sourceCaches[b]=new Ea(b,c,this.dispatcher);f.style=this,f.setEventedParent(this,function(){return{isSourceLoaded:e.loaded(),source:f.serialize(),sourceId:b}}),f.onAdd(this.map),this._changed=!0}},c.prototype.removeSource=function(b){if(this._checkLoaded(),void 0===this.sourceCaches[b])throw new Error("There is no source with this ID");for(var c in this._layers)if(this._layers[c].source===b)return this.fire(new a.ErrorEvent(new Error('Source "'+b+'" cannot be removed while layer "'+c+'" is using it.')));var d=this.sourceCaches[b];delete this.sourceCaches[b],delete this._updatedSources[b],d.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b})),d.setEventedParent(null),d.clearTiles(),d.onRemove&&d.onRemove(this.map),this._changed=!0},c.prototype.setGeoJSONSourceData=function(a,b){this._checkLoaded(),this.sourceCaches[a].getSource().setData(b),this._changed=!0},c.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},c.prototype.addLayer=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=b.id;if(this.getLayer(e))this.fire(new a.ErrorEvent(new Error('Layer with id "'+e+'" already exists on this map')));else{var f;if("custom"===b.type){if(Fb(this,a.validateCustomStyleLayer(b)))return;f=a.createStyleLayer(b)}else{if("object"==typeof b.source&&(this.addSource(e,b.source),b=a.clone$1(b),b=a.extend(b,{source:e})),this._validate(a.validateStyle.layer,"layers."+e,b,{arrayIndex:-1},d))return;f=a.createStyleLayer(b),this._validateLayer(f),f.setEventedParent(this,{layer:{id:e}})}d=c?this._order.indexOf(c):this._order.length;if(c&&-1===d)this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.')));else{if(this._order.splice(d,0,e),this._layerOrderChanged=!0,this._layers[e]=f,this._removedLayers[e]&&f.source&&"custom"!==f.type){b=this._removedLayers[e];delete this._removedLayers[e],b.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}},c.prototype.moveLayer=function(b,c){if(this._checkLoaded(),this._changed=!0,this._layers[b]){if(b!==c){var d=this._order.indexOf(b);this._order.splice(d,1);d=c?this._order.indexOf(c):this._order.length;c&&-1===d?this.fire(new a.ErrorEvent(new Error('Layer with id "'+c+'" does not exist on this map.'))):(this._order.splice(d,0,b),this._layerOrderChanged=!0)}}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be moved.")))},c.prototype.removeLayer=function(b){this._checkLoaded();var c=this._layers[b];if(c){c.setEventedParent(null);var d=this._order.indexOf(b);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[b]=c,delete this._layers[b],delete this._updatedLayers[b],delete this._updatedPaintProps[b],c.onRemove&&c.onRemove(this.map)}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be removed.")))},c.prototype.getLayer=function(a){return this._layers[a]},c.prototype.setLayerZoomRange=function(b,c,d){this._checkLoaded();var e=this.getLayer(b);e?e.minzoom===c&&e.maxzoom===d||(null!=c&&(e.minzoom=c),null!=d&&(e.maxzoom=d),this._updateLayer(e)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot have zoom extent.")))},c.prototype.setFilter=function(b,c,d){void 0===d&&(d={}),this._checkLoaded();var e=this.getLayer(b);if(e){if(!a.deepEqual(e.filter,c))return null==c?(e.filter=void 0,void this._updateLayer(e)):void (this._validate(a.validateStyle.filter,"layers."+e.id+".filter",c,null,d)||(e.filter=a.clone$1(c),this._updateLayer(e)))}else this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be filtered.")))},c.prototype.getFilter=function(b){return a.clone$1(this.getLayer(b).filter)},c.prototype.setLayoutProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.deepEqual(f.getLayoutProperty(c),d)||(f.setLayoutProperty(c,d,e),this._updateLayer(f)):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getLayoutProperty=function(b,c){var d=this.getLayer(b);if(d)return d.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style.")))},c.prototype.setPaintProperty=function(b,c,d,e){void 0===e&&(e={}),this._checkLoaded();var f=this.getLayer(b);f?a.deepEqual(f.getPaintProperty(c),d)||(f.setPaintProperty(c,d,e)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[b]=!0):this.fire(new a.ErrorEvent(new Error("The layer '"+b+"' does not exist in the map's style and cannot be styled.")))},c.prototype.getPaintProperty=function(a,b){return this.getLayer(a).getPaintProperty(b)},c.prototype.setFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=b.sourceLayer,f=this.sourceCaches[d];b=parseInt(b.id,10);if(void 0!==f){var g=f.getSource().type;"geojson"===g&&e?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==g||e?isNaN(b)||b<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative."))):f.setFeatureState(e,b,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.removeFeatureState=function(b,c){this._checkLoaded();var d=b.source,e=this.sourceCaches[d];if(void 0!==e){var f=e.getSource().type,g="vector"===f?b.sourceLayer:void 0,h=parseInt(b.id,10);"vector"!==f||g?void 0!==b.id&&isNaN(h)||h<0?this.fire(new a.ErrorEvent(new Error("The feature id parameter must be non-negative."))):c&&"string"!=typeof b.id&&"number"!=typeof b.id?this.fire(new a.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):e.removeFeatureState(g,h,c):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},c.prototype.getFeatureState=function(b){this._checkLoaded();var c=b.source,d=b.sourceLayer,e=this.sourceCaches[c];b=parseInt(b.id,10);if(void 0!==e)if("vector"!==e.getSource().type||d){if(!(isNaN(b)||b<0))return e.getFeatureState(d,b);this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")))}else this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));else this.fire(new a.ErrorEvent(new Error("The source '"+c+"' does not exist in the map's style.")))},c.prototype.getTransition=function(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},c.prototype.serialize=function(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return void 0!==a})},c.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},c.prototype._flattenAndSortRenderedFeatures=function(a){for(var b=this,c=function(a){return"fill-extrusion"===b._layers[a].type},d={},e=[],f=this._order.length-1;f>=0;f--){var g=this._order[f];if(c(g)){d[g]=f;for(var h=0,i=a;h<i.length;h+=1){var m=i[h][g];if(m)for(var j=0,m=m;j<m.length;j+=1){var k=m[j];e.push(k)}}}}e.sort(function(a,b){return b.intersectionZ-a.intersectionZ});for(var k=[],m=this._order.length-1;m>=0;m--){j=this._order[m];if(c(j))for(var i=e.length-1;i>=0;i--){g=e[i].feature;if(d[g.layer.id]<m)break;k.push(g),e.pop()}else for(var h=0,f=a;h<f.length;h+=1){g=f[h][j];if(g)for(var i=0,g=g;i<g.length;i+=1){var l=g[i];k.push(l.feature)}}}return k},c.prototype.queryRenderedFeatures=function(b,c,d){c&&c.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);var e={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var f=0,g=c.layers;f<g.length;f+=1){var h=g[f],i=this._layers[h];if(!i)return this.fire(new a.ErrorEvent(new Error("The layer '"+h+"' does not exist in the map's style and cannot be queried for features."))),[];e[i.source]=!0}}h=[];for(var j in this.sourceCaches)c.layers&&!e[j]||h.push(F(this.sourceCaches[j],this._layers,b,c,d));return this.placement&&h.push(function(a,b,c,d,e,f){for(var g={},h=e.queryRenderedSymbols(c),e=[],c=0,i=Object.keys(h).map(Number);c<i.length;c+=1){var j=i[c];e.push(f[j])}e.sort(G);for(var j=function(){var b=k[n],c=b.featureIndex.lookupSymbolFeatures(h[b.bucketInstanceId],b.bucketIndex,b.sourceLayerIndex,d.filter,d.layers,a);for(var e in c){var f=g[e]=g[e]||[],i=c[e];i.sort(function(a,c){var d=b.featureSortOrder;if(d){var e=d.indexOf(a.featureIndex);return d.indexOf(c.featureIndex)-e}return c.featureIndex-a.featureIndex});for(var l=0,i=i;l<i.length;l+=1){var j=i[l];f.push(j)}}},n=0,k=e;n<k.length;n+=1)j();f=function(c){g[c].forEach(function(d){d=d.feature;var e=a[c];e=b[e.source].getFeatureState(d.layer["source-layer"],d.id);d.source=d.layer.source,d.layer["source-layer"]&&(d.sourceLayer=d.layer["source-layer"]),d.state=e})};for(var l in g)f(l);return g}(this._layers,this.sourceCaches,b,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)},c.prototype.querySourceFeatures=function(b,c){c&&c.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);b=this.sourceCaches[b];return b?function(a,b){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),d=[],e={},f=0;f<c.length;f++){var g=c[f],h=g.tileID.canonical.key;e[h]||(e[h]=!0,g.querySourceFeatures(d,b))}return d}(b,c):[]},c.prototype.addSourceType=function(a,b,d){return c.getSourceType(a)?d(new Error('A source type called "'+a+'" already exists.')):(c.setSourceType(a,b),b.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:b.workerSourceURL},d):d(null,null))},c.prototype.getLight=function(){return this.light.getLight()},c.prototype.setLight=function(b,c){void 0===c&&(c={}),this._checkLoaded();var d=this.light.getLight(),e=!1;for(var f in b)if(!a.deepEqual(b[f],d[f])){e=!0;break}if(e){d={now:a.browser.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(b,c),this.light.updateTransitions(d)}},c.prototype._validate=function(b,c,d,e,f){return void 0===f&&(f={}),(!f||!1!==f.validate)&&Fb(this,b.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:d,styleSpec:a.styleSpec},e)))},c.prototype._remove=function(){for(var b in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[b].clearTiles();this.dispatcher.remove()},c.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},c.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},c.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)},c.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},c.prototype._updatePlacement=function(b,c,d,e){for(var f=!1,g=!1,h={},i=0,l=this._order;i<l.length;i+=1){var j=l[i];j=this._layers[j];if("symbol"===j.type){if(!h[j.source]){var k=this.sourceCaches[j.source];h[j.source]=k.getRenderableIds(!0).map(function(a){return k.getTileByID(a)}).sort(function(a,b){return b.tileID.overscaledZ-a.tileID.overscaledZ||(a.tileID.isLessThan(b.tileID)?-1:1)})}j=this.crossTileSymbolIndex.addLayer(j,h[j.source],b.center.lng);f=f||j}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);j=this._layerOrderChanged||0===d;if((j||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.browser.now()))&&(this.pauseablePlacement=new zb(b,this._order,j,c,d,e,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,h),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.browser.now()),g=!0),f&&this.pauseablePlacement.placement.setStale()),g||f)for(var l=0,i=this._order;l<i.length;l+=1){b=i[l];j=this._layers[b];"symbol"===j.type&&this.placement.updateLayerOpacities(j,h[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.browser.now())},c.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},c.prototype.getImages=function(a,b,c){this.imageManager.getImages(b.icons,c)},c.prototype.getGlyphs=function(a,b,c){this.glyphManager.getGlyphs(b.stacks,c)},c.prototype.getResource=function(b,c,d){return a.makeRequest(c,d)},c}(a.Evented);Ib.getSourceType=function(a){return C[a]},Ib.setSourceType=function(a,b){C[a]=b},Ib.registerForPluginAvailability=a.registerForPluginAvailability;var Jb=a.createLayout([{name:"a_pos",type:"Int16",components:2}]),Kb=bc("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}");y=bc("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}");A=bc("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}");B=bc("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}");e=bc("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}");n=bc("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}");x=bc("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}");var Lb=bc("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Mb=bc("uniform float u_overscale_factor;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {float alpha=0.5;vec4 color=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {color=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {color*=.2;}float extrude_scale_length=length(v_extrude_scale);float extrude_length=length(v_extrude)*extrude_scale_length;float stroke_width=15.0*extrude_scale_length/u_overscale_factor;float radius=v_radius*extrude_scale_length;float distance_to_edge=abs(extrude_length-radius);float opacity_t=smoothstep(-stroke_width,0.0,-distance_to_edge);gl_FragColor=opacity_t*color;}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;varying float v_radius;varying vec2 v_extrude;varying vec2 v_extrude_scale;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);highp float padding_factor=1.2;gl_Position.xy+=a_extrude*u_extrude_scale*padding_factor*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;v_radius=abs(a_extrude.y);v_extrude=a_extrude*padding_factor;v_extrude_scale=u_extrude_scale*u_camera_to_center_distance*collision_perspective_ratio;}"),Nb=bc("uniform highp vec4 u_color;void main() {gl_FragColor=u_color;}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ob=bc("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Pb=bc("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Qb=bc("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Rb=bc("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec4 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Sb=bc("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Tb=bc("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec4 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Ub=bc("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;return (data.r+data.g*256.0+data.b*256.0*256.0)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Vb=bc("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Wb=bc("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Xb=bc("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Yb=bc("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec4 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float pixelRatio=u_scale.x;float tileZoomRatio=u_scale.y;float fromScale=u_scale.z;float toScale=u_scale.w;vec2 display_size_a=vec2((pattern_br_a.x-pattern_tl_a.x)/pixelRatio,(pattern_br_a.y-pattern_tl_a.y)/pixelRatio);vec2 display_size_b=vec2((pattern_br_b.x-pattern_tl_b.x)/pixelRatio,(pattern_br_b.y-pattern_tl_b.y)/pixelRatio);vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x,1.0);float x_b=mod(v_linesofar/pattern_size_b.x,1.0);float y_a=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_a.y+2.0)/2.0)/pattern_size_a.y);float y_b=0.5+(v_normal.y*clamp(v_width2.s,0.0,(pattern_size_b.y+2.0)/2.0)/pattern_size_b.y);vec2 pos_a=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,vec2(x_a,y_a));vec2 pos_b=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,vec2(x_b,y_b));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);}"),Zb=bc("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),$b=bc("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ac=bc("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}");bc=bc("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size[0],a_size[1],u_size_t)/256.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size[0]/256.0;} else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {size=u_size;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=vec2(tex.x,tex.y);v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}");function bc(a,b){var c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d={};return{fragmentSource:a.replace(c,function(a,b,c,e,f){return d[f]=!0,"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"}),vertexSource:b=b.replace(c,function(a,b,c,e,f){a="float"===e?"vec2":"vec4";var g=f.match(/color/)?"color":a;return d[f]?"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float u_"+f+"_t;\nattribute "+c+" "+a+" a_"+f+";\nvarying "+c+" "+e+" "+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===g?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+f+" = unpack_mix_"+g+"(a_"+f+", u_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"define"===b?"\n#ifndef HAS_UNIFORM_u_"+f+"\nuniform lowp float u_"+f+"_t;\nattribute "+c+" "+a+" a_"+f+";\n#else\nuniform "+c+" "+e+" u_"+f+";\n#endif\n":"vec4"===g?"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = a_"+f+";\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+f+"\n    "+c+" "+e+" "+f+" = unpack_mix_"+g+"(a_"+f+", u_"+f+"_t);\n#else\n    "+c+" "+e+" "+f+" = u_"+f+";\n#endif\n"})}}var cc=Object.freeze({prelude:Kb,background:y,backgroundPattern:A,circle:B,clippingMask:e,heatmap:n,heatmapTexture:x,collisionBox:Lb,collisionCircle:Mb,debug:Nb,fill:Ob,fillOutline:Pb,fillOutlinePattern:Qb,fillPattern:Rb,fillExtrusion:Sb,fillExtrusionPattern:Tb,hillshadePrepare:Ub,hillshade:Vb,line:Wb,lineGradient:Xb,linePattern:Yb,lineSDF:Zb,raster:$b,symbolIcon:ac,symbolSDF:bc}),dc=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};dc.prototype.bind=function(a,b,c,d,e,f,g,h){this.context=a;for(var i=this.boundPaintVertexBuffers.length!==d.length,j=0;!i&&j<d.length;j++)this.boundPaintVertexBuffers[j]!==d[j]&&(i=!0);j=!this.vao||this.boundProgram!==b||this.boundLayoutVertexBuffer!==c||i||this.boundIndexBuffer!==e||this.boundVertexOffset!==f||this.boundDynamicVertexBuffer!==g||this.boundDynamicVertexBuffer2!==h;!a.extVertexArrayObject||j?this.freshBind(b,c,d,e,f,g,h):(a.bindVertexArrayOES.set(this.vao),g&&g.bind(),e&&e.dynamicDraw&&e.bind(),h&&h.bind())},dc.prototype.freshBind=function(a,b,c,d,e,f,g){var h,i=a.numAttributes,l=this.context,j=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),h=0,this.boundProgram=a,this.boundLayoutVertexBuffer=b,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=e,this.boundDynamicVertexBuffer=f,this.boundDynamicVertexBuffer2=g;else{h=l.currentNumAttributes||0;for(var k=i;k<h;k++)j.disableVertexAttribArray(k)}b.enableAttributes(j,a);for(var k=0,h=c;k<h.length;k+=1)h[k].enableAttributes(j,a);f&&f.enableAttributes(j,a),g&&g.enableAttributes(j,a),b.bind(),b.setVertexAttribPointers(j,a,e);for(var h=0,k=c;h<k.length;h+=1){b=k[h];b.bind(),b.setVertexAttribPointers(j,a,e)}f&&(f.bind(),f.setVertexAttribPointers(j,a,e)),d&&d.bind(),g&&(g.bind(),g.setVertexAttribPointers(j,a,e)),l.currentNumAttributes=i},dc.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ec=function(a,b,c,d,e){var f=a.gl;this.program=f.createProgram();var g=c.defines();e&&g.push("#define OVERDRAW_INSPECTOR;");e=g.concat(Kb.fragmentSource,b.fragmentSource).join("\n");g=g.concat(Kb.vertexSource,b.vertexSource).join("\n");b=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(b,e),f.compileShader(b),f.attachShader(this.program,b);e=f.createShader(f.VERTEX_SHADER);f.shaderSource(e,g),f.compileShader(e),f.attachShader(this.program,e);for(var b=c.layoutAttributes||[],g=0;g<b.length;g++)f.bindAttribLocation(this.program,g,b[g].name);f.linkProgram(this.program),this.numAttributes=f.getProgramParameter(this.program,f.ACTIVE_ATTRIBUTES),this.attributes={};for(var e={},b=0;b<this.numAttributes;b++){g=f.getActiveAttrib(this.program,b);g&&(this.attributes[g.name]=f.getAttribLocation(this.program,g.name))}for(var g=f.getProgramParameter(this.program,f.ACTIVE_UNIFORMS),b=0;b<g;b++){var h=f.getActiveUniform(this.program,b);h&&(e[h.name]=f.getUniformLocation(this.program,h.name))}this.fixedUniforms=d(a,e),this.binderUniforms=c.getUniforms(a,e)};function fc(b,c,d){var e=1/hb(d,1,c.transform.tileZoom),f=Math.pow(2,d.tileID.overscaledZ);c=d.tileSize*Math.pow(2,c.transform.tileZoom)/f;f=c*(d.tileID.canonical.x+d.tileID.wrap*f);c=c*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[a.browser.devicePixelRatio,e,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[f>>16,c>>16],u_pixel_coord_lower:[65535&f,65535&c]}}ec.prototype.draw=function(a,b,c,d,e,f,g,h,i,u,j,k,l,v,o,r){var s=a.gl;for(var t in a.program.set(this.program),a.setDepthMode(c),a.setStencilMode(d),a.setColorMode(e),a.setCullFace(f),this.fixedUniforms)this.fixedUniforms[t].set(g[t]);v&&v.setUniforms(a,this.binderUniforms,k,{zoom:l});for(var d=(c={},c[s.LINES]=2,c[s.TRIANGLES]=3,c[s.LINE_STRIP]=1,c)[b],e=0,f=j.get();e<f.length;e+=1){g=f[e];k=g.vaos||(g.vaos={});(k[h]||(k[h]=new dc())).bind(a,this,i,v?v.getPaintVertexBuffers():[],u,g.vertexOffset,o,r),s.drawElements(b,g.primitiveLength*d,s.UNSIGNED_SHORT,g.primitiveOffset*d*2)}};var gc=function(b,c,d,e){var f=c.style.light,g=f.properties.get("position");g=[g.x,g.y,g.z];var h=a.create$1();"viewport"===f.properties.get("anchor")&&a.fromRotation(h,-c.transform.angle),a.transformMat3(g,g,h);c=f.properties.get("color");return{u_matrix:b,u_lightpos:g,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+d,u_opacity:e}},hc=function(b,c,d,e,f,g,h){return a.extend(gc(b,c,d,e),fc(g,c,h),{u_height_factor:-Math.pow(2,f.overscaledZ)/h.tileSize/8})},ic=function(a){return{u_matrix:a}},X=function(b,c,d,e){return a.extend(ic(b),fc(d,c,e))},jc=function(a,b){return{u_matrix:a,u_world:b}},Y=function(b,c,d,e,f){return a.extend(X(b,c,d,e),{u_world:f})},kc=function(b,c,d,e){var f,g=b.transform;if("map"===e.paint.get("circle-pitch-alignment")){var h=hb(d,1,g.zoom);f=!0,h=[h,h]}else f=!1,h=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+("map"===e.paint.get("circle-pitch-scale")),u_matrix:b.translatePosMatrix(c.posMatrix,d,e.paint.get("circle-translate"),e.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:a.browser.devicePixelRatio,u_extrude_scale:h}};y=function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(b,c.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_overscale_factor:new a.Uniform1f(b,c.u_overscale_factor)}};var lc=function(a,b,c){var d=hb(c,1,b.zoom),e=Math.pow(2,b.zoom-c.tileID.overscaledZ);c=c.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:b.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[b.pixelsToGLUnits[0]/(d*e),b.pixelsToGLUnits[1]/(d*e)],u_overscale_factor:c}},mc=function(a,b){return{u_matrix:a,u_color:b}},nc=function(a){return{u_matrix:a}},oc=function(a,b,c,d){return{u_matrix:a,u_extrude_scale:hb(b,1,c),u_intensity:d}},pc=function(b,c,d,e){var f=a.create();a.ortho(f,0,b.width,b.height,0,0,1);b=b.context.gl;return{u_matrix:f,u_world:[b.drawingBufferWidth,b.drawingBufferHeight],u_image:d,u_color_ramp:e,u_opacity:c.paint.get("heatmap-opacity")}},qc=function(a,b,c){var d=c.paint.get("hillshade-shadow-color"),e=c.paint.get("hillshade-highlight-color"),f=c.paint.get("hillshade-accent-color"),g=c.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===c.paint.get("hillshade-illumination-anchor")&&(g-=a.transform.angle);var h=!a.options.moving;return{u_matrix:a.transform.calculatePosMatrix(b.tileID.toUnwrapped(),h),u_image:0,u_latrange:sc(a,b.tileID),u_light:[c.paint.get("hillshade-exaggeration"),g],u_shadow:d,u_highlight:e,u_accent:f}},rc=function(b,c){var d=b.dem.stride,e=a.create();return a.ortho(e,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(e,e,[0,-a.EXTENT,0]),{u_matrix:e,u_image:1,u_dimension:[d,d],u_zoom:b.tileID.overscaledZ,u_maxzoom:c}};function sc(b,c){b=Math.pow(2,c.canonical.z);c=c.canonical.y;return[new a.MercatorCoordinate(0,c/b).toLngLat().lat,new a.MercatorCoordinate(0,(c+1)/b).toLngLat().lat]}var tc=function(b,c,d){var e=b.transform;return{u_matrix:yc(b,c,d),u_ratio:1/hb(c,1,e.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_units_to_pixels:[1/e.pixelsToGLUnits[0],1/e.pixelsToGLUnits[1]]}},uc=function(b,c,d){return a.extend(tc(b,c,d),{u_image:0})},vc=function(b,c,d,e){var f=b.transform,g=xc(c,f);return{u_matrix:yc(b,c,d),u_texsize:c.imageAtlasTexture.size,u_ratio:1/hb(c,1,f.zoom),u_device_pixel_ratio:a.browser.devicePixelRatio,u_image:0,u_scale:[a.browser.devicePixelRatio,g,e.fromScale,e.toScale],u_fade:e.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},wc=function(b,c,d,e,f){var g=b.transform,h=b.lineAtlas;g=xc(c,g);var j="round"===d.layout.get("line-cap"),i=h.getDash(e.from,j);e=h.getDash(e.to,j);j=i.width*f.fromScale;var k=e.width*f.toScale;return a.extend(tc(b,c,d),{u_patternscale_a:[g/j,-i.height/2],u_patternscale_b:[g/k,-e.height/2],u_sdfgamma:h.width/(256*Math.min(j,k)*a.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:i.y,u_tex_y_b:e.y,u_mix:f.t})};function xc(a,b){return 1/hb(a,1,b.tileZoom)}function yc(a,b,c){return a.translatePosMatrix(b.tileID.posMatrix,b,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}var zc=function(a,b,c,d,e){return{u_matrix:a,u_tl_parent:b,u_scale_parent:c,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*e.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:e.paint.get("raster-brightness-min"),u_brightness_high:e.paint.get("raster-brightness-max"),u_saturation_factor:(a=e.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(b=e.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:Ac(e.paint.get("raster-hue-rotate"))}};function Ac(a){a*=Math.PI/180;var b=Math.sin(a);a=Math.cos(a);return[(2*a+1)/3,(-Math.sqrt(3)*b-a+1)/3,(Math.sqrt(3)*b-a+1)/3]}var Bc=function(a,b,c,d,e,f,g,h,i,k){var j=e.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:b?b.uSizeT:0,u_size:b?b.uSize:0,u_camera_to_center_distance:j.cameraToCenterDistance,u_pitch:j.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:j.width/j.height,u_fade_change:e.options.fadeDuration?e.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:g,u_coord_matrix:h,u_is_text:+i,u_pitch_with_map:+d,u_texsize:k,u_texture:0}},Cc=function(b,c,d,e,f,g,h,i,m,j,k){var l=f.transform;return a.extend(Bc(b,c,d,e,f,g,h,i,m,j),{u_gamma_scale:e?Math.cos(l._pitch)*l.cameraToCenterDistance:1,u_device_pixel_ratio:a.browser.devicePixelRatio,u_is_halo:+k})},Dc=function(a,b,c){return{u_matrix:a,u_opacity:b,u_color:c}},Ec=function(b,c,d,e,f,g){return a.extend(function(a,b,c,d){var e=c.imageManager.getPattern(a.from);a=c.imageManager.getPattern(a.to);var f=c.imageManager.getPixelSize(),g=f.width;f=f.height;var i=Math.pow(2,d.tileID.overscaledZ),h=d.tileSize*Math.pow(2,c.transform.tileZoom)/i;i=h*(d.tileID.canonical.x+d.tileID.wrap*i);h=h*d.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:e.tl,u_pattern_br_a:e.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[g,f],u_mix:b.t,u_pattern_size_a:e.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/hb(d,1,c.transform.tileZoom),u_pixel_coord_upper:[i>>16,h>>16],u_pixel_coord_lower:[65535&i,65535&h]}}(e,g,d,f),{u_matrix:b,u_opacity:c})},Fc={fillExtrusion:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fillExtrusionPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_lightpos:new a.Uniform3f(b,c.u_lightpos),u_lightintensity:new a.Uniform1f(b,c.u_lightintensity),u_lightcolor:new a.Uniform3f(b,c.u_lightcolor),u_vertical_gradient:new a.Uniform1f(b,c.u_vertical_gradient),u_height_factor:new a.Uniform1f(b,c.u_height_factor),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade),u_opacity:new a.Uniform1f(b,c.u_opacity)}},fill:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},fillPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},fillOutline:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world)}},fillOutlinePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_texsize:new a.Uniform2f(b,c.u_texsize),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},circle:function(b,c){return{u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(b,c.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(b,c.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},collisionBox:y,collisionCircle:y,debug:function(b,c){return{u_color:new a.UniformColor(b,c.u_color),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},clippingMask:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmap:function(b,c){return{u_extrude_scale:new a.Uniform1f(b,c.u_extrude_scale),u_intensity:new a.Uniform1f(b,c.u_intensity),u_matrix:new a.UniformMatrix4f(b,c.u_matrix)}},heatmapTexture:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_world:new a.Uniform2f(b,c.u_world),u_image:new a.Uniform1i(b,c.u_image),u_color_ramp:new a.Uniform1i(b,c.u_color_ramp),u_opacity:new a.Uniform1f(b,c.u_opacity)}},hillshade:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_latrange:new a.Uniform2f(b,c.u_latrange),u_light:new a.Uniform2f(b,c.u_light),u_shadow:new a.UniformColor(b,c.u_shadow),u_highlight:new a.UniformColor(b,c.u_highlight),u_accent:new a.UniformColor(b,c.u_accent)}},hillshadePrepare:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_image:new a.Uniform1i(b,c.u_image),u_dimension:new a.Uniform2f(b,c.u_dimension),u_zoom:new a.Uniform1f(b,c.u_zoom),u_maxzoom:new a.Uniform1f(b,c.u_maxzoom)}},line:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels)}},lineGradient:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_image:new a.Uniform1i(b,c.u_image)}},linePattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_texsize:new a.Uniform2f(b,c.u_texsize),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_image:new a.Uniform1i(b,c.u_image),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_scale:new a.Uniform4f(b,c.u_scale),u_fade:new a.Uniform1f(b,c.u_fade)}},lineSDF:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_ratio:new a.Uniform1f(b,c.u_ratio),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(b,c.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(b,c.u_patternscale_a),u_patternscale_b:new a.Uniform2f(b,c.u_patternscale_b),u_sdfgamma:new a.Uniform1f(b,c.u_sdfgamma),u_image:new a.Uniform1i(b,c.u_image),u_tex_y_a:new a.Uniform1f(b,c.u_tex_y_a),u_tex_y_b:new a.Uniform1f(b,c.u_tex_y_b),u_mix:new a.Uniform1f(b,c.u_mix)}},raster:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_tl_parent:new a.Uniform2f(b,c.u_tl_parent),u_scale_parent:new a.Uniform1f(b,c.u_scale_parent),u_buffer_scale:new a.Uniform1f(b,c.u_buffer_scale),u_fade_t:new a.Uniform1f(b,c.u_fade_t),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image0:new a.Uniform1i(b,c.u_image0),u_image1:new a.Uniform1i(b,c.u_image1),u_brightness_low:new a.Uniform1f(b,c.u_brightness_low),u_brightness_high:new a.Uniform1f(b,c.u_brightness_high),u_saturation_factor:new a.Uniform1f(b,c.u_saturation_factor),u_contrast_factor:new a.Uniform1f(b,c.u_contrast_factor),u_spin_weights:new a.Uniform3f(b,c.u_spin_weights)}},symbolIcon:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture)}},symbolSDF:function(b,c){return{u_is_size_zoom_constant:new a.Uniform1i(b,c.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(b,c.u_is_size_feature_constant),u_size_t:new a.Uniform1f(b,c.u_size_t),u_size:new a.Uniform1f(b,c.u_size),u_camera_to_center_distance:new a.Uniform1f(b,c.u_camera_to_center_distance),u_pitch:new a.Uniform1f(b,c.u_pitch),u_rotate_symbol:new a.Uniform1i(b,c.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(b,c.u_aspect_ratio),u_fade_change:new a.Uniform1f(b,c.u_fade_change),u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(b,c.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(b,c.u_coord_matrix),u_is_text:new a.Uniform1f(b,c.u_is_text),u_pitch_with_map:new a.Uniform1i(b,c.u_pitch_with_map),u_texsize:new a.Uniform2f(b,c.u_texsize),u_texture:new a.Uniform1i(b,c.u_texture),u_gamma_scale:new a.Uniform1f(b,c.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(b,c.u_device_pixel_ratio),u_is_halo:new a.Uniform1f(b,c.u_is_halo)}},background:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_color:new a.UniformColor(b,c.u_color)}},backgroundPattern:function(b,c){return{u_matrix:new a.UniformMatrix4f(b,c.u_matrix),u_opacity:new a.Uniform1f(b,c.u_opacity),u_image:new a.Uniform1i(b,c.u_image),u_pattern_tl_a:new a.Uniform2f(b,c.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(b,c.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(b,c.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(b,c.u_pattern_br_b),u_texsize:new a.Uniform2f(b,c.u_texsize),u_mix:new a.Uniform1f(b,c.u_mix),u_pattern_size_a:new a.Uniform2f(b,c.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(b,c.u_pattern_size_b),u_scale_a:new a.Uniform1f(b,c.u_scale_a),u_scale_b:new a.Uniform1f(b,c.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(b,c.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(b,c.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(b,c.u_tile_units_to_pixels)}}};function Gc(b,c){for(var b=b.sort(function(a,b){return a.tileID.isLessThan(b.tileID)?-1:b.tileID.isLessThan(a.tileID)?1:0}),d=0;d<b.length;d++){var e={},f=b[d],g=b.slice(d+1);Hc(f.tileID.wrapped(),f.tileID,g,new a.OverscaledTileID(0,f.tileID.wrap+1,0,0,0),e),f.setMask(e,c)}}function Hc(b,c,d,e,f){for(var g=0;g<d.length;g++){var h=d[g];if(e.isLessThan(h.tileID))break;if(c.key===h.tileID.key)return;if(h.tileID.isChildOf(c)){for(var h=c.children(1/0),i=0;i<h.length;i++)Hc(b,h[i],d.slice(g),e,f);return}}i=c.overscaledZ-b.overscaledZ;h=new a.CanonicalTileID(i,c.canonical.x-(b.canonical.x<<i),c.canonical.y-(b.canonical.y<<i));f[h.key]=f[h.key]||h}function Ic(a,b,c,d,e){for(var f=a.context,g=f.gl,h=e?a.useProgram("collisionCircle"):a.useProgram("collisionBox"),i=0;i<d.length;i++){var l=d[i],j=b.getTile(l),k=j.getBucket(c);if(k){k=e?k.collisionCircle:k.collisionBox;k&&h.draw(f,e?g.TRIANGLES:g.LINES,za.disabled,Aa.disabled,a.colorModeForRenderPass(),Ca.disabled,lc(l.posMatrix,a.transform,j),c.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,null,a.transform.zoom,null,null,k.collisionVertexBuffer)}}}var Jc=a.identity(new Float32Array(16));function Kc(b,c,d,e,f,g){var h=a.getAnchorAlignment(b);c=-(h.horizontalAlign-.5)*c;h=-(h.verticalAlign-.5)*d;d=a.evaluateRadialOffset(b,e);return new a.Point((c/f+d[0])*g,(h/f+d[1])*g)}function Lc(b,c,d,e,f,g,h,i,E,j){var k=b.text.placedSymbolArray,l=b.text.dynamicLayoutVertexArray;l.clear();for(var F=0;F<k.length;F++){var v=k.get(F),w=!v.hidden&&v.crossTileID?e[v.crossTileID]:null;if(w){var x=new a.Point(v.anchorX,v.anchorY),y=Va(x,d?i:h),z=.5+g.cameraToCenterDistance/y.signedDistanceFromCamera*.5;z=f.evaluateSizeForFeature(b.textSizeData,j,v)*z/a.ONE_EM;d&&(z*=b.tilePixelRatio/E);for(var A=w.width,B=w.height,C=w.radialOffset,D=w.textBoxScale,w=Kc(w.anchor,A,B,C,D,z),A=d?Va(x.add(w),h).point:y.point.add(c?w.rotate(-g.angle):w),B=0;B<v.numGlyphs;B++)a.addDynamicAttributes(l,A,0)}else db(v.numGlyphs,l)}b.text.dynamicLayoutVertexBuffer.updateData(l)}function Mc(b,c,d,e,f,g,h,i,ka,j,k,l,la){for(var r,x,F=b.context,K=F.gl,L=b.transform,i="map"===i,ka="map"===ka,N=i&&"point"!==d.layout.get("symbol-placement"),O=i&&!ka&&!N,P=void 0!==d.layout.get("symbol-sort-key").constantOr(1),aa=b.depthModeForSublayer(0,za.ReadOnly),Q=d.layout.get("text-variable-anchor"),ma=[],na=0,e=e;na<e.length;na+=1){var R=e[na],S=c.getTile(R),T=S.getBucket(d);if(T){var ba=f?T.text:T.icon;if(ba&&ba.segments.get().length){var ca=ba.programConfigurations.get(d.id),da=f||T.sdfIcons,ea=f?T.textSizeData:T.iconSizeData;r||(r=b.useProgram(da?"symbolSDF":"symbolIcon",ca),x=a.evaluateSizeForZoom(ea,L.zoom)),F.activeTexture.set(K.TEXTURE0);ca=void 0;var fa=void 0,ga=void 0;if(f)fa=S.glyphAtlasTexture,ga=K.LINEAR,ca=S.glyphAtlasTexture.size;else{var ha=1!==d.layout.get("icon-size").constantOr(0)||T.iconsNeedLinear,ia=ka||0!==L.pitch;fa=S.imageAtlasTexture,ga=da||b.options.rotating||b.options.zooming||ha||ia?K.LINEAR:K.NEAREST,ca=S.imageAtlasTexture.size}ha=hb(S,1,b.transform.zoom);ia=W(R.posMatrix,ka,i,b.transform,ha);ha=Ua(R.posMatrix,ka,i,b.transform,ha);if(N)Xa(T,R.posMatrix,b,f,ia,ha,ka,j);else if(f&&x&&Q){var ja=Math.pow(2,L.zoom-S.tileID.overscaledZ);Lc(T,i,ka,la,a.symbolSize,L,ia,R.posMatrix,ja,x)}T=b.translatePosMatrix(R.posMatrix,S,g,h);ja=N||f&&Q?Jc:ia;R=b.translatePosMatrix(ha,S,g,h,!0);ia=da&&0!==d.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1);ha={program:r,buffers:ba,uniformValues:da?Cc(ea.kind,x,O,ka,b,T,ja,R,f,ca,!0):Bc(ea.kind,x,O,ka,b,T,ja,R,f,ca),atlasTexture:fa,atlasInterpolation:ga,isSDF:da,hasHalo:ia};if(P)for(var S=0,ea=ba.segments.get();S<ea.length;S+=1){T=ea[S];ma.push({segments:new a.SegmentVector([T]),sortKey:T.sortKey,state:ha})}else ma.push({segments:ba.segments,sortKey:0,state:ha})}}}P&&ma.sort(function(a,b){return a.sortKey-b.sortKey});for(var ja=0,R=ma;ja<R.length;ja+=1){ca=R[ja];fa=ca.state;if(fa.atlasTexture.bind(fa.atlasInterpolation,K.CLAMP_TO_EDGE),fa.isSDF){ga=fa.uniformValues;fa.hasHalo&&(ga.u_is_halo=1,Nc(fa.buffers,ca.segments,d,b,fa.program,aa,k,l,ga)),ga.u_is_halo=0}Nc(fa.buffers,ca.segments,d,b,fa.program,aa,k,l,fa.uniformValues)}}function Nc(a,b,c,d,e,f,g,h,i){var k=d.context,j=k.gl;e.draw(k,j.TRIANGLES,f,g,h,Ca.disabled,i,c.id,a.layoutVertexBuffer,a.indexBuffer,b,c.paint,d.transform.zoom,a.programConfigurations.get(c.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function Oc(a,b,c,d,e,f,g){var h,i,j,k=a.context.gl,D=c.paint.get("fill-pattern"),l=D&&D.constantOr(1),p=c.getCrossfadeParameters();g?(i=l&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=k.LINES):(i=l?"fillPattern":"fill",h=k.TRIANGLES);for(var w=0,d=d;w<d.length;w+=1){var x=d[w],E=b.getTile(x);if(!l||E.patternsLoaded()){var y=E.getBucket(c);if(y){var z=y.programConfigurations.get(c.id),A=a.useProgram(i,z);l&&(a.context.activeTexture.set(k.TEXTURE0),E.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),z.updatePatternPaintBuffers(p));var B=D.constantOr(null);if(B&&E.imageAtlas){var C=E.imageAtlas.patternPositions[B.to];B=E.imageAtlas.patternPositions[B.from];C&&B&&z.setConstantPatternPositions(C,B)}C=a.translatePosMatrix(x.posMatrix,E,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(g){B=y.indexBuffer2,j=y.segments2;var F=[k.drawingBufferWidth,k.drawingBufferHeight];F="fillOutlinePattern"===i&&l?Y(C,a,p,E,F):jc(C,F)}else B=y.indexBuffer,j=y.segments,F=l?X(C,a,p,E):ic(C);A.draw(a.context,h,e,a.stencilModeForClipping(x),f,Ca.disabled,F,c.id,y.layoutVertexBuffer,B,j,c.paint,a.transform.zoom,z)}}}}function Pc(a,b,c,d,e,f,g){for(var h=a.context,i=h.gl,y=c.paint.get("fill-extrusion-pattern"),j=y.constantOr(1),k=c.getCrossfadeParameters(),l=c.paint.get("fill-extrusion-opacity"),z=0,d=d;z<d.length;z+=1){var m=d[z],t=b.getTile(m),u=t.getBucket(c);if(u){var v=u.programConfigurations.get(c.id),A=a.useProgram(j?"fillExtrusionPattern":"fillExtrusion",v);j&&(a.context.activeTexture.set(i.TEXTURE0),t.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),v.updatePatternPaintBuffers(k));var w=y.constantOr(null);if(w&&t.imageAtlas){var x=t.imageAtlas.patternPositions[w.to];w=t.imageAtlas.patternPositions[w.from];x&&w&&v.setConstantPatternPositions(x,w)}x=a.translatePosMatrix(m.posMatrix,t,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor"));w=c.paint.get("fill-extrusion-vertical-gradient");m=j?hc(x,a,w,l,m,k,t):gc(x,a,w,l);A.draw(h,h.gl.TRIANGLES,e,f,g,Ca.backCCW,m,c.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,c.paint,a.transform.zoom,v)}}}function Qc(a,b,c,d,e,f){var g=a.context,h=g.gl,i=b.fbo;if(i){var j=a.useProgram("hillshade");g.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,i.colorAttachment.get());i=qc(a,b,c);b.maskedBoundsBuffer&&b.maskedIndexBuffer&&b.segments?j.draw(g,h.TRIANGLES,d,e,f,Ca.disabled,i,c.id,b.maskedBoundsBuffer,b.maskedIndexBuffer,b.segments):j.draw(g,h.TRIANGLES,d,e,f,Ca.disabled,i,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function Rc(b,c,d,e,f,g,h){var i=b.context,m=i.gl;if(c.dem&&c.dem.data){var j=c.dem.dim,k=c.dem.stride,l=c.dem.getPixels();if(i.activeTexture.set(m.TEXTURE1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||b.getTileTexture(k),c.demTexture){k=c.demTexture;k.update(l,{premultiply:!1}),k.bind(m.NEAREST,m.CLAMP_TO_EDGE)}else c.demTexture=new a.Texture(i,l,m.RGBA,{premultiply:!1}),c.demTexture.bind(m.NEAREST,m.CLAMP_TO_EDGE);i.activeTexture.set(m.TEXTURE0);k=c.fbo;if(!k){l=new a.Texture(i,{width:j,height:j,data:null},m.RGBA);l.bind(m.LINEAR,m.CLAMP_TO_EDGE),(k=c.fbo=i.createFramebuffer(j,j)).colorAttachment.set(l.texture)}i.bindFramebuffer.set(k.framebuffer),i.viewport.set([0,0,j,j]),b.useProgram("hillshadePrepare").draw(i,m.TRIANGLES,f,g,h,Ca.disabled,rc(c,e),d.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function Sc(b,c,d,e,f){e=e.paint.get("raster-fade-duration");if(e>0){var g=a.browser.now(),h=(g-b.timeAdded)/e;g=c?(g-c.timeAdded)/e:-1;e=d.getSource();d=f.coveringZoomLevel({tileSize:e.tileSize,roundZoom:e.roundZoom});f=!c||Math.abs(c.tileID.overscaledZ-d)>Math.abs(b.tileID.overscaledZ-d);e=f&&b.refreshedUponExpiration?1:a.clamp(f?h:1-g,0,1);return b.refreshedUponExpiration&&h>=1&&(b.refreshedUponExpiration=!1),c?{opacity:1,mix:1-e}:{opacity:e,mix:0}}return{opacity:1,mix:0}}function Tc(b,c,d){var e=b.context,f=e.gl,g=d.posMatrix,h=b.useProgram("debug"),i=za.disabled,s=Aa.disabled,j=b.colorModeForRenderPass(),k="$debug";h.draw(e,f.LINE_STRIP,i,s,j,Ca.disabled,mc(g,a.Color.red),k,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments);for(var l=c.getTileByID(d.key).latestRawTileData,l=l&&l.byteLength||0,l=Math.floor(l/1024),l=function(a,b,c,d){d=d||1;var e,f,g,h,i,m,j,k,l=[];for(e=0,f=a.length;e<f;e++)if(i=Uc[a[e]]){for(k=null,g=0,h=i[1].length;g<h;g+=2)-1===i[1][g]&&-1===i[1][g+1]?k=null:(m=b+i[1][g]*d,j=c-i[1][g+1]*d,k&&l.push(k.x,k.y,m,j),k={x:m,y:j});b+=i[0]*d}return l}(d.toString()+" "+l+"kb",50,200,5),m=new a.StructArrayLayout2i4(),n=new a.StructArrayLayout2ui4(),r=0;r<l.length;r+=2)m.emplaceBack(l[r],l[r+1]),n.emplaceBack(r,r+1);for(var l=e.createVertexBuffer(m,Jb.members),r=e.createIndexBuffer(n),n=a.SegmentVector.simpleSegment(0,0,m.length/2,m.length/2),m=c.getTile(d).tileSize,c=a.EXTENT/(Math.pow(2,b.transform.zoom-d.overscaledZ)*m),b=[[-1,-1],[-1,1],[1,-1],[1,1]],d=0;d<b.length;d++){m=b[d];h.draw(e,f.LINES,i,s,j,Ca.disabled,mc(a.translate([],g,[c*m[0],c*m[1],0]),a.Color.white),k,l,r,n)}h.draw(e,f.LINES,i,s,j,Ca.disabled,mc(g,a.Color.black),k,l,r,n)}var Uc={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]},Vc={symbol:function(a,b,c,d,e){if("translucent"===a.renderPass){var f=Aa.disabled,g=a.colorModeForRenderPass();0!==c.paint.get("icon-opacity").constantOr(1)&&Mc(a,b,c,d,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),f,g,e),0!==c.paint.get("text-opacity").constantOr(1)&&Mc(a,b,c,d,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),f,g,e),b.map.showCollisionBoxes&&(function(a,b,c,d){Ic(a,b,c,d,!1),Ic(a,b,c,d,!0)})(a,b,c,d)}},circle:function(a,b,c,d){if("translucent"===a.renderPass){var e=c.paint.get("circle-opacity"),f=c.paint.get("circle-stroke-width"),g=c.paint.get("circle-stroke-opacity");if(0!==e.constantOr(1)||0!==f.constantOr(1)&&0!==g.constantOr(1))for(var e=a.context,f=e.gl,g=a.depthModeForSublayer(0,za.ReadOnly),h=Aa.disabled,i=a.colorModeForRenderPass(),j=0;j<d.length;j++){var q=d[j],k=b.getTile(q),l=k.getBucket(c);if(l){var p=l.programConfigurations.get(c.id);a.useProgram("circle",p).draw(e,f.TRIANGLES,g,h,i,Ca.disabled,kc(a,q,k,c),c.id,l.layoutVertexBuffer,l.indexBuffer,l.segments,c.paint,a.transform.zoom,p)}}}},heatmap:function(b,c,d,e){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===b.renderPass){var f=b.context,g=f.gl,h=b.depthModeForSublayer(0,za.ReadOnly),i=Aa.disabled,s=new Ba([g.ONE,g.ONE],a.Color.transparent,[!0,!0,!0,!0]);!function(a,b,c){var d=a.gl;a.activeTexture.set(d.TEXTURE1),a.viewport.set([0,0,b.width/4,b.height/4]);var e=c.heatmapFbo;if(e)d.bindTexture(d.TEXTURE_2D,e.colorAttachment.get()),a.bindFramebuffer.set(e.framebuffer);else{var f=d.createTexture();d.bindTexture(d.TEXTURE_2D,f),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),e=c.heatmapFbo=a.createFramebuffer(b.width/4,b.height/4),(function a(b,c,d,e){var f=b.gl;f.texImage2D(f.TEXTURE_2D,0,f.RGBA,c.width/4,c.height/4,0,f.RGBA,b.extTextureHalfFloat?b.extTextureHalfFloat.HALF_FLOAT_OES:f.UNSIGNED_BYTE,null),e.colorAttachment.set(d),b.extTextureHalfFloat&&f.checkFramebufferStatus(f.FRAMEBUFFER)!==f.FRAMEBUFFER_COMPLETE&&(b.extTextureHalfFloat=null,e.colorAttachment.setDirty(),a(b,c,d,e))})(a,b,f,e)}}(f,b,d),f.clear({color:a.Color.transparent});for(var j=0;j<e.length;j++){var k=e[j];if(!c.hasRenderableParent(k)){var l=c.getTile(k),t=l.getBucket(d);if(t){var p=t.programConfigurations.get(d.id),q=b.useProgram("heatmap",p),r=b.transform.zoom;q.draw(f,g.TRIANGLES,h,i,s,Ca.disabled,oc(k.posMatrix,l,r,d.paint.get("heatmap-intensity")),d.id,t.layoutVertexBuffer,t.indexBuffer,t.segments,d.paint,b.transform.zoom,p)}}}f.viewport.set([0,0,b.width,b.height])}else"translucent"===b.renderPass&&(b.context.setColorMode(b.colorModeForRenderPass()),function(b,c){var d=b.context,e=d.gl,f=c.heatmapFbo;if(f){d.activeTexture.set(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,f.colorAttachment.get()),d.activeTexture.set(e.TEXTURE1);f=c.colorRampTexture;f||(f=c.colorRampTexture=new a.Texture(d,c.colorRamp,e.RGBA)),f.bind(e.LINEAR,e.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(d,e.TRIANGLES,za.disabled,Aa.disabled,b.colorModeForRenderPass(),Ca.disabled,pc(b,c,0,1),c.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,c.paint,b.transform.zoom)}}(b,d))},line:function(b,c,d,e){if("translucent"===b.renderPass){var f=d.paint.get("line-opacity"),g=d.paint.get("line-width");if(0!==f.constantOr(1)&&0!==g.constantOr(1)){f=b.depthModeForSublayer(0,za.ReadOnly);g=b.colorModeForRenderPass();var I=d.paint.get("line-dasharray"),h=d.paint.get("line-pattern"),i=h.constantOr(1),j=d.paint.get("line-gradient"),J=d.getCrossfadeParameters(),k=I?"lineSDF":i?"linePattern":j?"lineGradient":"line",l=b.context,r=l.gl,z=!0;if(j){l.activeTexture.set(r.TEXTURE0);var A=d.gradientTexture;if(!d.gradient)return;A||(A=d.gradientTexture=new a.Texture(l,d.gradient,r.RGBA)),A.bind(r.LINEAR,r.CLAMP_TO_EDGE)}for(var A=0,e=e;A<e.length;A+=1){var B=e[A],C=c.getTile(B);if(!i||C.patternsLoaded()){var D=C.getBucket(d);if(D){var E=D.programConfigurations.get(d.id),F=b.context.program.get(),K=b.useProgram(k,E);F=z||K.program!==F;var G=h.constantOr(null);if(G&&C.imageAtlas){var H=C.imageAtlas.patternPositions[G.to];G=C.imageAtlas.patternPositions[G.from];H&&G&&E.setConstantPatternPositions(H,G)}H=I?wc(b,C,d,I,J):i?vc(b,C,d,J):j?uc(b,C,d):tc(b,C,d);I&&(F||b.lineAtlas.dirty)?(l.activeTexture.set(r.TEXTURE0),b.lineAtlas.bind(l)):i&&(l.activeTexture.set(r.TEXTURE0),C.imageAtlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE),E.updatePatternPaintBuffers(J)),K.draw(l,r.TRIANGLES,f,b.stencilModeForClipping(B),g,Ca.disabled,H,d.id,D.layoutVertexBuffer,D.indexBuffer,D.segments,d.paint,b.transform.zoom,E),z=!1}}}}}},fill:function(b,c,d,e){var f=d.paint.get("fill-color"),g=d.paint.get("fill-opacity");if(0!==g.constantOr(1)){var h=b.colorModeForRenderPass(),i=d.paint.get("fill-pattern");i=b.opaquePassEnabledForLayer()&&!i.constantOr(1)&&1===f.constantOr(a.Color.transparent).a&&1===g.constantOr(0)?"opaque":"translucent";if(b.renderPass===i){f=b.depthModeForSublayer(1,"opaque"===b.renderPass?za.ReadWrite:za.ReadOnly);Oc(b,c,d,e,f,h,!1)}if("translucent"===b.renderPass&&d.paint.get("fill-antialias")){g=b.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,za.ReadOnly);Oc(b,c,d,e,g,h,!0)}}},"fill-extrusion":function(a,b,c,d){var e=c.paint.get("fill-extrusion-opacity");if(0!==e&&"translucent"===a.renderPass){var f=new za(a.context.gl.LEQUAL,za.ReadWrite,a.depthRangeFor3D);if(1!==e||c.paint.get("fill-extrusion-pattern").constantOr(1))Pc(a,b,c,d,f,Aa.disabled,Ba.disabled),Pc(a,b,c,d,f,a.stencilModeFor3D(),a.colorModeForRenderPass());else{e=a.colorModeForRenderPass();Pc(a,b,c,d,f,Aa.disabled,e)}}},hillshade:function(a,b,c,d){if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var e=a.context,f=b.getSource().maxzoom,g=a.depthModeForSublayer(0,za.ReadOnly),h=Aa.disabled,i=a.colorModeForRenderPass(),k=0,d=d;k<d.length;k+=1){var j=d[k];j=b.getTile(j);j.needsHillshadePrepare&&"offscreen"===a.renderPass?Rc(a,j,c,f,g,h,i):"translucent"===a.renderPass&&Qc(a,j,c,g,h,i)}e.viewport.set([0,0,a.width,a.height])}},raster:function(a,b,c,d){if("translucent"===a.renderPass&&0!==c.paint.get("raster-opacity"))for(var e=a.context,f=e.gl,g=b.getSource(),h=a.useProgram("raster"),i=Aa.disabled,B=a.colorModeForRenderPass(),j=d.length&&d[0].overscaledZ,k=!a.options.moving,l=0,d=d;l<d.length;l+=1){var q=d[l],u=a.depthModeForSublayer(q.overscaledZ-j,1===c.paint.get("raster-opacity")?za.ReadWrite:za.ReadOnly,f.LESS),v=b.getTile(q),w=a.transform.calculatePosMatrix(q.toUnwrapped(),k);v.registerFadeDuration(c.paint.get("raster-fade-duration"));q=b.findLoadedParent(q,0);var C=Sc(v,q,b,c,a.transform),x=void 0,y=void 0,A="nearest"===c.paint.get("raster-resampling")?f.NEAREST:f.LINEAR;e.activeTexture.set(f.TEXTURE0),v.texture.bind(A,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),e.activeTexture.set(f.TEXTURE1),q?(q.texture.bind(A,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST),x=Math.pow(2,q.tileID.overscaledZ-v.tileID.overscaledZ),y=[v.tileID.canonical.x*x%1,v.tileID.canonical.y*x%1]):v.texture.bind(A,f.CLAMP_TO_EDGE,f.LINEAR_MIPMAP_NEAREST);q=zc(w,y||[0,0],x||1,C,c);g instanceof z?h.draw(e,f.TRIANGLES,u,i,B,Ca.disabled,q,c.id,g.boundsBuffer,a.quadTriangleIndexBuffer,g.boundsSegments):v.maskedBoundsBuffer&&v.maskedIndexBuffer&&v.segments?h.draw(e,f.TRIANGLES,u,i,B,Ca.disabled,q,c.id,v.maskedBoundsBuffer,v.maskedIndexBuffer,v.segments,c.paint,a.transform.zoom):h.draw(e,f.TRIANGLES,u,i,B,Ca.disabled,q,c.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,b,c){b=c.paint.get("background-color");var d=c.paint.get("background-opacity");if(0!==d){var e=a.context,f=e.gl,g=a.transform,h=g.tileSize,s=c.paint.get("background-pattern");if(!a.isPatternMissing(s)){var i=s||1!==b.a||1!==d?"translucent":"opaque";if(a.renderPass===i){var j=Aa.disabled;i=a.depthModeForSublayer(0,"opaque"===i?za.ReadWrite:za.ReadOnly);var t=a.colorModeForRenderPass(),k=a.useProgram(s?"backgroundPattern":"background");g=g.coveringTiles({tileSize:h});s&&(e.activeTexture.set(f.TEXTURE0),a.imageManager.bind(a.context));for(var l=c.getCrossfadeParameters(),n=0,g=g;n<g.length;n+=1){var u=g[n],q=a.transform.calculatePosMatrix(u.toUnwrapped());u=s?Ec(q,d,a,s,{tileID:u,tileSize:h},l):Dc(q,d,b);k.draw(e,f.TRIANGLES,i,j,t,Ca.disabled,u,c.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,b,c){for(var d=0;d<c.length;d++)Tc(a,b,c[d])},custom:function(a,b,c){b=a.context;c=c.implementation;if("offscreen"===a.renderPass){var d=c.prerender;d&&(a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),d.call(c,b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),b.setColorMode(a.colorModeForRenderPass()),b.setStencilMode(Aa.disabled);d="3d"===c.renderingMode?new za(a.context.gl.LEQUAL,za.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,za.ReadOnly);b.setDepthMode(d),c.render(b.gl,a.transform.customLayerMatrix()),b.setDirty(),a.setBaseState(),b.bindFramebuffer.set(null)}}},Wc=function(b,c){this.context=new Da(b),this.transform=c,this._tileTextures={},this.setup(),this.numSublayers=Ea.maxUnderzooming+Ea.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new a.ProgramConfiguration(),this.crossTileSymbolIndex=new Eb()};function Xc(a,b){if(a.y>b.y){var c=a;a=b,b=c}return{x0:a.x,y0:a.y,x1:b.x,y1:b.y,dx:b.x-a.x,dy:b.y-a.y}}function Yc(a,b,c,d,e){c=Math.max(c,Math.floor(b.y0));d=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var f=a;a=b,b=f}for(var f=a.dx/a.dy,j=b.dx/b.dy,g=a.dx>0,h=b.dx<0,c=c;c<d;c++){var k=f*Math.max(0,Math.min(a.dy,c+g-a.y0))+a.x0,i=j*Math.max(0,Math.min(b.dy,c+h-b.y0))+b.x0;e(Math.floor(i),Math.ceil(k),c)}}function Zc(a,b,c,d,e,f){var g=Xc(a,b);b=Xc(b,c);c=Xc(c,a);g.dy>b.dy&&(a=g,g=b,b=a),g.dy>c.dy&&(a=g,g=c,c=a),b.dy>c.dy&&(a=b,b=c,c=a),g.dy&&Yc(c,g,d,e,f),b.dy&&Yc(c,b,d,e,f)}Wc.prototype.resize=function(b,c){var d=this.context.gl;if(this.width=b*a.browser.devicePixelRatio,this.height=c*a.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var b=0,c=this.style._order;b<c.length;b+=1){var e=c[b];this.style._layers[e].resize()}this.depthRbo&&(d.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Wc.prototype.setup=function(){var b=this.context,c=new a.StructArrayLayout2i4();c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=b.createVertexBuffer(c,Jb.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);c=new a.StructArrayLayout2i4();c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=b.createVertexBuffer(c,Jb.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);c=new a.StructArrayLayout4i8();c.emplaceBack(0,0,0,0),c.emplaceBack(a.EXTENT,0,a.EXTENT,0),c.emplaceBack(0,a.EXTENT,0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=b.createVertexBuffer(c,a.rasterBoundsAttributes.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);c=new a.StructArrayLayout2i4();c.emplaceBack(0,0),c.emplaceBack(1,0),c.emplaceBack(0,1),c.emplaceBack(1,1),this.viewportBuffer=b.createVertexBuffer(c,Jb.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);c=new a.StructArrayLayout1ui2();c.emplaceBack(0),c.emplaceBack(1),c.emplaceBack(3),c.emplaceBack(2),c.emplaceBack(0),this.tileBorderIndexBuffer=b.createIndexBuffer(c);c=new a.StructArrayLayout3ui6();c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=b.createIndexBuffer(c);b=this.context.gl;this.stencilClearMode=new Aa({func:b.ALWAYS,mask:0},0,255,b.ZERO,b.ZERO,b.ZERO)},Wc.prototype.clearStencil=function(){var b=this.context,c=b.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var d=a.create();a.ortho(d,0,this.width,this.height,0,0,1),a.scale(d,d,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(b,c.TRIANGLES,za.disabled,this.stencilClearMode,Ba.disabled,Ca.disabled,nc(d),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Wc.prototype._renderTileClippingMasks=function(a,b){if(this.currentStencilSource!==a.source&&a.isTileClipped()&&b&&b.length){this.currentStencilSource=a.source;a=this.context;var c=a.gl;this.nextStencilID+b.length>256&&this.clearStencil(),a.setColorMode(Ba.disabled),a.setDepthMode(za.disabled);var d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var e=0,b=b;e<b.length;e+=1){var f=b[e],g=this._tileClippingMaskIDs[f.key]=this.nextStencilID++;d.draw(a,c.TRIANGLES,za.disabled,new Aa({func:c.ALWAYS,mask:0},g,255,c.KEEP,c.KEEP,c.REPLACE),Ba.disabled,Ca.disabled,nc(f.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Wc.prototype.stencilModeFor3D=function(){this.nextStencilID+1>256&&this.clearStencil();var a=this.nextStencilID++,b=this.context.gl;return new Aa({func:b.NOTEQUAL,mask:255},a,255,b.KEEP,b.KEEP,b.REPLACE)},Wc.prototype.stencilModeForClipping=function(a){var b=this.context.gl;return new Aa({func:b.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,b.KEEP,b.KEEP,b.REPLACE)},Wc.prototype.colorModeForRenderPass=function(){var b=this.context.gl;return this._showOverdrawInspector?new Ba([b.CONSTANT_COLOR,b.ONE],new a.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ba.unblended:Ba.alphaBlended},Wc.prototype.depthModeForSublayer=function(a,b,c){if(!this.opaquePassEnabledForLayer())return za.disabled;a=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new za(c||this.context.gl.LEQUAL,b,[a,a])},Wc.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Wc.prototype.render=function(b,c){this.style=b,this.options=c,this.lineAtlas=b.lineAtlas,this.imageManager=b.imageManager,this.glyphManager=b.glyphManager,this.symbolFadeChange=b.placement.symbolFadeChange(a.browser.now()),this.imageManager.beginFrame();var d=this.style._order,e=this.style.sourceCaches;for(var f in e){var g=e[f];g.used&&g.prepare(this.context)}g={};var h={},u={};for(var i in e){var j=e[i];g[i]=j.getVisibleCoordinates(),h[i]=g[i].slice().reverse(),u[i]=j.getVisibleCoordinates(!0).reverse()}for(var k in e){j=e[k];var l=j.getSource();if("raster"===l.type||"raster-dem"===l.type){for(var l=[],n=0,r=g[k];n<r.length;n+=1){var s=r[n];l.push(j.getTile(s))}Gc(l,this.context)}}this.opaquePassCutoff=1/0;for(var s=0;s<d.length;s++){j=d[s];if(this.style._layers[j].is3D()){this.opaquePassCutoff=s;break}}this.renderPass="offscreen",this.depthRboNeedsClear=!0;for(var r=0,n=d;r<n.length;r+=1){l=n[r];j=this.style._layers[l];if(j.hasOffscreenPass()&&!j.isHidden(this.transform.zoom)){s=h[j.source];("custom"===j.type||s.length)&&this.renderLayer(this,e[j.source],j,s)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(b._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){l=this.style._layers[d[this.currentLayer]];j=e[l.source];s=g[l.source];this._renderTileClippingMasks(l,s),this.renderLayer(this,j,l,s)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){r=this.style._layers[d[this.currentLayer]];n=e[r.source];c=("symbol"===r.type?u:h)[r.source];this._renderTileClippingMasks(r,g[r.source]),this.renderLayer(this,n,r,c)}if(this.options.showTileBoundaries)for(var t in e){Vc.debug(this,e[t],g[t]);break}this.context.setDefault()},Wc.prototype.setupOffscreenDepthRenderbuffer=function(){var a=this.context;this.depthRbo||(this.depthRbo=a.createRenderbuffer(a.gl.DEPTH_COMPONENT16,this.width,this.height))},Wc.prototype.renderLayer=function(a,b,c,d){c.isHidden(this.transform.zoom)||("background"===c.type||"custom"===c.type||d.length)&&(this.id=c.id,Vc[c.type](a,b,c,d,this.style.placement.variableOffsets))},Wc.prototype.translatePosMatrix=function(b,c,d,e,f){if(!d[0]&&!d[1])return b;e=f?"map"===e?this.transform.angle:0:"viewport"===e?-this.transform.angle:0;if(e){var g=Math.sin(e);e=Math.cos(e);d=[d[0]*e-d[1]*g,d[0]*g+d[1]*e]}g=[f?d[0]:hb(c,d[0],this.transform.zoom),f?d[1]:hb(c,d[1],this.transform.zoom),0];e=new Float32Array(16);return a.translate(e,b,g),e},Wc.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]},Wc.prototype.getTileTexture=function(a){a=this._tileTextures[a];return a&&a.length>0?a.pop():null},Wc.prototype.isPatternMissing=function(a){if(!a)return!1;var b=this.imageManager.getPattern(a.from);a=this.imageManager.getPattern(a.to);return!b||!a},Wc.prototype.useProgram=function(a,b){void 0===b&&(b=this.emptyProgramConfiguration),this.cache=this.cache||{};var c=""+a+(b.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[c]||(this.cache[c]=new ec(this.context,cc[a],b,Fc[a],this._showOverdrawInspector)),this.cache[c]},Wc.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Wc.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)};var $c=function(b,c,d){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===d||d,this._minZoom=b||0,this._maxZoom=c||22,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}};A={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};$c.prototype.clone=function(){var a=new $c(this._minZoom,this._maxZoom,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._calcMatrices(),a},A.minZoom.get=function(){return this._minZoom},A.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},A.maxZoom.get=function(){return this._maxZoom},A.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},A.renderWorldCopies.get=function(){return this._renderWorldCopies},A.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},A.worldSize.get=function(){return this.tileSize*this.scale},A.centerPoint.get=function(){return this.size._div(2)},A.size.get=function(){return new a.Point(this.width,this.height)},A.bearing.get=function(){return-this.angle/Math.PI*180},A.bearing.set=function(b){b=-a.wrap(b,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=a.create$2(),a.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},A.pitch.get=function(){return this._pitch/Math.PI*180},A.pitch.set=function(b){b=a.clamp(b,0,60)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())},A.fov.get=function(){return this._fov/Math.PI*180},A.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},A.zoom.get=function(){return this._zoom},A.zoom.set=function(a){a=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},A.center.get=function(){return this._center},A.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},$c.prototype.coveringZoomLevel=function(a){return(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize))},$c.prototype.getVisibleUnwrappedCoordinates=function(b){var c=[new a.UnwrappedTileID(0,b)];if(this._renderWorldCopies)for(var d=this.pointCoordinate(new a.Point(0,0)),e=this.pointCoordinate(new a.Point(this.width,0)),f=this.pointCoordinate(new a.Point(this.width,this.height)),g=this.pointCoordinate(new a.Point(0,this.height)),h=Math.floor(Math.min(d.x,e.x,f.x,g.x)),d=Math.floor(Math.max(d.x,e.x,f.x,g.x)),e=h-1;e<=d+1;e++)0!==e&&c.push(new a.UnwrappedTileID(e,b));return c},$c.prototype.coveringTiles=function(b){var c=this.coveringZoomLevel(b),d=c;if(void 0!==b.minzoom&&c<b.minzoom)return[];void 0!==b.maxzoom&&c>b.maxzoom&&(c=b.maxzoom);var e=a.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,c),g=new a.Point(f*e.x-.5,f*e.y-.5);return function(b,c,d,e){void 0===e&&(e=!0);var f=1<<b,g={};function h(c,h,i){var j,k;if(i>=0&&i<=f)for(c=c;c<h;c++)j=Math.floor(c/f),k=(c%f+f)%f,0!==j&&!0!==e||(j=new a.OverscaledTileID(d,j,b,k,i),g[j.key]=j)}c=c.map(function(b){return new a.Point(b.x,b.y)._mult(f)});return Zc(c[0],c[1],c[2],0,f,h),Zc(c[2],c[3],c[0],0,f,h),Object.keys(g).map(function(a){return g[a]})}(c,[this.pointCoordinate(new a.Point(0,0)),this.pointCoordinate(new a.Point(this.width,0)),this.pointCoordinate(new a.Point(this.width,this.height)),this.pointCoordinate(new a.Point(0,this.height))],b.reparseOverscaled?d:c,this._renderWorldCopies).sort(function(a,b){return g.dist(a.canonical)-g.dist(b.canonical)})},$c.prototype.resize=function(a,b){this.width=a,this.height=b,this.pixelsToGLUnits=[2/a,-2/b],this._constrain(),this._calcMatrices()},A.unmodified.get=function(){return this._unmodified},$c.prototype.zoomScale=function(a){return Math.pow(2,a)},$c.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},$c.prototype.project=function(b){var c=a.clamp(b.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.Point(a.mercatorXfromLng(b.lng)*this.worldSize,a.mercatorYfromLat(c)*this.worldSize)},$c.prototype.unproject=function(b){return new a.MercatorCoordinate(b.x/this.worldSize,b.y/this.worldSize).toLngLat()},A.point.get=function(){return this.project(this.center)},$c.prototype.setLocationAtPoint=function(b,c){c=this.pointCoordinate(c);var d=this.pointCoordinate(this.centerPoint);b=this.locationCoordinate(b);b=new a.MercatorCoordinate(b.x-(c.x-d.x),b.y-(c.y-d.y));this.center=this.coordinateLocation(b),this._renderWorldCopies&&(this.center=this.center.wrap())},$c.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},$c.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},$c.prototype.locationCoordinate=function(b){return a.MercatorCoordinate.fromLngLat(b)},$c.prototype.coordinateLocation=function(a){return a.toLngLat()},$c.prototype.pointCoordinate=function(b){var c=[b.x,b.y,0,1];b=[b.x,b.y,1,1];a.transformMat4(c,c,this.pixelMatrixInverse),a.transformMat4(b,b,this.pixelMatrixInverse);var d=c[3],e=b[3],f=c[0]/d,g=b[0]/e,h=c[1]/d,i=b[1]/e;c=c[2]/d;d=b[2]/e;b=c===d?0:(0-c)/(d-c);return new a.MercatorCoordinate(a.number(f,g,b)/this.worldSize,a.number(h,i,b)/this.worldSize)},$c.prototype.coordinatePoint=function(b){b=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(b,b,this.pixelMatrix),new a.Point(b[0]/b[3],b[1]/b[3])},$c.prototype.getBounds=function(){return new a.LngLatBounds().extend(this.pointLocation(new a.Point(0,0))).extend(this.pointLocation(new a.Point(this.width,0))).extend(this.pointLocation(new a.Point(this.width,this.height))).extend(this.pointLocation(new a.Point(0,this.height)))},$c.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},$c.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},$c.prototype.calculatePosMatrix=function(b,c){void 0===c&&(c=!1);var d=b.key,e=c?this._alignedPosMatrixCache:this._posMatrixCache;if(e[d])return e[d];var f=b.canonical,g=this.worldSize/this.zoomScale(f.z);b=f.x+Math.pow(2,f.z)*b.wrap;var h=a.identity(new Float64Array(16));return a.translate(h,h,[b*g,f.y*g,0]),a.scale(h,h,[g/a.EXTENT,g/a.EXTENT,1]),a.multiply(h,c?this.alignedProjMatrix:this.projMatrix,h),e[d]=new Float32Array(h),e[d]},$c.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},$c.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var b,c,d,e,f=-90,g=90,h=-180,i=180,p=this.size,j=this._unmodified;if(this.latRange){var k=this.latRange;f=a.mercatorYfromLat(k[1])*this.worldSize,b=(g=a.mercatorYfromLat(k[0])*this.worldSize)-f<p.y?p.y/(g-f):0}if(this.lngRange){k=this.lngRange;h=a.mercatorXfromLng(k[0])*this.worldSize,c=(i=a.mercatorXfromLng(k[1])*this.worldSize)-h<p.x?p.x/(i-h):0}k=this.point;var l=Math.max(c||0,b||0);if(l)return this.center=this.unproject(new a.Point(c?(i+h)/2:k.x,b?(g+f)/2:k.y)),this.zoom+=this.scaleZoom(l),this._unmodified=j,void (this._constraining=!1);if(this.latRange){l=k.y;var n=p.y/2;l-n<f&&(e=f+n),l+n>g&&(e=g-n)}if(this.lngRange){f=k.x;l=p.x/2;f-l<h&&(d=h+l),f+l>i&&(d=i-l)}void 0===d&&void 0===e||(this.center=this.unproject(new a.Point(void 0!==d?d:k.x,void 0!==e?e:k.y))),this._unmodified=j,this._constraining=!1}},$c.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var b=this._fov/2,c=Math.PI/2+this._pitch;c=Math.sin(b)*this.cameraToCenterDistance/Math.sin(Math.PI-c-b);b=this.point;var d=b.x;b=b.y;c=1.01*(Math.cos(Math.PI/2-this._pitch)*c+this.cameraToCenterDistance);var e=new Float64Array(16);a.perspective(e,this._fov,this.width/this.height,1,c),a.scale(e,e,[1,-1,1]),a.translate(e,e,[0,0,-this.cameraToCenterDistance]),a.rotateX(e,e,this._pitch),a.rotateZ(e,e,this.angle),a.translate(e,e,[-d,-b,0]),this.mercatorMatrix=a.scale([],e,[this.worldSize,this.worldSize,this.worldSize]),a.scale(e,e,[1,1,a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=e;c=this.width%2/2;var f=this.height%2/2,g=Math.cos(this.angle),h=Math.sin(this.angle);d=d-Math.round(d)+g*c+h*f;b=b-Math.round(b)+g*f+h*c;g=new Float64Array(e);if(a.translate(g,g,[d>.5?d-1:d,b>.5?b-1:b,0]),this.alignedProjMatrix=g,e=a.create(),a.scale(e,e,[this.width/2,-this.height/2,1]),a.translate(e,e,[1,-1,0]),this.labelPlaneMatrix=e,e=a.create(),a.scale(e,e,[1,-1,1]),a.translate(e,e,[-1,-1,0]),a.scale(e,e,[2/this.width,2/this.height,1]),this.glCoordMatrix=e,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(e=a.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=e,this._posMatrixCache={},this._alignedPosMatrixCache={}}},$c.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var b=this.pointCoordinate(new a.Point(0,0));b=[b.x*this.worldSize,b.y*this.worldSize,0,1];return a.transformMat4(b,b,this.pixelMatrix)[3]/this.cameraToCenterDistance},$c.prototype.getCameraPoint=function(){var b=this._pitch;b=Math.tan(b)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,b))},$c.prototype.getCameraQueryGeometry=function(b){var c=this.getCameraPoint();if(1===b.length)return[b[0],c];for(var d=c.x,e=c.y,f=c.x,c=c.y,g=0,b=b;g<b.length;g+=1){var h=b[g];d=Math.min(d,h.x),e=Math.min(e,h.y),f=Math.max(f,h.x),c=Math.max(c,h.y)}return[new a.Point(d,e),new a.Point(f,e),new a.Point(f,c),new a.Point(d,c),new a.Point(d,e)]},Object.defineProperties($c.prototype,A);var ad=function(){var b,c,d,e,f;a.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(b=this._updateHashUnthrottled.bind(this),c=300,d=!1,e=null,f=function(){e=null,d&&(b(),e=setTimeout(f,c),d=!1)},function(){return d=!0,e||f(),e})};ad.prototype.addTo=function(b){return this._map=b,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ad.prototype.remove=function(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ad.prototype.getHashString=function(a){var b=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10);d=Math.pow(10,d);var e=Math.round(b.lng*d)/d;b=Math.round(b.lat*d)/d;d=this._map.getBearing();var f=this._map.getPitch(),g="";return g+=a?"#/"+e+"/"+b+"/"+c:"#"+c+"/"+b+"/"+e,(d||f)&&(g+="/"+Math.round(10*d)/10),f&&(g+="/"+Math.round(f)),g},ad.prototype._onHashChange=function(){var b=a.window.location.hash.replace("#","").split("/");return b.length>=3&&(this._map.jumpTo({center:[+b[2],+b[1]],zoom:+b[0],bearing:+(b[3]||0),pitch:+(b[4]||0)}),!0)},ad.prototype._updateHashUnthrottled=function(){var b=this.getHashString();try{a.window.history.replaceState(a.window.history.state,"",b)}catch(a){}};var bd=function(b){function d(d,e,f,g){void 0===g&&(g={});var h=c.mousePos(e.getCanvasContainer(),f),i=e.unproject(h);b.call(this,d,a.extend({point:h,lngLat:i,originalEvent:f},g)),this._defaultPrevented=!1,this.target=e}b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d;var e={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,e),d}(a.Event),cd=function(b){function d(d,e,f){var g=c.touchPos(e.getCanvasContainer(),f),h=g.map(function(a){return e.unproject(a)}),i=g.reduce(function(a,b,c,d){return a.add(b.div(d.length))},new a.Point(0,0)),j=e.unproject(i);b.call(this,d,{points:g,point:i,lngLats:h,lngLat:j,originalEvent:f}),this._defaultPrevented=!1}b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d;var e={defaultPrevented:{configurable:!0}};return d.prototype.preventDefault=function(){this._defaultPrevented=!0},e.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(d.prototype,e),d}(a.Event),dd=function(a){function b(b,c,d){a.call(this,b,{originalEvent:d}),this._defaultPrevented=!1}a&&(b.__proto__=a),b.prototype=Object.create(a&&a.prototype),b.prototype.constructor=b;var c={defaultPrevented:{configurable:!0}};return b.prototype.preventDefault=function(){this._defaultPrevented=!0},c.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(b.prototype,c),b}(a.Event);B=function(b){this._map=b,this._el=b.getCanvasContainer(),this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,a.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};B.prototype.setZoomRate=function(a){this._defaultZoomRate=a},B.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},B.prototype.isEnabled=function(){return!!this._enabled},B.prototype.isActive=function(){return!!this._active},B.prototype.isZooming=function(){return!!this._zooming},B.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},B.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},B.prototype.onWheel=function(b){if(this.isEnabled()){var c=b.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*b.deltaY:b.deltaY,d=a.browser.now(),e=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,0!==c&&c%4.000244140625==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":e>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,b)):this._type||(this._type=Math.abs(e*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),b.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=b,this._delta-=c,this.isActive()||this._start(b)),b.preventDefault()}},B.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(a)},B.prototype._start=function(b){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0,this._map.fire(new a.Event("movestart",{originalEvent:b})),this._map.fire(new a.Event("zoomstart",{originalEvent:b}))),this._finishTimeout&&clearTimeout(this._finishTimeout);b=c.mousePos(this._el,b);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(b)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},B.prototype._onScrollFrame=function(){var b=this;if(this._frameId=null,this.isActive()){var c=this._map.transform;if(0!==this._delta){var d="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate;d=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&0!==d&&(d=1/d);var e="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(e*d))),"wheel"===this._type&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}e="number"==typeof this._targetZoom?this._targetZoom:c.zoom;d=this._startZoom;var f=this._easing,h=!1;if("wheel"===this._type&&d&&f){var g=Math.min((a.browser.now()-this._lastWheelEventTime)/200,1);f=f(g);c.zoom=a.number(d,e,f),g<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):h=!0}else c.zoom=e,h=!0;c.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new a.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new a.Event("zoom",{originalEvent:this._lastWheelEvent})),h&&(this._active=!1,this._finishTimeout=setTimeout(function(){b._zooming=!1,b._map.fire(new a.Event("zoomend",{originalEvent:b._lastWheelEvent})),b._map.fire(new a.Event("moveend",{originalEvent:b._lastWheelEvent})),delete b._targetZoom},200))}},B.prototype._smoothOutEasing=function(b){var c=a.ease;if(this._prevEase){var d=this._prevEase,e=(a.browser.now()-d.start)/d.duration;d=d.easing(e+.01)-d.easing(e);e=.27/Math.sqrt(d*d+1e-4)*.01;d=Math.sqrt(.0729-e*e);c=a.bezier(e,d,.25,1)}return this._prevEase={start:a.browser.now(),duration:b,easing:c},c};e=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._container=b.getContainer(),this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};e.prototype.isEnabled=function(){return!!this._enabled},e.prototype.isActive=function(){return!!this._active},e.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},e.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},e.prototype.onMouseDown=function(b){this.isEnabled()&&b.shiftKey&&0===b.button&&(a.window.document.addEventListener("mousemove",this._onMouseMove,!1),a.window.document.addEventListener("keydown",this._onKeyDown,!1),a.window.document.addEventListener("mouseup",this._onMouseUp,!1),c.disableDrag(),this._startPos=this._lastPos=c.mousePos(this._el,b),this._active=!0)},e.prototype._onMouseMove=function(a){var b=c.mousePos(this._el,a);if(!(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)){var d=this._startPos;this._lastPos=b,this._box||(this._box=c.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));a=Math.min(d.x,b.x);var e=Math.max(d.x,b.x),f=Math.min(d.y,b.y);d=Math.max(d.y,b.y);c.setTransform(this._box,"translate("+a+"px,"+f+"px)"),this._box.style.width=e-a+"px",this._box.style.height=d-f+"px"}},e.prototype._onMouseUp=function(b){if(0===b.button){var d=this._startPos,e=c.mousePos(this._el,b);this._finish(),c.suppressClick(),d.x===e.x&&d.y===e.y?this._fireEvent("boxzoomcancel",b):this._map.fitScreenCoordinates(d,e,this._map.getBearing(),{linear:!0}).fire(new a.Event("boxzoomend",{originalEvent:b}))}},e.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",a))},e.prototype._finish=function(){this._active=!1,a.window.document.removeEventListener("mousemove",this._onMouseMove,!1),a.window.document.removeEventListener("keydown",this._onKeyDown,!1),a.window.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(c.remove(this._box),this._box=null),c.enableDrag(),delete this._startPos,delete this._lastPos},e.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,{originalEvent:c}))};var ed=a.bezier(0,0,.25,1),fd=function(b,c){this._map=b,this._el=c.element||b.getCanvasContainer(),this._state="disabled",this._button=c.button||"right",this._bearingSnap=c.bearingSnap||0,this._pitchWithRotate=!1!==c.pitchWithRotate,a.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};fd.prototype.isEnabled=function(){return"disabled"!==this._state},fd.prototype.isActive=function(){return"active"===this._state},fd.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},fd.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},fd.prototype.onMouseDown=function(b){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=c.mouseButton(b),this._eventButton!==(b.ctrlKey?0:2))return}else{if(b.ctrlKey||0!==c.mouseButton(b))return;this._eventButton=0}c.disableDrag(),a.window.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.addEventListener("mouseup",this._onMouseUp),a.window.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[a.browser.now(),this._map.getBearing()]],this._startPos=this._lastPos=c.mousePos(this._el,b),this._center=this._map.transform.centerPoint,b.preventDefault()}},fd.prototype._onMouseMove=function(a){var b=c.mousePos(this._el,a);this._lastPos.equals(b)||(this._lastMoveEvent=a,this._lastPos=b,"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",a)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},fd.prototype._onDragFrame=function(){this._frameId=null;var b=this._lastMoveEvent;if(b){var c=this._map.transform,d=this._startPos,e=this._lastPos,f=.8*(d.x-e.x);d=-.5*(d.y-e.y);e=c.bearing-f;f=c.pitch-d;d=this._inertia;var g=d[d.length-1];this._drainInertiaBuffer(),d.push([a.browser.now(),this._map._normalizeBearing(e,g[1])]),c.bearing=e,this._pitchWithRotate&&(this._fireEvent("pitch",b),c.pitch=f),this._fireEvent("rotate",b),this._fireEvent("move",b),delete this._lastMoveEvent,this._startPos=this._lastPos}},fd.prototype._onMouseUp=function(a){if(c.mouseButton(a)===this._eventButton)switch(this._state){case"active":this._state="enabled",c.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(a);break;case"pending":this._state="enabled",this._unbind()}},fd.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",a),this._pitchWithRotate&&this._fireEvent("pitchend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},fd.prototype._unbind=function(){a.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),a.window.document.removeEventListener("mouseup",this._onMouseUp),a.window.removeEventListener("blur",this._onBlur),c.enableDrag()},fd.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._lastPos},fd.prototype._inertialRotate=function(a){var b=this;this._fireEvent("rotateend",a),this._drainInertiaBuffer();var c=this._map,d=c.getBearing(),e=this._inertia,f=function(){Math.abs(d)<b._bearingSnap?c.resetNorth({noMoveStart:!0},{originalEvent:a}):b._fireEvent("moveend",a),b._pitchWithRotate&&b._fireEvent("pitchend",a)};if(e.length<2)f();else{var g=e[0],h=e[e.length-1];e=e[e.length-2];e=c._normalizeBearing(d,e[1]);var i=h[1]-g[1],j=i<0?-1:1;h=(h[0]-g[0])/1e3;if(0!==i&&0!==h){g=Math.abs(i*(.25/h));g>180&&(g=180);i=g/180;e+=j*g*(i/2),Math.abs(c._normalizeBearing(e,0))<this._bearingSnap&&(e=c._normalizeBearing(0,e)),c.rotateTo(e,{duration:1e3*i,easing:ed,noMoveStart:!0},{originalEvent:a})}else f()}},fd.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},fd.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};var gd=a.bezier(0,0,.3,1);n=function(b,c){this._map=b,this._el=b.getCanvasContainer(),this._state="disabled",this._clickTolerance=c.clickTolerance||1,a.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};n.prototype.isEnabled=function(){return"disabled"!==this._state},n.prototype.isActive=function(){return"active"===this._state},n.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},n.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},n.prototype.onMouseDown=function(b){"enabled"===this._state&&(b.ctrlKey||0!==c.mouseButton(b)||(c.addEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),c.addEventListener(a.window.document,"mouseup",this._onMouseUp),this._start(b)))},n.prototype.onTouchStart=function(b){"enabled"===this._state&&(b.touches.length>1||(c.addEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),c.addEventListener(a.window.document,"touchend",this._onTouchEnd),this._start(b)))},n.prototype._start=function(b){a.window.addEventListener("blur",this._onBlur),this._state="pending",this._startPos=this._mouseDownPos=this._lastPos=c.mousePos(this._el,b),this._inertia=[[a.browser.now(),this._startPos]]},n.prototype._onMove=function(b){b.preventDefault();var d=c.mousePos(this._el,b);this._lastPos.equals(d)||"pending"===this._state&&d.dist(this._mouseDownPos)<this._clickTolerance||(this._lastMoveEvent=b,this._lastPos=d,this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),this._lastPos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",b),this._fireEvent("movestart",b)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame)))},n.prototype._onDragFrame=function(){this._frameId=null;var a=this._lastMoveEvent;if(a){var b=this._map.transform;b.setLocationAtPoint(b.pointLocation(this._startPos),this._lastPos),this._fireEvent("drag",a),this._fireEvent("move",a),this._startPos=this._lastPos,delete this._lastMoveEvent}},n.prototype._onMouseUp=function(a){if(0===c.mouseButton(a))switch(this._state){case"active":this._state="enabled",c.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},n.prototype._onTouchEnd=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(a);break;case"pending":this._state="enabled",this._unbind()}},n.prototype._onBlur=function(a){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",a),this._fireEvent("moveend",a);break;case"pending":this._state="enabled",this._unbind()}},n.prototype._unbind=function(){c.removeEventListener(a.window.document,"touchmove",this._onMove,{capture:!0,passive:!1}),c.removeEventListener(a.window.document,"touchend",this._onTouchEnd),c.removeEventListener(a.window.document,"mousemove",this._onMove,{capture:!0}),c.removeEventListener(a.window.document,"mouseup",this._onMouseUp),c.removeEventListener(a.window,"blur",this._onBlur)},n.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._startPos,delete this._mouseDownPos,delete this._lastPos},n.prototype._inertialPan=function(a){this._fireEvent("dragend",a),this._drainInertiaBuffer();var b=this._inertia;if(b.length<2)this._fireEvent("moveend",a);else{var c=b[b.length-1];b=b[0];var d=c[1].sub(b[1]),e=(c[0]-b[0])/1e3;if(0===e||c[1].equals(b[1]))this._fireEvent("moveend",a);else{c=d.mult(.3/e);b=c.mag();b>1400&&(b=1400,c._unit()._mult(b));d=b/750;e=c.mult(-d/2);this._map.panBy(e,{duration:1e3*d,easing:gd,noMoveStart:!0},{originalEvent:a})}}},n.prototype._fireEvent=function(b,c){return this._map.fire(new a.Event(b,c?{originalEvent:c}:{}))},n.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>0&&c-b[0][0]>160;)b.shift()};x=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onKeyDown"],this)};function hd(a){return a*(2-a)}x.prototype.isEnabled=function(){return!!this._enabled},x.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},x.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},x.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var b=0,c=0,d=0,e=0,f=0;switch(a.keyCode){case 61:case 107:case 171:case 187:b=1;break;case 189:case 109:case 173:b=-1;break;case 37:a.shiftKey?c=-1:(a.preventDefault(),e=-1);break;case 39:a.shiftKey?c=1:(a.preventDefault(),e=1);break;case 38:a.shiftKey?d=1:(a.preventDefault(),f=-1);break;case 40:a.shiftKey?d=-1:(f=1,a.preventDefault());break;default:return}var g=this._map,h=g.getZoom();b={duration:300,delayEndEvents:500,easing:hd,zoom:b?Math.round(h)+b*(a.shiftKey?2:1):h,bearing:g.getBearing()+15*c,pitch:g.getPitch()+10*d,offset:[100*-e,100*-f],center:g.getCenter()};g.easeTo(b,{originalEvent:a})}};Lb=function(b){this._map=b,a.bindAll(["_onDblClick","_onZoomEnd"],this)};Lb.prototype.isEnabled=function(){return!!this._enabled},Lb.prototype.isActive=function(){return!!this._active},Lb.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Lb.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Lb.prototype.onTouchStart=function(a){var b=this;if(this.isEnabled()&&!(a.points.length>1))if(this._tapped){var c=a.points[0],d=this._tappedPoint;if(d&&d.dist(c)<=30){a.originalEvent.preventDefault();var e=function(){b._tapped&&b._zoom(a),b._map.off("touchcancel",f),b._resetTapped()},f=function(){b._map.off("touchend",e),b._resetTapped()};this._map.once("touchend",e),this._map.once("touchcancel",f)}else this._resetTapped()}else this._tappedPoint=a.points[0],this._tapped=setTimeout(function(){b._tapped=null,b._tappedPoint=null},300)},Lb.prototype._resetTapped=function(){clearTimeout(this._tapped),this._tapped=null,this._tappedPoint=null},Lb.prototype.onDblClick=function(a){this.isEnabled()&&(a.originalEvent.preventDefault(),this._zoom(a))},Lb.prototype._zoom=function(a){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)},Lb.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var id=a.bezier(0,0,.15,1);Mb=function(b){this._map=b,this._el=b.getCanvasContainer(),a.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};Mb.prototype.isEnabled=function(){return!!this._enabled},Mb.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around)},Mb.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},Mb.prototype.disableRotation=function(){this._rotationDisabled=!0},Mb.prototype.enableRotation=function(){this._rotationDisabled=!1},Mb.prototype.onStart=function(b){if(this.isEnabled()&&2===b.touches.length){var d=c.mousePos(this._el,b.touches[0]);b=c.mousePos(this._el,b.touches[1]);var e=d.add(b).div(2);this._startVec=d.sub(b),this._startAround=this._map.transform.pointLocation(e),this._gestureIntent=void 0,this._inertia=[],c.addEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),c.addEventListener(a.window.document,"touchend",this._onEnd)}},Mb.prototype._getTouchEventData=function(a){var b=c.mousePos(this._el,a.touches[0]);a=c.mousePos(this._el,a.touches[1]);var d=b.sub(a);return{vec:d,center:b.add(a).div(2),scale:d.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*d.angleWith(this._startVec)/Math.PI}},Mb.prototype._onMove=function(b){if(2===b.touches.length){var c=this._getTouchEventData(b),d=c.vec,e=c.scale;c=c.bearing;if(!this._gestureIntent){e=this._rotationDisabled&&1!==e||Math.abs(1-e)>.15;Math.abs(c)>10?this._gestureIntent="rotate":e&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new a.Event(this._gestureIntent+"start",{originalEvent:b})),this._map.fire(new a.Event("movestart",{originalEvent:b})),this._startVec=d)}this._lastTouchEvent=b,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),b.preventDefault()}},Mb.prototype._onTouchFrame=function(){this._frameId=null;var b=this._gestureIntent;if(b){var c=this._map.transform;this._startScale||(this._startScale=c.scale,this._startBearing=c.bearing);var d=this._getTouchEventData(this._lastTouchEvent),e=d.center,f=d.bearing;d=d.scale;var g=c.pointLocation(e);g=c.locationPoint(g);"rotate"===b&&(c.bearing=this._startBearing+f),c.zoom=c.scaleZoom(this._startScale*d),c.setLocationAtPoint(this._startAround,g),this._map.fire(new a.Event(b,{originalEvent:this._lastTouchEvent})),this._map.fire(new a.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([a.browser.now(),d,e])}},Mb.prototype._onEnd=function(b){c.removeEventListener(a.window.document,"touchmove",this._onMove,{passive:!1}),c.removeEventListener(a.window.document,"touchend",this._onEnd);var d=this._gestureIntent,e=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,d){this._map.fire(new a.Event(d+"end",{originalEvent:b})),this._drainInertiaBuffer();d=this._inertia;var f=this._map;if(d.length<2)f.snapToNorth({},{originalEvent:b});else{var g=d[d.length-1];d=d[0];var i=f.transform.scaleZoom(e*g[1]);e=f.transform.scaleZoom(e*d[1]);var h=i-e;d=(g[0]-d[0])/1e3;g=g[2];if(0!==d&&i!==e){e=.15*h/d;Math.abs(e)>2.5&&(e=e>0?2.5:-2.5);h=1e3*Math.abs(e/(12*.15));d=i+e*h/2e3;d<0&&(d=0),f.easeTo({zoom:d,duration:h,easing:id,around:this._aroundCenter?f.getCenter():f.unproject(g),noMoveStart:!0},{originalEvent:b})}else f.snapToNorth({},{originalEvent:b})}}},Mb.prototype._drainInertiaBuffer=function(){for(var b=this._inertia,c=a.browser.now();b.length>2&&c-b[0][0]>160;)b.shift()};var jd={scrollZoom:B,boxZoom:e,dragRotate:fd,dragPan:n,keyboard:x,doubleClickZoom:Lb,touchZoomRotate:Mb};Nb=function(b){function c(c,d){b.call(this),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=d.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}return b&&(c.__proto__=b),c.prototype=Object.create(b&&b.prototype),c.prototype.constructor=c,c.prototype.getCenter=function(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)},c.prototype.setCenter=function(a,b){return this.jumpTo({center:a},b)},c.prototype.panBy=function(b,c,d){return b=a.Point.convert(b).mult(-1),this.panTo(this.transform.center,a.extend({offset:b},c),d)},c.prototype.panTo=function(b,c,d){return this.easeTo(a.extend({center:b},c),d)},c.prototype.getZoom=function(){return this.transform.zoom},c.prototype.setZoom=function(a,b){return this.jumpTo({zoom:a},b),this},c.prototype.zoomTo=function(b,c,d){return this.easeTo(a.extend({zoom:b},c),d)},c.prototype.zoomIn=function(a,b){return this.zoomTo(this.getZoom()+1,a,b),this},c.prototype.zoomOut=function(a,b){return this.zoomTo(this.getZoom()-1,a,b),this},c.prototype.getBearing=function(){return this.transform.bearing},c.prototype.setBearing=function(a,b){return this.jumpTo({bearing:a},b),this},c.prototype.rotateTo=function(b,c,d){return this.easeTo(a.extend({bearing:b},c),d)},c.prototype.resetNorth=function(b,c){return this.rotateTo(0,a.extend({duration:1e3},b),c),this},c.prototype.snapToNorth=function(a,b){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,b):this},c.prototype.getPitch=function(){return this.transform.pitch},c.prototype.setPitch=function(a,b){return this.jumpTo({pitch:a},b),this},c.prototype.cameraForBounds=function(b,c){return b=a.LngLatBounds.convert(b),this._cameraForBoxAndBearing(b.getNorthWest(),b.getSouthEast(),0,c)},c.prototype._cameraForBoxAndBearing=function(b,c,d,e){if("number"==typeof (e=a.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){var f=e.padding;e.padding={top:f,bottom:f,right:f,left:f}}if(a.deepEqual(Object.keys(e.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"])){f=this.transform;b=f.project(a.LngLat.convert(b));c=f.project(a.LngLat.convert(c));var i=b.rotate(-d*Math.PI/180),g=c.rotate(-d*Math.PI/180),h=new a.Point(Math.max(i.x,g.x),Math.max(i.y,g.y));i=new a.Point(Math.min(i.x,g.x),Math.min(i.y,g.y));g=h.sub(i);h=(f.width-e.padding.left-e.padding.right)/g.x;i=(f.height-e.padding.top-e.padding.bottom)/g.y;if(!(i<0||h<0)){g=Math.min(f.scaleZoom(f.scale*Math.min(h,i)),e.maxZoom);h=a.Point.convert(e.offset);i=(e.padding.left-e.padding.right)/2;e=(e.padding.top-e.padding.bottom)/2;i=new a.Point(h.x+i,h.y+e).mult(f.scale/f.zoomScale(g));return{center:f.unproject(b.add(c).div(2).sub(i)),zoom:g,bearing:d}}a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}else a.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")},c.prototype.fitBounds=function(a,b,c){return this._fitInternal(this.cameraForBounds(a,b),b,c)},c.prototype.fitScreenCoordinates=function(b,c,d,e,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.Point.convert(b)),this.transform.pointLocation(a.Point.convert(c)),d,e),e,f)},c.prototype._fitInternal=function(b,c,d){return b?(c=a.extend(b,c)).linear?this.easeTo(c,d):this.flyTo(c,d):this},c.prototype.jumpTo=function(b,c){this.stop();var d=this.transform,e=!1,f=!1,g=!1;return"zoom"in b&&d.zoom!==+b.zoom&&(e=!0,d.zoom=+b.zoom),void 0!==b.center&&(d.center=a.LngLat.convert(b.center)),"bearing"in b&&d.bearing!==+b.bearing&&(f=!0,d.bearing=+b.bearing),"pitch"in b&&d.pitch!==+b.pitch&&(g=!0,d.pitch=+b.pitch),this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),e&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),f&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),g&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c))},c.prototype.easeTo=function(b,c){var d=this;this.stop(),!1===(b=a.extend({offset:[0,0],duration:500,easing:a.ease},b)).animate&&(b.duration=0);var e=this.transform,f=this.getZoom(),g=this.getBearing(),h=this.getPitch(),i="zoom"in b?+b.zoom:f,w="bearing"in b?this._normalizeBearing(b.bearing,g):g,j="pitch"in b?+b.pitch:h,k=e.centerPoint.add(a.Point.convert(b.offset)),l=e.pointLocation(k),x=a.LngLat.convert(b.center||l);this._normalizeCenter(x);var r,s,t=e.project(l),u=e.project(x).sub(t),v=e.zoomScale(i-f);return b.around&&(r=a.LngLat.convert(b.around),s=e.locationPoint(r)),this._zooming=i!==f,this._rotating=g!==w,this._pitching=j!==h,this._prepareEase(c,b.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(b){if(d._zooming&&(e.zoom=a.number(f,i,b)),d._rotating&&(e.bearing=a.number(g,w,b)),d._pitching&&(e.pitch=a.number(h,j,b)),r)e.setLocationAtPoint(r,s);else{var l=e.zoomScale(e.zoom-f),m=i>f?Math.min(2,v):Math.max(.5,v);m=Math.pow(m,1-b);b=e.unproject(t.add(u.mult(b*m)).mult(l));e.setLocationAtPoint(e.renderWorldCopies?b.wrap():b,k)}d._fireMoveEvents(c)},function(){b.delayEndEvents?d._easeEndTimeoutID=setTimeout(function(){return d._afterEase(c)},b.delayEndEvents):d._afterEase(c)},b),this},c.prototype._prepareEase=function(b,c){this._moving=!0,c||this.fire(new a.Event("movestart",b)),this._zooming&&this.fire(new a.Event("zoomstart",b)),this._rotating&&this.fire(new a.Event("rotatestart",b)),this._pitching&&this.fire(new a.Event("pitchstart",b))},c.prototype._fireMoveEvents=function(b){this.fire(new a.Event("move",b)),this._zooming&&this.fire(new a.Event("zoom",b)),this._rotating&&this.fire(new a.Event("rotate",b)),this._pitching&&this.fire(new a.Event("pitch",b))},c.prototype._afterEase=function(b){var c=this._zooming,d=this._rotating,e=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,c&&this.fire(new a.Event("zoomend",b)),d&&this.fire(new a.Event("rotateend",b)),e&&this.fire(new a.Event("pitchend",b)),this.fire(new a.Event("moveend",b))},c.prototype.flyTo=function(b,c){var d=this;this.stop(),b=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},b);var e=this.transform,f=this.getZoom(),g=this.getBearing(),h=this.getPitch(),i="zoom"in b?a.clamp(+b.zoom,e.minZoom,e.maxZoom):f,M="bearing"in b?this._normalizeBearing(b.bearing,g):g,j="pitch"in b?+b.pitch:h,k=e.zoomScale(i-f),l=e.centerPoint.add(a.Point.convert(b.offset)),N=e.pointLocation(l),s=a.LngLat.convert(b.center||N);this._normalizeCenter(s);var t=e.project(N),B=e.project(s).sub(t),C=b.curve,D=Math.max(e.width,e.height),O=D/k,E=B.mag();if("minZoom"in b){N=a.clamp(Math.min(b.minZoom,f,i),e.minZoom,e.maxZoom);k=D/e.zoomScale(N-f);C=Math.sqrt(k/E*2)}var F=C*C;function G(a){a=(O*O-D*D+(a?-1:1)*F*F*E*E)/(2*(a?O:D)*F*E);return Math.log(Math.sqrt(a*a+1)-a)}function H(a){return(Math.exp(a)-Math.exp(-a))/2}function P(a){return(Math.exp(a)+Math.exp(-a))/2}var aa=G(0),I=function(a){return P(aa)/P(aa+C*a)},J=function(a){return D*((P(aa)*(H(a=aa+C*a)/P(a))-H(aa))/F)/E},K=(G(1)-aa)/C;if(Math.abs(E)<1e-6||!isFinite(K)){if(Math.abs(D-O)<1e-6)return this.easeTo(b,c);var L=O<D?-1:1;K=Math.abs(Math.log(O/D))/C,J=function(){return 0},I=function(a){return Math.exp(L*C*a)}}if("duration"in b)b.duration=+b.duration;else{N="screenSpeed"in b?+b.screenSpeed/C:+b.speed;b.duration=1e3*K/N}return b.maxDuration&&b.duration>b.maxDuration&&(b.duration=0),this._zooming=!0,this._rotating=g!==M,this._pitching=j!==h,this._prepareEase(c,!1),this._ease(function(b){var k=b*K,m=1/I(k);e.zoom=1===b?i:f+e.scaleZoom(m),d._rotating&&(e.bearing=a.number(g,M,b)),d._pitching&&(e.pitch=a.number(h,j,b));b=1===b?s:e.unproject(t.add(B.mult(J(k))).mult(m));e.setLocationAtPoint(e.renderWorldCopies?b.wrap():b,l),d._fireMoveEvents(c)},function(){return d._afterEase(c)},b),this},c.prototype.isEasing=function(){return!!this._easeFrameId},c.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var a=this._onEaseEnd;delete this._onEaseEnd,a.call(this)}return this},c.prototype._ease=function(b,c,d){!1===d.animate||0===d.duration?(b(1),c()):(this._easeStart=a.browser.now(),this._easeOptions=d,this._onEaseFrame=b,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},c.prototype._renderFrameCallback=function(){var b=Math.min((a.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(b)),b<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},c.prototype._normalizeBearing=function(b,c){b=a.wrap(b,-180,180);var d=Math.abs(b-c);return Math.abs(b-360-c)<d&&(b-=360),Math.abs(b+360-c)<d&&(b+=360),b},c.prototype._normalizeCenter=function(a){var b=this.transform;if(b.renderWorldCopies&&!b.lngRange){b=a.lng-b.center.lng;a.lng+=b>180?-360:b<-180?360:0}},c}(a.Evented);var kd=function(b){void 0===b&&(b={}),this.options=b,a.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};kd.prototype.getDefaultPosition=function(){return"bottom-right"},kd.prototype.onAdd=function(a){var b=this.options&&this.options.compact;return this._map=a,this._container=c.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=c.create("div","mapboxgl-ctrl-attrib-inner",this._container),b&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===b&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},kd.prototype.onRemove=function(){c.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},kd.prototype._updateEditLink=function(){var b=this._editLink;b||(b=this._editLink=this._container.querySelector(".mapbox-improve-map"));var c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:a.config.ACCESS_TOKEN}];if(b){var d=c.reduce(function(a,b,d){return b.value&&(a+=b.key+"="+b.value+(d<c.length-1?"&":"")),a},"?");b.href=a.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):""),b.rel="noopener nofollow"}},kd.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},kd.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(a){return"string"!=typeof a?"":a})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}b=this._map.style.sourceCaches;for(var c in b){var d=b[c];if(d.used){d=d.getSource();d.attribution&&a.indexOf(d.attribution)<0&&a.push(d.attribution)}}a.sort(function(a,b){return a.length-b.length});d=(a=a.filter(function(b,c){for(var c=c+1;c<a.length;c++)if(a[c].indexOf(b)>=0)return!1;return!0})).join(" | ");d!==this._attribHTML&&(this._attribHTML=d,a.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},kd.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ld=function(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)};ld.prototype.onAdd=function(a){this._map=a,this._container=c.create("div","mapboxgl-ctrl");a=c.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label","Mapbox logo"),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ld.prototype.onRemove=function(){c.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ld.prototype.getDefaultPosition=function(){return"bottom-left"},ld.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ld.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var b in a)if(a[b].getSource().mapbox_logo)return!0;return!1}},ld.prototype._updateCompact=function(){var a=this._container.children;if(a.length){a=a[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var md=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};md.prototype.add=function(a){var b=++this._id;return this._queue.push({callback:a,id:b,cancelled:!1}),b},md.prototype.remove=function(a){for(var b=this._currentlyRunning,c=0,b=b?this._queue.concat(b):this._queue;c<b.length;c+=1){var d=b[c];if(d.id===a)return void (d.cancelled=!0)}},md.prototype.run=function(){var a=this._currentlyRunning=this._queue;this._queue=[];for(var b=0,a=a;b<a.length;b+=1){var c=a[b];if(!c.cancelled&&(c.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},md.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var nd=a.window.HTMLImageElement,od=a.window.HTMLElement,pd={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,clickTolerance:3,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0};Ob=function(d){function e(b){var e=this;if(null!=(b=a.extend({},pd,b)).minZoom&&null!=b.maxZoom&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than minZoom");var f=new $c(b.minZoom,b.maxZoom,b.renderWorldCopies);if(d.call(this,f,b),this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=b.collectResourceTiming,this._renderTaskQueue=new md(),this._controls=[],this._mapId=a.uniqueId(),this._requestManager=new a.RequestManager(b.transformRequest),"string"==typeof b.container){if(this._container=a.window.document.getElementById(b.container),!this._container)throw new Error("Container '"+b.container+"' not found.")}else{if(!(b.container instanceof od))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return e._update(!1)}),this.on("moveend",function(){return e._update(!1)}),this.on("zoom",function(){return e._update(!0)}),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1)),(function(a,b){var d=a.getCanvasContainer(),e=null,f=!1,g=null;for(var h in jd)a[h]=new jd[h](a,b),b.interactive&&b[h]&&a[h].enable(b[h]);c.addEventListener(d,"mouseout",function(b){a.fire(new bd("mouseout",a,b))}),c.addEventListener(d,"mousedown",function(e){f=!0,g=c.mousePos(d,e);var h=new bd("mousedown",a,e);a.fire(h),h.defaultPrevented||(b.interactive&&!a.doubleClickZoom.isActive()&&a.stop(),a.boxZoom.onMouseDown(e),a.boxZoom.isActive()||a.dragPan.isActive()||a.dragRotate.onMouseDown(e),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onMouseDown(e))}),c.addEventListener(d,"mouseup",function(b){var c=a.dragRotate.isActive();e&&!c&&a.fire(new bd("contextmenu",a,e)),e=null,f=!1,a.fire(new bd("mouseup",a,b))}),c.addEventListener(d,"mousemove",function(b){if(!a.dragPan.isActive()&&!a.dragRotate.isActive()){for(var c=b.target;c&&c!==d;)c=c.parentNode;c===d&&a.fire(new bd("mousemove",a,b))}}),c.addEventListener(d,"mouseover",function(b){for(var c=b.target;c&&c!==d;)c=c.parentNode;c===d&&a.fire(new bd("mouseover",a,b))}),c.addEventListener(d,"touchstart",function(c){var d=new cd("touchstart",a,c);a.fire(d),d.defaultPrevented||(b.interactive&&a.stop(),a.boxZoom.isActive()||a.dragRotate.isActive()||a.dragPan.onTouchStart(c),a.touchZoomRotate.onStart(c),a.doubleClickZoom.onTouchStart(d))},{passive:!1}),c.addEventListener(d,"touchmove",function(b){a.fire(new cd("touchmove",a,b))},{passive:!1}),c.addEventListener(d,"touchend",function(b){a.fire(new cd("touchend",a,b))}),c.addEventListener(d,"touchcancel",function(b){a.fire(new cd("touchcancel",a,b))}),c.addEventListener(d,"click",function(e){var f=c.mousePos(d,e);(f.equals(g)||f.dist(g)<b.clickTolerance)&&a.fire(new bd("click",a,e))}),c.addEventListener(d,"dblclick",function(b){b=new bd("dblclick",a,b);a.fire(b),b.defaultPrevented||a.doubleClickZoom.onDblClick(b)}),c.addEventListener(d,"contextmenu",function(b){var c=a.dragRotate.isActive();f||c?f&&(e=b):a.fire(new bd("contextmenu",a,b)),(a.dragRotate.isEnabled()||a.listens("contextmenu"))&&b.preventDefault()}),c.addEventListener(d,"wheel",function(c){b.interactive&&a.stop();var d=new dd("wheel",a,c);a.fire(d),d.defaultPrevented||a.scrollZoom.onWheel(c)},{passive:!1})})(this,b),this._hash=b.hash&&new ad().addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,a.extend({},b.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=b.localIdeographFontFamily,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new kd({customAttribution:b.customAttribution})),this.addControl(new ld(),b.logoPosition),this.on("style.load",function(){e.transform.unmodified&&e.jumpTo(e.style.stylesheet)}),this.on("data",function(b){e._update("style"===b.dataType),e.fire(new a.Event(b.dataType+"data",b))}),this.on("dataloading",function(b){e.fire(new a.Event(b.dataType+"dataloading",b))})}d&&(e.__proto__=d),e.prototype=Object.create(d&&d.prototype),e.prototype.constructor=e;var f={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return e.prototype._getMapId=function(){return this._mapId},e.prototype.addControl=function(b,c){if(void 0===c&&b.getDefaultPosition&&(c=b.getDefaultPosition()),void 0===c&&(c="top-right"),!b||!b.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var d=b.onAdd(this);this._controls.push(b);b=this._controlPositions[c];return-1!==c.indexOf("bottom")?b.insertBefore(d,b.firstChild):b.appendChild(d),this},e.prototype.removeControl=function(b){if(!b||!b.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var c=this._controls.indexOf(b);return c>-1&&this._controls.splice(c,1),b.onRemove(this),this},e.prototype.resize=function(b){var c=this._containerDimensions(),d=c[0];c=c[1];return this._resizeCanvas(d,c),this.transform.resize(d,c),this.painter.resize(d,c),this.fire(new a.Event("movestart",b)).fire(new a.Event("move",b)).fire(new a.Event("resize",b)).fire(new a.Event("moveend",b)),this},e.prototype.getBounds=function(){return this.transform.getBounds()},e.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},e.prototype.setMaxBounds=function(b){return this.transform.setMaxBounds(a.LngLatBounds.convert(b)),this._update()},e.prototype.setMinZoom=function(a){if((a=null==a?0:a)>=0&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},e.prototype.getMinZoom=function(){return this.transform.minZoom},e.prototype.setMaxZoom=function(a){if((a=null==a?22:a)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw new Error("maxZoom must be greater than the current minZoom")},e.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},e.prototype.setRenderWorldCopies=function(a){return this.transform.renderWorldCopies=a,this._update()},e.prototype.getMaxZoom=function(){return this.transform.maxZoom},e.prototype.project=function(b){return this.transform.locationPoint(a.LngLat.convert(b))},e.prototype.unproject=function(b){return this.transform.pointLocation(a.Point.convert(b))},e.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},e.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isZooming()},e.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},e.prototype.on=function(a,b,c){var e=this;if(void 0===c)return d.prototype.on.call(this,a,b);var f=function(){var d;if("mouseenter"===a||"mouseover"===a){var f=!1;return{layer:b,listener:c,delegates:{mousemove:function(d){var g=e.getLayer(b)?e.queryRenderedFeatures(d.point,{layers:[b]}):[];g.length?f||(f=!0,c.call(e,new bd(a,e,d.originalEvent,{features:g}))):f=!1},mouseout:function(){f=!1}}}}if("mouseleave"===a||"mouseout"===a){var g=!1;return{layer:b,listener:c,delegates:{mousemove:function(d){(e.getLayer(b)?e.queryRenderedFeatures(d.point,{layers:[b]}):[]).length?g=!0:g&&(g=!1,c.call(e,new bd(a,e,d.originalEvent)))},mouseout:function(b){g&&(g=!1,c.call(e,new bd(a,e,b.originalEvent)))}}}}return{layer:b,listener:c,delegates:(d={},d[a]=function(a){var d=e.getLayer(b)?e.queryRenderedFeatures(a.point,{layers:[b]}):[];d.length&&(a.features=d,c.call(e,a),delete a.features)},d)}}();for(var g in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[a]=this._delegatedListeners[a]||[],this._delegatedListeners[a].push(f),f.delegates)this.on(g,f.delegates[g]);return this},e.prototype.off=function(a,b,c){if(void 0===c)return d.prototype.off.call(this,a,b);if(this._delegatedListeners&&this._delegatedListeners[a])for(var a=this._delegatedListeners[a],e=0;e<a.length;e++){var f=a[e];if(f.layer===b&&f.listener===c){for(var g in f.delegates)this.off(g,f.delegates[g]);return a.splice(e,1),this}}return this},e.prototype.queryRenderedFeatures=function(b,c){if(!this.style)return[];var d;if(void 0!==c||void 0===b||b instanceof a.Point||Array.isArray(b)||(c=b,b=void 0),c=c||{},(b=b||[[0,0],[this.transform.width,this.transform.height]])instanceof a.Point||"number"==typeof b[0])d=[a.Point.convert(b)];else{var e=a.Point.convert(b[0]);b=a.Point.convert(b[1]);d=[e,new a.Point(b.x,e.y),b,new a.Point(e.x,b.y),e]}return this.style.queryRenderedFeatures(d,c,this.transform)},e.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)},e.prototype.setStyle=function(b,c){return!1!==(c=a.extend({},{localIdeographFontFamily:pd.localIdeographFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(b,c))},e.prototype._updateStyle=function(a,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),a?(this.style=new Ib(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof a?this.style.loadURL(a):this.style.loadJSON(a),this):(delete this.style,this)},e.prototype._diffStyle=function(b,c){var d=this;if("string"==typeof b){var e=this._requestManager.normalizeStyleURL(b);e=this._requestManager.transformRequest(e,a.ResourceType.Style);a.getJSON(e,function(b,e){b?d.fire(new a.ErrorEvent(b)):e&&d._updateDiff(e,c)})}else"object"==typeof b&&this._updateDiff(b,c)},e.prototype._updateDiff=function(b,c){try{this.style.setState(b)&&this._update(!0)}catch(d){a.warnOnce("Unable to perform style diff: "+(d.message||d.error||d)+".  Rebuilding the style from scratch."),this._updateStyle(b,c)}},e.prototype.getStyle=function(){if(this.style)return this.style.serialize()},e.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")},e.prototype.addSource=function(a,b){return this.style.addSource(a,b),this._update(!0)},e.prototype.isSourceLoaded=function(b){var c=this.style&&this.style.sourceCaches[b];if(void 0!==c)return c.loaded();this.fire(new a.ErrorEvent(new Error("There is no source with ID '"+b+"'")))},e.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches;for(var b in a){var c=a[b]._tiles;for(var d in c){var e=c[d];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0},e.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,b,c)},e.prototype.removeSource=function(a){return this.style.removeSource(a),this._update(!0)},e.prototype.getSource=function(a){return this.style.getSource(a)},e.prototype.addImage=function(b,c,d){void 0===d&&(d={});var e=d.pixelRatio;void 0===e&&(e=1);d=d.sdf;void 0===d&&(d=!1);if(c instanceof nd){var f=a.browser.getImageData(c),g=f.width,h=f.height;f=f.data;this.style.addImage(b,{data:new a.RGBAImage({width:g,height:h},f),pixelRatio:e,sdf:d,version:0})}else{if(void 0===c.width||void 0===c.height)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));g=c.width;h=c.height;f=c.data;c=c;this.style.addImage(b,{data:new a.RGBAImage({width:g,height:h},new Uint8Array(f)),pixelRatio:e,sdf:d,version:0,userImage:c}),c.onAdd&&c.onAdd(this,b)}},e.prototype.updateImage=function(b,c){var d=this.style.getImage(b);if(!d)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var e=c instanceof nd?a.browser.getImageData(c):c,f=e.width,g=e.height;e=e.data;if(void 0===f||void 0===g)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==d.data.width||g!==d.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));f=!(c instanceof nd);d.data.replace(e,f),this.style.updateImage(b,d)},e.prototype.hasImage=function(b){return b?!!this.style.getImage(b):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)},e.prototype.removeImage=function(a){this.style.removeImage(a)},e.prototype.loadImage=function(b,c){a.getImage(this._requestManager.transformRequest(b,a.ResourceType.Image),c)},e.prototype.listImages=function(){return this.style.listImages()},e.prototype.addLayer=function(a,b){return this.style.addLayer(a,b),this._update(!0)},e.prototype.moveLayer=function(a,b){return this.style.moveLayer(a,b),this._update(!0)},e.prototype.removeLayer=function(a){return this.style.removeLayer(a),this._update(!0)},e.prototype.getLayer=function(a){return this.style.getLayer(a)},e.prototype.setFilter=function(a,b,c){return void 0===c&&(c={}),this.style.setFilter(a,b,c),this._update(!0)},e.prototype.setLayerZoomRange=function(a,b,c){return this.style.setLayerZoomRange(a,b,c),this._update(!0)},e.prototype.getFilter=function(a){return this.style.getFilter(a)},e.prototype.setPaintProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setPaintProperty(a,b,c,d),this._update(!0)},e.prototype.getPaintProperty=function(a,b){return this.style.getPaintProperty(a,b)},e.prototype.setLayoutProperty=function(a,b,c,d){return void 0===d&&(d={}),this.style.setLayoutProperty(a,b,c,d),this._update(!0)},e.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,b)},e.prototype.setLight=function(a,b){return void 0===b&&(b={}),this.style.setLight(a,b),this._update(!0)},e.prototype.getLight=function(){return this.style.getLight()},e.prototype.setFeatureState=function(a,b){return this.style.setFeatureState(a,b),this._update()},e.prototype.removeFeatureState=function(a,b){return this.style.removeFeatureState(a,b),this._update()},e.prototype.getFeatureState=function(a){return this.style.getFeatureState(a)},e.prototype.getContainer=function(){return this._container},e.prototype.getCanvasContainer=function(){return this._canvasContainer},e.prototype.getCanvas=function(){return this._canvas},e.prototype._containerDimensions=function(){var a=0,b=0;return this._container&&(a=this._container.clientWidth||400,b=this._container.clientHeight||300),[a,b]},e.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},e.prototype._setupContainer=function(){var a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSCanary=c.create("div","mapboxgl-canary",a)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=c.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=c.create("canvas","mapboxgl-canvas",b),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");b=this._containerDimensions();this._resizeCanvas(b[0],b[1]);var d=this._controlContainer=c.create("div","mapboxgl-control-container",a),e=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){e[a]=c.create("div","mapboxgl-ctrl-"+a,d)})},e.prototype._resizeCanvas=function(b,c){var d=a.window.devicePixelRatio||1;this._canvas.width=d*b,this._canvas.height=d*c,this._canvas.style.width=b+"px",this._canvas.style.height=c+"px"},e.prototype._setupPainter=function(){var c=a.extend({},b.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1});c=this._canvas.getContext("webgl",c)||this._canvas.getContext("experimental-webgl",c);c?(this.painter=new Wc(c,this.transform),a.webpSupported.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))},e.prototype._contextLost=function(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:b}))},e.prototype._contextRestored=function(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:b}))},e.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},e.prototype._update=function(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this.triggerRepaint(),this):this},e.prototype._requestRenderFrame=function(a){return this._update(),this._renderTaskQueue.add(a)},e.prototype._cancelRenderFrame=function(a){this._renderTaskQueue.remove(a)},e.prototype._render=function(){this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run();var b=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var c=this.transform.zoom,d=a.browser.now();this.style.zoomHistory.update(c,d);c=new a.EvaluationParameters(c,{now:d,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()});d=c.crossFadingFactor();1===d&&d===this._crossFadingFactor||(b=!0,this._crossFadingFactor=d),this.style.update(c)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||b)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),this},e.prototype.remove=function(){this._hash&&this._hash.remove();for(var b=0,c=this._controls;b<c.length;b+=1)c[b].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),qd(this._canvasContainer),qd(this._controlContainer),qd(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this.fire(new a.Event("remove"))},e.prototype.triggerRepaint=function(){var b=this;this.style&&!this._frame&&(this._frame=a.browser.frame(function(){b._frame=null,b._render()}))},e.prototype._onWindowOnline=function(){this._update()},e.prototype._onWindowResize=function(){this._trackResize&&this.resize()._update()},f.showTileBoundaries.get=function(){return!!this._showTileBoundaries},f.showTileBoundaries.set=function(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())},f.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},f.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,a?this.style._generateCollisionBoxes():this._update())},f.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},f.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())},f.repaint.get=function(){return!!this._repaint},f.repaint.set=function(a){this._repaint!==a&&(this._repaint=a,this.triggerRepaint())},f.vertices.get=function(){return!!this._vertices},f.vertices.set=function(a){this._vertices=a,this._update()},e.prototype._setCacheLimits=function(b,c){a.setCacheLimits(b,c)},Object.defineProperties(e.prototype,f),e}(Nb);function qd(a){a.parentNode&&a.parentNode.removeChild(a)}var rd={showCompass:!0,showZoom:!0};Pb=function(b){var d=this;this.options=a.extend({},rd,b),this._container=c.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(a.bindAll(["_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return d._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return d._map.zoomOut()})),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){return d._map.resetNorth()}),this._compassArrow=c.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function sd(b,c,d){if(b=new a.LngLat(b.lng,b.lat),c){var e=new a.LngLat(b.lng-360,b.lat),f=new a.LngLat(b.lng+360,b.lat),g=d.locationPoint(b).distSqr(c);d.locationPoint(e).distSqr(c)<g?b=e:d.locationPoint(f).distSqr(c)<g&&(b=f)}for(;Math.abs(b.lng-d.center.lng)>180;){e=d.locationPoint(b);if(e.x>=0&&e.y>=0&&e.x<=d.width&&e.y<=d.height)break;b.lng>d.center.lng?b.lng-=360:b.lng+=360}return b}Pb.prototype._updateZoomButtons=function(){var a=this._map.getZoom();this._zoomInButton.classList.toggle("mapboxgl-ctrl-icon-disabled",a===this._map.getMaxZoom()),this._zoomOutButton.classList.toggle("mapboxgl-ctrl-icon-disabled",a===this._map.getMinZoom())},Pb.prototype._rotateCompassArrow=function(){var a="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=a},Pb.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fd(a,{button:"left",element:this._compass}),c.addEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.enable()),this._container},Pb.prototype.onRemove=function(){c.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),c.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown),this._handler.disable(),delete this._handler),delete this._map},Pb.prototype._createButton=function(a,b,d){a=c.create("button",a,this._container);return a.type="button",a.title=b,a.setAttribute("aria-label",b),a.addEventListener("click",d),a};var td={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ud(a,b,c){a=a.classList;for(var d in td)a.remove("mapboxgl-"+c+"-anchor-"+d);a.add("mapboxgl-"+c+"-anchor-"+b)}var vd,wd=function(b){function d(d,e){if(b.call(this),(d instanceof a.window.HTMLElement||e)&&(d=a.extend({element:d},e)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._draggable=d&&d.draggable||!1,this._state="inactive",d&&d.element)this._element=d.element,this._offset=a.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=c.create("div");e=c.createNS("http://www.w3.org/2000/svg","svg");e.setAttributeNS(null,"display","block"),e.setAttributeNS(null,"height","41px"),e.setAttributeNS(null,"width","27px"),e.setAttributeNS(null,"viewBox","0 0 27 41");var f=c.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");f=c.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill-rule","nonzero");var g=c.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(3.0, 29.0)"),g.setAttributeNS(null,"fill","#000000");for(var l=0,h=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];l<h.length;l+=1){var i=h[l],j=c.createNS("http://www.w3.org/2000/svg","ellipse");j.setAttributeNS(null,"opacity","0.04"),j.setAttributeNS(null,"cx","10.5"),j.setAttributeNS(null,"cy","5.80029008"),j.setAttributeNS(null,"rx",i.rx),j.setAttributeNS(null,"ry",i.ry),g.appendChild(j)}i=c.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"fill",this._color);j=c.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),i.appendChild(j);l=c.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"opacity","0.25"),l.setAttributeNS(null,"fill","#000000");h=c.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),l.appendChild(h);j=c.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(6.0, 7.0)"),j.setAttributeNS(null,"fill","#FFFFFF");h=c.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"transform","translate(8.0, 8.0)");var m=c.createNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"fill","#000000"),m.setAttributeNS(null,"opacity","0.25"),m.setAttributeNS(null,"cx","5.5"),m.setAttributeNS(null,"cy","5.5"),m.setAttributeNS(null,"r","5.4999962");var k=c.createNS("http://www.w3.org/2000/svg","circle");k.setAttributeNS(null,"fill","#FFFFFF"),k.setAttributeNS(null,"cx","5.5"),k.setAttributeNS(null,"cy","5.5"),k.setAttributeNS(null,"r","5.4999962"),h.appendChild(m),h.appendChild(k),f.appendChild(g),f.appendChild(i),f.appendChild(l),f.appendChild(j),f.appendChild(h),e.appendChild(f),this._element.appendChild(e),this._offset=a.Point.convert(d&&d.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(a){a.preventDefault()}),ud(this._element,this._anchor,"marker"),this._popup=null}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},d.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),delete this._map),c.remove(this._element),this._popup&&this._popup.remove(),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},d.prototype.getElement=function(){return this._element},d.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null),a){if(!("offset"in a.options)){var b=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},d.prototype._onMapClick=function(a){a=a.originalEvent.target;var b=this._element;this._popup&&(a===b||b.contains(a))&&this.togglePopup()},d.prototype.getPopup=function(){return this._popup},d.prototype.togglePopup=function(){var a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this},d.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=sd(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),a&&"moveend"!==a.type||(this._pos=this._pos.round()),c.setTransform(this._element,td[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"))},d.prototype.getOffset=function(){return this._offset},d.prototype.setOffset=function(b){return this._offset=a.Point.convert(b),this._update(),this},d.prototype._onMove=function(b){this._pos=b.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))},d.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"},d.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},d.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},d.prototype.isDraggable=function(){return this._draggable},d}(a.Evented),Z={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0};Qb=function(b){function d(c){b.call(this),this.options=a.extend({},Z,c),a.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.onAdd=function(b){var d;return this._map=b,this._container=c.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._setupUI,void 0!==vd?d(vd):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(function(a){vd="denied"!==a.state,d(vd)}):(vd=!!a.window.navigator.geolocation,d(vd)),this._container},d.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),c.remove(this._container),this._map=void 0},d.prototype._onSuccess=function(b){if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(b),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(b),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",b)),this._finish()},d.prototype._updateCamera=function(b){var c=new a.LngLat(b.coords.longitude,b.coords.latitude);b=b.coords.accuracy;var d=this._map.getBearing();d=a.extend({bearing:d},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(b),d,{geolocateSource:!0})},d.prototype._updateMarker=function(a){a?this._userLocationDotMarker.setLngLat([a.coords.longitude,a.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},d.prototype._onError=function(b){if(this.options.trackUserLocation)if(1===b.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",b)),this._finish()},d.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},d.prototype._setupUI=function(b){var d=this;!1!==b?(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=c.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=c.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new wd(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(b){b.geolocateSource||"ACTIVE_LOCK"!==d._watchState||(d._watchState="BACKGROUND",d._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),d._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),d.fire(new a.Event("trackuserlocationend")))})):a.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.")},d.prototype.trigger=function(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},d.prototype._clearWatch=function(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},d}(a.Evented);var xd={maxWidth:100,unit:"metric"};Rb=function(b){this.options=a.extend({},xd,b),a.bindAll(["_onMove","setUnit"],this)};function yd(a,b,c){var d,e,f,h=c&&c.maxWidth||100,g=a._container.clientHeight/2;f=(d=a.unproject([0,g]),a=a.unproject([h,g]),g=Math.PI/180,e=d.lat*g,f=a.lat*g,e=Math.sin(e)*Math.sin(f)+Math.cos(e)*Math.cos(f)*Math.cos((a.lng-d.lng)*g),6371e3*Math.acos(Math.min(e,1)));if(c&&"imperial"===c.unit){a=3.2808*f;a>5280?zd(b,h,a/5280,"mi"):zd(b,h,a,"ft")}else c&&"nautical"===c.unit?zd(b,h,f/1852,"nm"):zd(b,h,f,"m")}function zd(a,b,c,d){var e,f;f=(e=c,f=Math.pow(10,(""+Math.floor(e)).length-1),e=(e=e/f)>=10?10:e>=5?5:e>=3?3:e>=2?2:e>=1?1:function(a){var b=Math.pow(10,Math.ceil(-Math.log(a)/Math.LN10));return Math.round(a*b)/b}(e),f*e);e=f/c;"m"===d&&f>=1e3&&(f/=1e3,d="km"),a.style.width=b*e+"px",a.innerHTML=f+d}Rb.prototype.getDefaultPosition=function(){return"bottom-left"},Rb.prototype._onMove=function(){yd(this._map,this._container,this.options)},Rb.prototype.onAdd=function(a){return this._map=a,this._container=c.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Rb.prototype.onRemove=function(){c.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Rb.prototype.setUnit=function(a){this.options.unit=a,yd(this._map,this._container,this.options)};Sb=function(b){this._fullscreen=!1,b&&b.container&&(b.container instanceof a.window.HTMLElement?this._container=b.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in a.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in a.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in a.window.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Sb.prototype.onAdd=function(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=c.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Sb.prototype.onRemove=function(){c.remove(this._controlContainer),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Sb.prototype._checkFullscreenSupport=function(){return!!(a.window.document.fullscreenEnabled||a.window.document.mozFullScreenEnabled||a.window.document.msFullscreenEnabled||a.window.document.webkitFullscreenEnabled)},Sb.prototype._setupUI=function(){(this._fullscreenButton=c.create("button",this._className+"-icon "+this._className+"-fullscreen",this._controlContainer)).type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Sb.prototype._updateTitle=function(){var a=this._isFullscreen()?"Exit fullscreen":"Enter fullscreen";this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},Sb.prototype._isFullscreen=function(){return this._fullscreen},Sb.prototype._changeIcon=function(){(a.window.document.fullscreenElement||a.window.document.mozFullScreenElement||a.window.document.webkitFullscreenElement||a.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"),this._updateTitle())},Sb.prototype._onClickFullscreen=function(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.mozCancelFullScreen?a.window.document.mozCancelFullScreen():a.window.document.msExitFullscreen?a.window.document.msExitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ad={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"};Tb=function(b){function d(c){b.call(this),this.options=a.extend(Object.create(Ad),c),a.bindAll(["_update","_onClickClose","remove"],this)}return b&&(d.__proto__=b),d.prototype=Object.create(b&&b.prototype),d.prototype.constructor=d,d.prototype.addTo=function(b){var c=this;return this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",function(a){c._update(a.point)}),this._map.on("mouseup",function(a){c._update(a.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this},d.prototype.isOpen=function(){return!!this._map},d.prototype.remove=function(){return this._content&&c.remove(this._content),this._container&&(c.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),this._map.off("remove",this.remove),this._map.off("mousemove"),delete this._map),this.fire(new a.Event("close")),this},d.prototype.getLngLat=function(){return this._lngLat},d.prototype.setLngLat=function(b){return this._lngLat=a.LngLat.convert(b),this._pos=null,this._map&&(this._map.on("move",this._update),this._map.off("mousemove"),this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this._trackPointer=!1,this._update(),this},d.prototype.trackPointer=function(){var a=this;return this._trackPointer=!0,this._pos=null,this._map&&(this._map.off("move",this._update),this._map.on("mousemove",function(b){a._update(b.point)}),this._map.on("drag",function(b){a._update(b.point)}),this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},d.prototype.getElement=function(){return this._container},d.prototype.setText=function(b){return this.setDOMContent(a.window.document.createTextNode(b))},d.prototype.setHTML=function(b){var c=a.window.document.createDocumentFragment(),d=a.window.document.createElement("body");for(d.innerHTML=b;b=d.firstChild;)c.appendChild(b);return this.setDOMContent(c)},d.prototype.getMaxWidth=function(){return this._container.style.maxWidth},d.prototype.setMaxWidth=function(a){return this.options.maxWidth=a,this._update(),this},d.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},d.prototype._createContent=function(){this._content&&c.remove(this._content),this._content=c.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=c.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},d.prototype._update=function(b){var d=this,e=this._lngLat||this._trackPointer;if(this._map&&e&&this._content&&(this._container||(this._container=c.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=c.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(a){return d._container.classList.add(a)})),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=sd(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||b)){e=this._pos=this._trackPointer&&b?b:this._map.project(this._lngLat);b=this.options.anchor;var f=function b(c){if(c){if("number"==typeof c){var d=Math.round(Math.sqrt(.5*Math.pow(c,2)));return{center:new a.Point(0,0),top:new a.Point(0,c),"top-left":new a.Point(d,d),"top-right":new a.Point(-d,d),bottom:new a.Point(0,-c),"bottom-left":new a.Point(d,-d),"bottom-right":new a.Point(-d,-d),left:new a.Point(c,0),right:new a.Point(-c,0)}}if(c instanceof a.Point||Array.isArray(c)){d=a.Point.convert(c);return{center:d,top:d,"top-left":d,"top-right":d,bottom:d,"bottom-left":d,"bottom-right":d,left:d,right:d}}return{center:a.Point.convert(c.center||[0,0]),top:a.Point.convert(c.top||[0,0]),"top-left":a.Point.convert(c["top-left"]||[0,0]),"top-right":a.Point.convert(c["top-right"]||[0,0]),bottom:a.Point.convert(c.bottom||[0,0]),"bottom-left":a.Point.convert(c["bottom-left"]||[0,0]),"bottom-right":a.Point.convert(c["bottom-right"]||[0,0]),left:a.Point.convert(c.left||[0,0]),right:a.Point.convert(c.right||[0,0])}}return b(new a.Point(0,0))}(this.options.offset);if(!b){var h=this._container.offsetWidth,g=this._container.offsetHeight;g=e.y+f.bottom.y<g?["top"]:e.y>this._map.transform.height-g?["bottom"]:[],e.x<h/2?g.push("left"):e.x>this._map.transform.width-h/2&&g.push("right"),b=0===g.length?"bottom":g.join("-")}h=e.add(f[b]).round();c.setTransform(this._container,td[b]+" translate("+h.x+"px,"+h.y+"px)"),ud(this._container,b,"popup")}},d.prototype._onClickClose=function(){this.remove()},d}(a.Evented);var $={version:a.version,supported:b,setRTLTextPlugin:a.setRTLTextPlugin,Map:Ob,NavigationControl:Pb,GeolocateControl:Qb,AttributionControl:kd,ScaleControl:Rb,FullscreenControl:Sb,Popup:Tb,Marker:wd,Style:Ib,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,config:a.config,get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(b){a.config.ACCESS_TOKEN=b},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(b){a.config.API_URL=b},get workerCount(){return Ia.workerCount},set workerCount(a){Ia.workerCount=a},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.config.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage:function(b){a.clearTileCache(b)},workerUrl:""};return $});return d})}var k=!1,l=function(){k||(k=!0,j());return h.exports};a=function(a){switch(a){case void 0:return l()}};e.exports=a}),null);
__d("mapbox-gl",["mapbox-gl-1.1.1"],(function(a,b,c,d,e,f){e.exports=b("mapbox-gl-1.1.1")()}),null);
__d("FBMapUtils",["invariant","immutable","immutable-v4-rc-9","mapbox-gl"],(function(a,b,c,d,e,f,g){"use strict";var h=b("immutable-v4-rc-9").isImmutable,i="place-neighbourhood";a=2e3;c=function(a,c,d,e){var f=c.getSources(),g=d.getSources(),j=c.getLayers(),k=d.getLayers(),l=new Set(),m=new Set();f!==g&&(f.forEach(function(b,c){g.has(c)||(j.forEach(function(b){b.get("source")===c&&(l.add(b.get("id")),a.removeLayer(b.get("id")))}),a.removeSource(c))}),g.forEach(function(b,c){var d=f.get(c);if(b!==d)if(d==null)a.addSource(c,b.toJS());else if(d.get("type")==="geojson"&&b.get("type")==="geojson"){(d=a.getSource(c))==null?void 0:d.setData(b.get("data"))}else j.forEach(function(b){b.get("source")===c&&a.removeLayer(b.get("id"))}),a.removeSource(c),a.addSource(c,b.toJS()),k.forEach(function(a){a.get("source")===c&&m.add(a.get("id"))})}));var n;k.reverse().forEach(function(b){var d=b.get("id");(!c.hasLayer(d)||m.has(d))&&a.addLayer(b.toJS(),n);n=d});j!==k&&(j.filter(function(a){return!l.has(a.get("id"))}).forEach(function(b){!d.hasLayer(b.get("id"))&&a.getLayer(b.get("id"))!=null&&a.removeLayer(b.get("id"))}),k.forEach(function(d){var e=d.get("id"),f=c.getLayer(e);if(f!=null&&!m.has(e)){if(f.get("filter")!==d.get("filter")){var g=d.get("filter")?d.get("filter").toJS():null;a.setFilter(d.get("id"),g)}(f.get("minzoom")!==d.get("minzoom")||f.get("maxzoom")!==d.get("maxzoom"))&&a.setLayerZoomRange(e,d.get("minzoom"),d.get("maxzoom"));g=[{key:"paint",callbackName:"setPaintProperty"},{key:"layout",callbackName:"setLayoutProperty"}];g.forEach(function(c){var g=c.key,i=c.callbackName,j=f.get(g)||b("immutable").Map(),k=d.get(g)||b("immutable").Map();j!==k&&(j.forEach(function(b,c){return!k.has(c)&&a[i].call(e,c,void 0)}),k.forEach(function(b,c){if(j.get(c)!==b){b=h(b)?b.toJS():b;a[i](e,c,b)}}))})}}));if(!e.isEmpty()&&a.getLayer(i)!=null){var o=a.getStyle().layers,p=o.findIndex(function(a){return a.id===i});k.forEach(function(b){var c=b.get("id");if(e.has(c)){b=o.findIndex(function(a){return a.id===c});b>p&&a.moveLayer(c,i)}})}};d=function(a,b){a.on("dragend",b),a.on("zoomend",b),a.on("pitchend",b),a.on("rotateend",b)};f=function(a,b){b>=0||g(0,11441);var c=(a[0]+a[2])/2,d=(a[1]+a[3])/2,e=a[2]-c;a=a[3]-d;c=[c-e*b,d-a*b,c+e*b,d+a*b];c[0]<-180&&(c[0]=-180);c[1]<-90&&(c[1]=-90);c[2]>180&&(c[2]=180);c[3]>90&&(c[3]=90);return c};e.exports={updateMapStyle:c,onMapViewUpdate:d,getScaledBbox:f,LAST_LABEL_LAYER:i,MAX_DURATION_FOR_ANIMATION:a}}),null);
/**
 * License: https://www.facebook.com/legal/license/V9vdYColc4k/
 */
__d("mapbox-sphericalmercator-1.1.0",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a=function(){var b={},c=Math.PI/180,d=180/Math.PI,e=6378137,f=20037508.342789244;function g(a){return Number(a)===a&&a%1!==0}function a(a){a=a||{};this.size=a.size||256;if(!b[this.size]){a=this.size;var c=b[this.size]={};c.Bc=[];c.Cc=[];c.zc=[];c.Ac=[];for(var d=0;d<30;d++)c.Bc.push(a/360),c.Cc.push(a/(2*Math.PI)),c.zc.push(a/2),c.Ac.push(a),a*=2}this.Bc=b[this.size].Bc;this.Cc=b[this.size].Cc;this.zc=b[this.size].zc;this.Ac=b[this.size].Ac}a.prototype.px=function(a,b){if(g(b)){var d=this.size*Math.pow(2,b),e=d/2,f=d/360,h=d/(2*Math.PI);d=d;var i=Math.min(Math.max(Math.sin(c*a[1]),-.9999),.9999);f=e+a[0]*f;h=e+.5*Math.log((1+i)/(1-i))*-h;f>d&&(f=d);h>d&&(h=d);return[f,h]}else{var e=this.zc[b],i=Math.min(Math.max(Math.sin(c*a[1]),-.9999),.9999);f=Math.round(e+a[0]*this.Bc[b]);h=Math.round(e+.5*Math.log((1+i)/(1-i))*-this.Cc[b]);f>this.Ac[b]&&(f=this.Ac[b]);h>this.Ac[b]&&(h=this.Ac[b]);return[f,h]}};a.prototype.ll=function(a,b){if(g(b)){var c=this.size*Math.pow(2,b),e=c/360,f=c/(2*Math.PI);c=c/2;f=(a[1]-c)/-f;c=(a[0]-c)/e;e=d*(2*Math.atan(Math.exp(f))-.5*Math.PI);return[c,e]}else{f=(a[1]-this.zc[b])/-this.Cc[b];c=(a[0]-this.zc[b])/this.Bc[b];e=d*(2*Math.atan(Math.exp(f))-.5*Math.PI);return[c,e]}};a.prototype.bbox=function(a,b,c,d,e){d&&(b=Math.pow(2,c)-1-b);d=[a*this.size,(+b+1)*this.size];a=[(+a+1)*this.size,b*this.size];b=this.ll(d,c).concat(this.ll(a,c));if(e==="900913")return this.convert(b,"900913");else return b};a.prototype.xyz=function(a,b,c,d){d==="900913"&&(a=this.convert(a,"WGS84"));d=[a[0],a[1]];a=[a[2],a[3]];d=this.px(d,b);a=this.px(a,b);var e=[Math.floor(d[0]/this.size),Math.floor((a[0]-1)/this.size)];a=[Math.floor(a[1]/this.size),Math.floor((d[1]-1)/this.size)];d={minX:Math.min.apply(Math,e)<0?0:Math.min.apply(Math,e),minY:Math.min.apply(Math,a)<0?0:Math.min.apply(Math,a),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,a)};if(c){e={minY:Math.pow(2,b)-1-d.maxY,maxY:Math.pow(2,b)-1-d.minY};d.minY=e.minY;d.maxY=e.maxY}return d};a.prototype.convert=function(a,b){if(b==="900913")return this.forward(a.slice(0,2)).concat(this.forward(a.slice(2,4)));else return this.inverse(a.slice(0,2)).concat(this.inverse(a.slice(2,4)))};a.prototype.forward=function(a){a=[e*a[0]*c,e*Math.log(Math.tan(Math.PI*.25+.5*a[1]*c))];a[0]>f&&(a[0]=f);a[0]<-f&&(a[0]=-f);a[1]>f&&(a[1]=f);a[1]<-f&&(a[1]=-f);return a};a.prototype.inverse=function(a){return[a[0]*d/e,(Math.PI*.5-2*Math.atan(Math.exp(-a[1]/e)))*d]};return a}();typeof h!=="undefined"&&typeof g!=="undefined"&&(h.exports=g=a)}var j=!1,k=function(){j||(j=!0,i());return h.exports};a=function(a){switch(a){case void 0:return k()}};e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/8Vcpwxe5tAL/
 */
__d("mapbox-geo-viewport-0.4.0",["mapbox-sphericalmercator-1.1.0"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("mapbox-sphericalmercator-1.1.0"));c={};var h={exports:c};function i(){var a=g(),b={};h.exports.viewport=e;h.exports.bounds=f;function c(c){c=c||256;b[c]||(b[c]=new a({size:c}));return b[c]}function d(a,b,c){a=Math.min(a-Math.log(b[0])/Math.log(2),a-Math.log(b[1])/Math.log(2));return c?a:Math.floor(a)}function e(a,b,e,f,g,h){e=e===void 0?0:e;f=f===void 0?20:f;g=c(g);var i=f,j=g.px([a[0],a[1]],i);g=g.px([a[2],a[3]],i);var k=g[0]-j[0];j=j[1]-g[1];g=[k/b[0],j/b[1]];k=[(a[0]+a[2])/2,(a[1]+a[3])/2];j=d(i,g,h);b=Math.max(e,Math.min(f,j));return{center:k,zoom:b}}function f(a,b,d,e){a.lon!==void 0&&(a=[a.lon,a.lat]);e=c(e);a=e.px(a,b);var f=e.ll([a[0]-d[0]/2,a[1]-d[1]/2],b);e=e.ll([a[0]+d[0]/2,a[1]+d[1]/2],b);return[f[0],e[1],e[0],f[1]]}}var j=!1,k=function(){j||(j=!0,i());return h.exports};d=function(a){switch(a){case void 0:return k()}};e.exports=d}),null);
__d("mapbox-geo-viewport",["mapbox-geo-viewport-0.4.0"],(function(a,b,c,d,e,f){e.exports=b("mapbox-geo-viewport-0.4.0")()}),null);
__d("FBMapView",["immutable","mapbox-geo-viewport","nearlyEqualNumbers"],(function(a,b,c,d,e,f){"use strict";var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(b("immutable").Record({center:[0,0],zoom:0,bearing:0,pitch:0}));a=function(){function a(a){if(a==null){this.$1=new g();return}var c=a.center||[0,0],d=a.zoom||0;if(a.bounds){var e=b("mapbox-geo-viewport").viewport(a.bounds,[a.width,a.height],void 0,void 0,512,!0);c=e.center;d=e.zoom}c=c!=null&&typeof c==="object"&&!Array.isArray(c)?c.toArray():c;e=a.pitch;a=a.bearing;this.$1=new g({center:c,zoom:d,pitch:e||0,bearing:a||0})}var c=a.prototype;c.getCenter=function(){return this.$1.center};c.setCenter=function(b){return new a(babelHelpers["extends"]({},this.$1.toObject(),{center:b}))};c.getZoom=function(){return this.$1.zoom};c.setZoom=function(b){return new a(babelHelpers["extends"]({},this.$1.toObject(),{zoom:b}))};c.getPitch=function(){return this.$1.pitch};c.setPitch=function(b){return new a(babelHelpers["extends"]({},this.$1.toObject(),{pitch:b}))};c.getBearing=function(){return this.$1.bearing};c.setBearing=function(b){return new a(babelHelpers["extends"]({},this.$1.toObject(),{bearing:b}))};c.toJS=function(){return this.$1.toObject()};c.equals=function(a){return this.equalsCenter(a)&&this.equalsZoom(a)&&this.equalsPitch(a)&&this.equalsBearing(a)};c.equalsCenter=function(a){return b("nearlyEqualNumbers")(this.getCenter()[0],a.getCenter()[0])&&b("nearlyEqualNumbers")(this.getCenter()[1],a.getCenter()[1])};c.equalsZoom=function(a){return b("nearlyEqualNumbers")(this.getZoom(),a.getZoom())};c.equalsPitch=function(a){return b("nearlyEqualNumbers")(this.getPitch(),a.getPitch())};c.equalsBearing=function(a){return b("nearlyEqualNumbers")(this.getBearing(),a.getBearing())};return a}();e.exports=a}),null);
__d("setupPoliticalView",["MapsPoliticalView"],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null||b("MapsPoliticalView").politicalView==="neutral")return;a.on("style.load",function(){a.getStyle().layers.forEach(function(c){c=c.id;c.startsWith("neutral_")?a.setLayoutProperty(c,"visibility","none"):c.startsWith(b("MapsPoliticalView").politicalView+"_")&&a.setLayoutProperty(c,"visibility","visible")})})}e.exports=a}),null);
__d("FBMapCore.react",["invariant","FBMapBaseStyles","FBMapConfigs","FBMapStyle","FBMapStyleUtils","FBMapUtils","FBMapView","React","immutable","mapbox-gl","setupPoliticalView"],(function(a,b,c,d,e,f,g){"use strict";var h=b("FBMapBaseStyles").mapboxBaseStyle,i=b("FBMapStyleUtils").getAccessToken,j=b("FBMapUtils").LAST_LABEL_LAYER,k=b("FBMapUtils").MAX_DURATION_FOR_ANIMATION,l=b("FBMapUtils").updateMapStyle,m=b("React");a=b("immutable").Set;c=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$2=!1,c.$3=null,c.$4=m.createRef(),b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){var a=this,c;b("mapbox-gl").accessToken=(c=this.props.accessToken)!=null?c:h.accessToken;this.$4.current!==null||g(0,1119);var d=this.props.baseStyleURI;c={container:this.$4.current,center:this.props.mapView.getCenter(),zoom:this.props.mapView.getZoom(),bounds:this.props.bounds,pitch:this.props.mapView.getPitch(),bearing:this.props.mapView.getBearing(),minZoom:this.props.minZoom,maxZoom:this.props.maxZoom,attributionControl:!1,transformRequest:this.props.transformRequest,style:d,keyboard:!this.props.disableKeyboard};this.$1=new(b("mapbox-gl").Map)(c);b("setupPoliticalView")(this.$1);this.$1.once("load",function(){a.props.baseStyleURI!==d&&a.$1.setStyle(a.props.baseStyleURI),a.$3=new(b("FBMapStyle"))(a.$1.getStyle()),a.$5(a.props.mapStyle,a.props.layersToMoveBehindLabels),a.props.scaleControlOptions!=="hide"&&a.$1.addControl(new(b("mapbox-gl").ScaleControl)(a.props.scaleControlOptions||void 0)),a.props.attributionControl&&a.$1.addControl(a.props.attributionControl,"bottom-left"),a.$2=!0,a.$1.resize(),a.props.onMapReady(a.$1)})};d.componentWillUnmount=function(){try{this.$1.remove()}catch(a){}};d.componentDidUpdate=function(a){var c=this,d=this.props,e=d.baseStyleURI;d=d.accessToken;d=(d=d)!=null?d:i(e);b("mapbox-gl").accessToken!==d&&(b("mapbox-gl").accessToken=d);if(this.$2){var f=this.props.mapStyle;d=a.baseStyleURI;var g=a.mapStyle;(e!==d||f!==g)&&(e===""?this.$1.setStyle(f.toJS()):e!==d?this.$1.setStyle(e).once("styledata",function(){c.$3=new(b("FBMapStyle"))(c.$1.getStyle()),c.$5(f,c.props.layersToMoveBehindLabels)}):l(this.$1,g,f,this.props.layersToMoveBehindLabels))}this.props.bounds&&JSON.stringify(this.props.bounds)!==JSON.stringify(a.bounds)&&this.$1.fitBounds(this.props.bounds);this.props.minZoom!==a.minZoom&&this.$1.setMinZoom(this.props.minZoom);this.props.maxZoom!==a.maxZoom&&this.$1.setMaxZoom(this.props.maxZoom);d=this.props.mapView;d.equals(a.mapView)||(this.props.disableAnimation?this.$1.jumpTo(d.toJS()):this.$1.flyTo(babelHelpers["extends"]({},d.toJS(),{maxDuration:k})))};d.render=function(){return m.jsx("div",{"data-testid":void 0,ref:this.$4,style:{width:"100%",height:"100%"}})};d.$5=function(a,b){var c=this,d=this.$3;!a.isEmpty()&&d!=null&&this.$1.setStyle(d.merge([a]).toJS());b.isEmpty()||d!=null&&d.hasLayer(j)&&a.getLayers().forEach(function(a){a=a.get("id");b.has(a)&&c.$1.moveLayer(a,j)})};return c}(m.PureComponent);c.defaultProps={onMapReady:function(a){},baseStyleURI:h.options.DEFAULT,mapView:new(b("FBMapView"))(),minZoom:b("FBMapConfigs").MIN_ZOOM,maxZoom:b("FBMapConfigs").MAX_ZOOM,scaleControlOptions:void 0,transformRequest:void 0,disableKeyboard:!1,scheme:"tms",layersToMoveBehindLabels:a([]),disableAnimation:!0};e.exports=c}),null);
__d("FBMap.react",["cx","fbt","invariant","FBMapCore.react","FBMapFunnelLogger","FBMapFunnelLoggerConstants","FBMapInfoButton.react","FBMapStyle","FBMapStyleUtils","FBMapUtils","FBMapZoomMessage.react","FBMapZoomOverlay.react","FBOverlayBase.react","FBOverlayContainer.react","FBOverlayElement.react","FBTilesAttributionLogo.react","React","Style","SUIBusinessTheme","SUINotice.react","areEqual","cxMargin","immutable","mapbox-gl"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=b("FBMapFunnelLoggerConstants").MAP_INTERACTIVE_EVENTS,l=b("FBMapFunnelLoggerConstants").MAP_TILE_SOURCES,m=b("FBMapStyleUtils").isDigitalGlobe,n=b("FBMapStyleUtils").isMapboxStyle,o=b("FBMapUtils").MAX_DURATION_FOR_ANIMATION,p=b("React");b("immutable").Set;var q=b("mapbox-gl").supported(),r="(max-width: 640px)";a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=null,d.$3=d.props.funnelLogger||new(b("FBMapFunnelLogger"))(d.props.surface,"FBMap"),d.state={isMapLoaded:!1,isMinZoom:!1,isMaxZoom:!1,isDigitalGlobe:!1},d.$11=function(){var a=d.$1;if(!window.matchMedia(r).matches){d.$14();return!0}else a!=null&&(a.scrollZoom.enable(),d.$13());return!1},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){this.$2=this.props.style};d.componentWillUnmount=function(){this.props.funnelLogger==null&&this.$3.endFunnel()};d.componentDidUpdate=function(a){var c=this.props,d=c.style,e=c.baseStyleURI,f=c.minZoom;c=c.maxZoom;var g=a.baseStyleURI,h=a.minZoom;a=a.maxZoom;!(j||(j=b("areEqual")))(d,this.$2)&&this.$1!=null&&(this.$2=d,this.$1.resize());e!==g&&n(e)&&this.$3.setMapTileSource(l.MAPBOX);this.setState({isDigitalGlobe:m(e)});this.state.isMinZoom&&f!=null&&h!=null&&f<h&&this.setState({isMinZoom:!1});this.state.isMaxZoom&&c!=null&&a!=null&&c>a&&this.setState({isMaxZoom:!1})};d.render=function(){var a=this;if(!q)return p.jsx(b("SUINotice.react"),{margin:"_3-8j",type:"warning",theme:b("SUIBusinessTheme"),children:h._("Your browser doesn't support mapbox-gl library. To see the map, turn on WebGL in your browser settings and try again.")});var c=this.props,d=c.showZoomControls,e=c.showInfoButton,f=c.zoomPosition,g=c.infoButtonPosition,i=c.onMapReady,j=c.initialMapView,k=c.initialBounds,l=c.style,m=c.children,n=c.surface,o=c.mapStyle;c.funnelLogger;var r=c.enableCommandScroll;c=babelHelpers.objectWithoutPropertiesLoose(c,["showZoomControls","showInfoButton","zoomPosition","infoButtonPosition","onMapReady","initialMapView","initialBounds","style","children","surface","mapStyle","funnelLogger","enableCommandScroll"]);o=o!=null&&this.props.layersToMoveBehindLabels!=null?o.moveLayersToLowestZPosition(this.props.layersToMoveBehindLabels):o||new(b("FBMapStyle"))();return p.jsxs(b("FBOverlayContainer.react"),{style:babelHelpers["extends"]({overflow:"hidden"},l),children:[p.jsx(b("FBOverlayBase.react"),{children:p.jsx(b("FBMapCore.react"),babelHelpers["extends"]({},c,{mapStyle:o,onMapReady:function(b){return a.$4(b,i)}}))}),r===!0?this.$5():null,d?this.$6(f,j,k):null,e?this.$7(g,n):null,this.state.isDigitalGlobe?this.$8():null,m!=null?p.Children.map(m,function(a){return a!=null&&a.type===b("FBOverlayElement.react")?a:void 0}):null]})};d.$8=function(){return!this.state.isMapLoaded?null:p.jsx(b("FBOverlayElement.react"),{vertical:"bottom",horizontal:"center",children:p.jsx(b("FBTilesAttributionLogo.react"),{mapProvider:"DG"})})};d.$7=function(a,c){var d=this;return!this.state.isMapLoaded?null:p.jsx(b("FBOverlayElement.react"),babelHelpers["extends"]({},a,{children:p.jsx(b("FBMapInfoButton.react"),{popoverPosition:a,fetchMapInfo:function(){return{mapUrl:null,mapBounds:d.$1&&d.$1.getBounds(),zoom:d.$1&&d.$1.getZoom()}},surface:c})}))};d.$6=function(a,c,d){var e=this;if(!this.state.isMapLoaded)return null;var f=this.$1;f!=null||i(0,4853);return p.jsx(b("FBOverlayElement.react"),babelHelpers["extends"]({},a,{children:p.jsx(b("FBMapZoomOverlay.react"),{className:"_6vul",onZoomIn:this.state.isMaxZoom?null:function(){e.$9(f,f.getZoom()+1)},onZoomOut:this.state.isMinZoom?null:function(){e.$9(f,f.getZoom()-1)},onRecenter:c!=null||d!=null?function(){return e.$10(f,c,d)}:null})}))};d.$5=function(){var a=this.$11();return!this.state.isMapLoaded||!a?null:p.jsx(b("FBOverlayElement.react"),{vertical:"bottom",horizontal:"center",children:p.jsx(b("FBMapZoomMessage.react"),{})})};d.$12=function(){var a=document.getElementsByClassName("_928y")[0];b("Style").set(a,"transform","scale(1)");b("Style").set(a,"opacity","1");window.setTimeout(this.$13,3e3)};d.$13=function(){var a=document.getElementsByClassName("_928y")[0];b("Style").set(a,"opacity","0");b("Style").set(a,"transform","scale(0)")};d.$14=function(){var a=this,b=this.$1;if(b===null)return;else if(b!=null){var c=function(a){(a.metaKey===!0||a.ctrlKey===!0)&&b.scrollZoom.enable()},d=function(){b.scrollZoom.disable()};b.scrollZoom.disable();document.addEventListener("keydown",this.$13);document.addEventListener("keydown",c);document.addEventListener("keyup",d);b.on("wheel",function(){return b.scrollZoom.isEnabled()?null:a.$12()})}};d.$9=function(a,b){a.flyTo({zoom:b,maxDuration:o}),this.$3.sendInteractiveEvent(k.ZOOM_MAP)};d.$10=function(a,b,c){c!=null?a.fitBounds(c):b!=null&&a.flyTo(babelHelpers["extends"]({},b.toJS(),{maxDuration:o})),this.$3.sendInteractiveEvent(k.MOVE_MAP)};d.$4=function(a,b){var c=this;b&&b(a);if(this.$1==null){this.$1=a;b=this.$15(a);var d=b.isMinZoom;b=b.isMaxZoom;this.setState({isMapLoaded:!0,isMinZoom:d,isMaxZoom:b})}a.on("zoomend",function(){var d=c.$15(a),b=d.isMinZoom;d=d.isMaxZoom;(b!==c.state.isMinZoom||d!==c.state.isMaxZoom)&&c.setState({isMinZoom:b,isMaxZoom:d})});(this.props.baseStyleURI==null||n(this.props.baseStyleURI))&&this.$3.setMapTileSource(l.MAPBOX);this.$3.onMapReady();this.props.enableCommandScroll===!0&&(this.$11(),window.addEventListener("resize",this.$11));a.on("boxzoomend",function(){return c.$3.sendInteractiveEvent(k.ZOOM_MAP)});a.on("wheel",function(){return c.$3.sendInteractiveEvent(k.ZOOM_MAP)});a.on("dragend",function(){return c.$3.sendInteractiveEvent(k.MOVE_MAP)});a.on("rotateend",function(){return c.$3.sendInteractiveEvent(k.MOVE_MAP)});a.on("pitchend",function(){return c.$3.sendInteractiveEvent(k.MOVE_MAP)});a.on("click",function(){return c.$3.sendInteractiveEvent(k.GESTURE_SINGLE_TAP)})};d.$15=function(a){var b,c,d=a.getZoom();b=(b=this.props.minZoom)!=null?b:a.getMinZoom();c=(c=this.props.maxZoom)!=null?c:a.getMaxZoom();a=d===b||b===0&&d<.643857;b=d===c;return{isMinZoom:a,isMaxZoom:b}};return c}(p.PureComponent);a.defaultProps={showInfoButton:!0,showZoomControls:!0,zoomPosition:{vertical:"top",horizontal:"left"},infoButtonPosition:{vertical:"bottom",horizontal:"right"},disableAnimation:!1,enableCommandScroll:!1};e.exports=a}),null);
__d("FBMapMarker",["React","ReactDOM","mapbox-gl"],(function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(){function a(a){this.$2=null;a=babelHelpers["extends"]({},a);var c=a.element,d=null;c!=null&&(d=document.createElement("div"),c instanceof HTMLElement?d.appendChild(c):g.isValidElement(c)&&b("ReactDOM").render(c,d));a.element;c=babelHelpers.objectWithoutPropertiesLoose(a,["element"]);a=babelHelpers["extends"]({},c,{element:d});this.$1=new(b("mapbox-gl").Marker)(a)}var c=a.prototype;c.getLngLat=function(){return this.$1.getLngLat()};c.setLngLat=function(a){this.$1.setLngLat(a);return this};c.addTo=function(a){this.$1.addTo(a);return this};c.remove=function(){this.$1.remove();return this};c.setPopup=function(a){var b=a.getMapboxInstance();this.$1.setPopup(b);this.$2=a;return this};c.getPopup=function(){return this.$2};c.togglePopup=function(){this.$1.togglePopup();return this};c.getOffset=function(){return this.$1.getOffset()};c.setOffset=function(a){this.$1.setOffset(a);return this};c.setDraggable=function(a){this.$1.setDraggable(a);return this};c.isDraggable=function(){return this.$1.isDraggable()};c.setContent=function(a){var c=this.getElement();a!=null?b("ReactDOM").render(a,c):b("ReactDOM").unmountComponentAtNode(c);return this};c.getElement=function(){return this.$1.getElement()};c.on=function(a,b){this.$1.on(a,b)};c.off=function(a,b){this.$1.off(a,b)};c.once=function(a,b){this.$1.once(a,b)};c.fire=function(a,b){this.$1.fire(a,b)};c.listens=function(a){this.$1.listens(a)};return a}();e.exports=a}),null);