if (self.CavalryLogger) { CavalryLogger.start_js(["etuzR"]); }

__d("Asset3DBackgroundMap",[],(function(a,b,c,d,e,f){e.exports={one:{story:{normal:"3d-bkgrd-1.jpg",hd:"3d-bkgrd-1-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-1.jpg",hd:"3d-bkgrd-btn-1-2x.jpg"}},two:{story:{normal:"3d-bkgrd-2.jpg",hd:"3d-bkgrd-2-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-2.jpg",hd:"3d-bkgrd-btn-2-2x.jpg"}},three:{story:{normal:"3d-bkgrd-3.jpg",hd:"3d-bkgrd-3-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-3.jpg",hd:"3d-bkgrd-btn-3-2x.jpg"}},four:{story:{normal:"3d-bkgrd-4.jpg",hd:"3d-bkgrd-4-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-4.jpg",hd:"3d-bkgrd-btn-4-2x.jpg"}},five:{story:{normal:"3d-bkgrd-5.jpg",hd:"3d-bkgrd-5-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-5.jpg",hd:"3d-bkgrd-btn-5-2x.jpg"}},six:{story:{normal:"3d-bkgrd-6.jpg",hd:"3d-bkgrd-6-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-6.jpg",hd:"3d-bkgrd-btn-6-2x.jpg"}},seven:{story:{normal:"3d-bkgrd-7.jpg",hd:"3d-bkgrd-7-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-7.jpg",hd:"3d-bkgrd-btn-7-2x.jpg"}},eight:{story:{normal:"3d-bkgrd-8.jpg",hd:"3d-bkgrd-8-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-8.jpg",hd:"3d-bkgrd-btn-8-2x.jpg"}},nine:{story:{normal:"3d-bkgrd-9.jpg",hd:"3d-bkgrd-9-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-9.jpg",hd:"3d-bkgrd-btn-9-2x.jpg"}},ten:{story:{normal:"3d-bkgrd-10.jpg",hd:"3d-bkgrd-10-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-10.jpg",hd:"3d-bkgrd-btn-10-2x.jpg"}},eleven:{story:{normal:"3d-bkgrd-11.jpg",hd:"3d-bkgrd-11-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-11.jpg",hd:"3d-bkgrd-btn-11-2x.jpg"}},twelve:{story:{normal:"3d-bkgrd-12.jpg",hd:"3d-bkgrd-12-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-12.jpg",hd:"3d-bkgrd-btn-12-2x.jpg"}},thirteen:{story:{normal:"3d-bkgrd-13.jpg",hd:"3d-bkgrd-13-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-13.jpg",hd:"3d-bkgrd-btn-13-2x.jpg"}},fourteen:{story:{normal:"3d-bkgrd-14.jpg",hd:"3d-bkgrd-14-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-14.jpg",hd:"3d-bkgrd-btn-14-2x.jpg"}},fifteen:{story:{normal:"3d-bkgrd-15.jpg",hd:"3d-bkgrd-15-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-15.jpg",hd:"3d-bkgrd-btn-15-2x.jpg"}},sixteen:{story:{normal:"3d-bkgrd-16.jpg",hd:"3d-bkgrd-16-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-16.jpg",hd:"3d-bkgrd-btn-16-2x.jpg"}},seventeen:{story:{normal:"3d-bkgrd-17.jpg",hd:"3d-bkgrd-17-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-17.jpg",hd:"3d-bkgrd-btn-17-2x.jpg"}},eighteen:{story:{normal:"3d-bkgrd-18.jpg",hd:"3d-bkgrd-18-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-18.jpg",hd:"3d-bkgrd-btn-18-2x.jpg"}},twenty:{story:{normal:"3d-bkgrd-20.jpg",hd:"3d-bkgrd-20-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-20.jpg",hd:"3d-bkgrd-btn-20-2x.jpg"}},twentyone:{story:{normal:"3d-bkgrd-21.jpg",hd:"3d-bkgrd-21-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-21.jpg",hd:"3d-bkgrd-btn-21-2x.jpg"}},twentytwo:{story:{normal:"3d-bkgrd-22.jpg",hd:"3d-bkgrd-22-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-22.jpg",hd:"3d-bkgrd-btn-22-2x.jpg"}},twentythree:{story:{normal:"3d-bkgrd-23.jpg",hd:"3d-bkgrd-23-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-23.jpg",hd:"3d-bkgrd-btn-23-2x.jpg"}},twentyfour:{story:{normal:"3d-bkgrd-24.jpg",hd:"3d-bkgrd-24-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-24.jpg",hd:"3d-bkgrd-btn-24-2x.jpg"}},twentyfive:{story:{normal:"3d-bkgrd-25.jpg",hd:"3d-bkgrd-25-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-25.jpg",hd:"3d-bkgrd-btn-25-2x.jpg"}},twentysix:{story:{normal:"3d-bkgrd-26.jpg",hd:"3d-bkgrd-26-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-26.jpg",hd:"3d-bkgrd-btn-26-2x.jpg"}},twentyseven:{story:{normal:"3d-bkgrd-27.jpg",hd:"3d-bkgrd-27-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-27.jpg",hd:"3d-bkgrd-btn-27-2x.jpg"}},twentyeight:{story:{normal:"3d-bkgrd-28.jpg",hd:"3d-bkgrd-28-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-28.jpg",hd:"3d-bkgrd-btn-28-2x.jpg"}},twentynine:{story:{normal:"3d-bkgrd-29.jpg",hd:"3d-bkgrd-29-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-29.jpg",hd:"3d-bkgrd-btn-29-2x.jpg"}},thirty:{story:{normal:"3d-bkgrd-30.jpg",hd:"3d-bkgrd-30-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-30.jpg",hd:"3d-bkgrd-btn-30-2x.jpg"}},thirtyone:{story:{normal:"3d-bkgrd-31.jpg",hd:"3d-bkgrd-31-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-31.jpg",hd:"3d-bkgrd-btn-31-2x.jpg"}},thirtytwo:{story:{normal:"3d-bkgrd-32.jpg",hd:"3d-bkgrd-32-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-32.jpg",hd:"3d-bkgrd-btn-32-2x.jpg"}},thirtythree:{story:{normal:"3d-bkgrd-33.jpg",hd:"3d-bkgrd-33-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-33.jpg",hd:"3d-bkgrd-btn-33-2x.jpg"}},thirtyfour:{story:{normal:"3d-bkgrd-34.jpg",hd:"3d-bkgrd-34-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-34.jpg",hd:"3d-bkgrd-btn-34-2x.jpg"}},thirtyfive:{story:{normal:"3d-bkgrd-35.jpg",hd:"3d-bkgrd-35-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-35.jpg",hd:"3d-bkgrd-btn-35-2x.jpg"}},thirtysix:{story:{normal:"3d-bkgrd-36.jpg",hd:"3d-bkgrd-36-2x.jpg"},thumbnail:{normal:"3d-bkgrd-btn-36.jpg",hd:"3d-bkgrd-btn-36-2x.jpg"}},"default":{story:{normal:null,hd:null},thumbnail:{normal:null,hd:null}},medium:{story:{normal:"3d-bkgrd-medium.jpg",hd:"3d-bkgrd-medium-2x.jpg"},thumbnail:{normal:null,hd:null}},spaces:{story:{normal:"3d-bkgrd-spaces.jpg",hd:"3d-bkgrd-spaces-2x.jpg"},thumbnail:{normal:null,hd:null}},creator:{story:{normal:"3d-bkgrd-creator.jpg",hd:"3d-bkgrd-creator-2x.jpg"},thumbnail:{normal:null,hd:null}}}}),null);
__d("Asset3DConstants",[],(function(a,b,c,d,e,f){e.exports={ROTATION_FACTOR:.08,MAX_ZOOM:.25,CAMERA_RADIUS:1,GYRO_SPEED:.06,MODAL:{H_TARGET_FACTOR:{H_PHOTO:-.24,V_PHOTO:-.124},V_TARGET_FACTOR:{H_PHOTO:-.24,V_PHOTO:-.212},H_TARGET_DISTRIBUTE_FACTOR:{H_PHOTO:.7,V_PHOTO:.8},V_TARGET_DISTRIBUTE_FACTOR:{H_PHOTO:.6,V_PHOTO:.86},FOV_FACTOR:.92},POST:{FOV_FACTOR:.925}}}),null);
__d("SocialVRThreeJS",["ThreeJS.r93"],(function(a,b,c,d,e,f){e.exports=b("ThreeJS.r93")}),null);
__d("AnimatedCameraMotion",["Asset3DConstants","React","SocialVRThreeJS","Tween","WitHelpers"],(function(a,b,c,d,e,f){var g=b("Asset3DConstants").GYRO_SPEED,h=b("React");b("SocialVRThreeJS").Camera;var i=b("SocialVRThreeJS").Vector3,j=b("WitHelpers").debounce;e.exports={withAnimatedCameraMotion:function(a){return function(c){"use strict";babelHelpers.inheritsLoose(d,c);function d(){var a,d;for(var e=arguments.length,f=new Array(e),h=0;h<e;h++)f[h]=arguments[h];return(a=d=c.call.apply(c,[this].concat(f))||this,d.state={cameraPos:void 0,lookAtPos:void 0,isAnimating:!1},d.$1=j(function(a,c,e,f){d.__tween&&d.__tween.stop(),d.__tween=new(b("Tween"))(),d.__tween.start(function(b){d.setState({cameraPos:a.map(function(a,d){return a*(1-b)+b*c[d]}),lookAtPos:e.map(function(a,c){return a*(1-b)+b*f[c]}),isAnimating:!0})},16/g-16)},16),a)||babelHelpers.assertThisInitialized(d)}var e=d.prototype;e.UNSAFE_componentWillReceiveProps=function(a){var b=a.toCameraPos,c=a.toLookAtPos;a=a.camera;var d=this.state,e=d.cameraPos;e=e===void 0?a.position.toArray():e;d=d.lookAtPos;a=d===void 0?a.lookAtPosition.toArray():d;if(e&&a&&b&&c){d=e.map(function(a,c){return a+g*(b[c]-a)});var f=a.map(function(a,b){return a+g*(c[b]-a)});this.setState({cameraPos:d,lookAtPos:f,isAnimating:!1})}else this.setState({cameraPos:e,lookAtPos:a,isAnimating:!1})};e.componentWillUnmount=function(){this.__tween&&(this.__tween.stop(),this.__tween=null)};e.render=function(){var b=this.state,c=b.cameraPos,d=b.lookAtPos;b=b.isAnimating;var e=this.props,f=e.camera,g=e.toCameraPos,j=e.toLookAtPos;e=babelHelpers.objectWithoutPropertiesLoose(e,["camera","toCameraPos","toLookAtPos"]);c&&d&&(!b&&g&&j&&(this.__tween&&this.__tween.stop(),this.$1(c,g,d,j)),f.position.set(c[0],c[1],c[2]),f.lookAt(new i(d[0],d[1],d[2])));return h.jsx(a,babelHelpers["extends"]({camera:f},e))};return d}(h.Component)}}}),null);
__d("R3Scene",["React","SocialVRThreeJS"],(function(a,b,c,d,e,f){var g=b("React"),h=b("SocialVRThreeJS").Scene;e.exports=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;b.$1=new h();return b}var c=b.prototype;c.componentDidUpdate=function(){this.__update()};c.componentDidMount=function(){this.__update()};c.__update=function(){var a=this.props.rendererDelegate;a&&this.$2&&a.requestUpdate(this.$1,this.$2)};c.$3=function(a){this.$2=a};c.render=function(){var a=this,b=this.props.children;this.props.children!=null&&(b=g.Children.map(b,function(b){return g.cloneElement(b,{rendererDelegate:Object.assign({},a.props.rendererDelegate,{requestUpdate:function(){return a.__update()}}),sceneDelegate:{getParentNode:function(){return a.$1},setCamera:function(b){return a.$3(b)}}})}));return g.jsx("div",{name:"scene",ref:"sceneElement",children:b})};return b}(g.Component)}),null);
__d("React3",["R3Scene","React","partitionArray"],(function(a,b,c,d,e,f){var g=b("React"),h=function(c){"use strict";babelHelpers.inheritsLoose(a,c);function a(a){a=c.call(this,a)||this;a.$1=new Map();return a}var d=a.prototype;d.componentDidMount=function(){var a=this.props,b=a.rendererDelegate,c=a.sceneDelegate;a=a.effects;var d=this.__component;if(d!=null&&c!=null&&b!=null){c=c.getParentNode();d=d.element();this.__sceneElement=d;this.__mount(c,d);this.$2(d,a);b.requestUpdate()}};d.componentDidUpdate=function(){this.$3(this.__sceneElement,this.props.effects)};d.componentWillUnmount=function(){var a=this.props,b=a.rendererDelegate;a=a.sceneDelegate;var c=this.__sceneElement;if(a!=null&&b!=null){a=a.getParentNode();this.__unmount(a,c);Array.from(this.$1).forEach(function(a){a[0];a=a[1];return a.onRemove(c,b)});b.requestUpdate()}};d.__mount=function(a,b){a.add(b)};d.__unmount=function(a,b){a.remove(b)};d.__getRendererDelegate=function(){var a=this.props,b=a.rendererDelegate,c=a.onUpdate,d=this.__sceneElement;return c&&b?Object.assign({},b,{requestUpdate:function(){c(d),b.requestUpdate()}}):b};d.__delegateChildren=function(a){var b=this;return g.Children.map(a,function(a){return g.cloneElement(a,{sceneDelegate:Object.assign({},b.props.sceneDelegate,{getParentNode:function(){return b.__sceneElement}}),rendererDelegate:b.__getRendererDelegate()})})};d.$2=function(a,b){b===void 0&&(b=[]);b=b||[];var c=this.__getRendererDelegate();c&&(b.forEach(function(b){return b.onApply(a,c)}),this.$1=new Map(b.map(function(a){return[a.getKey(),a]})))};d.$3=function(a,c){var d=this;c===void 0&&(c=[]);var e=new Map(c.map(function(a){return[a.getKey(),a]}));c=b("partitionArray")(c,function(a){return d.$1.has(a.getKey())});c[0];c=c[1];var f=b("partitionArray")(Array.from(this.$1),function(a){var b=a[0];a[1];return e.has(b)}),g=f[0];f=f[1];f=f.map(function(a){return a[1]});g=g.map(function(a){return a[1]});var h=this.__getRendererDelegate();h&&(c.forEach(function(b){return b.onApply(a,h)}),g.forEach(function(b){var c=e.get(b.getKey())||b;b.onUpdate(a,h,c)}),f.forEach(function(b){return b.onRemove(a,h)}));c.forEach(function(a){return d.$1.set(a.getKey(),a)});f.forEach(function(a){return d.$1["delete"](a.getKey())})};return a}(g.Component);function a(a){return function(b){"use strict";babelHelpers.inheritsLoose(c,b);function c(){return b.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var b=this;return g.jsx(a,babelHelpers["extends"]({ref:function(a){return b.__component=a}},this.props,{children:this.__delegateChildren(this.props.children)}))};return c}(h)}function c(a){return function(b){"use strict";babelHelpers.inheritsLoose(c,b);function c(){return b.apply(this,arguments)||this}var d=c.prototype;d.componentDidMount=function(){b.prototype.componentDidMount.call(this);var a=this.props.sceneDelegate;a&&a.setCamera(this.__sceneElement)};d.componentWillUnmount=function(){b.prototype.componentWillUnmount.call(this);var a=this.props.sceneDelegate;a&&a.setCamera(null)};d.__mount=function(a,b){a.add(b.model())};d.__unmount=function(a,b){a.remove(b.model())};d.render=function(){var b=this;return g.jsx(a,babelHelpers["extends"]({ref:function(a){return b.__component=a}},this.props,{children:this.__delegateChildren(this.props.children)}))};return c}(h)}function d(a){return function(b){"use strict";babelHelpers.inheritsLoose(c,b);function c(){return b.apply(this,arguments)||this}var d=c.prototype;d.screenshot=function(){if(this.$1)return this.$1.screenshot();else return null};d.getElement=function(){if(this.$1)return this.$1.getElement();else return null};d.render=function(){var b=this,c=g.Children.map(this.props.children,function(a){return g.cloneElement(a,{rendererDelegate:{requestUpdate:function(a,c){return b.$1&&b.$1.update(a,c)},getRenderElement:function(){return b.$1&&b.$1.getElement()},getRenderDimension:function(){return b.$1&&b.$1.getDimension()}}})}),d=this.props,e=d.width;d=d.height;return g.jsxs("div",{name:"renderer container",style:{width:e+"px",height:d+"px"},children:[g.jsx(a,babelHelpers["extends"]({ref:function(a){return b.$1=a}},this.props)),c]})};return c}(g.Component)}f=function(){"use strict";function a(a){this.props=a}var b=a.prototype;b.getKey=function(){return this.props.key};b.getProps=function(){return this.props};b.onApply=function(a,b){};b.onUpdate=function(a,b,c){};b.onRemove=function(a,b){};return a}();e.exports={makeRenderable:a,makeCamera:c,makeRenderer:d,R3Effect:f,Scene:b("R3Scene")}}),null);
__d("GltfRenderable.react",["React","React3"],(function(a,b,c,d,e,f){var g=b("React");a=b("React3").makeRenderable;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.element=function(){var a=this.props.model;return a};c.render=function(){return g.jsx("div",{name:"GLTFModel",children:this.props.children})};return b}(g.Component);e.exports=a(c)}),null);
__d("PerspectiveCamera.react",["React","React3","SocialVRThreeJS"],(function(a,b,c,d,e,f){var g=b("React");a=b("React3").makeCamera;var h=b("SocialVRThreeJS").Object3D,i=b("SocialVRThreeJS").PerspectiveCamera;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.componentDidMount=function(){var a=this.props,b=a.aspectRatio,c=a.fov;c=c===void 0?45:c;var d=a.near;d=d===void 0?.01:d;var e=a.far;e=e===void 0?1e3:e;var f=a.position;a=a.lookAt;this.$1=new i(c,b,d,e);this.$2=new h();this.$2.add(this.$1);if(f!=null){(c=this.$2.position).set.apply(c,f)}if(a!=null){this.$3=new h();(b=this.$3.position).set.apply(b,a);this.$1.lookAt(0,0,1);this.$2.lookAt(this.$3.position)}};c.componentDidUpdate=function(){var a=this.props,b=a.position;a=a.lookAt;if(b!=null){var c;(c=this.$2.position).set.apply(c,b)}if(a!=null){(c=this.$3.position).set.apply(c,a);this.$1.lookAt(0,0,1);this.$2.lookAt(this.$3.position)}};c.element=function(){return this.$4(this.$1)};c.model=function(){return this.$2};c.render=function(){return g.jsx("div",{name:"Perspective Camera",children:this.props.children})};c.$4=function(a){var b=this;return Object.assign(a,{model:function(){return b.$2},target:function(){return b.$3}})};return b}(g.Component);e.exports=a(c)}),null);
__d("Asset3DScene.react",["GltfRenderable.react","PerspectiveCamera.react","React","React3","SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h=b("React3").Scene,i=b("SocialVRThreeJS").Box3,j=b("SocialVRThreeJS").Vector3,k=1.5,l=Math.PI/8;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.screenshot=function(){return this.refs.renderer.screenshot()};d.render=function(){var a=this.props,c=a.model,d=a.onCameraUpdate,e=a.cameraEffects,f=a.modelEffects,k=a.cameraPosition;a=a.cameraTarget;var l=new i().setFromObject(c),m=l.min,n=l.max;k=k&&a?{position:k,target:a}:this.$1(m,n);a=k.position;m=k.target;n=l.getSize(new j());k=n.x;l=n.y;n=n.z;k=Math.sqrt(k/2*(k/2)+l/2*(l/2)+n/2*(n/2));l=Math.sqrt((a[0]-m[0])*(a[0]-m[0])+(a[1]-m[1])*(a[1]-m[1])+(a[2]-m[2])*(a[2]-m[2]));return g.jsxs(h,babelHelpers["extends"]({},this.props,{children:[g.jsx(b("PerspectiveCamera.react"),{position:a,lookAt:m,near:l-k,far:l+k,effects:e||[],onUpdate:d}),g.jsx(b("GltfRenderable.react"),{model:c,effects:f})]}))};d.$1=function(a,b){var c=b.x,d=b.y;b=b.z;var e=a.x,f=a.y;a=a.z;var g={x:(c+e)*.5,y:(d+f)*.5,z:(b+a)*.5};c=Math.sqrt((c-e)*(c-e)+(d-f)*(d-f)+(b-a)*(b-a));return{position:[g.x,g.y+c*k*Math.sin(l),g.z+c*k*Math.cos(l)],target:[g.x,g.y,g.z]}};return c}(g.Component);e.exports=a}),null);
__d("XAsset3DUpdateFallbackImageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/3d/update/",{id:{type:"FBID",required:!0}})}),null);
__d("dataUriToBlob",[],(function(a,b,c,d,e,f){function a(a){var b=a.split(",")[0].indexOf("base64")>=0,c=a.split(",")[0].split(":")[1].split(";")[0];a=b?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]);if(b){b=new Uint8Array(a.length);for(var d=0;d<a.length;d++)b[d]=a.charCodeAt(d);d=[b]}else d=[a];return new Blob(d,{type:c})}e.exports=a}),null);
__d("isHDScreen",[],(function(a,b,c,d,e,f){"use strict";function a(){if(window.devicePixelRatio>1.5)return!0;var a="(-webkit-min-device-pixel-ratio: 1.5),(min--moz-device-pixel-ratio: 1.5),(-o-min-device-pixel-ratio: 3/2),(min-resolution: 1.5dppx)";return window.matchMedia&&window.matchMedia(a).matches?!0:!1}e.exports=a}),null);
__d("Asset3DUtils",["ActorURI","Asset3DBackgroundMap","AsyncRequest","XAsset3DUpdateFallbackImageController","dataUriToBlob","isHDScreen"],(function(a,b,c,d,e,f){"use strict";var g="/images/asset3d/backgrounds/",h="/images/asset3d/backgrounds/thumbnails/";a={fileEquals:function(a,b){return!!a&&!!b&&a.name===b.name&&a.size===b.size&&a.lastModified===b.lastModified},getBackgroundStyles:function(a,c){if(!a)return null;a=b("Asset3DBackgroundMap")[a];a&&(b("isHDScreen")()?a=a[c].hd:a=a[c].normal);if(a)switch(c){case"story":a=g+a;return{backgroundImage:"url("+a+")",backgroundSize:"cover"};case"thumbnail":a=h+a;return{backgroundImage:"url("+a+")",backgroundSize:"100%"}}return null},takeScreenshot:function(a){return b("dataUriToBlob")(a.toDataURL("image/png"))},saveScreenshot:function(a,c,d,e){c=b("ActorURI").create(b("XAsset3DUpdateFallbackImageController").getURIBuilder().setFBID("id",String(c)).getURI(),d);d=new FormData();d.append("fallback_image",a);e&&d.append("fallback_depth_image",e);new(b("AsyncRequest"))().setURI(c).setMethod("POST").setRawData(d).setErrorHandler(function(a){a&&a.errorDescription}).send()},getPanSpeed:function(a,b){var c=b.x,d=b.y;b=b.z;var e=a.x,f=a.y;a=a.z;c=Math.sqrt((c-e)*(c-e)+(d-f)*(d-f)+(b-a)*(b-a));return c},getCameraOrientation:function(a){var b=a.target();b=b.position;a=a.model();a=a.position;a=a.clone().sub(b).normalize();b=a.x;var c=a.y;a=a.z;c=Math.asin(c);var d=Math.atan(b/a);if(b*a>0)if(b>0)return{yaw:d,pitch:c};else return{yaw:d+Math.PI,pitch:c};else if(b>0)return{yaw:d+Math.PI,pitch:c};else return{yaw:d,pitch:c}},polarCoordToCartesianCoord:function(a,b){var c=Math.cos(b)*Math.sin(a),d=Math.sin(b);b=Math.cos(b)*Math.cos(a);return{x:c,y:d,z:b}}};e.exports=a}),null);
__d("SceneRenderer",["FBLogger","SocialVRThreeJS"],(function(a,b,c,d,e,f){b("SocialVRThreeJS").Camera;b("SocialVRThreeJS").Scene;var g=b("SocialVRThreeJS").WebGLRenderer;a=function(){"use strict";function a(){try{var a=new g({antialias:!0,alpha:!0});this.$1=!0;a.gammaOutput=!0;a.setPixelRatio(window.devicePixelRatio);this.__renderer=a}catch(a){this.$1=!1,b("FBLogger")("Asset3DSceneRenderer").info("failed to create a webgl context (will fallback to 2D version)",a)}this.__width=0;this.__height=0}var c=a.prototype;c.isValid=function(){return this.$1};c.render=function(a,b,c,d){var e=d.height;d=d.width;d=Math.round(d);e=Math.round(e);var f=this.__renderer;if(f){this.__isSizeValid(d,e)||this.__resize(d,e);f.render(b,c);b=f.getDrawingBufferSize();c=b.width;b=b.height;a.clearRect(0,0,d,e);a.drawImage(f.domElement,0,0,c,b,0,0,d,e)}return this};c.getEl=function(){return this.__renderer&&this.__renderer.domElement};c.getRenderInfo=function(){var a;return(a=this.__renderer)==null?void 0:(a=a.info)==null?void 0:a.render};c.dispose=function(){this.__renderer&&(this.__renderer.dispose(),this.__renderer=null);return this};c.__resize=function(a,b){this.__renderer&&(this.__renderer.setSize(a,b),this.__width=a,this.__height=b);return this};c.__isSizeValid=function(a,b){return this.__width===a&&this.__height===b};return a}();e.exports=a}),null);
__d("FixedSizedSceneRenderer",["SceneRenderer"],(function(a,b,c,d,e,f){var g=null;a=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}b.getInstance=function(){g==null&&(g=new b());return g};var c=b.prototype;c.__resize=function(b,c){var a=this.__renderer;a&&(this.__width=Math.max(b,this.__width),this.__height=Math.max(c,this.__height),a.setSize(this.__width,this.__height));return this};c.__isSizeValid=function(a,b){return this.__width>=a&&this.__height>=b};return b}(b("SceneRenderer"));e.exports=a}),null);
__d("CanvasRenderer.react",["FixedSizedSceneRenderer","React","React3"],(function(a,b,c,d,e,f){var g=b("React"),h=new(b("FixedSizedSceneRenderer"))();a=b("React3").makeRenderer;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.componentDidMount=function(){var a=this.refs.canvas;this.$1=a.getContext("2d");a.addEventListener("contextmenu",function(a){a.preventDefault();return!1})};c.getElement=function(){return this.refs.canvas};c.getDimension=function(){var a=this.props,b=a.width;a=a.height;return{width:b,height:a}};c.update=function(a,b){var c=this.props,d=c.width;d=d===void 0?100:d;var e=c.height;e=e===void 0?100:e;c=c.onRender;h.render(this.$1,a,b,{width:d,height:e,pixelRatio:window.devicePixelRatio});c&&c(h.getRenderInfo())};c.screenshot=function(){return this.refs.canvas.toDataURL("image/png")};c.render=function(){var a=this.props,b=a.width;b=b===void 0?100:b;a=a.height;a=a===void 0?100:a;return g.jsx("canvas",{ref:"canvas",width:b,height:a,style:{width:b+"px",height:a+"px"}})};return b}(g.Component);e.exports=a(c)}),null);
__d("R3AmbientLight",["React3","SocialVRThreeJS"],(function(a,b,c,d,e,f){a=b("React3").R3Effect;var g=b("SocialVRThreeJS").AmbientLight;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b||{key:"R3AmbientLight",color:16777215,intensity:.5})||this}var c=b.prototype;c.onApply=function(a,b){var c=this.props,d=c.color;c=c.intensity;d=new g(d,c);a.add(d);b&&b.requestUpdate();this.$R3AmbientLight1=d};c.onRemove=function(a,b){a&&this.$R3AmbientLight1&&a.remove(this.$R3AmbientLight1)};return b}(a);e.exports=c}),null);
__d("R3DirectionalLight",["React3","SocialVRThreeJS"],(function(a,b,c,d,e,f){a=b("React3").R3Effect;var g=b("SocialVRThreeJS").DirectionalLight;c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b||{key:"R3DirectionalLight",position:[0,1,0],color:16777215,intensity:.5})||this}var c=b.prototype;c.onApply=function(a,b){var c=this.props,d=c.position,e=c.color;c=c.intensity;e=new g(e,c);(c=e.position).set.apply(c,d);e.target=a;a.add(e);b&&b.requestUpdate();this.$R3DirectionalLight1=e};c.onRemove=function(a,b){this.$R3DirectionalLight1&&a.remove(this.$R3DirectionalLight1)};return b}(a);e.exports=c}),null);
__d("R3OrbitalAnimation",["Asset3DUtils","React3"],(function(a,b,c,d,e,f){a=b("React3").R3Effect;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b||{key:"R3OrbitalAnimation",speed:.001,duration:1e3})||this;b.$R3OrbitalAnimation1=!1;return b}var d=c.prototype;d.onApply=function(a,b){var c=this;this.$R3OrbitalAnimation1=!0;window.requestAnimationFrame(function(){return c.$R3OrbitalAnimation2(a,b)})};d.onRemove=function(a,b){this.$R3OrbitalAnimation1=!1};d.$R3OrbitalAnimation2=function(a,c){var d=this;if(this.$R3OrbitalAnimation1){var e=this.props.speed;e=e===void 0?.001:e;var f=a.model().position,g=a.target().position,h=b("Asset3DUtils").getCameraOrientation(a),i=h.yaw;h=h.pitch;f=f.clone().sub(g).length();e=e*Math.PI*2;i=b("Asset3DUtils").polarCoordToCartesianCoord(i+e,h);e=i.x;h=i.y;i=i.z;a.model().position.set(f*e+g.x,f*h+g.y,f*i+g.z);a.model().lookAt(g.x,g.y,g.z);c.requestUpdate();window.requestAnimationFrame(function(){return d.$R3OrbitalAnimation2(a,c)})}};return c}(a);e.exports=c}),null);
__d("R3SphericalCameraControl",["Asset3DUtils","React3","SphericalViewportControl","SubscriptionsHandler","radToDeg"],(function(a,b,c,d,e,f){a=b("React3").R3Effect;var g=.15,h=50;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.onApply=function(a,b){if(b){this.$R3SphericalCameraControl1=this.$R3SphericalCameraControl3(a,b.getRenderElement());var c=b.getRenderDimension(),d=c.width;c=c.height;this.__configSphericalViewportControl(this.$R3SphericalCameraControl1);this.$R3SphericalCameraControl1.updateViewportClientSize({width:d,height:c});this.$R3SphericalCameraControl4(this.$R3SphericalCameraControl1,a,b);b.requestUpdate()}};d.onUpdate=function(a,c,d){c=b("Asset3DUtils").getCameraOrientation(a);d=c.yaw;a=c.pitch;this.$R3SphericalCameraControl1.setSphericalOrientation(b("radToDeg")(d),b("radToDeg")(a))};d.onRemove=function(a){this.$R3SphericalCameraControl2.release()};d.$R3SphericalCameraControl3=function(a,c){a=b("Asset3DUtils").getCameraOrientation(a);var d=a.yaw;a=a.pitch;var e={enableGyro:!1,slipFactor:g,enableRubberBanding:!1,disableAutoClientSizeUpdate:!0,enableZoomWithShiftKey:!0,enablePanningWithRightMouse:!0,listenOnlyOneElement:!1};d={expansionCoef:1.01,fieldOfView:this.props.fov==null?h:this.props.fov,initialHeading:b("radToDeg")(d),initialPitch:b("radToDeg")(a),projectionType:"flat"};return new(b("SphericalViewportControl"))(c,d,this.__getSphericalViewportControlConfig(e))};d.$R3SphericalCameraControl4=function(a,c,d){var e;this.$R3SphericalCameraControl2=new(b("SubscriptionsHandler"))();(e=this.$R3SphericalCameraControl2).addSubscriptions.apply(e,this.__registerOtherListeners(a,c,d))};d.__configSphericalViewportControl=function(a){};d.__getSphericalViewportControlConfig=function(a){return a};d.__registerOtherListeners=function(a,b,c){return[]};return c}(a);e.exports=c}),null);
__d("R3PanCameraControl",["R3SphericalCameraControl","React","SocialVRThreeJS","degToRad"],(function(a,b,c,d,e,f){var g=b("React"),h=b("SocialVRThreeJS").Vector3;a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b||{panSpeed:1,key:"R3PanCameraControl"})||this;b.$R3PanCameraControl1=0;b.$R3PanCameraControl2=0;return b}var d=c.prototype;d.render=function(){return g.jsx("div",{name:"attribute zoomable camera control"})};d.__registerOtherListeners=function(a,c,d){var e=this;return[a.addListener("viewportChange",function(a,c,d){e.$R3PanCameraControl1=b("degToRad")(a),e.$R3PanCameraControl2=b("degToRad")(c)}),a.addListener("panningWithRightMouse",function(a){var b=a.x;a=a.y;e.$R3PanCameraControl3(c,-b,a,0,e.$R3PanCameraControl1,e.$R3PanCameraControl2);d.requestUpdate()})]};d.__getSphericalViewportControlConfig=function(a){return Object.assign({},a,{enableGyro:!1})};d.$R3PanCameraControl3=function(a,b,c,d,e,f){d=this.props.panSpeed;d=d===void 0?1:d;var g=a.target();a=a.model();var i=a.position.clone().sub(g.position),j=new h(1,0,0).applyAxisAngle(new h(0,1,0),e).normalize();f=new h(0,1,0).applyAxisAngle(new h(1,0,0),-f).applyAxisAngle(new h(0,1,0),e).normalize();g.position.add(j.multiplyScalar(b*d));g.position.add(f.multiplyScalar(c*d));e=g.position;j=e.clone().add(i);a.position.set(j.x,j.y,j.z)};return c}(b("R3SphericalCameraControl"));e.exports=a}),null);
__d("R3PositionalCameraControl",["Asset3DUtils","React3"],(function(a,b,c,d,e,f){a=b("React3").R3Effect;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b||{key:"R3PositionalCameraControl",range:.1*Math.PI,bound:.5*Math.PI})||this;b.$R3PositionalCameraControl1=0;return b}var d=c.prototype;d.onApply=function(a,b){var c=this,d=this.props,e=d.positionUpdate;d=d.initialPosition;e&&(this.$R3PositionalCameraControl2=e.addListener("position",function(d){d>=0&&d<=1&&(c.$R3PositionalCameraControl3(a,d),b.requestUpdate())}));d!=null&&(d>=0&&d<=1&&(this.$R3PositionalCameraControl3(a,d),b.requestUpdate()))};d.onRemove=function(a,b){this.$R3PositionalCameraControl2&&this.$R3PositionalCameraControl2.remove()};d.$R3PositionalCameraControl3=function(a,c){var d=this.props,e=d.range;d=d.bound;e=e==null?.1*Math.PI:parseFloat(e);d=d==null?.5*Math.PI:parseFloat(d);c=c*e-.5*e;e=this.$R3PositionalCameraControl1;var f=b("Asset3DUtils").getCameraOrientation(a),g=f.yaw;f=f.pitch;f=Math.max(-d,Math.min(f-e+c,d));e=a.target();d=e.position;e=a.model();a=e.position;a=a.clone().sub(d).length();g=b("Asset3DUtils").polarCoordToCartesianCoord(g,f);f=g.x;var h=g.y;g=g.z;e.position.set(a*f+d.x,a*h+d.y,a*g+d.z);e.lookAt(d.x,d.y,d.z);this.$R3PositionalCameraControl1=c};return c}(a);e.exports=c}),null);
__d("R3TurntableCameraControl",["Asset3DUtils","R3SphericalCameraControl","React","degToRad"],(function(a,b,c,d,e,f){var g=b("React"),h=6,i=3;a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b||{enableGyro:!1,key:"R3TurntableCameraControl"})||this}var d=c.prototype;d.render=function(){return g.jsx("div",{name:"attribute turnable camera control"})};d.__registerOtherListeners=function(a,c,d){var e=this;if(d)return[a.addListener("viewportChange",function(a,f,g){g=b("degToRad")(a);a=b("degToRad")(f);e.$R3TurntableCameraControl1(c,g,a);d.requestUpdate()}),a.addListener("updateViewportEnd",function(b,c){e.props.enableGyro&&a.reEnableGyro()}),a.addListener("onMovementStart",function(a,b){e.props.onInteractionStart&&e.props.onInteractionStart(c)}),a.addListener("DOM/click",function(a){d.getRenderElement().dispatchEvent(new Event("DOM/click",{bubbles:!0}))})];else return[]};d.__configSphericalViewportControl=function(a){a.setAngularVelocityScaleFactor({x:h,y:i})};d.__getSphericalViewportControlConfig=function(a){return Object.assign({},a,{enableGyro:!!this.props.enableGyro})};d.$R3TurntableCameraControl1=function(a,c,d){var e=a.target();e=e.position;a=a.model();var f=a.position;f=f.clone().sub(e).length();c=b("Asset3DUtils").polarCoordToCartesianCoord(c,d);d=c.x;var g=c.y;c=c.z;a.position.set(f*d+e.x,f*g+e.y,f*c+e.z);a.lookAt(e.x,e.y,e.z)};return c}(b("R3SphericalCameraControl"));e.exports=a}),null);
__d("R3ZoomCameraControl",["R3SphericalCameraControl","React"],(function(a,b,c,d,e,f){var g=b("React"),h=.001;a=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b){return a.call(this,b||{key:"R3ZoomCameraControl",zoomSpeed:.05})||this}var c=b.prototype;c.render=function(){return g.jsx("div",{name:"attribute zoomable camera control"})};c.__getSphericalViewportControlConfig=function(a){return Object.assign({},a,{enableGyro:!1})};c.__registerOtherListeners=function(a,b,c){var d=this.props,e=d.maxCameraDistance,f=d.minCameraDistance;d=d.zoomSpeed;var g=d==null?.05:parseFloat(d);if(c)return[a.addListener("wheelScrollWithShiftKey",function(a,d){d=b.model();var i=b.target();i=i.position.clone().sub(d.position.clone());var j=i.length();i=i.normalize();a<0&&(b.near-j*g>=h&&(e==null||j<=e)&&(d.position.add(i.multiplyScalar(j*g)),b.near-=j*g,b.far-=j*g,b.updateProjectionMatrix(),c.requestUpdate()));a>0&&((f==null||j>=f)&&(d.position.sub(i.multiplyScalar(j*g)),b.near+=j*g,b.far+=j*g,b.updateProjectionMatrix(),c.requestUpdate()))})];else return[]};return b}(b("R3SphericalCameraControl"));e.exports=a}),null);
__d("Asset3DFeedView.react",["Asset3DScene.react","Asset3DUtils","CanvasRenderer.react","EventListener","R3AmbientLight","R3DirectionalLight","R3OrbitalAnimation","R3PanCameraControl","R3PositionalCameraControl","R3TurntableCameraControl","R3ZoomCameraControl","React","SocialVRThreeJS","SubscriptionsHandler","debounce"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h=b("SocialVRThreeJS").Box3;a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$1=!1,d.$2=new(b("SubscriptionsHandler"))(),d.$3=b("debounce")(function(){return d.$1=!1},50),c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.screenshot=function(){return this.refs.renderer.screenshot()};d.componentDidMount=function(){var a=this,c=this.refs.content,d=this.props.onInteractionStart;d&&this.$2.addSubscriptions(b("EventListener").listen(c,"mousemove",function(){!a.$1?(a.$1=!0,d()):a.$3()}),b("EventListener").listen(c,"mouseenter",d),b("EventListener").listen(c,"mousedown",d))};d.render=function(){var a=this.props,c=a.model,d=a.viewportInfo,e=d.width;d=d.height;var f=a.onCameraUpdate,h=a.cameraPosition,i=a.cameraTarget;a=a.onRender;return g.jsx("div",{ref:"content",children:g.jsx(b("CanvasRenderer.react"),{width:e,height:d,onRender:a,ref:"renderer",children:g.jsx(b("Asset3DScene.react"),{model:c,cameraPosition:h,cameraTarget:i,onCameraUpdate:f,cameraEffects:this.$4(this.props),modelEffects:[new(b("R3DirectionalLight"))({key:"directionalLight",position:[1,2,1]}),new(b("R3AmbientLight"))({key:"ambientLight",color:13421772,intensity:.5})]})})})};d.$4=function(a){var c=a.model,d=a.isAttractionMode,e=a.positionUpdate,f=a.isInViewport;f=f===void 0?!0:f;a=a.scrollPosition;c=new h().setFromObject(c);var g=c.min;c=c.max;g=[new(b("R3TurntableCameraControl"))({key:"turntalbeControl",enableGyro:!0}),new(b("R3PanCameraControl"))({key:"panControl",panSpeed:b("Asset3DUtils").getPanSpeed(g,c)}),new(b("R3ZoomCameraControl"))()];d===!0&&g.push(new(b("R3OrbitalAnimation"))({key:"orbitalAnimation"}));f===!0&&g.push(new(b("R3PositionalCameraControl"))({key:"positionalControl",positionUpdate:e,range:.3*Math.PI,bound:.25*Math.PI,initialPosition:a}));return g};return c}(g.Component);e.exports=a}),null);
__d("Asset3DFullscreenViewContainer.react",["cx","Asset3DFeedView.react","Asset3DUtils","FBLogger","FDSCloseButton.react","React","Spotlight.react","UIPagelet","ge"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=function(){c.props.onExit()},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidMount=function(){this.$2()};d.render=function(){var a=this,c=this.props,d=c.model,e=c.viewportInfo;c=c.backgroundType;var f=e.height;return h.jsxs(b("Spotlight.react"),{onHide:this.$1,shown:!0,rootClassName:"_6gen",children:[h.jsx("div",{className:"_6gdn",children:h.jsx(b("FDSCloseButton.react"),{onClick:function(){return a.$1()},size:"large"})}),h.jsx("div",{className:"_n3",children:h.jsxs("div",{className:"_6iy4",children:[h.jsx("div",{style:this.$3(c),children:h.jsx("div",{ref:"contentContainer",children:h.jsx(b("Asset3DFeedView.react"),{model:d,viewportInfo:e})})}),h.jsx("div",{style:{height:f,overflowY:"auto"},className:"_6iy5",id:"pagelet_asset3d_viewer"})]})})]})};d.$2=function(){try{b("UIPagelet").loadFromEndpoint("Asset3DViewerPagelet",b("ge")("pagelet_asset3d_viewer",this.root),{storyID:this.props.storyID})}catch(a){b("FBLogger")("Asset3DFullscreenViewerContainer").info("the modal has been closed",a)}};d.$3=function(a){if(a!=null)return b("Asset3DUtils").getBackgroundStyles(a,"story");else return null};return c}(h.Component);e.exports=a}),null);
__d("Asset3DModalViewerStore",["undux"],(function(a,b,c,d,e,f){a=b("undux").connect;c=b("undux").createStore;d={pointerPos:{x:0,y:0}};f=c(d);e.exports.withStore=a(f)}),null);
__d("Asset3DViewerHelper",["Asset3DConstants"],(function(a,b,c,d,e,f){"use strict";var g=(a=b("Asset3DConstants")).CAMERA_RADIUS,h=a.MAX_ZOOM,i=a.MODAL,j=a.ROTATION_FACTOR;e.exports={getCameraViewParams:function(a,b,c,d,e,f){var k=.5*c,l=.5*d;a=2*(a-k)/c;k=-2*(b-l)/d;c=e>f;b=Math.sin(k*Math.PI*.5);l=Math.sin(a*Math.PI*.5);d=f*j*b;k=e*j*l;a=Math.tan(e/2)*g*(c?i.H_TARGET_FACTOR.H_PHOTO:i.H_TARGET_FACTOR.V_PHOTO);e=Math.tan(f/2)*g*(c?i.V_TARGET_FACTOR.H_PHOTO:i.V_TARGET_FACTOR.V_PHOTO);f=-b*e;b=-l*a;e=h*-.1;l=-d;a=-k;d=g+e;k=c?i.H_TARGET_DISTRIBUTE_FACTOR.H_PHOTO:i.H_TARGET_DISTRIBUTE_FACTOR.V_PHOTO;e=c?i.V_TARGET_DISTRIBUTE_FACTOR.H_PHOTO:i.V_TARGET_DISTRIBUTE_FACTOR.V_PHOTO;return{lookAtPos:[-(1-k)*b,-(1-e)*f,-g],cameraPos:[d*Math.cos(l)*Math.sin(a),0+d*Math.sin(l),-g+d*Math.cos(l)*Math.cos(a)]}}}}),null);
__d("Asset3dCameraControl",["EventListener","SocialVRThreeJS","degToRad"],(function(a,b,c,d,e,f){"use strict";var g=.01,h=2e3,i=b("degToRad")(270),j=b("degToRad")(0),k=50,l=5e3;a=function(){function a(a,c,d,e,f){var l=this;this.__cameraTarget=new(b("SocialVRThreeJS").Vector3)();this.__width=0;this.__height=0;this.__aspectRatio=1;this.__yaw=i;this.__pitch=j;this.__dirty=!0;this.__isInAttractMode=!1;this.__attractModeAnimationFrameID=null;this.$1=null;this.__fullVisibility=!1;this.__width=a;this.__height=c;this.__aspectRatio=a/c;this.__canvas=d;this.__camera=new(b("SocialVRThreeJS").PerspectiveCamera)(k,this.__width/this.__height,g,h);this.__renderingControl=f;e=new(b("SocialVRThreeJS").DirectionalLight)(15658734);e.position.set(1,2,1);this.__camera.add(e);this.setupViewportListeners();this.setDirty(!0);b("EventListener").listen(document,"visibilitychange",function(){l.setDirty(!0,!0)});b("EventListener").listen(window,"blur",function(){l.setDirty(!0,!0)});b("EventListener").listen(window,"focus",function(){l.setDirty(!0,!0)})}var c=a.prototype;c.modelLoad=function(a,b){b===void 0};c.setupViewportListeners=function(){};c.update=function(a){};c.camera=function(){return this.__camera};c.getHorizontalFov=function(){return this.__hFov};c.getVerticalFov=function(){return this.__vFov};c.destroy=function(){this.$1&&(window.clearTimeout(this.$1),this.$1=null)};c.isDirty=function(){return this.__dirty};c.setDirty=function(a,b){var c=this;b===void 0&&(b=!1);this.__dirty=a;a&&b&&(this.__isInAttractMode&&this.__exitAttractMode(),this.$1&&(window.clearTimeout(this.$1),this.$1=null),this.__fullVisibility&&(this.$1=window.setTimeout(function(){c.$1=null,c.__enterAttractMode()},l)))};c.setFullVisibility=function(a){this.__fullVisibility=a};c.resetCamera=function(){};c.__updateResetCamera=function(){};c.__enterAttractMode=function(){this.__isInAttractMode=!0};c.__exitAttractMode=function(){this.__attractModeAnimationFrameID!==null&&(window.cancelAnimationFrame(this.__attractModeAnimationFrameID),this.__attractModeAnimationFrameID=null),this.__isInAttractMode=!1};c.resize=function(a,b){};c.aspectRatio=function(){return this.__aspectRatio};return a}();e.exports=a}),null);
__d("Asset3dContextMenu",["CurrentUser","EventListener","React","ReactXUIMenu","UserAgent","MountedContextMenu.react","ReactDOM"],(function(a,b,c,d,e,f){"use strict";var g=b("React"),h=b("ReactXUIMenu").Item;a=function(){function a(a,c,d,e,f,g,h){var i=this;this.$9=function(a){var c=/^a$/i.test(a.target.nodeName||""),d=b("UserAgent").isPlatform("Mac OS X")?a.metaKey:a.ctrlKey;c=!c&&b("CurrentUser").isEmployee()&&d;c?(a.preventDefault(),i.$10()):(b("ReactDOM").unmountComponentAtNode(i.$1),delete i.$3)};this.$1=a;this.$2=c;this.$4=d;this.$5=e;this.$6=f;this.$7=g;this.$8=h;b("EventListener").listen(c,"contextmenu",this.$9)}var c=a.prototype;c.$10=function(){if(this.$2){var a,c,d,e;this.$4&&(a=g.jsx(h,{href:this.$4,target:"_blank",children:"Download 3D File"}));this.$5&&(c=g.jsx(h,{href:this.$5,target:"_blank",children:"Download 3D Depth File"}));this.$6&&(d=g.jsx(h,{href:this.$6,target:"_blank",children:"Download Original Image File"}));this.$7&&(e=g.jsx(h,{href:this.$7,target:"_blank",children:"3D Photo console"}));var f=g.jsxs(b("ReactXUIMenu"),{children:[a,c,d,e,g.jsx(h,{onclick:this.$8,children:"Dev Info"})]});f=g.jsx(b("MountedContextMenu.react"),{mountedTriggerElem:this.$2,menu:f});this.$3=b("ReactDOM").render(f,this.$1)}};return a}();e.exports=a}),null);
__d("Asset3dComponentContextMenu.react",["Asset3dContextMenu","React"],(function(a,b,c,d,e,f){"use strict";var g=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.componentDidMount=function(){this.props.target&&(this.$1=new(b("Asset3dContextMenu"))(this.refs.container,this.props.target,this.props.fileURL,this.props.depthImageURL,this.props.fallbackImgURL,this.props.consoleURL,this.props.onToggleDevPanel))};d.render=function(){return g.jsx("div",{ref:"container"})};return c}(g.Component);e.exports=a}),null);
__d("XAsset3DForLinkShareSrcController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/3d/linkshare/src/",{status_id:{type:"FBID",required:!0}})}),null);
__d("Asset3DLoader",["regeneratorRuntime","Promise","ActorURI","XAsset3DForLinkShareSrcController","XAsyncRequest"],(function(a,b,c,d,e,f){var g=10,h=1e3,i="Failed to load the asset because the arguments provided is not enought",j="Failed to load the asset because the max times of retry has reached",k="Failed to load the asset because the request to the server returned failed";a=function(){"use strict";function a(a,b){this.$1=a,this.$2=b||{timesOfRetry:g,retryDelay:h}}var c=a.prototype;c.parse=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.$1.parse(a));case 2:return c.abrupt("return",c.sent);case 3:case"end":return c.stop()}},null,this)};c.load=function(a){var c,d,e,f,g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:a===void 0&&(a={});c=a,d=c.uri,e=c.statusID,f=c.actorID,g=c.assetID;if(d){j.next=10;break}if(!(e&&f)){j.next=7;break}return j.abrupt("return",this.$3(this.__createURL(e,f)));case 7:return j.abrupt("return",b("Promise").resolve({error:i}));case 8:j.next=14;break;case 10:j.next=12;return b("regeneratorRuntime").awrap(this.$1.load(a));case 12:h=j.sent;return j.abrupt("return",Object.assign({},h,{assetID:g,uri:d}));case 14:case"end":return j.stop()}},null,this)};c.__createURL=function(a,c){return b("ActorURI").create(b("XAsset3DForLinkShareSrcController").getURIBuilder().setFBID("status_id",String(a)).getURI(),c)};c.$3=function(a,c,d){var e=this;c===void 0&&(c=1);d===void 0&&(d=0);return new(b("Promise"))(function(c,f){var g=new(b("XAsyncRequest"))().setURI(a).setMethod("GET").setReadOnly(!0).setHandler(c).setErrorHandler(function(a){return e.$4(a)});d>0?setTimeout(function(){g.send()},d):g.send()}).then(function(b){return e.$5(a,c,b)})};c.$5=function(a,c,d){var e,f,g,h,i;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:e=d.getPayload(),f=e.status,g=e.asset3d_id,h=e.glb_uri;l.t0=f;l.next=l.t0==="uploading"?4:l.t0==="success"?5:9;break;case 4:return l.abrupt("return",this.$2.timesOfRetry>=c?this.$3(a,++c,this.$2.retryDelay):b("Promise").resolve({error:j}));case 5:l.next=7;return b("regeneratorRuntime").awrap(this.$1.load({assetID:g,uri:h}));case 7:i=l.sent;return l.abrupt("return",Object.assign({},i,{assetID:g,uri:h}));case 9:return l.abrupt("return",b("Promise").resolve({error:k}));case 10:case"end":return l.stop()}},null,this)};c.$4=function(a){throw a};return a}();e.exports=a}),null);
__d("GLTFLoader.r93",["Promise","ThreeJS.r93"],(function(a,b,c,d,e,f){GLTFLoader=function(){var a;function c(a){this.manager=a!==void 0?a:b("ThreeJS.r93").DefaultLoadingManager,this.dracoLoader=null}c.prototype={constructor:c,crossOrigin:"Anonymous",load:function(a,c,d,e){var f=this,g=this.path!==void 0?this.path:b("ThreeJS.r93").LoaderUtils.extractUrlBase(a),h=new(b("ThreeJS.r93").FileLoader)(f.manager);h.setResponseType("arraybuffer");h.load(a,function(a){try{f.parse(a,g,c,e)}catch(a){if(e!==void 0)e(a);else throw a}},d,e)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this},setDRACOLoader:function(a){this.dracoLoader=a;return this},parse:function(a,c,d,j){var k,o={};if(typeof a==="string")k=a;else{var p=b("ThreeJS.r93").LoaderUtils.decodeText(new Uint8Array(a,0,4));if(p===i){try{o[e.KHR_BINARY_GLTF]=new l(a)}catch(a){j&&j(a);return}k=o[e.KHR_BINARY_GLTF].content}else k=b("ThreeJS.r93").LoaderUtils.decodeText(new Uint8Array(a))}p=JSON.parse(k);if(p.asset===void 0||p.asset.version[0]<2){j&&j(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));return}if(p.extensionsUsed)for(var a=0;a<p.extensionsUsed.length;++a){k=p.extensionsUsed[a];var q=p.extensionsRequired||[];switch(k){case e.KHR_LIGHTS:o[k]=new g(p);break;case e.KHR_MATERIALS_UNLIT:o[k]=new h(p);break;case e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[k]=new n();break;case e.KHR_DRACO_MESH_COMPRESSION:o[k]=new m(p,this.dracoLoader);break;case e.MSFT_TEXTURE_DDS:o[e.MSFT_TEXTURE_DDS]=new f();break;default:q.indexOf(k)>=0}}var r=new N(p,o,{path:c||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager});r.parse(function(a,b,c,e,f){a={scene:a,scenes:b,cameras:c,animations:e,asset:f.asset,parser:r,userData:{}};f.extras&&(a.userData=f.extras);C(o,a,f);d(a)},j)}};function d(){var a={};return{get:function(b){return a[b]},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},removeAll:function(){a={}}}}var e={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function f(){if(!b("ThreeJS.r93").DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=e.MSFT_TEXTURE_DDS;this.ddsLoader=new(b("ThreeJS.r93").DDSLoader)()}function g(a){this.name=e.KHR_LIGHTS;this.lights={};a=a.extensions&&a.extensions[e.KHR_LIGHTS]||{};a=a.lights||{};for(var c in a){var d=a[c],f,g=new(b("ThreeJS.r93").Color)().fromArray(d.color);switch(d.type){case"directional":f=new(b("ThreeJS.r93").DirectionalLight)(g);f.target.position.set(0,0,1);f.add(f.target);break;case"point":f=new(b("ThreeJS.r93").PointLight)(g);break;case"spot":f=new(b("ThreeJS.r93").SpotLight)(g);d.spot=d.spot||{};d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0;d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4;f.angle=d.spot.outerConeAngle;f.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle;f.target.position.set(0,0,1);f.add(f.target);break;case"ambient":f=new(b("ThreeJS.r93").AmbientLight)(g);break}f&&(f.decay=2,d.intensity!==void 0&&(f.intensity=d.intensity),f.name=d.name||"light_"+c,this.lights[c]=f)}}function h(a){this.name=e.KHR_MATERIALS_UNLIT}h.prototype.getMaterialType=function(a){return b("ThreeJS.r93").MeshBasicMaterial};h.prototype.extendParams=function(a,c,d){var e=[];a.color=new(b("ThreeJS.r93").Color)(1,1,1);a.opacity=1;c=c.pbrMetallicRoughness;if(c){if(Array.isArray(c.baseColorFactor)){var f=c.baseColorFactor;a.color.fromArray(f);a.opacity=f[3]}c.baseColorTexture!==void 0&&e.push(d.assignTexture(a,"map",c.baseColorTexture.index))}return b("Promise").all(e)};var i="glTF",j=12,k={JSON:1313821514,BIN:5130562};function l(a){this.name=e.KHR_BINARY_GLTF;this.content=null;this.body=null;var c=new DataView(a,0,j);this.header={magic:b("ThreeJS.r93").LoaderUtils.decodeText(new Uint8Array(a.slice(0,4))),version:c.getUint32(4,!0),length:c.getUint32(8,!0)};if(this.header.magic!==i)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");else if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");c=new DataView(a,j);var d=0;while(d<c.byteLength){var f=c.getUint32(d,!0);d+=4;var g=c.getUint32(d,!0);d+=4;if(g===k.JSON){var h=new Uint8Array(a,j+d,f);this.content=b("ThreeJS.r93").LoaderUtils.decodeText(h)}else if(g===k.BIN){h=j+d;this.body=a.slice(h,h+f)}d+=f}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function m(a,b){if(!b)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=e.KHR_DRACO_MESH_COMPRESSION;this.json=a;this.dracoLoader=b}m.prototype.decodePrimitive=function(a,c){var d=this.json,e=this.dracoLoader,f=a.extensions[this.name].bufferView,g=a.extensions[this.name].attributes,h={},i={},j={};for(var k in g){if(!(k in w))continue;h[w[k]]=g[k]}for(k in a.attributes)if(w[k]!==void 0&&g[k]!==void 0){var l=d.accessors[a.attributes[k]],m=q[l.componentType];j[w[k]]=m;i[w[k]]=l.normalized===!0}return c.getDependency("bufferView",f).then(function(a){return new(b("Promise"))(function(b){e.decodeDracoFile(a,function(c){for(var a in c.attributes){var d=c.attributes[a],e=i[a];e!==void 0&&(d.normalized=e)}b(c)},h,j)})})};function n(){return{name:e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return b("ThreeJS.r93").ShaderMaterial},extendParams:function(c,d,e){var a;d=d.extensions[this.name];var f=(a=b("ThreeJS.r93")).ShaderLib.standard,g=a.UniformsUtils.clone(f.uniforms),h=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),j=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),k=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n");h=f.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",h).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",j).replace("#include <metalnessmap_fragment>",k).replace("#include <lights_physical_fragment>",l);delete g.roughness;delete g.metalness;delete g.roughnessMap;delete g.metalnessMap;g.specular={value:new a.Color().setHex(1118481)};g.glossiness={value:.5};g.specularMap={value:null};g.glossinessMap={value:null};c.vertexShader=f.vertexShader;c.fragmentShader=h;c.uniforms=g;c.defines={STANDARD:""};c.color=new a.Color(1,1,1);c.opacity=1;i=[];if(Array.isArray(d.diffuseFactor)){j=d.diffuseFactor;c.color.fromArray(j);c.opacity=j[3]}d.diffuseTexture!==void 0&&i.push(e.assignTexture(c,"map",d.diffuseTexture.index));c.emissive=new(b("ThreeJS.r93").Color)(0,0,0);c.glossiness=d.glossinessFactor!==void 0?d.glossinessFactor:1;c.specular=new(b("ThreeJS.r93").Color)(1,1,1);Array.isArray(d.specularFactor)&&c.specular.fromArray(d.specularFactor);if(d.specularGlossinessTexture!==void 0){k=d.specularGlossinessTexture.index;i.push(e.assignTexture(c,"glossinessMap",k));i.push(e.assignTexture(c,"specularMap",k))}return b("Promise").all(i)},createMaterial:function(a){var c=new(b("ThreeJS.r93").ShaderMaterial)({defines:a.defines,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms,fog:!0,lights:!0,opacity:a.opacity,transparent:a.transparent});c.isGLTFSpecularGlossinessMaterial=!0;c.color=a.color;c.map=a.map===void 0?null:a.map;c.lightMap=null;c.lightMapIntensity=1;c.aoMap=a.aoMap===void 0?null:a.aoMap;c.aoMapIntensity=1;c.emissive=a.emissive;c.emissiveIntensity=1;c.emissiveMap=a.emissiveMap===void 0?null:a.emissiveMap;c.bumpMap=a.bumpMap===void 0?null:a.bumpMap;c.bumpScale=1;c.normalMap=a.normalMap===void 0?null:a.normalMap;a.normalScale&&(c.normalScale=a.normalScale);c.displacementMap=null;c.displacementScale=1;c.displacementBias=0;c.specularMap=a.specularMap===void 0?null:a.specularMap;c.specular=a.specular;c.glossinessMap=a.glossinessMap===void 0?null:a.glossinessMap;c.glossiness=a.glossiness;c.alphaMap=null;c.envMap=a.envMap===void 0?null:a.envMap;c.envMapIntensity=1;c.refractionRatio=.98;c.extensions.derivatives=!0;return c},cloneMaterial:function(a){var b=a.clone();b.isGLTFSpecularGlossinessMaterial=!0;var c=this.specularGlossinessParams;for(var d=0,e=c.length;d<e;d++)b[c[d]]=a[c[d]];return b},refreshUniforms:function(a,b,c,d,e,f){if(e.isGLTFSpecularGlossinessMaterial!==!0)return;a=e.uniforms;b=e.defines;a.opacity.value=e.opacity;a.diffuse.value.copy(e.color);a.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity);a.map.value=e.map;a.specularMap.value=e.specularMap;a.alphaMap.value=e.alphaMap;a.lightMap.value=e.lightMap;a.lightMapIntensity.value=e.lightMapIntensity;a.aoMap.value=e.aoMap;a.aoMapIntensity.value=e.aoMapIntensity;var g;e.map?g=e.map:e.specularMap?g=e.specularMap:e.displacementMap?g=e.displacementMap:e.normalMap?g=e.normalMap:e.bumpMap?g=e.bumpMap:e.glossinessMap?g=e.glossinessMap:e.alphaMap?g=e.alphaMap:e.emissiveMap&&(g=e.emissiveMap);if(g!==void 0){g.isWebGLRenderTarget&&(g=g.texture);if(g.matrix!==void 0){if(g.matrixAutoUpdate===!0){c=g.offset;d=g.repeat;f=g.rotation;var h=g.center;g.matrix.setUvTransform(c.x,c.y,d.x,d.y,f,h.x,h.y)}a.uvTransform.value.copy(g.matrix)}else c=g.offset,d=g.repeat,a.offsetRepeat.value.set(c.x,c.y,d.x,d.y)}a.envMap.value=e.envMap;a.envMapIntensity.value=e.envMapIntensity;a.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1;a.refractionRatio.value=e.refractionRatio;a.specular.value.copy(e.specular);a.glossiness.value=e.glossiness;a.glossinessMap.value=e.glossinessMap;a.emissiveMap.value=e.emissiveMap;a.bumpMap.value=e.bumpMap;a.normalMap.value=e.normalMap;a.displacementMap.value=e.displacementMap;a.displacementScale.value=e.displacementScale;a.displacementBias.value=e.displacementBias;a.glossinessMap.value!==null&&b.USE_GLOSSINESSMAP===void 0&&(b.USE_GLOSSINESSMAP="",b.USE_ROUGHNESSMAP="");a.glossinessMap.value===null&&b.USE_GLOSSINESSMAP!==void 0&&(delete b.USE_GLOSSINESSMAP,delete b.USE_ROUGHNESSMAP)}}}function o(a,c,d,e){b("ThreeJS.r93").Interpolant.call(this,a,c,d,e)}o.prototype=Object.create((a=b("ThreeJS.r93")).Interpolant.prototype);o.prototype.constructor=o;o.prototype.interpolate_=function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=g*2,i=g*3;d=d-b;c=(c-b)/d;b=c*c;var j=b*c;a=a*i;i=a-i;var k=2*j-3*b+1;c=j-2*b+c;var l=-2*j+3*b;j=j-b;for(var b=0;b!==g;b++){var m=f[i+b+g],n=f[i+b+h]*d,o=f[a+b+g],p=f[a+b]*d;e[b]=k*m+c*n+l*o+j*p}return e};var p={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123};({5126:Number,35675:a.Matrix3,35676:a.Matrix4,35664:a.Vector2,35665:a.Vector3,35666:a.Vector4,35678:a.Texture});var q={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},r={9728:a.NearestFilter,9729:a.LinearFilter,9984:a.NearestMipMapNearestFilter,9985:a.LinearMipMapNearestFilter,9986:a.NearestMipMapLinearFilter,9987:a.LinearMipMapLinearFilter},s={33071:a.ClampToEdgeWrapping,33648:a.MirroredRepeatWrapping,10497:a.RepeatWrapping},t={6406:a.AlphaFormat,6407:a.RGBFormat,6408:a.RGBAFormat,6409:a.LuminanceFormat,6410:a.LuminanceAlphaFormat},u={5121:a.UnsignedByteType,32819:a.UnsignedShort4444Type,32820:a.UnsignedShort5551Type,33635:a.UnsignedShort565Type};({1028:a.BackSide,1029:a.FrontSide});({512:a.NeverDepth,513:a.LessDepth,514:a.EqualDepth,515:a.LessEqualDepth,516:a.GreaterEqualDepth,517:a.NotEqualDepth,518:a.GreaterEqualDepth,519:a.AlwaysDepth});({32774:a.AddEquation,32778:a.SubtractEquation,32779:a.ReverseSubtractEquation});({0:a.ZeroFactor,1:a.OneFactor,768:a.SrcColorFactor,769:a.OneMinusSrcColorFactor,770:a.SrcAlphaFactor,771:a.OneMinusSrcAlphaFactor,772:a.DstAlphaFactor,773:a.OneMinusDstAlphaFactor,774:a.DstColorFactor,775:a.OneMinusDstColorFactor,776:a.SrcAlphaSaturateFactor});var v={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},x={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},y={CUBICSPLINE:a.InterpolateSmooth,LINEAR:a.InterpolateLinear,STEP:a.InterpolateDiscrete};({2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"});var z={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function A(a,b){if(typeof a!=="string"||a==="")return"";if(/^(https?:)?\/\//i.test(a))return a;if(/^data:.*,.*$/i.test(a))return a;return/^blob:.*$/i.test(a)?a:b+a}function B(){return new(b("ThreeJS.r93").MeshStandardMaterial)({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:b("ThreeJS.r93").FrontSide})}function C(a,b,c){for(var d in c.extensions)a[d]===void 0&&(b.userData.gltfExtensions=b.userData.gltfExtensions||{},b.userData.gltfExtensions[d]=c.extensions[d])}function D(a,b,c){var d=!1,e=!1;for(var f=0,g=b.length;f<g;f++){var h=b[f];h.POSITION!==void 0&&(d=!0);h.NORMAL!==void 0&&(e=!0);if(d&&e)break}if(!d&&!e)return;var i=[],j=[];for(var f=0,g=b.length;f<g;f++){var h=b[f],k="morphTarget"+f;if(d){if(h.POSITION!==void 0){var l=L(c[h.POSITION]);l.name=k;var m=a.attributes.position;for(var n=0,o=l.count;n<o;n++)l.setXYZ(n,l.getX(n)+m.getX(n),l.getY(n)+m.getY(n),l.getZ(n)+m.getZ(n))}else l=a.attributes.position;i.push(l)}if(e){if(h.NORMAL!==void 0){m=L(c[h.NORMAL]);m.name=k;l=a.attributes.normal;for(var n=0,o=m.count;n<o;n++)m.setXYZ(n,m.getX(n)+l.getX(n),m.getY(n)+l.getY(n),m.getZ(n)+l.getZ(n))}else m=a.attributes.normal;j.push(m)}}d&&(a.morphAttributes.position=i);e&&(a.morphAttributes.normal=j)}function E(a,b){a.updateMorphTargets();if(b.weights!==void 0)for(var c=0,d=b.weights.length;c<d;c++)a.morphTargetInfluences[c]=b.weights[c];if(b.extras&&Array.isArray(b.extras.targetNames)){b=b.extras.targetNames;if(a.morphTargetInfluences.length===b.length){a.morphTargetDictionary={};for(var c=0,d=b.length;c<d;c++)a.morphTargetDictionary[b[c]]=c}}}function F(a,b){return a.indices!==b.indices?!1:G(a.attributes,b.attributes)}function G(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0}function H(a,b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function I(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(F(e.primitive,b))return e.promise}return null}function J(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(H(b,e.baseGeometries))return e.geometry}return null}function K(a,b,c){for(var d=0,e=a.length;d<e;d++){var f=a[d];if(b===f.baseGeometry&&H(c,f.primitives))return f.geometry}return null}function L(a){if(a.isInterleavedBufferAttribute){var c=a.count,d=a.itemSize,e=a.array.slice(0,c*d);for(var f=0;f<c;++f)e[f]=a.getX(f),d>=2&&(e[f+1]=a.getY(f)),d>=3&&(e[f+2]=a.getZ(f)),d>=4&&(e[f+3]=a.getW(f));return new(b("ThreeJS.r93").BufferAttribute)(e,d,a.normalized)}return a.clone()}function M(a){if(a.length<2)return!1;var b=a[0],c=b.targets||[];if(b.indices===void 0)return!1;for(var d=1,e=a.length;d<e;d++){var f=a[d];if(b.mode!==f.mode)return!1;if(f.indices===void 0)return!1;if(!G(b.attributes,f.attributes))return!1;f=f.targets||[];if(c.length!==f.length)return!1;for(var g=0,h=c.length;g<h;g++)if(!G(c[g],f[g]))return!1}return!0}function N(a,c,e){this.json=a||{},this.extensions=c||{},this.options=e||{},this.cache=new d(),this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new(b("ThreeJS.r93").TextureLoader)(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new(b("ThreeJS.r93").FileLoader)(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}N.prototype.parse=function(a,b){var c=this.json;this.cache.removeAll();this.markDefs();this.getMultiDependencies(["scene","animation","camera"]).then(function(b){var d=b.scenes||[],e=d[c.scene||0],f=b.animations||[];b=b.cameras||[];a(e,d,b,f,c)})["catch"](b)};N.prototype.markDefs=function(){var a=this.json.nodes||[],b=this.json.skins||[],c=this.json.meshes||[],d={},e={};for(var f=0,g=b.length;f<g;f++){var h=b[f].joints;for(var i=0,j=h.length;i<j;i++)a[h[i]].isBone=!0}for(var i=0,j=a.length;i<j;i++){h=a[i];h.mesh!==void 0&&(d[h.mesh]===void 0&&(d[h.mesh]=e[h.mesh]=0),d[h.mesh]++,h.skin!==void 0&&(c[h.mesh].isSkinnedMesh=!0))}this.json.meshReferences=d;this.json.meshUses=e};N.prototype.getDependency=function(a,b){var c=a+":"+b,d=this.cache.get(c);if(!d){switch(a){case"scene":d=this.loadScene(b);break;case"node":d=this.loadNode(b);break;case"mesh":d=this.loadMesh(b);break;case"accessor":d=this.loadAccessor(b);break;case"bufferView":d=this.loadBufferView(b);break;case"buffer":d=this.loadBuffer(b);break;case"material":d=this.loadMaterial(b);break;case"texture":d=this.loadTexture(b);break;case"skin":d=this.loadSkin(b);break;case"animation":d=this.loadAnimation(b);break;case"camera":d=this.loadCamera(b);break;default:throw new Error("Unknown type: "+a)}this.cache.add(c,d)}return d};N.prototype.getDependencies=function(a){var c=this.cache.get(a);if(!c){var d=this,e=this.json[a+(a==="mesh"?"es":"s")]||[];c=b("Promise").all(e.map(function(b,c){return d.getDependency(a,c)}));this.cache.add(a,c)}return c};N.prototype.getMultiDependencies=function(a){var c={},d=[];for(var e=0,f=a.length;e<f;e++){var g=a[e],h=this.getDependencies(g);h=h.then(function(b,a){c[b]=a}.bind(this,g+(g==="mesh"?"es":"s")));d.push(h)}return b("Promise").all(d).then(function(){return c})};N.prototype.loadBuffer=function(a){var c=this.json.buffers[a],d=this.fileLoader;if(c.type&&c.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+c.type+" buffer type is not supported.");if(c.uri===void 0&&a===0)return b("Promise").resolve(this.extensions[e.KHR_BINARY_GLTF].body);var f=this.options;return new(b("Promise"))(function(a,b){d.load(A(c.uri,f.path),a,void 0,function(){b(new Error('THREE.GLTFLoader: Failed to load buffer "'+c.uri+'".'))})})};N.prototype.loadBufferView=function(a){var b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){var c=b.byteLength||0,d=b.byteOffset||0;return a.slice(d,d+c)})};N.prototype.loadAccessor=function(a){var c=this,d=this.json,e=this.json.accessors[a];if(e.bufferView===void 0&&e.sparse===void 0)return null;a=[];e.bufferView!==void 0?a.push(this.getDependency("bufferView",e.bufferView)):a.push(null);e.sparse!==void 0&&(a.push(this.getDependency("bufferView",e.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",e.sparse.values.bufferView)));return b("Promise").all(a).then(function(a){var f=a[0],g=v[e.type],h=q[e.componentType],i=h.BYTES_PER_ELEMENT,j=i*g,k=e.byteOffset||0,l=d.bufferViews[e.bufferView].byteStride,m=e.normalized===!0,n;if(l&&l!==j){j="InterleavedBuffer:"+e.bufferView+":"+e.componentType;var o=c.cache.get(j);o||(n=new h(f),o=new(b("ThreeJS.r93").InterleavedBuffer)(n,l/i),c.cache.add(j,o));l=new(b("ThreeJS.r93").InterleavedBufferAttribute)(o,g,k/i,m)}else f===null?n=new h(e.count*g):n=new h(f,k,e.count*g),l=new(b("ThreeJS.r93").BufferAttribute)(n,g,m);if(e.sparse!==void 0){j=v.SCALAR;o=q[e.sparse.indices.componentType];i=e.sparse.indices.byteOffset||0;k=e.sparse.values.byteOffset||0;n=new o(a[1],i,e.sparse.count*j);m=new h(a[2],k,e.sparse.count*g);f!==null&&l.setArray(l.array.slice());for(var o=0,i=n.length;o<i;o++){j=n[o];l.setX(j,m[o*g]);g>=2&&l.setY(j,m[o*g+1]);g>=3&&l.setZ(j,m[o*g+2]);g>=4&&l.setW(j,m[o*g+3]);if(g>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return l})};N.prototype.loadTexture=function(a){var c=this,d=this.json,f=this.options,g=this.textureLoader,h=window.URL||window.webkitURL,i=d.textures[a],j=i.extensions||{},k;j[e.MSFT_TEXTURE_DDS]?k=d.images[j[e.MSFT_TEXTURE_DDS].source]:k=d.images[i.source];var l=k.uri,m=!1;k.bufferView!==void 0&&(l=c.getDependency("bufferView",k.bufferView).then(function(a){m=!0;a=new Blob([a],{type:k.mimeType});l=h.createObjectURL(a);return l}));return b("Promise").resolve(l).then(function(a){var d=b("ThreeJS.r93").Loader.Handlers.get(a);d||(d=j[e.MSFT_TEXTURE_DDS]?c.extensions[e.MSFT_TEXTURE_DDS].ddsLoader:g);return new(b("Promise"))(function(b,c){d.load(A(a,f.path),b,void 0,c)})}).then(function(a){m===!0&&h.revokeObjectURL(l);a.flipY=!1;i.name!==void 0&&(a.name=i.name);j[e.MSFT_TEXTURE_DDS]||(a.format=i.format!==void 0?t[i.format]:b("ThreeJS.r93").RGBAFormat);i.internalFormat!==void 0&&a.format!==t[i.internalFormat];a.type=i.type!==void 0?u[i.type]:b("ThreeJS.r93").UnsignedByteType;var c=d.samplers||{};c=c[i.sampler]||{};a.magFilter=r[c.magFilter]||b("ThreeJS.r93").LinearFilter;a.minFilter=r[c.minFilter]||b("ThreeJS.r93").LinearMipMapLinearFilter;a.wrapS=s[c.wrapS]||b("ThreeJS.r93").RepeatWrapping;a.wrapT=s[c.wrapT]||b("ThreeJS.r93").RepeatWrapping;return a})};N.prototype.assignTexture=function(a,b,c){return this.getDependency("texture",c).then(function(c){a[b]=c})};N.prototype.loadMaterial=function(a){var c=this;this.json;var d=this.extensions,f=this.json.materials[a],g,h={};a=f.extensions||{};var i=[];if(a[e.KHR_MATERIALS_UNLIT]){a=d[e.KHR_MATERIALS_UNLIT];g=a.getMaterialType(f);i.push(a.extendParams(h,f,c))}else{g=b("ThreeJS.r93").MeshStandardMaterial;a=f.pbrMetallicRoughness||{};h.color=new(b("ThreeJS.r93").Color)(1,1,1);h.opacity=1;if(Array.isArray(a.baseColorFactor)){var j=a.baseColorFactor;h.color.fromArray(j);h.opacity=j[3]}a.baseColorTexture!==void 0&&i.push(c.assignTexture(h,"map",a.baseColorTexture.index));h.metalness=a.metallicFactor!==void 0?a.metallicFactor:1;h.roughness=a.roughnessFactor!==void 0?a.roughnessFactor:1;if(a.metallicRoughnessTexture!==void 0){j=a.metallicRoughnessTexture.index;i.push(c.assignTexture(h,"metalnessMap",j));i.push(c.assignTexture(h,"roughnessMap",j))}}f.doubleSided===!0&&(h.side=b("ThreeJS.r93").DoubleSide);a=f.alphaMode||z.OPAQUE;a===z.BLEND?h.transparent=!0:(h.transparent=!1,a===z.MASK&&(h.alphaTest=f.alphaCutoff!==void 0?f.alphaCutoff:.5));f.normalTexture!==void 0&&g!==b("ThreeJS.r93").MeshBasicMaterial&&(i.push(c.assignTexture(h,"normalMap",f.normalTexture.index)),h.normalScale=new(b("ThreeJS.r93").Vector2)(1,1),f.normalTexture.scale!==void 0&&h.normalScale.set(f.normalTexture.scale,f.normalTexture.scale));f.occlusionTexture!==void 0&&g!==b("ThreeJS.r93").MeshBasicMaterial&&(i.push(c.assignTexture(h,"aoMap",f.occlusionTexture.index)),f.occlusionTexture.strength!==void 0&&(h.aoMapIntensity=f.occlusionTexture.strength));f.emissiveFactor!==void 0&&g!==b("ThreeJS.r93").MeshBasicMaterial&&(h.emissive=new(b("ThreeJS.r93").Color)().fromArray(f.emissiveFactor));f.emissiveTexture!==void 0&&g!==b("ThreeJS.r93").MeshBasicMaterial&&i.push(c.assignTexture(h,"emissiveMap",f.emissiveTexture.index));return b("Promise").all(i).then(function(){var a;g===b("ThreeJS.r93").ShaderMaterial?a=d[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(h):a=new g(h);f.name!==void 0&&(a.name=f.name);a.normalScale&&(a.normalScale.y=-a.normalScale.y);a.map&&(a.map.encoding=b("ThreeJS.r93").sRGBEncoding);a.emissiveMap&&(a.emissiveMap.encoding=b("ThreeJS.r93").sRGBEncoding);a.specularMap&&(a.specularMap.encoding=b("ThreeJS.r93").sRGBEncoding);f.extras&&(a.userData=f.extras);f.extensions&&C(d,a,f);return a})};function O(a,b,c){var d=b.attributes;for(var e in d){var f=w[e],g=c[d[e]];if(!f)continue;if(f in a.attributes)continue;a.addAttribute(f,g)}b.indices!==void 0&&!a.index&&a.setIndex(c[b.indices]);b.targets!==void 0&&D(a,b.targets,c);b.extras!==void 0&&(a.userData=b.extras)}N.prototype.loadGeometries=function(a){var c=this,d=this.extensions,f=this.primitiveCache,g=M(a),h;g&&(h=a,a=[a[0]]);return this.getDependencies("accessor").then(function(i){var j=[];for(var k=0,l=a.length;k<l;k++){var m=a[k],n=I(f,m);if(n)j.push(n);else if(m.extensions&&m.extensions[e.KHR_DRACO_MESH_COMPRESSION]){n=d[e.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(m,c).then(function(a){O(a,m,i);return a});f.push({primitive:m,promise:n});j.push(n)}else{var o=new(b("ThreeJS.r93").BufferGeometry)();O(o,m,i);n=b("Promise").resolve(o);f.push({primitive:m,promise:n});j.push(n)}}return b("Promise").all(j).then(function(l){if(g){var m=l[0],d=c.multiPassGeometryCache,j=K(d,m,h);if(j!==null)return[j.geometry];var k=new(b("ThreeJS.r93").BufferGeometry)();k.name=m.name;k.userData=m.userData;for(var n in m.attributes)k.addAttribute(n,m.attributes[n]);for(var n in m.morphAttributes)k.morphAttributes[n]=m.morphAttributes[n];var o=[],p=0;for(var e=0,f=h.length;e<f;e++){var q=i[h[e].indices];for(var r=0,s=q.count;r<s;r++)o.push(q.array[r]);k.addGroup(p,q.count,e);p+=q.count}k.setIndex(o);d.push({geometry:k,baseGeometry:m,primitives:h});return[k]}else if(l.length>1&&b("ThreeJS.r93").BufferGeometryUtils!==void 0){for(var e=1,f=a.length;e<f;e++)if(a[0].mode!==a[e].mode)return l;var d=c.multiplePrimitivesCache,j=J(d,l);if(j){if(j.geometry!==null)return[j.geometry]}else{var k=b("ThreeJS.r93").BufferGeometryUtils.mergeBufferGeometries(l,!0);d.push({geometry:k,baseGeometries:l});if(k!==null)return[k]}}return l})})};N.prototype.loadMesh=function(a){var c=this;this.json;var d=this.extensions,f=this.json.meshes[a];return this.getMultiDependencies(["accessor","material"]).then(function(g){var h=f.primitives,i=[];for(var j=0,k=h.length;j<k;j++)i[j]=h[j].material===void 0?B():g.materials[h[j].material];return c.loadGeometries(h).then(function(k){var l=k.length===1&&k[0].groups.length>0,m=[];for(var g=0,j=k.length;g<j;g++){var n=k[g],o=h[g],q,r=l?i:i[g];if(o.mode===p.TRIANGLES||o.mode===p.TRIANGLE_STRIP||o.mode===p.TRIANGLE_FAN||o.mode===void 0)q=f.isSkinnedMesh===!0?new(b("ThreeJS.r93").SkinnedMesh)(n,r):new(b("ThreeJS.r93").Mesh)(n,r),o.mode===p.TRIANGLE_STRIP?q.drawMode=b("ThreeJS.r93").TriangleStripDrawMode:o.mode===p.TRIANGLE_FAN&&(q.drawMode=b("ThreeJS.r93").TriangleFanDrawMode);else if(o.mode===p.LINES)q=new(b("ThreeJS.r93").LineSegments)(n,r);else if(o.mode===p.LINE_STRIP)q=new(b("ThreeJS.r93").Line)(n,r);else if(o.mode===p.LINE_LOOP)q=new(b("ThreeJS.r93").LineLoop)(n,r);else if(o.mode===p.POINTS)q=new(b("ThreeJS.r93").Points)(n,r);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+o.mode);Object.keys(q.geometry.morphAttributes).length>0&&E(q,f);q.name=f.name||"mesh_"+a;k.length>1&&(q.name+="_"+g);f.extras!==void 0&&(q.userData=f.extras);m.push(q);o=l?q.material:[q.material];var s=n.attributes.color!==void 0,t=n.attributes.normal===void 0,u=q.isSkinnedMesh===!0,v=Object.keys(n.morphAttributes).length>0,w=v&&n.morphAttributes.normal!==void 0;for(var x=0,y=o.length;x<y;x++){var r=o[x];if(q.isPoints){var z="PointsMaterial:"+r.uuid,A=c.cache.get(z);A||(A=new(b("ThreeJS.r93").PointsMaterial)(),b("ThreeJS.r93").Material.prototype.copy.call(A,r),A.color.copy(r.color),A.map=r.map,A.lights=!1,c.cache.add(z,A));r=A}else if(q.isLine){var z="LineBasicMaterial:"+r.uuid;A=c.cache.get(z);A||(A=new(b("ThreeJS.r93").LineBasicMaterial)(),b("ThreeJS.r93").Material.prototype.copy.call(A,r),A.color.copy(r.color),A.lights=!1,c.cache.add(z,A));r=A}if(s||t||u||v){var z="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(z+="specular-glossiness:");u&&(z+="skinning:");s&&(z+="vertex-colors:");t&&(z+="flat-shading:");v&&(z+="morph-targets:");w&&(z+="morph-normals:");A=c.cache.get(z);A||(A=r.isGLTFSpecularGlossinessMaterial?d[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),u&&(A.skinning=!0),s&&(A.vertexColors=b("ThreeJS.r93").VertexColors),t&&(A.flatShading=!0),v&&(A.morphTargets=!0),w&&(A.morphNormals=!0),c.cache.add(z,A));r=A}o[x]=r;r.aoMap&&n.attributes.uv2===void 0&&n.attributes.uv!==void 0&&n.addAttribute("uv2",new(b("ThreeJS.r93").BufferAttribute)(n.attributes.uv.array,2));r.isGLTFSpecularGlossinessMaterial&&(q.onBeforeRender=d[e.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}q.material=l?o:o[0]}if(m.length===1)return m[0];z=new(b("ThreeJS.r93").Group)();for(var g=0,j=m.length;g<j;g++)z.add(m[g]);return z})})};N.prototype.loadCamera=function(a){var c;a=this.json.cameras[a];var d=a[a.type];if(!d)return;a.type==="perspective"?c=new(b("ThreeJS.r93").PerspectiveCamera)(b("ThreeJS.r93").Math.radToDeg(d.yfov),d.aspectRatio||1,d.znear||1,d.zfar||2e6):a.type==="orthographic"&&(c=new(b("ThreeJS.r93").OrthographicCamera)(d.xmag/-2,d.xmag/2,d.ymag/2,d.ymag/-2,d.znear,d.zfar));a.name!==void 0&&(c.name=a.name);a.extras&&(c.userData=a.extras);return b("Promise").resolve(c)};N.prototype.loadSkin=function(a){a=this.json.skins[a];var c={joints:a.joints};return a.inverseBindMatrices===void 0?b("Promise").resolve(c):this.getDependency("accessor",a.inverseBindMatrices).then(function(a){c.inverseBindMatrices=a;return c})};N.prototype.loadAnimation=function(a){this.json;var c=this.json.animations[a];return this.getMultiDependencies(["accessor","node"]).then(function(d){var e=[];for(var f=0,g=c.channels.length;f<g;f++){var h=c.channels[f],i=c.samplers[h.sampler];if(i){h=h.target;var j=h.node!==void 0?h.node:h.id,k=c.parameters!==void 0?c.parameters[i.input]:i.input,l=c.parameters!==void 0?c.parameters[i.output]:i.output;k=d.accessors[k];l=d.accessors[l];var m=d.nodes[j];if(m){m.updateMatrix();m.matrixAutoUpdate=!0;var n;switch(x[h.path]){case x.weights:n=b("ThreeJS.r93").NumberKeyframeTrack;break;case x.rotation:n=b("ThreeJS.r93").QuaternionKeyframeTrack;break;case x.position:case x.scale:default:n=b("ThreeJS.r93").VectorKeyframeTrack;break}var p=m.name?m.name:m.uuid,q=i.interpolation!==void 0?y[i.interpolation]:b("ThreeJS.r93").InterpolateLinear,r=[];x[h.path]===x.weights?m.traverse(function(a){a.isMesh===!0&&a.morphTargetInfluences&&r.push(a.name?a.name:a.uuid)}):r.push(p);for(var m=0,p=r.length;m<p;m++){var s=new n(r[m]+"."+x[h.path],b("ThreeJS.r93").AnimationUtils.arraySlice(k.array,0),b("ThreeJS.r93").AnimationUtils.arraySlice(l.array,0),q);i.interpolation==="CUBICSPLINE"&&(s.createInterpolant=function(a){return new o(this.times,this.values,this.getValueSize()/3,a)},s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0);e.push(s)}}}}var j=c.name!==void 0?c.name:"animation_"+a;return new(b("ThreeJS.r93").AnimationClip)(j,void 0,e)})};N.prototype.loadNode=function(a){this.json;var c=this.extensions,d=this.json.meshReferences,f=this.json.meshUses,g=this.json.nodes[a];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(a){var h;if(g.isBone===!0)h=new(b("ThreeJS.r93").Bone)();else if(g.mesh!==void 0){var i=a.meshes[g.mesh];h=i.clone();if(i.isGroup===!0)for(var j=0,k=i.children.length;j<k;j++){var l=i.children[j];l.material&&l.material.isGLTFSpecularGlossinessMaterial===!0&&(h.children[j].onBeforeRender=l.onBeforeRender)}else i.material&&i.material.isGLTFSpecularGlossinessMaterial===!0&&(h.onBeforeRender=i.onBeforeRender);d[g.mesh]>1&&(h.name+="_instance_"+f[g.mesh]++)}else if(g.camera!==void 0)h=a.cameras[g.camera];else if(g.extensions&&g.extensions[e.KHR_LIGHTS]&&g.extensions[e.KHR_LIGHTS].light!==void 0){l=c[e.KHR_LIGHTS].lights;h=l[g.extensions[e.KHR_LIGHTS].light]}else h=new(b("ThreeJS.r93").Object3D)();g.name!==void 0&&(h.name=b("ThreeJS.r93").PropertyBinding.sanitizeNodeName(g.name));g.extras&&(h.userData=g.extras);g.extensions&&C(c,h,g);if(g.matrix!==void 0){j=new(b("ThreeJS.r93").Matrix4)();j.fromArray(g.matrix);h.applyMatrix(j)}else g.translation!==void 0&&h.position.fromArray(g.translation),g.rotation!==void 0&&h.quaternion.fromArray(g.rotation),g.scale!==void 0&&h.scale.fromArray(g.scale);return h})};N.prototype.loadScene=function(){function a(c,d,e,f,g){var h=f[c];c=e.nodes[c];if(c.skin!==void 0){var i=h.isGroup===!0?h.children:[h];for(var j=0,k=i.length;j<k;j++){var l=i[j],m=g[c.skin],n=[],o=[];for(var p=0,q=m.joints.length;p<q;p++){var r=m.joints[p];r=f[r];if(r){n.push(r);r=new(b("ThreeJS.r93").Matrix4)();m.inverseBindMatrices!==void 0&&r.fromArray(m.inverseBindMatrices.array,p*16);o.push(r)}}l.bind(new(b("ThreeJS.r93").Skeleton)(n,o),l.matrixWorld)}}d.add(h);if(c.children){r=c.children;for(var j=0,k=r.length;j<k;j++){p=r[j];a(p,h,e,f,g)}}}return function(c){var d=this.json,f=this.extensions,g=this.json.scenes[c];return this.getMultiDependencies(["node","skin"]).then(function(c){var h=new(b("ThreeJS.r93").Scene)();g.name!==void 0&&(h.name=g.name);g.extras&&(h.userData=g.extras);g.extensions&&C(f,h,g);var i=g.nodes||[];for(var j=0,k=i.length;j<k;j++)a(i[j],h,d,c.nodes,c.skins);if(g.extensions&&g.extensions[e.KHR_LIGHTS]&&g.extensions[e.KHR_LIGHTS].light!==void 0){c=f[e.KHR_LIGHTS].lights;h.add(c[g.extensions[e.KHR_LIGHTS].light])}return h})}}();return c}(),e.exports=GLTFLoader}),null);
__d("GLTFLoader.r93.patch",["GLTFLoader.r93"],(function(a,b,c,d,e,f){e.exports.patch=function(){return b("GLTFLoader.r93")}}),null);
__d("Asset3DLoaderAdapter",["Promise","GLTFLoader.r93.patch"],(function(a,b,c,d,e,f){b("GLTFLoader.r93.patch").patch(),e.exports=function(){"use strict";function a(a){this.$1=a}var c=a.prototype;c.load=function(a){var c=this;if(!a.uri)return b("Promise").reject({error:"Not a valid uri"});var d=new(b("Promise"))(function(b,d){var e=setTimeout(function(){d(new Error("Loader timed out"))},1e3*20);c.$1.load(a.uri,function(a){clearTimeout(e),b(a)},function(){},function(a){clearTimeout(e),b({error:a})})});return d};c.parse=function(a){var c=this;return new(b("Promise"))(function(b,d){c.$1.parse(a,"",function(a){b(a)},function(){},function(a){b({error:a})})})};return a}()}),null);
__d("Asset3DLoaderFactory",["Asset3DLoader","Asset3DLoaderAdapter","GLTFLoader.r93.patch"],(function(a,b,c,d,e,f){var g=b("GLTFLoader.r93.patch").patch();e.exports={make:function(a){switch(a){default:return new(b("Asset3DLoader"))(new(b("Asset3DLoaderAdapter"))(new g()),{retryDelay:1e3,timesOfRetry:10})}}}}),null);
__d("SceneViewer.react",["cx","React","SceneRenderer","SocialVRThreeJS"],(function(a,b,c,d,e,f,g){var h=b("React");b("SocialVRThreeJS").Camera;b("SocialVRThreeJS").Scene;var i=new(b("SceneRenderer"))();a=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.shouldComponentUpdate=function(a){return!0};c.componentDidMount=function(){var a=this.props.viewportInfo,b=a.height;a=a.width;this.$1=this.refs.canvas.getContext("2d");this.$2(a,b);this.$3()};c.$3=function(){var a=this.props,b=a.camera,c=a.scene,d=a.viewportInfo;a=a.onRenderFailed;var e=this.$1;e&&i.isValid()?i.render(e,c,b,d):a&&a()};c.render=function(){var a=this.props.viewportInfo,b=a.height;a=a.width;this.$4(a,b);this.$3();return h.jsx("canvas",{ref:"canvas",className:"_6dax"})};c.$4=function(a,b){var c=this.refs.canvas;c&&(c.width!==Math.round(a)||c.height!==Math.round(b))&&this.$2(a,b)};c.$2=function(a,b){var c=this.refs.canvas;c.width=Math.round(a);c.height=Math.round(b)};return b}(h.Component);e.exports=a}),null);
__d("Asset3dFeedViewerModalContainer.react",["cx","AnimatedCameraMotion","Asset3DModalViewerStore","Asset3DViewerHelper","EventListener","FDSCloseButton.react","React","UIPagelet","ge","rxjs","SceneViewer.react","SocialVRThreeJS","Spotlight.react"],(function(a,b,c,d,e,f,g){"use strict";a=b("AnimatedCameraMotion").withAnimatedCameraMotion;c=b("Asset3DModalViewerStore").withStore;var h=b("React");b("rxjs").Subscription;var i=a(b("SceneViewer.react"));b("SocialVRThreeJS").Camera;b("SocialVRThreeJS").Scene;d=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.state={cameraPos:null,lookAtPos:null};d.$2=function(){d.props.onExit()};var e=c.store,f=c.viewportInfo,g=c.asset3DInfo;d.$1=e.on("pointerPos").subscribe(function(a){var c=a.x;a=a.y;var e=g.horizontalFov,h=g.verticalFov,i=f.width,j=f.height;c=b("Asset3DViewerHelper").getCameraViewParams(c,a,i,j,e,h);a=c.cameraPos;i=c.lookAtPos;d.setState({lookAtPos:i,cameraPos:a})});return d}var d=c.prototype;d.componentDidMount=function(){var a=this.props.store;b("EventListener").listen(this.refs.contentContainer,"mousemove",function(b){var c=b.offsetX;b=b.offsetY;a.set("pointerPos")({x:c,y:b})});this.setupFeedback()};d.componentWillUnmount=function(){this.$1.unsubscribe()};d.render=function(){var a=this,c=this.props,d=c.scene,e=c.camera;c=c.viewportInfo;var f=this.state,g=f.cameraPos;f=f.lookAtPos;var j=c.height;return h.jsxs(b("Spotlight.react"),{onHide:this.$2,shown:!0,rootClassName:"_6gen",children:[h.jsx("div",{className:"_6gdn",children:h.jsx(b("FDSCloseButton.react"),{onClick:function(){return a.$2()},size:"large"})}),h.jsx("div",{className:"_n3",children:h.jsxs("div",{className:"_6iy4",style:{height:c.height},children:[h.jsx("div",{ref:"contentContainer",tabIndex:0,children:h.jsx(i,{toLookAtPos:f,toCameraPos:g,scene:d,camera:e,viewportInfo:c})}),h.jsx("div",{style:{height:j,overflowY:"auto"},className:"_6iy5",id:"pagelet_asset3d_viewer"})]})})]})};d.setupFeedback=function(){b("UIPagelet").loadFromEndpoint("Asset3DViewerPagelet",b("ge")("pagelet_asset3d_viewer",this.root),{storyID:this.props.storyID})};return c}(h.Component);e.exports=c(d)}),null);
__d("VertexAlphaMaterial",["ThreeJS.r93"],(function(a,b,c,d,e,f){var g=!1;a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(c){c=a.call(this,c)||this;c.name="CustomVertexAlphaShader";c.vertexShader="#include <common>\n          #include <skinning_pars_vertex>\n          #include <clipping_planes_pars_vertex>\n          #include <fog_pars_vertex>\n          attribute vec4 color;\n          varying vec4 colorAlpha;\n          void main(void) {\n            #include <skinbase_vertex>\n            #include <begin_vertex>\n            #include <skinning_vertex>\n            #include <project_vertex>\n            #include <worldpos_vertex>\n            #include <clipping_planes_vertex>\n            #include <fog_vertex>\n            colorAlpha = color;\n          }";c.fragmentShader="#include <common>\n          #include <fog_pars_fragment>\n          #include <clipping_planes_pars_fragment>\n          uniform float opacity;\n          varying vec4 colorAlpha;\n          void main(void) {\n            #include <clipping_planes_fragment>\n            gl_FragColor = colorAlpha;\n            gl_FragColor.a *= opacity;\n            #include <fog_fragment>\n            #include <premultiplied_alpha_fragment>\n            "+(g?"gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);":"")+"\n          }";c.uniforms.fogColor={value:new(b("ThreeJS.r93").Color)()};c.uniforms.fogNear={value:0};c.uniforms.fogFar={value:0};c.uniforms.fogDensity={value:0};c.uniforms.opacity={value:1};return c}return c}(b("ThreeJS.r93").ShaderMaterial);e.exports=a}),null);
__d("Asset3dThreeJsHelpers",["ThreeJS.r93","VertexAlphaMaterial"],(function(a,b,c,d,e,f){"use strict";a={onModelLoad:function(a){a.traverse(function(a){if(a.isMesh){a=a;if(!a.geometry.isBufferGeometry)return;var c=a.material;c.map&&c.map.isTexture&&c.map.anisotropy===1&&(c.map.anisotropy=4);var d=a.geometry;d=d.getAttribute("color");var e=!1;if(d&&d.itemSize===4){for(var f=0,g=3;f<d.count;f++,g+=4)if(d.array[g]<1){e=!0;break}e&&(c=new(b("VertexAlphaMaterial"))({flatShading:c.flatShading,skinning:c.skinning,transparent:c.transparent,morphTargets:c.morphTargets,fog:!0,clipping:!0}));c.needsUpdate=!0;a.material=c}}})}};e.exports=a}),null);
__d("Asset3dTurntableCameraControl",["Asset3dCameraControl","Ease","SocialVRThreeJS","SphericalViewportControl","Tween","degToRad","radToDeg","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";var g=b("degToRad")(-70),h=b("degToRad")(100),i=1.2,j=.01,k=30,l=.95,m=.1,n=10,o=.15,p=270,q=50,r=.05,s=.001,t=6.5,u=1.2,v=Object.freeze({FAKE_GYRO_INITIAL:"fake_gyro_initial",FOCUS_STATE:"focus_state",FAKE_GYRO_AFTER_FOCUS:"fake_gyro_after_focus"});a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g,h){var i;i=a.call(this,c,d,f,g,h)||this;i.$Asset3dTurntableCameraControl1=new(b("SocialVRThreeJS").Object3D)();i.$Asset3dTurntableCameraControl2=new(b("SocialVRThreeJS").Object3D)();i.$Asset3dTurntableCameraControl3=new(b("SocialVRThreeJS").Vector3)();i.$Asset3dTurntableCameraControl4=new(b("SocialVRThreeJS").Vector3)();i.$Asset3dTurntableCameraControl5=new(b("SocialVRThreeJS").Object3D)();i.$Asset3dTurntableCameraControl9=0;i.$Asset3dTurntableCameraControl10=!1;i.$Asset3dTurntableCameraControl12=v.FAKE_GYRO_INITIAL;i.$Asset3dTurntableCameraControl15=null;i.__updateResetCamera=function(){var a=i.__sphericalViewportControl.getOrientation();Math.abs(a.x-i.__initialOrientation.x)>180&&(a.x>i.__initialOrientation.x?a.x-=360:a.x+=360);i.__sphericalViewportControl.setSphericalOrientation(a.x+r*(i.__initialOrientation.x-a.x),a.y+r*(i.__initialOrientation.y-a.y));var c=i.__camera.position;c.set(c.x+r*(i.__cameraInitialPosition.x-c.x),c.y+r*(i.__cameraInitialPosition.y-c.y),c.z+r*(i.__cameraInitialPosition.z-c.z));var d=i.__cameraTarget;d.set(d.x+r*(i.__cameraInitialTarget.x-d.x),d.y+r*(i.__cameraInitialTarget.y-d.y),d.z+r*(i.__cameraInitialTarget.z-d.z));i.$Asset3dTurntableCameraControl1.position.x+=r*(i.$Asset3dTurntableCameraControl13-i.$Asset3dTurntableCameraControl1.position.x);i.$Asset3dTurntableCameraControl2.position.y+=r*(i.$Asset3dTurntableCameraControl14-i.$Asset3dTurntableCameraControl2.position.y);var e=Math.abs(a.x);a=Math.abs(a.y);var f=Math.abs(c.x-i.__cameraInitialPosition.x),g=Math.abs(c.y-i.__cameraInitialPosition.y);c=Math.abs(c.z-i.__cameraInitialPosition.z);var h=Math.abs(d.x-i.__cameraInitialTarget.x),j=Math.abs(d.y-i.__cameraInitialTarget.y);d=Math.abs(d.z-i.__cameraInitialTarget.z);(e>s||a>s||f>s||g>s||c>s||h>s||j>s||d>s)&&i.$Asset3dTurntableCameraControl15?i.$Asset3dTurntableCameraControl15=b("requestAnimationFrame")(i.__updateResetCamera):i.$Asset3dTurntableCameraControl15=null};i.__camera.name="Turntable Camera";i.$Asset3dTurntableCameraControl5.add(i.__camera);e.add(i.$Asset3dTurntableCameraControl5);i.$Asset3dTurntableCameraControl11=new(b("Tween"))();return i}var d=c.prototype;d.setupViewportListeners=function(){var a=this,c={enableGyro:!0,slipFactor:o,enableRubberBanding:!1,disableAutoClientSizeUpdate:!0,enableZoomWithShiftKey:!0,enablePanningWithRightMouse:!0},d={expansionCoef:1.01,fieldOfView:q,initialHeading:p,initialPitch:0,projectionType:"flat"};this.__sphericalViewportControl=new(b("SphericalViewportControl"))(this.__canvas,d,c);this.__sphericalViewportControl.updateViewportClientSize({width:this.__width,height:this.__height});this.__sphericalViewportControl.addListener("viewportChange",function(c,d,e){a.__yaw=b("degToRad")(c),a.__pitch=b("degToRad")(-d),a.$Asset3dTurntableCameraControl12===v.FOCUS_STATE&&(a.__pitch=Math.min(b("degToRad")(45),Math.max(a.__pitch,b("degToRad")(-45)))),a.setDirty(!0)});this.__sphericalViewportControl.addListener("DOM/click",function(b){a.__canvas.dispatchEvent(new CustomEvent("DOM/click"))});this.__sphericalViewportControl.addListener("mouseMove",function(b){a.$Asset3dTurntableCameraControl10&&(a.__sphericalViewportControl.setMovementPosition(b),a.$Asset3dTurntableCameraControl10=!1),a.setDirty(!0),a.__renderingControl.startRenderingLoop()});this.__sphericalViewportControl.addListener("wheelScrollWithShiftKey",function(b,c){a.setDirty(!0);a.$Asset3dTurntableCameraControl15=null;var d=a.__camera.position.length();b>0?d<a.$Asset3dTurntableCameraControl7&&(a.$Asset3dTurntableCameraControl16((1-1/l)*c.x,(1/l-1)*c.y),a.__camera.position.divideScalar(l),a.$Asset3dTurntableCameraControl1.position.divideScalar(l),a.$Asset3dTurntableCameraControl2.position.divideScalar(l)):b<0&&(d>a.$Asset3dTurntableCameraControl6&&(a.$Asset3dTurntableCameraControl16((1-l)*c.x,(l-1)*c.y),a.__camera.position.multiplyScalar(l),a.$Asset3dTurntableCameraControl1.position.multiplyScalar(l),a.$Asset3dTurntableCameraControl2.position.multiplyScalar(l)))});this.__sphericalViewportControl.addListener("panningWithRightMouse",function(b){a.$Asset3dTurntableCameraControl16(-b.x,b.y),a.setDirty(!0),a.$Asset3dTurntableCameraControl15=null});this.__sphericalViewportControl.addListener("updateViewportMoveStart",function(b){a.$Asset3dTurntableCameraControl15=null});this.__sphericalViewportControl.addListener("updateViewportMove",function(b){a.$Asset3dTurntableCameraControl11.stop(),a.setDirty(!0)});this.__sphericalViewportControl.addListener("updateViewportEnd",function(c,d){a.$Asset3dTurntableCameraControl8=d,a.$Asset3dTurntableCameraControl9=c,a.$Asset3dTurntableCameraControl12===v.FOCUS_STATE&&(a.$Asset3dTurntableCameraControl12=v.FAKE_GYRO_AFTER_FOCUS,a.__sphericalViewportControl.setSphericalOrientation(b("radToDeg")(a.__yaw),b("radToDeg")(-a.__pitch)),a.__sphericalViewportControl.setAngularVelocityScaleFactor({x:1,y:1}),a.__sphericalViewportControl.reEnableGyro(),a.$Asset3dTurntableCameraControl10=!0),a.$Asset3dTurntableCameraControl17()});this.__sphericalViewportControl.addListener("onMovementStart",function(b){a.$Asset3dTurntableCameraControl15=null,a.$Asset3dTurntableCameraControl11.stop(),a.setDirty(!0),a.$Asset3dTurntableCameraControl12!==v.FOCUS_STATE&&(a.$Asset3dTurntableCameraControl12=v.FOCUS_STATE,a.__sphericalViewportControl.setAngularVelocityScaleFactor({x:t,y:u}))})};d.modelLoad=function(a,c){c===void 0;this.setDirty(!0);c=null;var d=null;a.traverse(function(a){a.name==="FB_Post_Camera"?c=a:a.name==="FB_Post_Target"&&(d=a)});if(c&&d){c.updateMatrixWorld();d.updateMatrixWorld();var e=new(b("SocialVRThreeJS").Vector3)().setFromMatrixPosition(c.matrixWorld),f=new(b("SocialVRThreeJS").Vector3)().setFromMatrixPosition(d.matrixWorld);this.__cameraTarget.copy(f);this.__camera.near=c.near;this.__camera.far=c.far;this.__camera.fov=c.fov;e.sub(f);f=e.length();e.normalize();var g=Math.asin(e.y);e=Math.atan2(e.x,e.z);this.__sphericalViewportControl.setRelativeSphericalOrientation(b("radToDeg")(e),b("radToDeg")(g))}else{e=new(b("SocialVRThreeJS").Box3)().setFromObject(a);g=new(b("SocialVRThreeJS").Vector3)();a=e.getSize(g).length();e.getCenter(this.__cameraTarget);this.__camera.near=a*j;this.__camera.far=a*k;this.__camera.aspect=1;f=a*i}this.$Asset3dTurntableCameraControl6=m*f;this.$Asset3dTurntableCameraControl7=n*f;this.$Asset3dTurntableCameraControl5.position.copy(this.__cameraTarget);this.__camera.position.set(0,0,f);this.$Asset3dTurntableCameraControl2.position.y=2*f*Math.tan(b("degToRad")(this.__camera.fov*.5));this.$Asset3dTurntableCameraControl1.position.x=this.$Asset3dTurntableCameraControl2.position.y*this.__camera.aspect;this.$Asset3dTurntableCameraControl5.add(this.$Asset3dTurntableCameraControl1);this.$Asset3dTurntableCameraControl5.add(this.$Asset3dTurntableCameraControl2);this.__camera.updateProjectionMatrix();this.__initialOrientation=this.__sphericalViewportControl.getOrientation();this.__cameraInitialTarget=this.__cameraTarget.clone();this.__cameraInitialPosition=this.__camera.position.clone();this.$Asset3dTurntableCameraControl14=this.$Asset3dTurntableCameraControl2.position.y;this.$Asset3dTurntableCameraControl13=this.$Asset3dTurntableCameraControl1.position.x};d.update=function(a){if(!this.isDirty())return;a=g+h*(1-a);a=this.__pitch+a;var b=-this.__yaw,c=-.001*Math.cos(a)*Math.cos(b),d=.001*Math.sin(a);a=-.001*Math.cos(a)*Math.sin(b);this.$Asset3dTurntableCameraControl5.position.set(c+this.__cameraTarget.x,d+this.__cameraTarget.y,a+this.__cameraTarget.z);this.$Asset3dTurntableCameraControl5.lookAt(this.__cameraTarget)};d.$Asset3dTurntableCameraControl16=function(a,b){var c=this.$Asset3dTurntableCameraControl3,d=this.$Asset3dTurntableCameraControl4;c.set(0,0,0);this.$Asset3dTurntableCameraControl5.updateMatrixWorld();d.setFromMatrixPosition(this.$Asset3dTurntableCameraControl1.matrixWorld);d.sub(this.__cameraTarget);c.addScaledVector(d,a);d.setFromMatrixPosition(this.$Asset3dTurntableCameraControl2.matrixWorld);d.sub(this.__cameraTarget);c.addScaledVector(d,b);this.__cameraTarget.add(c);this.$Asset3dTurntableCameraControl5.position.add(c)};d.$Asset3dTurntableCameraControl17=function(){var a=this;this.$Asset3dTurntableCameraControl12===v.FAKE_GYRO_INITIAL&&this.$Asset3dTurntableCameraControl11.start(function(c,d){a.setDirty(!0);d=b("Tween").scale(a.$Asset3dTurntableCameraControl9,a.__initialOrientation.x,c);c=b("Tween").scale(a.$Asset3dTurntableCameraControl8,a.__initialOrientation.y,c);a.__sphericalViewportControl.setSphericalOrientation(d,c)},2e3,b("Ease").makePowerIn(3))};d.resetCamera=function(){this.$Asset3dTurntableCameraControl15||(this.$Asset3dTurntableCameraControl15=b("requestAnimationFrame")(this.__updateResetCamera))};d.destroy=function(){a.prototype.destroy.call(this),this.$Asset3dTurntableCameraControl11.stop,this.__sphericalViewportControl&&this.__sphericalViewportControl.destroy()};d.resizeCanvas=function(a,b){this.__sphericalViewportControl&&this.__sphericalViewportControl.updateViewportClientSize({width:a,height:b})};return c}(b("Asset3dCameraControl"));e.exports=a}),null);
__d("VrHtmlToImageDataURLLoader",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=document.createElement("canvas")}a.getInstance=function(){a.singleVrHtmlToImageDataURLLoader||(a.singleVrHtmlToImageDataURLLoader=new a());return a.singleVrHtmlToImageDataURLLoader};var b=a.prototype;b.loadHtml=function(b,c,d,e,f){c=a.WORLD_TO_PIXELS*c;d=a.WORLD_TO_PIXELS*d;b='<svg xmlns="http://www.w3.org/2000/svg" background-color="blue" width="'+c+'" height="'+d+'"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="height:100%;width:100%; xbackground:green;">'+b+"</div></foreignObject></svg>";b=encodeURIComponent(b);e.onload=this.$2.bind(this,e,f,c,d);e.src="data:image/svg+xml,"+b};b.$2=function(a,b,c,d){var e=this.$1.getContext("2d");this.$1.width=c;this.$1.height=d;e.clearRect(0,0,this.$1.width,this.$1.height);e.drawImage(a,0,0);b(this.$1.toDataURL("image/png"))};b.loadPicture=function(a,b,c){b.crossOrigin="Anonymous",b.onload=this.$3.bind(this,b,c),b.src=a};b.$3=function(a,b){var c=this.$1.getContext("2d");this.$1.width=a.width;this.$1.height=a.height;c.clearRect(0,0,this.$1.width,this.$1.height);c.drawImage(a,0,0);b(this.$1.toDataURL("image/png"))};return a}();a.WORLD_TO_PIXELS=1024;a.singleVrHtmlToImageDataURLLoader=null;e.exports=a}),null);
__d("Asset3dVr3DofZoomNuxText",["SocialVRThreeJS","VrHtmlToImageDataURLLoader"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$3=new Image();this.$4=new Image();this.$2=new((a=b("SocialVRThreeJS")).Texture)();this.$2.image=this.$3;this.$2.wrapS=a.RepeatWrapping;this.$2.wrapT=a.RepeatWrapping;this.$2.repeat.x=1;this.$2.repeat.y=1;this.$5=new a.Mesh(new a.PlaneGeometry(this.$1.width,this.$1.height,32),new a.MeshBasicMaterial({map:this.$2,transparent:!0,depthWrite:!1,opacity:0}));this.$5.name="nuxTextMesh";this.$6()}var c=a.prototype;c.model=function(){return this.$5};c.$6=function(){var a=this,c=(this.$1.height*b("VrHtmlToImageDataURLLoader").WORLD_TO_PIXELS-8)/6,d=c-2;d='<div style="height:100%;padding:4px;text-align:center;font-family:Helvetica, Arial, sans-serif;font-size:'+d+"px;line-height:"+c+'px;">';d+="<div><b>"+this.$1.headerText.toString()+"</b></div>";d+='<div style="padding-top: '+c/2+'px;">'+this.$1.bodyText.toString()+"</div>";d+="</div>";b("VrHtmlToImageDataURLLoader").getInstance().loadHtml(d,this.$1.width,this.$1.height,this.$4,function(b){a.$3.onload=function(){a.$2.needsUpdate=!0},a.$3.src=b})};return a}();e.exports=a}),null);
__d("ThreeJsHelpers",["SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";a={createRoundedCorneredPlane:function(a,c,d,e){e=new(b("SocialVRThreeJS").Shape)();var f=-a/2,g=-c/2;e.moveTo(f,g+d);e.lineTo(f,g+c-d);e.quadraticCurveTo(f,g+c,f+d,g+c);e.lineTo(f+a-d,g+c);e.quadraticCurveTo(f+a,g+c,f+a,g+c-d);e.lineTo(f+a,g+d);e.quadraticCurveTo(f+a,g,f+a-d,g);e.lineTo(f+d,g);e.quadraticCurveTo(f,g,f,g+d);return new(b("SocialVRThreeJS").ShapeBufferGeometry)(e)},disposeModel:function(a){a.traverse(function(a){a.isMesh&&(a.geometry&&a.geometry.dispose(),a.material&&(Object.values(a.material).forEach(function(a){a instanceof b("SocialVRThreeJS").Texture&&a.dispose()}),a.material.dispose()))})},createAnimationGroup:function(a){var c=new(b("SocialVRThreeJS").AnimationObjectGroup)();a.traverse(function(a){a.isMesh&&c.add(a)});return c}};e.exports=a}),null);
__d("VrFadeAnimation",["SocialVRThreeJS"],(function(a,b,c,d,e,f){var g=1;a=function(){"use strict";function a(a,c){this.$2=new(b("SocialVRThreeJS").Clock)();this.$1=new(b("SocialVRThreeJS").AnimationMixer)(a);var d=[];c.forEach(function(a){if(a.objectNames)a.objectNames.forEach(function(c){c=new(b("SocialVRThreeJS").NumberKeyframeTrack)(c+".material.opacity",a.times,a.opacities,b("SocialVRThreeJS").InterpolateLinear);d.push(c)});else{var c=new(b("SocialVRThreeJS").NumberKeyframeTrack)(".material.opacity",a.times,a.opacities,b("SocialVRThreeJS").InterpolateLinear);d.push(c)}});this.$3=new(b("SocialVRThreeJS").AnimationClip)("fadeAnimation",-1,d)}var c=a.prototype;c.start=function(){this.$1.clipAction(this.$3).play().setLoop(b("SocialVRThreeJS").LoopOnce,g),this.$2.start()};c.stop=function(){this.$1.clipAction(this.$3).stop(),this.$2.stop()};c.update=function(){this.$1.update(this.$2.getDelta())};c.isRunning=function(){return this.$1.clipAction(this.$3).isRunning()};return a}();e.exports=a}),null);
__d("Asset3DVr3ZoomNux",["fbt","Asset3dVr3DofZoomNuxText","SocialVRThreeJS","ThreeJsHelpers","VrFadeAnimation"],(function(a,b,c,d,e,f,g){"use strict";var h=.75,i=.375,j=42,k=13,l=4,m=120,n=280,o=m*k,p=1e3;a=function(){function a(a){this.$1=a;this.$7=!1;this.$5=null;this.$2=new((a=b("SocialVRThreeJS")).Mesh)(b("ThreeJsHelpers").createRoundedCorneredPlane(h,i,.025),new a.MeshBasicMaterial({color:"white",depthWrite:!1,transparent:!0,opacity:0}));this.$2.name="nuxMesh";var c=h*.6,d=i*.75;this.$6=new(b("Asset3dVr3DofZoomNuxText"))({headerText:g._("Zoom"),bodyText:g._("Slide your thumb up or down on your controller's trackpad to zoom in or out"),width:c,height:d});c=this.$6.model();d=h*.1;c.translateX(d);this.$2.add(c);c=new a.TextureLoader().load(this.$1.textureURI);c.wrapS=a.RepeatWrapping;c.wrapT=a.RepeatWrapping;c.repeat.x=m/o;c.repeat.y=1;var e=i*.95,f=e*m/n;this.$3=new a.Mesh(new a.PlaneGeometry(f,e,1),new a.MeshBasicMaterial({colorWrite:!0,depthWrite:!1,map:c,transparent:!0,opacity:0}));this.$3.name="controllerMesh";this.$3.translateX(-(h-f)/2+d/2);this.$2.add(this.$3);e=[{times:[0,.5,4,5],opacities:[0,.25,.25,0],objectNames:[this.$2.name]},{times:[0,.75,1,4,5],opacities:[0,1,1,1,0],objectNames:[this.$3.name,this.$6.model().name]}];this.$4=new(b("VrFadeAnimation"))(this.$2,e)}var c=a.prototype;c.model=function(){return this.$2};c.size=function(){var a=new(b("SocialVRThreeJS").Box3)().setFromObject(this.model()),c=new(b("SocialVRThreeJS").Vector3)();a.getSize(c);return c};c.$8=function(){this.$7=!0,this.$3.material.map.offset.x=0,this.$5={nextFrameTime:Date.now()+p,nextframeNumber:0,frameCount:0},this.$4.start()};c.onRender=function(){this.$7||this.$8();this.$4&&this.$4.update();var a=this.$5;if(a&&a.frameCount<=k*l){var b=Date.now();if(b>a.nextFrameTime){b=this.$3.material.map;b.offset.x=a.nextframeNumber*b.repeat.x;b=Math.floor(a.frameCount/k);b%2===0?a.nextframeNumber+=1:a.nextframeNumber-=1;a.frameCount+=1;a.nextFrameTime+=j}}};return a}();e.exports=a}),null);
__d("XAsset3DVrStoryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/3d/vrstory/",{post_id:{type:"FBID",required:!0}})}),null);
__d("Asset3dVrStoryFetcher",["invariant","Promise","Asset3dThreeJsHelpers","XAsset3DVrStoryController","XAsyncRequest","GLTFLoader.r93.patch","SocialVRThreeJS"],(function(a,b,c,d,e,f,g){"use strict";b("GLTFLoader.r93.patch").patch();a={sendPhotoRequest:function(a,c){var d=b("XAsset3DVrStoryController").getURIBuilder();d.setFBID("post_id",String(a));d=d.getURI();var e=new(b("XAsyncRequest"))();e.setURI(d);e.setMethod("GET");e.setReadOnly(!0);return new(b("Promise"))(function(d,f){e.setHandler(function(e){var h=e.payload;if(c!=null){e=h.glbURI;e||g(0,13154);c.load(e,function(c){var e=c.userData;c=c.scene;b("Asset3dThreeJsHelpers").onModelLoad(c);d({userData:e,model:c,storyProps:h.storyProps,photoID:a.toString()})},null,function(){f("LoadGLTFError")})}else d({userData:null,model:null,storyProps:h.storyProps,photoID:a.toString()})}).setErrorHandler(function(){f("FetchStoryError")}),e.send()})}};e.exports=a}),null);
__d("XAsset3DVrNavigationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/3d/vrnavigation/",{original_creation_time:{type:"Int",required:!0},cursor:{type:"String"},feed_type:{type:"Enum",required:!0,enumType:1}})}),null);
__d("Asset3dPhotoVrNavigator",["invariant","Promise","Asset3dVrStoryFetcher","XAsset3DVrNavigationController","XAsyncRequest","GLTFLoader.r93.patch"],(function(a,b,c,d,e,f,g){"use strict";var h=b("GLTFLoader.r93.patch").patch(),i=6;a=function(){function a(a){this.$1=new h(),this.$3=a.creationTime,this.$2=a.feedType,this.__nextCursor=null,this.__currentPostIds=[],this.__nextPostIds=null,this.__currentNextIndex=0,this.__fetchNextPromise=null,this.__atEndOfFeed=!1,this.__fetchNextProps()}var c=a.prototype;c.feedType=function(){return this.$2};c.atEndOfFeed=function(){return this.__atEndOfFeed};c.__isCurrentIndexOutsideOfFetchBoundary=function(){return this.__currentPostIds.length-this.__currentNextIndex<i};a.__sendNextIdsRequest=function(a,c,d){var e=b("XAsset3DVrNavigationController").getURIBuilder();e.setInt("original_creation_time",a);e.setEnum("feed_type",c);d&&e.setString("cursor",d);a=e.getURI();var f=new(b("XAsyncRequest"))();f.setURI(a);f.setMethod("GET");f.setReadOnly(!0);return new(b("Promise"))(function(a,b){f.setHandler(function(b){b=b.payload.nextProps;a(b)}).setErrorHandler(function(){b("FetchNextIdsError")}),f.send()})};c.__fetchNextProps=function(){var c=this;if(this.__fetchNextPromise===null&&(this.__currentPostIds.length===0||this.__isCurrentIndexOutsideOfFetchBoundary()&&this.__nextPostIds===null))if(this.__atEndOfFeed)this.__fetchNextPromise=b("Promise").reject("FetchingPastEndOfFeedError");else{var d=a.__sendNextIdsRequest(this.$3,this.$2,this.__nextCursor);this.__fetchNextPromise=d.then(function(a){a?(c.__nextPostIds=a.nextPostIds,c.__nextCursor=a.nextCursor,c.__atEndOfFeed=!a.hasNext):(c.__nextPostIds=null,c.__nextCursor=null,c.__atEndOfFeed=!0),c.__fetchNextPromise=null},function(a){c.__fetchNextPromise=null;c.__atEndOfFeed=!0;return b("Promise").reject(a)})}if(this.__fetchNextPromise&&this.__currentNextIndex===this.__currentPostIds.length)return this.__fetchNextPromise;else return b("Promise").resolve()};c.fetchNextPhoto=function(){var a=this;return this.__fetchNextProps().then(function(){return a.__fetchPhoto()},function(a){return b("Promise").reject(a)})};c.__fetchPhoto=function(){var a=this;this.__currentNextIndex===this.__currentPostIds.length&&(this.__currentNextIndex=0,this.__nextPostIds||g(0,13056),this.__currentPostIds=this.__nextPostIds,this.__nextPostIds=null);var c=this.__currentPostIds[this.__currentNextIndex];this.__currentNextIndex+=1;return b("Asset3dVrStoryFetcher").sendPhotoRequest(c,this.$1).then(function(b){var c=a.__currentNextIndex===a.__currentPostIds.length&&a.__atEndOfFeed;return babelHelpers["extends"]({atEndOfFeed:c},b)})};return a}();e.exports=a}),null);
__d("Asset3dVrRoundButton",["SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$2=new((a=b("SocialVRThreeJS")).Mesh)(new a.CircleGeometry(this.$1.radius,64),new a.MeshBasicMaterial({colorWrite:!0,depthWrite:!1}));this.$2.frustumCulled=!1;this.$3=new a.Mesh(new a.CircleGeometry(this.$1.textureRadius,64),new a.MeshBasicMaterial({colorWrite:!0,depthWrite:!1,transparent:!0}));this.$3.frustumCulled=!1;this.$2.add(this.$3)}var c=a.prototype;c.model=function(){return this.$2};c.hitTest=function(a){a=a.intersectObject(this.$2,!1);return a.length>0};c.setColor=function(a){this.$2.material.color=a};c.setTexture=function(a){this.$3.material.map=a};return a}();e.exports=a}),null);
__d("Asset3dVrRoundButtonManager",["Asset3dVrRoundButton","SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$9=!1;this.$2=new((a=b("SocialVRThreeJS")).Color)(this.$1.color);this.$3=new a.Color(this.$1.hoverColor);this.$4=new a.Color(this.$1.clickColor);this.$6=new a.TextureLoader().load(this.$1.textureURI);this.$6.wrapS=a.RepeatWrapping;this.$6.wrapT=a.RepeatWrapping;this.$6.repeat.x=1;this.$6.repeat.y=1;this.$7=new a.TextureLoader().load(this.$1.hoveredTextureURI);this.$7.wrapS=a.RepeatWrapping;this.$7.wrapT=a.RepeatWrapping;this.$7.repeat.x=1;this.$7.repeat.y=1;this.$8=new a.TextureLoader().load(this.$1.clickTextureURI);this.$8.wrapS=a.RepeatWrapping;this.$8.wrapT=a.RepeatWrapping;this.$8.repeat.x=1;this.$8.repeat.y=1;this.$5=new(b("Asset3dVrRoundButton"))(this.$1.buttonProps);this.$5.setColor(this.$2);this.$5.setTexture(this.$6)}var c=a.prototype;c.model=function(){return this.$5.model()};c.show=function(){this.model().visible=!0};c.hide=function(){this.model().visible=!1};c.onRender=function(a){var b=a.isPressed();a=this.$5.hitTest(a.rayCaster());a?b?(this.$5.setColor(this.$3),this.$5.setTexture(this.$7)):(this.$5.setColor(this.$4),this.$5.setTexture(this.$8)):(this.$5.setColor(this.$2),this.$5.setTexture(this.$6));a&&this.$9&&!b&&this.$1.onClick();this.$9=b};return a}();e.exports=a}),null);
__d("WebXRController",["SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d){this.__hand=a,this.__controllerListener=c,this.$3=new(b("SocialVRThreeJS").Vector3)(),this.$2=new(b("SocialVRThreeJS").Quaternion)(),this.$5={},this.$4=d}var c=a.prototype;c.update=function(a,b){var c=!1;for(var d=b.session.inputSources,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;if(g.targetRaySpace){var h=b.getPose(g.targetRaySpace,a.vr.getReferenceSpace());g.handedness===this.__hand&&(this.__pose=h,this.$1=g.gamepad,c=!0)}}c||(this.__pose=void 0)};c.axes=function(){return this.__axes};c.orientation=function(){var a=null;if(this.__pose&&this.isValid()){var b=this.__pose.transform.orientation;b&&(this.$2.set(b.x,b.y,b.z,b.w),a=this.$2)}return a};c.position=function(){var a=null;if(this.__pose&&this.isValid()){var b=this.__pose.transform.position;this.__pose.transform.position&&(this.$3.set(b.x,b.y,b.z),a=this.$3)}return a};c.hand=function(){return this.__hand};c.isValid=function(){return this.__pose!==void 0};c.hasButtonPressed=function(){return this.isValid()&&this.$1?this.__hasButtonPressed(this.$1):!1};c.__hasButtonPressed=function(a){a=a.buttons;for(var b=0;b<a.length;b++)if(a[b].pressed)return!0;return!1};c.__dectButtonPressed=function(a){var b=this;this.$4.forEach(function(c){var d=!1;if(a.id===c.gampadId){var e=a.buttons;d=c.buttonIndex>0&&c.buttonIndex<e.length&&e[c.buttonIndex].pressed}e=b.$5[c];d&&!e&&b.__controllerListener({controller:b,eventType:c.eventType});b.$5[c]=d})};return a}();e.exports=a}),null);
__d("GetXRFromNavigator",[],(function(a,b,c,d,e,f){"use strict";a=function(){return navigator.xr};e.exports=a}),null);
__d("WebVrTimeTracker",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){var a=this;this.$2=0;window.addEventListener("vrdisplayblur",function(){a.stopTime()});window.addEventListener("vrdisplayfocus",function(){a.startTime()})}var b=a.prototype;b.reset=function(){this.$1=null,this.$2=0};b.startTime=function(){this.$1===null&&(this.$1=Date.now())};b.stopTime=function(){var a=this.$1;a=a!==null&&a!==void 0?Date.now()-a:0;this.$1=null;this.$2+=a;return this.$2};return a}();e.exports=a}),null);
__d("WebXRManager",["invariant","Promise","GetXRFromNavigator","WebVrTimeTracker","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=function(){a.getInstance=function(){a.$1==null&&(a.$1=new a());return a.$1};function a(){var c=this;this.$6=[];this.$15=function(){c.$3=null,c.$12()};this.$16=function(){c.$2&&c.$2.onVrFocusChange&&c.$2.onVrFocusChange()};a.$1===null||g(0,11125);this.$8=!1;this.$4=!1;this.$3=null;this.$5=null;this.$7=new(b("WebVrTimeTracker"))();this.$10();var d=b("GetXRFromNavigator")();d&&(d.addEventListener("devicechange",function(a){c.$10()}),d.addEventListener("sessiongranted",function(a){c.$11()}));document.addEventListener("visibilitychange",function(){document.visibilityState!=="visible"&&(c.$12(),b("promiseDone")(c.exitVr()))})}var c=a.prototype;c.setDeeplinkProps=function(a){this.$9=a};c.isDeepLink=function(){return this.$8};c.addXRSupportListener=function(a){this.$6.push(a),a(this.$4)};c.removeXRSupportListener=function(a){a=this.$6.indexOf(a);a>=0&&this.$6.splice(a,1)};c.$13=function(){var a=this;this.$6.forEach(function(b){b(a.$4)})};c.$10=function(){var a=this,c=b("GetXRFromNavigator")();c&&c.isSessionSupported?b("promiseDone")(b("Promise").resolve(c.isSessionSupported("immersive-vr").then(function(b){a.$4=b,a.$13()}))):this.$4=!1};c.$14=function(a){a.addEventListener("end",this.$15),a.addEventListener("visibilitychange",this.$16),this.$3=a,this.$17()};c.$11=function(){var a=this;this.$2&&this.$2.onVrFocusChange&&this.$2.onVrFocusChange();var b=this.$9;if(b){var c={onVrEnter:function(){a.$8=!0,b.onVrDeepLink()},onVrExit:function(){},vrAttributes:b.vrAttributes,vrCanvas:b.vrCanvas};this.enterVr(c)}};c.enterVr=function(a){var c=this;if(!this.$4)return b("Promise").resolve();if(this.$3!==null){this.$12();this.$2=a;this.$17();return b("Promise").resolve()}this.$2=a;a=b("GetXRFromNavigator")();return!a?b("Promise").resolve():a.requestSession("immersive-vr").then(function(a){c.$14(a);return b("Promise").resolve()})["catch"](function(a){})};c.$17=function(){var a=this.$2;a||g(0,10938);this.$7.reset();this.$7.startTime();if(!this.$3)return;var b=this.$3;a.onVrEnter(b)};c.exitVr=function(){this.$4&&this.$3!==null&&this.$3!==void 0&&this.$3.end();return b("Promise").resolve()};c.$12=function(){this.$8=!1;var a=this.$2;if(a){var b=this.$7.stopTime();this.$7.reset();a.onVrExit(b);this.$2=null}};c.inVr=function(){return this.$3!==null};c.getXRFrame=function(){return this.$5};c.getXRSession=function(){return this.$3};c.render=function(a,b){if(this.inVr()){var c=this.$2;c||g(0,10939);c=c.onVrRender;c||g(0,11325);this.$5=b;c(a,b)}};return a}();a.$1=null;e.exports=a}),null);
__d("Asset3dVrViewer",["invariant","SocialVRThreeJS","ThreeJsHelpers","WebXRController","WebXRManager","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=500,i=5592405;a=function(){function a(a){this.__frameData=null;this.__helperEuler=new(b("SocialVRThreeJS").Euler)();this.__helperVector3=new(b("SocialVRThreeJS").Vector3)();this.__helperQuaternion=new(b("SocialVRThreeJS").Quaternion)();this.__helperArray=[];this.__navigationProps=null;var c=[{gampadId:"Oculus Touch (Right)",buttonIndex:4,eventType:"quit"},{gampadId:"Oculus Touch",buttonIndex:4,eventType:"quit"}];this.__leftController=new(b("WebXRController"))("left",this.__onControllerEvent.bind(this),c);this.__rightController=new(b("WebXRController"))("right",this.__onControllerEvent.bind(this),c);this.$2=a?[]:[{type:"position",warningUpperLimit:.15,warningLowerLimit:-.15,upperLimit:.3,lowerLimit:-.3,arrayIndex:0},{type:"position",warningUpperLimit:.15,warningLowerLimit:-.15,upperLimit:.3,lowerLimit:-.3,arrayIndex:1},{type:"position",warningUpperLimit:.45,warningLowerLimit:-.75,upperLimit:.6,lowerLimit:-1,arrayIndex:2},{type:"orientation",eulerOrder:"YXZ",warningUpperLimit:b("SocialVRThreeJS").Math.degToRad(20),warningLowerLimit:b("SocialVRThreeJS").Math.degToRad(-20),upperLimit:b("SocialVRThreeJS").Math.degToRad(45),lowerLimit:b("SocialVRThreeJS").Math.degToRad(-45),arrayIndex:1}];this.__warningValue=0;this.__clearColor=new(b("SocialVRThreeJS").Color)(i);this.__isAutoRecenteringEnabled=!0;this.__scene=new(b("SocialVRThreeJS").Scene)();c=new(b("SocialVRThreeJS").AmbientLight)(13421772,.5);this.__scene.add(c);this.__vrCamera=new(b("SocialVRThreeJS").PerspectiveCamera)(75,1,.1,2e3);this.__vrCameraPositionAnchor=new(b("SocialVRThreeJS").Object3D)();this.__vrCameraPositionAnchor.add(this.__vrCamera);this.__vrCameraOrientationAnchor=new(b("SocialVRThreeJS").Object3D)();this.__vrCameraOrientationAnchor.add(this.__vrCameraPositionAnchor)}var c=a.prototype;c.setup=function(a,b,c,d,e){this.__model=a,this.__storyProps=b,this.__photoID=c,this.__navigationProps=d,this.__userData=e};c.__setupScene=function(){this.__scene.add(this.__model),this.__isAutoRecentering=!1};c.onExitVr=function(){this.__destroyScene()};c.__destroyScene=function(){this.__scene.remove(this.__model),b("ThreeJsHelpers").disposeModel(this.__model),this.__model=null,this.__isAutoRecentering=!1};c.render=function(a){};c.__render=function(a){this.__frameData=b("WebXRManager").getInstance().getXRFrame();if(!this.__frameData)return;var c=this.__frameData;this.__detectAutoRecenter();this.__recenter(a.vr.getReferenceSpace());this.__leftController.update(a,c);this.__rightController.update(a,c)};c.markNeedsRecentering=function(){this.__applyFrameOrientation=!0};c.__detectAutoRecenter=function(){var a=this;if(this.__isAutoRecenteringEnabled){this.__warningValue=0;if(this.__isAutoRecentering){var b=this.$1;b||g(0,5387);var c=Date.now();c-b>h&&(this.$1=null,this.__isAutoRecentering=!1,this.__applyFrameOrientation=!0)}else this.__vrCamera.getWorldPosition(this.__helperVector3),this.__vrCamera.getWorldQuaternion(this.__helperQuaternion),this.$2.some(function(b,c){b.type==="orientation"?(a.__helperEuler.setFromQuaternion(a.__helperQuaternion,b.eulerOrder),a.__helperEuler.toArray(a.__helperArray)):a.__helperVector3.toArray(a.__helperArray);b.arrayIndex>=0&&b.arrayIndex<a.__helperArray.length||g(0,5388);c=a.__helperArray[b.arrayIndex];var d=0;if(c<b.lowerLimit||c>b.upperLimit){a.$1=Date.now();a.__isAutoRecentering=!0;return!0}else c<b.warningLowerLimit?d=(c-b.warningLowerLimit)/(b.lowerLimit-b.warningLowerLimit):c>b.warningUpperLimit&&(d=(c-b.warningUpperLimit)/(b.upperLimit-b.warningUpperLimit));d>a.__warningValue&&(a.__warningValue=d);return!1})}};c.__recenter=function(a){if(!this.__frameData)return;a=this.__frameData.getViewerPose(a);if(this.__frameData&&a&&this.__applyFrameOrientation){this.__applyFrameOrientation=!1;if(a.transform.position){var b=a.transform.position;this.__helperVector3.set(b.x,b.y,b.z);this.__vrCameraPositionAnchor.position.copy(this.__helperVector3.negate());this.__vrCameraPositionAnchor.updateMatrixWorld(!0)}if(a.transform.orientation){b=a.transform.orientation;this.__helperQuaternion.set(b.x,b.y,b.z,b.w);this.__helperEuler.setFromQuaternion(this.__helperQuaternion,"YXZ");this.__vrCameraOrientationAnchor.rotation.y=-this.__helperEuler.y;this.__vrCameraOrientationAnchor.updateMatrixWorld(!0)}}};c.__onControllerEvent=function(a){switch(a.eventType){case"quit":b("promiseDone")(b("WebXRManager").getInstance().exitVr());break}};return a}();e.exports=a}),null);
__d("OculusArmModel",["SocialVRThreeJS"],(function(a,b,c,d,e,f){var g=b("SocialVRThreeJS").Matrix4,h=b("SocialVRThreeJS").Quaternion,i=b("SocialVRThreeJS").Vector3,j=60*Math.PI/180,k=new i(0,0,1),l=new i(1,0,0),m=new i(0,1,0),n=new h(1,0,0,0),o=new i(1,1,1),p=new h(0,0,0,1),q=function(){"use strict";function a(a,b){this.$1=a.clone(),this.$2=b.clone(),this.$3=new g(),this.$3.compose(this.$1,this.$2,o)}var b=a.prototype;b.setPosition=function(a){this.$1.copy(a),this.$3.setPosition(a)};b.setPositionFromValues=function(a,b,c){this.$1.set(a,b,c),this.$3.setPosition(this.$1)};b.setOrientation=function(a){this.$2.copy(a),this.$3.makeRotationFromQuaternion(a),this.$3.setPosition(this.$1)};b.getPosition=function(){return this.$1};b.getOrientation=function(){return this.$2};b.getMatrix=function(){return this.$3};return a}(),r=function(a,b){"use strict";this.parent=a,this.transform=b};a=function(){"use strict";function a(a){var b=this;a===void 0&&(a="right");a=a==="left"?-1:1;this.$11={neck:new r(null,new q(new i(-.1,.5,0),p)),clavicle:new r("neck",new q(new i(a*.2286,0,0),p)),shoulder:new r("clavicle",new q(new i(0,-.2441,.02134),p)),elbow:new r("shoulder",new q(new i(0,0,-.3048),p)),wrist:new r("elbow",new q(new i(0,0,-.0762),p)),hand:new r("wrist",new q(new i(0,.0381,-.0381),p))};this.$13=["neck","clavicle","shoulder","elbow","wrist","hand"];this.$12={};Object.keys(this.$11).forEach(function(a){b.$12[a]=new g()});this.$1=new q(k,n);this.$2=new q(k,n);this.$3=new q(k,n);this.$4=new h();this.$5=new h();this.$6=new h();this.$7=new h();this.$8=new i();this.$9=new i();this.$10=new i();this.computeWorldTransforms()}var b=a.prototype;b.setHeadPosition=function(a){this.$1.setPosition(a)};b.setHeadOrientation=function(a){this.$1.setOrientation(a)};b.setControllerOrientation=function(a){this.$2.setOrientation(a)};b.getPose=function(){return this.$2};b.update=function(){this.$5.setFromRotationMatrix(this.$1.getMatrix());this.$5.set(this.$5.w,0,this.$5.y,0);this.$5.normalize();this.$3.setPosition(this.$1.getPosition());this.$3.setOrientation(this.$5);this.$4.copy(this.$2.getOrientation());this.$6.set(this.$4.w,0,this.$4.y,0);this.$6.normalize();this.$8.copy(k).applyQuaternion(this.$5);this.$10.copy(k).applyQuaternion(this.$6);var a=this.$8.angleTo(this.$10);if(a>j){this.$9.copy(l).applyQuaternion(this.$5);var b=Math.sign(this.$10.dot(this.$9));a=(a-j)*-b;this.$7.setFromAxisAngle(m,a);this.$4.copy(this.$7.multiply(this.$4))}b=this.$5.inverse().multiply(this.$4);a=n.slerp(b,.6);b=n.slerp(b,.4);this.$11.shoulder.transform.setOrientation(a);this.$11.elbow.transform.setOrientation(b);this.computeWorldTransforms()};b.computeWorldTransforms=function(){var a=this;this.$13.forEach(function(b){var c=a.$11[b];c.parent!==null&&c.parent!==void 0?a.$12[b].copy(a.$12[c.parent]):a.$12[b].copy(a.$3.getMatrix());a.$12[b].multiply(c.transform.getMatrix())});this.$2.setPositionFromValues(this.$12.hand.elements[12],this.$12.hand.elements[13],this.$12.hand.elements[14])};return a}();e.exports=a}),null);
__d("VrCursor",["OculusArmModel","SocialVRThreeJS"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$14=null;this.$2=null;this.$13=!1;this.$6=new((a=b("SocialVRThreeJS")).Euler)();this.$7=new a.Vector3();this.$8=new a.Quaternion();this.$11=new a.Quaternion();this.$12=new a.Vector3();this.$5=new a.Raycaster();this.$9=new a.Color(this.$1.circleColor);this.$10=new a.Color(this.$1.circlePressedColor);this.$3=new a.Vector3(0,0,-1);this.$4=new a.Object3D();this.$1.worldAnchor.add(this.$4);this.$15=new(b("OculusArmModel"))("right");this.$16=new(b("OculusArmModel"))("left");this.$17();this.$18()}var c=a.prototype;c.wandModel=function(){return this.$14};c.cursorCircleModel=function(){return this.$2};c.$17=function(){this.$2=new(b("SocialVRThreeJS").Mesh)(new(b("SocialVRThreeJS").CircleGeometry)(this.$1.circleRadius,64),new(b("SocialVRThreeJS").MeshBasicMaterial)({colorWrite:!0,depthWrite:!0,color:this.$9}));var a=this.$1.circleImageURL;if(a!==null){var c;a=new((c=b("SocialVRThreeJS")).TextureLoader)().load(a);a.wrapS=c.RepeatWrapping;a.wrapT=c.RepeatWrapping;a.repeat.x=1;a.repeat.y=1;this.$2.add(new c.Mesh(new c.CircleGeometry(this.$1.circleRadius*1.1,64),new c.MeshBasicMaterial({colorWrite:!0,depthWrite:!0,color:this.$9,map:a,transparent:!0})))}};c.$19=function(){var a=document.createElement("canvas");a.width=1024;a.height=32;var c=a.getContext("2d"),d=c.createLinearGradient(0,0,1024,0);d.addColorStop(0,"rgba(255, 255, 255, 0.9)");d.addColorStop(1,"rgba(255, 255, 255, 0)");c.fillStyle=d;c.fillRect(0,0,1024,32);d=new(b("SocialVRThreeJS").Texture)(a);d.needsUpdate=!0;c=new(b("SocialVRThreeJS").MeshBasicMaterial)({map:d,transparent:!0});return c};c.$18=function(){var a,c=new((a=b("SocialVRThreeJS")).Geometry)();c.vertices.push(new a.Vector3(-.01,.01,0),new a.Vector3(.01,.01,0),new a.Vector3(.01,.01,-1),new a.Vector3(-.01,.01,-1),new a.Vector3(-.01,-.01,0),new a.Vector3(.01,-.01,0),new a.Vector3(.01,-.01,-1),new a.Vector3(-.01,-.01,-1));c.faces.push(new a.Face3(0,1,3),new a.Face3(1,2,3),new a.Face3(1,5,2),new a.Face3(5,6,2),new a.Face3(5,4,6),new a.Face3(4,7,6),new a.Face3(4,0,7),new a.Face3(0,3,7));var d=[new a.Vector2(0,1),new a.Vector2(0,0),new a.Vector2(1,0),new a.Vector2(1,1)];c.faceVertexUvs[0][0]=[d[0],d[1],d[3]];c.faceVertexUvs[0][1]=[d[1],d[2],d[3]];c.faceVertexUvs[0][2]=[d[0],d[1],d[3]];c.faceVertexUvs[0][3]=[d[1],d[2],d[3]];c.faceVertexUvs[0][4]=[d[0],d[1],d[3]];c.faceVertexUvs[0][5]=[d[1],d[2],d[3]];c.faceVertexUvs[0][6]=[d[0],d[1],d[3]];c.faceVertexUvs[0][7]=[d[1],d[2],d[3]];c.verticesNeedUpdate=!0;c.elementsNeedUpdate=!0;d=new a.Mesh(c,this.$19());c=new a.Object3D();c.add(d);c.scale.fromArray([.5,.5,.5]);this.$14=new a.Object3D();this.$14.add(c)};c.$20=function(a,b,c,d,e){a===void 0&&(a=[0,0,0]);b===void 0&&(b=[0,0,0,0]);if(d)this.$4.position.copy(d),this.$4.updateMatrixWorld(!0),this.$4.getWorldPosition(this.$7),this.$4.setRotationFromQuaternion(c),this.$4.updateMatrixWorld(!0),this.$4.getWorldQuaternion(this.$8),this.$12.copy(this.$7),this.$11.copy(this.$8);else{d=e=="left"?this.$16:this.$15;this.$7.fromArray(a);d.setHeadPosition(this.$7);this.$8.fromArray(b);this.$4.setRotationFromQuaternion(this.$8);this.$4.updateMatrixWorld(!0);this.$4.getWorldQuaternion(this.$8);d.setHeadOrientation(this.$8);this.$4.setRotationFromQuaternion(c);this.$4.updateMatrixWorld(!0);this.$4.getWorldQuaternion(this.$8);d.setControllerOrientation(this.$8);d.update();this.$12.copy(d.getPose().getPosition());this.$11.copy(d.getPose().getOrientation())}};c.isPressed=function(){return this.$13};c.rayCaster=function(){return this.$5};c.show=function(){this.wandModel().visible=!0,this.cursorCircleModel().visible=!0};c.hide=function(){this.wandModel().visible=!1,this.cursorCircleModel().visible=!1};c.update=function(a,b,c,d,e,f){this.$13=e;if(c){this.$2.getWorldPosition(this.$7);e=this.$7.z;this.$20(a,b,c,d,f);this.$14.position.copy(this.$12);this.$14.setRotationFromQuaternion(this.$11);a=Math.abs(this.$12.z-e);this.$6.setFromQuaternion(this.$11,"XYZ");this.$2.position.y=this.$12.y+a*Math.tan(this.$6.x);this.$6.setFromQuaternion(this.$11,"YXZ");this.$2.position.x=this.$12.x-a*Math.tan(this.$6.y);this.$2.getWorldPosition(this.$7);this.$5.set(this.$7,this.$3);this.$13?this.$2.material.color=this.$10:this.$2.material.color=this.$9}};return a}();e.exports=a}),null);
__d("VrStoryHeader",["SocialVRThreeJS","VrHtmlToImageDataURLLoader"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d){var e=this;this.$1=d;this.$5=new Image();this.$6=new Image();this.$9=new Image();this.$2=a;this.$3=c*this.numberOfRows();this.$4=new((d=b("SocialVRThreeJS")).Texture)();this.$4.image=this.$5;this.$4.wrapS=d.RepeatWrapping;this.$4.wrapT=d.RepeatWrapping;this.$4.repeat.x=1;this.$4.repeat.y=1;this.$7=new d.Mesh(new d.PlaneGeometry(this.$2,this.$3,32),new d.MeshBasicMaterial({map:this.$4,transparent:!0,depthWrite:!1,opacity:1}));a=this.$1.owningPictureURI;a!==void 0&&a!==null&&b("VrHtmlToImageDataURLLoader").getInstance().loadPicture(a,this.$9,function(a){e.$8=a,e.$10()});this.$10()}var c=a.prototype;c.model=function(){return this.$7};c.numberOfRows=function(){var a=2;this.$1.message!==null&&(a+=1.5);return a};c.$10=function(){var a=this,c=(this.$3*b("VrHtmlToImageDataURLLoader").WORLD_TO_PIXELS-8)/this.numberOfRows(),d=c-2,e='<div style="height:100%;padding:4px;font-family:Helvetica, Arial, sans-serif;white-space:nowrap;font-size:'+d+"px;line-height:"+c+'px;">';e+='<div style="height: '+c*2+'px; width: 100%;">';e+='<div style="display:block; float: left; width:'+c*2+"px; height:"+c*2+"px;";this.$8!==void 0&&this.$8!==null&&(e+="background-image: url("+this.$8+");");e+='background-size:cover;border-radius:50%;">';e+="</div>";e+='<div style="display:block; width:auto; padding-left: '+(c*2+10)+'px; ">';this.$1.title!==void 0&&this.$1.title!==null&&(e+="<div>"+this.$1.title+"</div>");this.$1.creationTime!==void 0&&this.$1.creationTime!==null&&(e+='<div style="font-size: '+d*.8+'px;">'+this.$1.creationTime+"</div>");e+="</div>";e+="</div>";this.$1.message!==void 0&&this.$1.message!==null&&(e+='<div style="height: '+c/2+'px; width: 100%;"></div>',e+='<div style="text-overflow:ellipsis;overflow:hidden;">'+this.$1.message+"</div>");e+="</div>";b("VrHtmlToImageDataURLLoader").getInstance().loadHtml(e,this.$2,this.$3,this.$6,function(b){a.$5.onload=function(){a.$4.needsUpdate=!0},a.$5.src=b})};return a}();e.exports=a}),null);
__d("VrStoryReactions",["invariant","SocialVRThreeJS","VrHtmlToImageDataURLLoader"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,c,d){var e=this;this.$8={};this.$1=d;this.$5=new Image();this.$6=new Image();this.$2=a;this.$3=c*this.numberOfRows();this.$4=new((d=b("SocialVRThreeJS")).Texture)();this.$4.image=this.$5;this.$4.wrapS=d.RepeatWrapping;this.$4.wrapT=d.RepeatWrapping;this.$4.repeat.x=1;this.$4.repeat.y=1;this.$7=new d.Mesh(new d.PlaneGeometry(this.$2,this.$3,32),new d.MeshBasicMaterial({map:this.$4,transparent:!0,depthWrite:!1,opacity:1}));this.$1.supportedReactions&&(this.$8={},this.$1.supportedReactions.forEach(function(a){a.URI!==void 0&&a.URI!==null&&a.count!==void 0&&a.count!==null&&a.count>0&&e.$9.bind(e,a.URI)()}));this.$10()}var c=a.prototype;c.model=function(){return this.$7};c.numberOfRows=function(){return 1};c.$9=function(a){var c=this,d=new Image();b("VrHtmlToImageDataURLLoader").getInstance().loadPicture(a,d,function(b){c.$8[a]=b,c.$10()})};c.$10=function(){var a=this;this.$1.reactionsText!==void 0&&this.$1.reactionsText!==null||g(0,5802);var c=(this.$3*b("VrHtmlToImageDataURLLoader").WORLD_TO_PIXELS-8)/this.numberOfRows();c=c-2;var d='<div style="height:100%;font-family:Helvetica, Arial, sans-serif; display:flex;flex-direction:row;align-items:center">';if(this.$1.supportedReactions){d+='<div style="padding-right:20px">';var e=3,f=Object.keys(this.$8);for(var h=0;h<f.length&&h<e;h++){var i=f[h];i=this.$8[i];d+='<div style="border:2px solid white;display:inline-block;position:relative;margin-right:-10px;width:'+c+"px; height:"+c+"px;";d+="z-index: "+(f.length-h)+";";d+="background-image: url("+i+");";d+='background-size:cover;border-radius:50%;"></div>'}d+="</div>"}i=this.$1.reactionsText;i!==void 0&&i!==null&&(d+='<div style="font-size: '+c+'px; white-space: nowrap; text-overflow:ellipsis;overflow:hidden;">'+i+"</div>");d+="</div>";b("VrHtmlToImageDataURLLoader").getInstance().loadHtml(d,this.$2,this.$3,this.$6,function(b){a.$5.onload=function(){a.$4.needsUpdate=!0},a.$5.src=b})};return a}();e.exports=a}),null);
__d("VrStory",["invariant","SocialVRThreeJS","ThreeJsHelpers","VrStoryHeader","VrStoryReactions"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,c,d,e,f,h){this.$1=new(b("SocialVRThreeJS").Object3D)();this.$5=a;this.$6=d;this.$7=e;this.$8=f;d=new(b("SocialVRThreeJS").Vector3)();c.getSize(d);h.header||g(0,4805);this.$2=new(b("VrStoryHeader"))(d.x,this.$8,h.header);e=this.$2.numberOfRows()*this.$8;f=0;this.$3=null;c=h.reactions;c&&c.reactionsText!==null&&(this.$3=new(b("VrStoryReactions"))(d.x,this.$8,c),f=this.$3.numberOfRows()*this.$8);h=d.x+2*this.$6;c=d.y+3*this.$6+e+f+(f>0?this.$6:0);this.$4=d.y;h=new(b("SocialVRThreeJS").Mesh)(b("ThreeJsHelpers").createRoundedCorneredPlane(h,c,this.$7),new(b("SocialVRThreeJS").MeshBasicMaterial)({color:new(b("SocialVRThreeJS").Color)("white"),colorWrite:!0,depthWrite:!1,transparent:!0}));h.renderOrder=0;this.$1.add(h);var i=this.$2.model();i.renderOrder=2;i.position.y=0;i.translateY(c/2-this.$6-e/2);h.add(i);if(this.$3){i=this.$3.model();i.renderOrder=3;h.add(i);i.position.y=0;i.translateY(-c/2+this.$6+f/2)}this.$1.position.copy(a);h=2*this.$6+e-(c-d.y)/2;this.$1.translateY(h)}var c=a.prototype;c.model=function(){return this.$1};c.dispose=function(){b("ThreeJsHelpers").disposeModel(this.$1)};return a}();e.exports=a}),null);
__d("VrStoryUIContainer",["SocialVRThreeJS","ThreeJsHelpers","VrFadeAnimation","VrStory"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$4=new((a=b("SocialVRThreeJS")).Object3D)();this.$1.uiScene.add(this.$4);var c=this.$1.frameWidth,d=this.$1.frameHeight;this.$3=new a.Mesh(b("ThreeJsHelpers").createRoundedCorneredPlane(c,d,this.$1.frameBorderRadius),new a.MeshBasicMaterial({stencilWrite:!0,colorWrite:!1,color:new a.Color("blue"),depthWrite:!1}));this.$3.position.fromArray(this.$1.framePosition);this.$1.uiScene.add(this.$3);c=new a.Box3().setFromObject(this.$3);this.$2=new(b("VrStory"))(this.$3.position,c,this.$1.framePadding,this.$1.frameBorderRadius,this.$1.frameRowHeight,this.$1.storyCardProps);this.$4.add(this.$2.model());d=this.$1.fade;if(d){a=b("ThreeJsHelpers").createAnimationGroup(this.$4);this.$5=new(b("VrFadeAnimation"))(a,[{times:d.times,opacities:d.opacities}]);this.$5.start()}else this.$5=null}var c=a.prototype;c.move=function(a){this.$1.uiScene.position.fromArray(a),this.$1.storyScene&&this.$1.storyScene.position.fromArray(a)};c.position=function(){return[this.$1.uiScene.position.x,this.$1.uiScene.position.y,this.$1.uiScene.position.z]};c.addUICompontent=function(a,b,c){this.$4.add(a);var d=this.size(),e=this.$2.model().position.clone();switch(b){case"top":e.y+=d.y/2;break;case"bottom":e.y-=d.y/2;break;case"left":e.x-=d.x/2;break;case"right":e.x+=d.x/2;break}a.position.fromArray(c).add(e)};c.size=function(){var a=new(b("SocialVRThreeJS").Box3)().setFromObject(this.$2.model()),c=new(b("SocialVRThreeJS").Vector3)();a.getSize(c);return c};c.dispose=function(){this.$1.uiScene.remove(this.$4),this.$1.uiScene.remove(this.$3),b("ThreeJsHelpers").disposeModel(this.$4),b("ThreeJsHelpers").disposeModel(this.$3)};c.render=function(a,b){this.$5&&this.$5.isRunning()&&this.$5.update();var c=a.state.buffers.stencil,d=a.state.buffers.depth,e=a.context;this.renderFrameStencil(a,b);this.$1.storyScene&&(c.setFunc(e.EQUAL,1,255),c.setOp(e.KEEP,e.KEEP,e.KEEP),a.render(this.$1.storyScene,b));this.$3.visible=!1;this.$4.visible=!0;c.setFunc(e.NOTEQUAL,1,255);c.setOp(e.KEEP,e.KEEP,e.KEEP);d.setTest(!1);a.render(this.$1.uiScene,b);a.clearStencil();a.clearDepth();c.setTest(!1)};c.renderFrameStencil=function(a,b){var c=a.state.buffers.stencil,d=a.context;this.$3.visible=!0;this.$4.visible=!1;a.clearStencil();c.setTest(!0);c.setFunc(d.ALWAYS,1,255);c.setOp(d.REPLACE,d.REPLACE,d.REPLACE);a.render(this.$1.uiScene,b);a.clearDepth()};return a}();e.exports=a}),null);
__d("VrWorldFade",["invariant","Promise","SocialVRThreeJS","VrFadeAnimation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a;this.$6=new((a=b("SocialVRThreeJS")).Mesh)(new a.BoxGeometry(5,5,5),new a.MeshBasicMaterial({transparent:!0,colorWrite:!0,depthWrite:!1,opacity:1,color:new a.Color(this.$1.color)}));this.$6.name="fadeMesh";this.$6.material.side=a.BackSide;this.$7=new a.Scene();this.$7.add(this.$6);this.$2=new(b("VrFadeAnimation"))(this.$6,[{times:this.$1.fadeInParams.times,opacities:this.$1.fadeInParams.opacities}]);this.$3=new(b("VrFadeAnimation"))(this.$6,[{times:this.$1.fadeOutParams.times,opacities:this.$1.fadeOutParams.opacities}]);this.$4=null;this.$5=null}var c=a.prototype;c.setFade=function(a){!this.$2.isRunning()&&!this.$3.isRunning()&&(this.$6.material.opacity=a)};c.startFadeIn=function(){var a=this;this.isAnimationRunning()&&g(0,13092);this.$4===null||g(0,13098);var c=new(b("Promise"))(function(b,c){a.$2.start(),a.$4=b});return c};c.stopFadeIn=function(){this.$2.stop(),this.$4&&(this.$4(),this.$4=null)};c.startFadeOut=function(){var a=this;this.isAnimationRunning()&&g(0,13092);this.$5===null||g(0,13099);var c=new(b("Promise"))(function(b,c){a.$3.start(),a.$5=b});return c};c.stopFadeOut=function(){this.$3.stop(),this.$5&&(this.$5(),this.$5=null)};c.isAnimationRunning=function(){return this.$2.isRunning()||this.$3.isRunning()};c.isFadedIn=function(){return this.$6.material.opacity===1};c.onRender=function(a,b){var c=this.$2.isRunning(),d=this.$3.isRunning();c&&this.$2.update();d&&this.$3.update();if(c&&!this.$2.isRunning()){this.$2.stop();this.$6.material.opacity=1;c=this.$4;this.$4=null;c||g(0,13100);c()}if(d&&!this.$3.isRunning()){this.$5||g(0,13101);this.$3.stop();this.$6.material.opacity=0;c=this.$5;this.$5=null;c||g(0,13100);c()}if(this.$6.material.opacity!==0){d=a.gammaOutput;a.gammaOutput=!1;a.render(this.$7,b);a.gammaOutput=d}};return a}();e.exports=a}),null);
__d("Asset3dPhotoVrViewer",["invariant","regeneratorRuntime","Asset3dPhotoVrNavigator","Asset3DVr3ZoomNux","Asset3dVrRoundButtonManager","Asset3dVrStoryFetcher","Asset3dVrViewer","SocialVRThreeJS","VrCursor","VrStoryUIContainer","VrWorldFade","WebVrTimeTracker","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=1,i=1.3,j=.03,k=.0125,l=[0,0,-1.25],m=.045,n=1.5,o=[0,0,0],p=15922165,q=-.1,r=b("SocialVRThreeJS").Math.degToRad(45),s=.6,t=0,u=.5,v=.666489,w=16777215,x=65280,y=.0125,z=.015,A=.06,B=.022,C=16777215,D=6850196,E=9019820;a=function(a){babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this,c.disableOutOfViewDetection)||this;d.$Asset3dPhotoVrViewer1=c;d.$Asset3dPhotoVrViewer6=null;d.$Asset3dPhotoVrViewer7=null;d.$Asset3dPhotoVrViewer10=null;d.$Asset3dPhotoVrViewer8=new(b("SocialVRThreeJS").Scene)();d.$Asset3dPhotoVrViewer12=null;d.$Asset3dPhotoVrViewer13=!1;d.$Asset3dPhotoVrViewer16=new(b("WebVrTimeTracker"))();d.$Asset3dPhotoVrViewer15=0;d.$Asset3dPhotoVrViewer5=0;d.$Asset3dPhotoVrViewer17=!1;d.$Asset3dPhotoVrViewer2=!0;d.$Asset3dPhotoVrViewer3=new(b("VrWorldFade"))({color:d.__clearColor.getHex(),fadeInParams:{times:[0,.5],opacities:[0,1]},fadeOutParams:{times:[0,.5],opacities:[1,0]}});d.$Asset3dPhotoVrViewer3.setFade(0);return d}var d=c.prototype;d.$Asset3dPhotoVrViewer18=function(){var a=this.$Asset3dPhotoVrViewer7;a||g(0,12466);var c=.05,d=new(b("Asset3DVr3ZoomNux"))({textureURI:this.$Asset3dPhotoVrViewer1.imageURIs.zoomNux}),e=d.model(),f=d.size();a.addUICompontent(e,"bottom",[0,-f.y/2-c,0]);this.$Asset3dPhotoVrViewer6=d};d.onEnterVr=function(a,c){var d=this;this.$Asset3dPhotoVrViewer14=c;this.$Asset3dPhotoVrViewer17=!1;if(this.__storyProps!=null)this.$Asset3dPhotoVrViewer19(a);else{c=this.__photoID;c!=null||g(0,19973);b("promiseDone")(b("Asset3dVrStoryFetcher").sendPhotoRequest(c,null).then(function(b){d.__storyProps=b.storyProps,d.$Asset3dPhotoVrViewer19(a)}))}};d.$Asset3dPhotoVrViewer19=function(a){this.__navigationProps&&this.__navigationProps.hasNext&&(this.$Asset3dPhotoVrViewer9=new(b("Asset3dPhotoVrNavigator"))(this.__navigationProps)),this.$Asset3dPhotoVrViewer20(a),this.$Asset3dPhotoVrViewer21(),this.__applyFrameOrientation=!0,this.$Asset3dPhotoVrViewer17=!0};d.$Asset3dPhotoVrViewer21=function(){var a=this;this.$Asset3dPhotoVrViewer16.reset();this.$Asset3dPhotoVrViewer16.startTime();this.__setupScene();var c=this.__storyProps;c||g(0,19974);var d=this.$Asset3dPhotoVrViewer14;d||g(0,13176);d.logOnWebVrStoryStart(this.__photoID,c.isCurrentUserStory,this.feedType());this.$Asset3dPhotoVrViewer15+=1;d=n;if(this.__userData.FB_PHOTO_3D_DATA){var e=this.__userData.FB_PHOTO_3D_DATA.hFov<this.__userData.FB_PHOTO_3D_DATA.vFov,f=e?this.__userData.FB_PHOTO_3D_DATA.vFov:this.__userData.FB_PHOTO_3D_DATA.hFov;if(f!==void 0&&f!==null&&f!==v){var q=-l[2]/2*Math.tan(v/2);f=-l[2]/2*Math.tan(f/2);d=n*q/f}this.$Asset3dPhotoVrViewer2=e}else this.$Asset3dPhotoVrViewer2=!0;this.$Asset3dPhotoVrViewer7==null||g(0,12452);this.$Asset3dPhotoVrViewer7=new(b("VrStoryUIContainer"))({frameWidth:this.$Asset3dPhotoVrViewer2?h:i,frameHeight:this.$Asset3dPhotoVrViewer2?i:h,framePadding:j,frameBorderRadius:k,framePosition:l,frameRowHeight:m,frameClearColor:p,storyScene:this.__scene,storyCardProps:c,uiScene:this.$Asset3dPhotoVrViewer8});if(this.$Asset3dPhotoVrViewer9){this.$Asset3dPhotoVrViewer12=this.$Asset3dPhotoVrViewer9.fetchNextPhoto();q=this.$Asset3dPhotoVrViewer7;q||g(0,12538);f=new(b("VrCursor"))({circleColor:w,circlePressedColor:x,circleRadius:y,circleImageURL:this.$Asset3dPhotoVrViewer1.imageURIs.cursor,worldAnchor:this.__vrCameraPositionAnchor,intersectionZPlane:l[2]});q.addUICompontent(f.wandModel(),"bottom",[0,0,0]);q.addUICompontent(f.cursorCircleModel(),"bottom",[0,0,z]);this.$Asset3dPhotoVrViewer10=f;this.$Asset3dPhotoVrViewer11=new(b("Asset3dVrRoundButtonManager"))({buttonProps:{radius:A,textureRadius:B},textureURI:this.$Asset3dPhotoVrViewer1.imageURIs.nextButton,hoveredTextureURI:this.$Asset3dPhotoVrViewer1.imageURIs.nextButtonHovered,clickTextureURI:this.$Asset3dPhotoVrViewer1.imageURIs.nextButtonClicked,color:C,hoverColor:D,clickColor:E,onClick:function(){b("promiseDone")(a.$Asset3dPhotoVrViewer22())}});e=this.$Asset3dPhotoVrViewer11.model();c=new(b("SocialVRThreeJS").Box3)().setFromObject(e);f=new(b("SocialVRThreeJS").Vector3)();c.getSize(f);q.addUICompontent(e,"right",[f.x/2+.05,-f.y/2,0])}this.__model.scale.x=d;this.__model.scale.y=d;this.__model.position.fromArray(o)};d.$Asset3dPhotoVrViewer22=function(){var a,d,e,f,h,i,j,k;return b("regeneratorRuntime").async(function(l){while(1)switch(l.prev=l.next){case 0:a=this.$Asset3dPhotoVrViewer12;if(!(a&&!this.$Asset3dPhotoVrViewer13)){l.next=37;break}this.$Asset3dPhotoVrViewer13=!0;if(this.$Asset3dPhotoVrViewer3.isFadedIn()){l.next=6;break}l.next=6;return b("regeneratorRuntime").awrap(this.$Asset3dPhotoVrViewer3.startFadeIn());case 6:d=this.$Asset3dPhotoVrViewer9;d||g(0,13431);e=this.$Asset3dPhotoVrViewer14;e||g(0,13389);l.prev=10;l.next=13;return b("regeneratorRuntime").awrap(c.$Asset3dPhotoVrViewer23(a,d,e));case 13:f=l.sent;this.$Asset3dPhotoVrViewer24();h=f.userData;i=f.model;h!=null&&i!=null||g(0,19972);this.__storyProps=f.storyProps;this.__userData=h;this.__model=i;this.__photoID=f.photoID;this.$Asset3dPhotoVrViewer21();f.atEndOfFeed&&(j=this.$Asset3dPhotoVrViewer11,j||g(0,13267),j.hide());l.next=26;return b("regeneratorRuntime").awrap(this.$Asset3dPhotoVrViewer3.startFadeOut());case 26:l.next=36;break;case 28:l.prev=28;l.t0=l["catch"](10);l.t0==="FetchNextIdsError"?e.logOnWebVrFetchIDsError():l.t0==="FetchingPastEndOfFeedError"&&e.logOnWebVrPastEndOfFeedError();k=this.$Asset3dPhotoVrViewer11;k||g(0,13267);k.hide();l.next=36;return b("regeneratorRuntime").awrap(this.$Asset3dPhotoVrViewer3.startFadeOut());case 36:this.$Asset3dPhotoVrViewer13=!1;case 37:case"end":return l.stop()}},null,this,[[10,28]])};c.$Asset3dPhotoVrViewer23=function(a,d,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:h.prev=0;h.next=3;return b("regeneratorRuntime").awrap(a);case 3:f=h.sent;return h.abrupt("return",f);case 7:h.prev=7;h.t0=h["catch"](0);if(!(h.t0==="FetchStoryError"||h.t0==="LoadGLTFError")){h.next=15;break}h.t0==="FetchStoryError"?e.logOnWebVrFetchStoryError():e.logOnWebVrLoadGLTFError();g=d.fetchNextPhoto();return h.abrupt("return",c.$Asset3dPhotoVrViewer23(g,d,e));case 15:throw h.t0;case 16:case"end":return h.stop()}},null,this,[[0,7]])};d.$Asset3dPhotoVrViewer20=function(a){a.autoClear=!1,a.vr.autoSubmitFrame=!1,a.setClearColor(this.__clearColor,1)};d.onExitVr=function(){this.$Asset3dPhotoVrViewer24(),this.$Asset3dPhotoVrViewer9=null,this.$Asset3dPhotoVrViewer15=0};d.storyCount=function(){return this.$Asset3dPhotoVrViewer15};d.feedType=function(){return this.$Asset3dPhotoVrViewer9&&this.$Asset3dPhotoVrViewer9.feedType()};d.atEndOfFeed=function(){return this.$Asset3dPhotoVrViewer9!=null&&this.$Asset3dPhotoVrViewer9.atEndOfFeed()};d.$Asset3dPhotoVrViewer24=function(){var a=this.$Asset3dPhotoVrViewer16.stopTime();this.$Asset3dPhotoVrViewer16.reset();this.__destroyScene();var b=this.$Asset3dPhotoVrViewer14;b||g(0,13176);b.logOnWebVrStoryEnd(this.__photoID,a,this.__storyProps!=null?this.__storyProps.isCurrentUserStory:!1);b=this.$Asset3dPhotoVrViewer7;b&&(b.dispose(),this.$Asset3dPhotoVrViewer7=null);this.$Asset3dPhotoVrViewer6=null;this.$Asset3dPhotoVrViewer10=null;this.$Asset3dPhotoVrViewer11=null;this.$Asset3dPhotoVrViewer12=null};d.$Asset3dPhotoVrViewer25=function(a){if(a.emulatedPosition){this.$Asset3dPhotoVrViewer6===null&&this.storyCount()===1&&(this.__leftController.isValid()||this.__rightController.isValid())&&this.$Asset3dPhotoVrViewer18();this.$Asset3dPhotoVrViewer6!==void 0&&this.$Asset3dPhotoVrViewer6!==null&&this.$Asset3dPhotoVrViewer6.onRender();a=this.$Asset3dPhotoVrViewer7;a||g(0,12467);this.__vrCamera.getWorldQuaternion(this.__helperQuaternion);this.__helperEuler.setFromQuaternion(this.__helperQuaternion,"YXZ");var b=Math.max(-1,Math.min(1,-this.__helperEuler.y/r));this.__helperEuler.setFromQuaternion(this.__helperQuaternion,"XYZ");var c=Math.max(-1,Math.min(1,this.__helperEuler.x/r)),d=a.position();b=b*q;c=c*q;d=d[2];var e=this.__rightController.axes(),f=this.__leftController.axes();e=e?e[1]:f?f[1]:0;if(e!==0){if(this.$Asset3dPhotoVrViewer4){f=this.$Asset3dPhotoVrViewer4-e;d=Math.max(Math.min(s,f*u+d),t)}this.$Asset3dPhotoVrViewer4=e}else this.$Asset3dPhotoVrViewer4=null;this.$Asset3dPhotoVrViewer5=d;a.move([b,c,d])}};d.$Asset3dPhotoVrViewer26=function(a){var b=this.$Asset3dPhotoVrViewer10;if(b){var c=this.__rightController.isValid()?this.__rightController:this.__leftController;if(c.isValid()){b.show();var d=c.orientation(),e=c.position(),f=c.hasButtonPressed();c=c.hand();var g,h=[0,0,0];if(a){if(a.transform.orientation){var i=a.transform.orientation;g=[i.x,i.y,i.z,i.w]}if(a.transform.position){i=a.transform.position;h=[i.x,i.y,i.z]}}h[2]+=this.$Asset3dPhotoVrViewer5;b.update(h,g,d,e,f,c);a=this.$Asset3dPhotoVrViewer11;a&&a.onRender(b)}else b.hide()}};d.render=function(a){if(!this.$Asset3dPhotoVrViewer17){a.clear(!0,!0,!0);this.$Asset3dPhotoVrViewer3.setFade(1);this.$Asset3dPhotoVrViewer3.onRender(a,this.__vrCamera);a.vr.submitFrame();return}this.__isAutoRecenteringEnabled=!this.$Asset3dPhotoVrViewer13;this.__render(a);if(this.__isAutoRecentering)a.clear(!0,!0,!0);else{if(!this.__frameData)return;var b=this.__frameData.getViewerPose(a.vr.getReferenceSpace());this.$Asset3dPhotoVrViewer26(b);this.$Asset3dPhotoVrViewer25(b);a.clear(!0,!0,!0);b=this.$Asset3dPhotoVrViewer7;b||g(0,12465);b.render(a,this.__vrCamera);this.__isAutoRecenteringEnabled&&this.$Asset3dPhotoVrViewer3.setFade(this.__warningValue)}this.$Asset3dPhotoVrViewer3.onRender(a,this.__vrCamera);a.vr.submitFrame()};return c}(b("Asset3dVrViewer"));e.exports=a}),null);
__d("Asset3dVrRenderer",["invariant","Asset3dPhotoVrViewer","SocialVRThreeJS","UserAgent","WebXRManager"],(function(a,b,c,d,e,f,g){"use strict";var h=1.25;a=function(){function a(a){this.$1=a,this.$6={},b("UserAgent").isBrowser("Oculus Browser")&&(this.$4=!0,this.$6={caCorrection:!0,highRefreshRate:!0}),b("WebXRManager").getInstance().addXRSupportListener(this.onXRSupport.bind(this))}var c=a.prototype;c.onXRSupport=function(a){if(a===!0){this.$2||(this.$2=new(b("Asset3dPhotoVrViewer"))(this.$1.photoViewerProps));if(!this.$3){a=new(b("SocialVRThreeJS").WebGLRenderer)({antialias:!0,alpha:!0,preserveDrawingBuffer:!1});a.gammaOutput=!0;a.setPixelRatio(window.devicePixelRatio);b("UserAgent").isBrowser("Oculus Browser")&&a.vr.setScaling(h);this.$3=a}}else this.$3=null};c.$7=function(){this.$2&&this.$2.markNeedsRecentering()};c.$8=function(a){var c=this.$5;c||g(0,13176);c.logOnWebVrStart();var d=this.$2;d||g(0,12515);d.onEnterVr(this.$3,c);this.$3.vr.enabled=!0;a&&this.$3.vr.setSession&&(this.$3.vr.setSession(a),this.$3.vr.setAnimationLoop(function(a,c){b("WebXRManager").getInstance().render(a,c)}))};c.$9=function(a){var b=this.$2;b||g(0,12515);this.$5&&this.$5.logOnWebVrEnd(a,b.storyCount(),b.feedType(),b.atEndOfFeed());this.$5=null;this.$3.vr.enabled=!1;this.$3.clear(!0,!0,!0);b.onExitVr()};c.$10=function(){var a=this.$2;a||g(0,12515);a.render(this.$3)};c.createVrDeviceManagerProps=function(a,c,d,e,f,h,i,j,k){var l=this;c=c.clone(!0);this.$4&&c.traverse(function(a){if(a.isMesh){a=a;if(!a.geometry.isBufferGeometry)return;a=a.material;a.map&&a.map.isTexture&&(a.map.minFilter=b("SocialVRThreeJS").LinearMipMapLinearFilter)}});a=function(a){l.$2||g(0,12516),l.$2.setup(c,d,e,f,h),l.$5=i,l.$8(a),j()};var m=function(a){l.$9(a),k()};a={onVrFocusChange:this.$7.bind(this),onVrEnter:a,onVrExit:m,onVrRender:this.$10.bind(this),vrAttributes:this.$6,vrCanvas:this.$3.domElement};return a};c.createVrDeepLinkProps=function(a){var b={onVrDeepLink:function(){a()},vrAttributes:this.$6,vrCanvas:this.$3.domElement};return b};c.domElement=function(){return this.$3.domElement};return a}();e.exports=a}),null);
__d("Photo3dCameraControl",["Asset3dCameraControl","EventListener","Random","SocialVRThreeJS","degToRad","getElementRect","gkx","performanceNow","radToDeg"],(function(a,b,c,d,e,f){"use strict";var g,h=.12,i=.06,j=.925,k=.92,l=.508015513,m=.666488587,n=Object.freeze({h_photo:-.14,v_photo:-.124}),o=Object.freeze({h_photo:-.124,v_photo:-.112}),p=Object.freeze({h_photo:.112,v_photo:.12}),q=Object.freeze({h_photo:.12,v_photo:.112}),r=Object.freeze({h_photo:.7,v_photo:.6}),s=Object.freeze({h_photo:.6,v_photo:.7}),t=Object.freeze({h_photo:.96,v_photo:.8}),u=Object.freeze({h_photo:.8,v_photo:.96}),v=.01,w=1,x=.005,y=.1,z=.001,A=.4,B=.3,C=3e-4,D=6e-4,E=D/1700,F=b("degToRad")(.1),G=b("degToRad")(179.9);a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g,h){var i;g===void 0&&(g=!1);i=a.call(this,c,d,f,g,h)||this;i.$Photo3dCameraControl1=!1;i.$Photo3dCameraControl2=0;i.$Photo3dCameraControl3=0;i.$Photo3dCameraControl4=0;i.$Photo3dCameraControl5=0;i.$Photo3dCameraControl6=b("Random").random()<.5;i.$Photo3dCameraControl12=0;i.$Photo3dCameraControl13=0;i.$Photo3dCameraControl15=null;i.$Photo3dCameraControl23=function(a){i.setDirty(!0,!0);var b=Math.max(Math.min(x*(a-i.$Photo3dCameraControl16),1),0);i.$Photo3dCameraControl16=a;i.$Photo3dCameraControl2+=b*(i.$Photo3dCameraControl4-i.$Photo3dCameraControl2);i.$Photo3dCameraControl3+=b*(i.$Photo3dCameraControl5-i.$Photo3dCameraControl3);Math.abs(i.$Photo3dCameraControl2-i.$Photo3dCameraControl4)>z||Math.abs(i.$Photo3dCameraControl3-i.$Photo3dCameraControl5)>z?i.$Photo3dCameraControl15=window.requestAnimationFrame(i.$Photo3dCameraControl23):i.$Photo3dCameraControl15=null};i.$Photo3dCameraControl28=function(a){if(!i.__isInAttractMode)return;var b=a-i.$Photo3dCameraControl20;i.$Photo3dCameraControl20=a;a=A-i.$Photo3dCameraControl17;var c=Math.abs(a)<B;i.$Photo3dCameraControl17+=Math.min(C*b,.99)*a;if(c){a=i.$Photo3dCameraControl19+E*b;a<D&&(i.$Photo3dCameraControl19=a);if(i.$Photo3dCameraControl6){i.$Photo3dCameraControl18+=i.$Photo3dCameraControl19*b;while(i.$Photo3dCameraControl18>Math.PI)i.$Photo3dCameraControl18-=2*Math.PI}else{i.$Photo3dCameraControl18-=i.$Photo3dCameraControl19*b;while(i.$Photo3dCameraControl18<-Math.PI)i.$Photo3dCameraControl18+=2*Math.PI}}i.$Photo3dCameraControl2=i.$Photo3dCameraControl17*Math.cos(i.$Photo3dCameraControl18);i.$Photo3dCameraControl3=i.$Photo3dCameraControl17*Math.sin(i.$Photo3dCameraControl18);i.setDirty(!0,!1);i.__renderingControl.update();i.__attractModeAnimationFrameID=window.requestAnimationFrame(i.$Photo3dCameraControl28)};i.__camera.name="2.5D Photo Camera";e.add(i.__camera);i.$Photo3dCameraControl11=g;return i}var d=c.prototype;d.setupViewportListeners=function(){var a=this;b("EventListener").listen(this.__canvas,"mousemove",function(c){var d=c.clientX;c=c.clientY;var e=b("getElementRect")(a.__canvas);if(d>e.left&&d<e.right&&c>e.top&&c<e.bottom){var f=.5*(e.left+e.right),g=.5*(e.top+e.bottom);a.$Photo3dCameraControl4=2*(d-f)/e.width;a.$Photo3dCameraControl5=-2*(c-g)/e.height;a.$Photo3dCameraControl1=!0;a.$Photo3dCameraControl21();a.__renderingControl.startRenderingLoop()}})};d.resize=function(a,b){this.$Photo3dCameraControl22(a/b),this.setDirty(!0)};d.$Photo3dCameraControl21=function(){this.$Photo3dCameraControl15||(this.$Photo3dCameraControl16=(g||(g=b("performanceNow")))(),this.$Photo3dCameraControl15=window.requestAnimationFrame(this.$Photo3dCameraControl23))};d.modelLoad=function(a,c){c===void 0&&(c=null);this.setDirty(!0);c&&c.FB_PHOTO_3D_DATA?(this.$Photo3dCameraControl12=Math.min(Math.max(c.FB_PHOTO_3D_DATA.hFov,F),G),this.$Photo3dCameraControl13=Math.min(Math.max(c.FB_PHOTO_3D_DATA.vFov,F),G)):(this.$Photo3dCameraControl12=l,this.$Photo3dCameraControl13=m);this.$Photo3dCameraControl14=this.$Photo3dCameraControl12>this.$Photo3dCameraControl13?"h_photo":"v_photo";c=new(b("SocialVRThreeJS").Box3)().setFromObject(a);this.__camera.near=Math.max(-1-c.max.z,v);c.expandByPoint(new(b("SocialVRThreeJS").Vector3)(0,0,y));a=new(b("SocialVRThreeJS").Vector3)();this.__camera.far=c.getSize(a).length();this.__cameraTarget.set(0,0,-w);this.__camera.position.set(0,0,0);this.$Photo3dCameraControl22(this.__aspectRatio)};d.$Photo3dCameraControl22=function(a){var c=Math.tan(this.$Photo3dCameraControl12/2),d=Math.tan(this.$Photo3dCameraControl13/2),e=1;this.__hFov=this.$Photo3dCameraControl12;this.__vFov=this.$Photo3dCameraControl13;c>0&&d>0&&(e=c/d,b("gkx")("935091")&&a>0&&(e<a?(d=c/a,e=c/d,this.__vFov=Math.atan(d)*2):e>a&&(c=d*a,e=c/d,this.__hFov=Math.atan(c)*2)));this.__aspectRatio=e;this.__camera.aspect=this.__aspectRatio;this.__camera.fov=this.$Photo3dCameraControl11?b("radToDeg")(this.__vFov)*k:b("radToDeg")(this.__vFov)*j;this.__camera.updateProjectionMatrix();this.$Photo3dCameraControl7=Math.tan(this.__hFov/2)*w*this.$Photo3dCameraControl24();this.$Photo3dCameraControl8=Math.tan(this.__vFov/2)*w*this.$Photo3dCameraControl25();this.$Photo3dCameraControl9=this.$Photo3dCameraControl26();this.$Photo3dCameraControl10=this.$Photo3dCameraControl27()};d.$Photo3dCameraControl24=function(){return this.$Photo3dCameraControl11?p[this.$Photo3dCameraControl14]:n[this.$Photo3dCameraControl14]};d.$Photo3dCameraControl25=function(){return this.$Photo3dCameraControl11?q[this.$Photo3dCameraControl14]:o[this.$Photo3dCameraControl14]};d.$Photo3dCameraControl26=function(){return this.$Photo3dCameraControl11?t[this.$Photo3dCameraControl14]:r[this.$Photo3dCameraControl14]};d.$Photo3dCameraControl27=function(){return this.$Photo3dCameraControl11?u[this.$Photo3dCameraControl14]:s[this.$Photo3dCameraControl14]};d.update=function(a){if(!this.isDirty())return;var b=this.__vFov*h*(2*a-1),c=(1-2*a)*this.$Photo3dCameraControl8,d=Math.sin(this.$Photo3dCameraControl3*Math.PI*.5),e=Math.sin(this.$Photo3dCameraControl2*Math.PI*.5),f=this.__vFov*i*d,g=this.__hFov*i*e;d=-d*this.$Photo3dCameraControl8;e=-e*this.$Photo3dCameraControl7;a=Math.pow(a+.16,3)/(Math.pow(a+.16,3)+Math.pow(1-(a+.16),3))-.9;f=-(f+b);b=-g;g=w-a*y;this.__cameraTarget.set(-((1-this.$Photo3dCameraControl9)*e),-(this.$Photo3dCameraControl10*c+(1-this.$Photo3dCameraControl10)*d),-w);this.__camera.position.set(0+g*Math.cos(f)*Math.sin(b),0+g*Math.sin(f),-w+g*Math.cos(f)*Math.cos(b));this.__camera.lookAt(this.__cameraTarget);this.__camera.lookAtPosition=this.__cameraTarget};d.__exitAttractMode=function(){a.prototype.__exitAttractMode.call(this),this.$Photo3dCameraControl4=this.$Photo3dCameraControl2,this.$Photo3dCameraControl5=this.$Photo3dCameraControl3};d.__enterAttractMode=function(){a.prototype.__enterAttractMode.call(this);this.$Photo3dCameraControl15!==null&&(window.cancelAnimationFrame(this.$Photo3dCameraControl15),this.$Photo3dCameraControl15=null);var c=this.$Photo3dCameraControl2,d=this.$Photo3dCameraControl3;this.$Photo3dCameraControl17=Math.sqrt(c*c+d*d);this.$Photo3dCameraControl18=Math.atan2(d,c);this.$Photo3dCameraControl19=0;this.$Photo3dCameraControl20=(g||(g=b("performanceNow")))();this.__attractModeAnimationFrameID||(this.__attractModeAnimationFrameID=window.requestAnimationFrame(this.$Photo3dCameraControl28))};return c}(b("Asset3dCameraControl"));e.exports=a}),null);
__d("Asset3dRenderManager",["invariant","Asset3dThreeJsHelpers","Asset3dTurntableCameraControl","Asset3dVrRenderer","FixedSizedSceneRenderer","Photo3dCameraControl","SocialVRThreeJS","ThreeJsHelpers","WebXRManager"],(function(a,b,c,d,e,f,g){"use strict";var h=new(b("FixedSizedSceneRenderer"))();a=function(){function a(a,b,c,d,e,f,g,h,i){this.$6=0,this.$7=0,this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$8=e,this.$9=f,this.$5=g,this.$11=!0,this.$10=h,this.$12=i}var c=a.prototype;c.onModelLoad=function(a,c,d,e,f){f&&this.$2&&this.$3&&(this.$4.logNetworkLoadEvents(f,this.$2,this.$3),this.$4.logGlbParsingEvents(f)),this.userData=e,this.$6=c,this.$7=d,b("Asset3dThreeJsHelpers").onModelLoad(a),this.model=a,this.$13(),h.isValid()?(this.$14(),this.$15(),this.$16()):this.$10()};c.$13=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.$6,this.canvas.height=this.$7,this.context=this.canvas.getContext("2d")};c.$15=function(){this.scene&&this.canvas||g(0,549),this.cameraControl=this.$1==="photos_3d"?new(b("Photo3dCameraControl"))(this.$6,this.$7,this.scene,this.canvas,this.$5,this.$12):new(b("Asset3dTurntableCameraControl"))(this.$6,this.$7,this.scene,this.canvas,this.$5,this.$12),this.cameraControl.modelLoad(this.model,this.userData)};c.$14=function(){var a=this;this.model||g(0,550);this.scene=new(b("SocialVRThreeJS").Scene)();this.scene.add(this.model);if(this.$17(this.scene))new(b("SocialVRThreeJS").TextureLoader)().load("/images/asset3d/iblenv_b20_02n-30.jpg",function(c){c.mapping=b("SocialVRThreeJS").CubeUVReflectionMapping,c.minFilter=b("SocialVRThreeJS").LinearFilter,c.magFilter=b("SocialVRThreeJS").LinearFilter,a.scene.traverse(function(a){a.material&&a.material.type=="MeshStandardMaterial"&&(a.material.envMap=c,a.material.envMapIntensity=1.5,a.material.needsUpdate=!0)})});else{var c=new(b("SocialVRThreeJS").AmbientLight)(13421772,.5);this.scene.add(c)}};c.$17=function(a){var b=!1;a.traverse(function(a){a=a.material;!b&&a&&a.isMeshStandardMaterial&&!(a.extensions&&a.extensions.KHR_materials_unlit!=null)&&(b=!0)});return b};c.isValid=function(){return this.$11};c.disposeModel=function(){var a=this.model.clone();this.scene.remove(this.model);b("ThreeJsHelpers").disposeModel(this.model);this.model=a;this.scene.add(this.model)};c.$16=function(){this.$8&&(window.asset3dVrRenderer||(this.$9||g(0,551),window.asset3dVrRenderer=new(b("Asset3dVrRenderer"))({canvas2DWidth:this.$6*2,canvas2DHeight:this.$7,photoViewerProps:this.$9})),this.vrRenderer=window.asset3dVrRenderer)};c.destroy=function(){this.cameraControl&&this.cameraControl.destroy(),this.model&&this.disposeModel()};c.renderAsset3D=function(a){a===void 0&&(a=!0);var c=this.context,d=this.cameraControl;h&&h.isValid()&&c&&d&&d.isDirty()&&!b("WebXRManager").getInstance().inVr()&&(a&&d.setDirty(!1),h.render(c,this.scene,d.camera(),{width:this.$6,height:this.$7,pixelRatio:window.devicePixelRatio}))};c.getEl=function(){return this.canvas};c.resize=function(a,b){this.cameraControl.resize(a,b),this.$5||(this.canvas.width=a,this.canvas.height=b),this.cameraControl.setDirty(!0,!0)};return a}();e.exports=a}),null);
__d("Asset3dScrollTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";var g,h=60,i=500;a=function(){function a(){this.$1=new Array(i).fill({pos:0,time:0}),this.$2=0,this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$7=0,this.$8=0}var c=a.prototype;c.$9=function(){this.$4>0&&(this.$5-=this.$1[this.$2].pos,this.$2=(this.$2+1)%i,this.$4-=1)};c.$10=function(a,b){this.$1[this.$3]={pos:a,time:b},this.$5+=a,this.$3=(this.$3+1)%i,this.$4<i?this.$4+=1:(this.$5-=this.$1[this.$2].pos,this.$2=(this.$2+1)%i)};c.onScroll=function(a,c){this.$6=a,c&&(this.$7=a,this.$8=(g||(g=b("performanceNow")))())};c.samplePosition=function(){var a=(g||(g=b("performanceNow")))(),c=Math.max(a-this.$8,0);this.$7=this.$6+(this.$7-this.$6)*Math.exp(-c*.01);this.$8=a;while(this.$4>0&&a-this.$1[this.$2].time>h)this.$9();this.$10(this.$7,a);return this.$5/this.$4};return a}();e.exports=a}),null);
__d("GltfScenePerformanceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:GltfScenePerformanceLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setActiveDurationMs=function(a){this.$1.active_duration_ms=a;return this};c.setAsset3dCategory=function(a){this.$1.asset3d_category=a;return this};c.setAsset3dFeedType=function(a){this.$1.asset3d_feed_type=a;return this};c.setAsset3dID=function(a){this.$1.asset3d_id=a;return this};c.setCompressionLevel=function(a){this.$1.compression_level=a;return this};c.setCompressionType=function(a){this.$1.compression_type=a;return this};c.setCurrentStoryID=function(a){this.$1.current_story_id=a;return this};c.setEndOfFeedReached=function(a){this.$1.end_of_feed_reached=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setGltfSceneAvgRenderFrameRate=function(a){this.$1.gltf_scene_avg_render_frame_rate=a;return this};c.setIsCurrentUsersStory=function(a){this.$1.is_current_users_story=a;return this};c.setSceneURL=function(a){this.$1.scene_url=a;return this};c.setStartTimeMs=function(a){this.$1.start_time_ms=a;return this};c.setStoryCount=function(a){this.$1.story_count=a;return this};c.setStoryID=function(a){this.$1.story_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={active_duration_ms:!0,asset3d_category:!0,asset3d_feed_type:!0,asset3d_id:!0,compression_level:!0,compression_type:!0,current_story_id:!0,end_of_feed_reached:!0,event:!0,gltf_scene_avg_render_frame_rate:!0,is_current_users_story:!0,scene_url:!0,start_time_ms:!0,story_count:!0,story_id:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("GLTFSceneLoggerUtils",["GltfScenePerformanceTypedLogger"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.data={frameCount:0,timeSinceLastFPSLogMs:0,touchPanStartMs:0,fakeGyroStartMs:0},this.$1=a}var c=a.prototype;c.logNetworkLoadEvents=function(a,b,c){this.$2("gltf_scene_network_load_start",{startTimeMs:a.networkLoad.startTimeMs}),this.$2("gltf_scene_network_load_end",{activeDurationMs:a.networkLoad.durationMs,compressor:b,compressionLevel:c})};c.logGpuUploadStart=function(){this.$2("gltf_scene_gpu_upload_start")};c.logGpuUploadEnd=function(a){this.$2("gltf_scene_gpu_upload_end",{activeDurationMs:a})};c.logAverageFrameRate=function(a){this.$2("gltf_scene_avg_render_frame_rate",{averageFrameRate:a})};c.logGlbParsingEvents=function(a){this.$2("gltf_scene_glb_parsing_start",{startTimeMs:a.glbParsing.startTimeMs}),this.$2("gltf_scene_glb_parsing_end",{activeDurationMs:a.glbParsing.durationMs})};c.logOnTouchPanEnd=function(a){this.$2("gltf_scene_on_touch_pan_end",{activeDurationMs:a})};c.logOnFakeGyroEnd=function(a){if(a<1e3)return;this.$2("gltf_scene_on_fake_gyro_end_www",{activeDurationMs:a})};c.logOnWebVrRequestEnter=function(){this.$2("gltf_scene_web_request_enter",{})};c.logOnWebVrStart=function(){this.$2("gltf_scene_web_vr_start",{})};c.logOnWebVrEnd=function(a,b,c,d){this.$2("gltf_scene_web_vr_end",{activeDurationMs:a,storyCount:b,feedType:c,endOfFeedReached:d},!0)};c.logOnWebVrStoryStart=function(a,b,c){this.$2("gltf_scene_web_vr_story_start",{currentStoryID:a,isCurrentUsersStory:b,feedType:c})};c.logOnWebVrStoryEnd=function(a,b,c){this.$2("gltf_scene_web_vr_story_end",{activeDurationMs:b,currentStoryID:a,isCurrentUsersStory:c})};c.logOnWebVrFetchIDsError=function(){this.$2("gltf_scene_web_vr_fetch_ids_error")};c.logOnWebVrPastEndOfFeedError=function(){this.$2("gltf_scene_web_vr_past_end_of_feed_error")};c.logOnWebVrFetchStoryError=function(){this.$2("gltf_scene_web_vr_fetch_story_error")};c.logOnWebVrLoadGLTFError=function(){this.$2("gltf_scene_web_vr_load_gltf_error")};c.logViewportSizeError=function(){this.$2("gltf_scene_viewport_size_error")};c.$2=function(a,c,d){c===void 0&&(c={});a=new(b("GltfScenePerformanceTypedLogger"))().setEvent(a).setAsset3dID(this.$1.asset3dID).setAsset3dCategory(this.$1.asset3dCategory).setSceneURL(this.$1.sceneURL).setActiveDurationMs(c.activeDurationMs).setStartTimeMs(c.startTimeMs).setGltfSceneAvgRenderFrameRate(c.averageFrameRate);this.$1.storyTimelineID&&a.setStoryID(this.$1.storyTimelineID);var e=c.storyCount?c.storyCount:1;a.setStoryCount(e);a.setAsset3dFeedType(c.feedType);a.setIsCurrentUsersStory(c.isCurrentUsersStory);e=c.currentStoryID?c.currentStoryID:this.$1.storyTimelineID;a.setCurrentStoryID(e);d?a.logImmediately():a.log()};return a}();e.exports=a}),null);
__d("SphericalMediaMouseOverlay.react",["cx","fbt","CSS","React","ReactDOM","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React"),j=800,k=function(a){return{mouseRoot:"_3bxe _2660"+(a?" _2dz7":""),mouse:"_2661"+(a?" _2dz7":""),mouseRotate:"_2663"+(a?" _2dz7":""),mouseInner:"_2664"+(a?" _2dz7":""),mouseLeftButton:"_2666"+(a?" _2dz7":""),mouseBackground:"_15nj",mouseButtons:"_2665",mouseRightButton:"_2667",mouseBody:"_266m",mouseText:"_2662"}};a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$2=null,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentDidUpdate=function(a){var b=this;a.isActive&&!this.props.isActive?this.$2=setTimeout(function(){return b.$3()},j):!this.props.isActive?this.$3():this.props.isActive&&(this.$2!==null&&(clearTimeout(this.$2),this.$2=null),this.$4())};d.componentDidMount=function(){this.props.isActive||this.$3();var a=b("ReactDOM").findDOMNode(this);a instanceof HTMLElement&&(this.$1=a)};d.componentWillUnmount=function(){this.$1=null};d.$3=function(){this.$1&&b("CSS").addClass(this.$1,"_8b2")};d.$4=function(){this.$1&&b("CSS").removeClass(this.$1,"_8b2")};d.render=function(){var a=this.props,c=a.className;a=a.isActive;var d=this.props.copy?this.props.copy:h._("Click and drag to look around");a=k(a);return i.jsxs("div",{className:b("joinClasses")(c,a.mouseRoot),children:[i.jsx("div",{className:a.mouse,children:i.jsx("div",{className:a.mouseRotate,children:i.jsxs("div",{className:a.mouseInner,children:[i.jsx("div",{className:a.mouseBackground}),i.jsxs("div",{className:a.mouseButtons,children:[i.jsx("div",{className:a.mouseLeftButton}),i.jsx("div",{className:a.mouseRightButton})]}),i.jsx("div",{className:a.mouseBody})]})})}),i.jsx("div",{className:a.mouseText,children:d})]})};return c}(i.PureComponent);e.exports=a}),null);
__d("EnterVrButton.react",["ix","cx","fbt","invariant","AbstractButton.react","Image.react","React","SUIBusinessTheme","SUITooltip.react","asset"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this,c=k.jsx(b("Image.react"),{src:g("556058")}),d="",e="",f;this.props.inVr?(d=k.jsx("div",{className:"_6ydz",children:i._("VR mode on")}),e=i._("Exit VR")):this.props.isLoading?d=k.jsx("div",{className:"_6ydz",children:i._("Loading")}):e=i._("Enter VR");this.props.needsOverlay&&(f=k.jsx("div",{className:"_6yd-"}));d=k.jsxs("div",{children:[f,k.jsxs("div",{className:"_6yd_",children:[d,k.jsx(b("SUITooltip.react"),{ref:function(b){return a.$1=b},theme:b("SUIBusinessTheme"),tooltip:e,tooltipDelay:500,children:k.jsx(b("AbstractButton.react"),{disabled:this.props.isLoading,label:e,labelIsHidden:!0,className:"_6ye0",image:c,onClick:function(){a.props.onClickCallback(),a.__hideToolTip()}})})]})]});return d};d.__hideToolTip=function(){this.$1||j(0,5e3),this.$1.hide()};return c}(k.PureComponent);e.exports=a}),null);
__d("WebVrContainer.react",["cx","invariant","EnterVrButton.react","React","Spotlight.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={inVr:!1,isVrDeviceReady:!1,isClientReady:!1,vrCanvas:null,vrRenderWidth:0,vrRenderHeight:0},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.setDeviceReady=function(a,b,c){this.setState({isVrDeviceReady:a,vrRenderWidth:b,vrRenderHeight:c})};d.setIsClientReady=function(a){this.setState({isClientReady:a})};d.setVrOn=function(a){this.state.inVr||(this.state.vrCanvas===null||h(0,10946),a.parentElement===null||h(0,10947),this.setState({inVr:!0,vrCanvas:a}))};d.setVrOff=function(){if(this.state.inVr){var a=this.$1;a!==null&&a!==void 0||h(0,10943);var b=this.state.vrCanvas;b!==null&&b!==void 0||h(0,10944);b.parentElement===a||h(0,10945);a.removeChild(b);this.setState({inVr:!1,vrCanvas:null})}};d.componentDidUpdate=function(){if(this.state.inVr){var a=this.$1;a!==null&&a!==void 0||h(0,11040);var b=this.state.vrCanvas;b!==null&&b!==void 0||h(0,11039);a.appendChild(b)}};d.render=function(){var a=this,c;if(!this.state.isVrDeviceReady)c=i.jsx("div",{});else{var d=i.jsx(b("EnterVrButton.react"),{onClickCallback:function(){a.state.inVr?a.props.exitVrCallback():a.props.enterVrCallback()},needsOverlay:this.props.needsOverlay,inVr:this.state.inVr,isLoading:!this.state.isClientReady});if(this.state.inVr){var e={width:this.state.vrRenderWidth,maxWidth:"80vw",height:this.state.vrRenderHeight,maxHeight:"90vh",overflow:"hidden",position:"relative"};e=i.jsx(b("Spotlight.react"),{onHide:function(){a.props.exitVrCallback()},shown:this.state.inVr,rootClassName:"_6_ca",children:i.jsxs("div",{className:"_n3",style:e,children:[i.jsx("div",{ref:function(b){return a.$1=b}}),d]})});c=i.jsx("div",{children:e})}else c=i.jsx("div",{children:d})}return c};return c}(i.Component);e.exports=a}),null);
__d("Asset3dFeedViewer.react",["ix","csx","cx","fbt","invariant","Animation","Asset3dComponentContextMenu.react","Asset3dFeedViewerModalContainer.react","Asset3DFullscreenViewContainer.react","Asset3dRenderManager","Asset3dScrollTracker","Asset3DLoaderFactory","Asset3DUtils","CSS","DOM","DOMQuery","EventListener","GLTFSceneLoggerUtils","Image.react","Link.react","React","ReactDOM","ScaledImage.react","SphericalMediaMouseOverlay.react","SubscriptionsHandler","URI","WebVrContainer.react","WebXRManager","asset","getElementRect","gkx","onViewportChanged","promiseDone"],(function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l,m=b("Asset3DLoaderFactory").make("Asset3DLoader"),n=b("React"),o=360,p=.9,q=10,r=20,s=4e3,t=300,u={DISABLED:"0",DEV:"1"},v=j._("Click and drag to look around in 3D"),w=j._("Move your mouse to view the photo in 3D"),x=function(a){a=!!a.composerID||!!a.attribution;return{sphericalOverlay:a?"_1r1y":""}};function y(a){var b=a.fps;b=b===void 0?0:b;return a.isVisible?n.jsxs("ul",{className:"_6a-z",children:[n.jsx("li",{className:"_6a--",children:n.jsxs("span",{children:["AssetID: ",a.asset3dID]})}),n.jsx("li",{className:"_6a--",children:n.jsxs("span",{children:["PostID: ",a.postID||""]})}),n.jsx("li",{className:"_6a--",children:n.jsxs("span",{children:["FPS: ",(b||0).toFixed(2)]})})]}):null}function z(a){var c=a.fallbackImageURI,d=a.showErrorMsg,e=a.width;a=a.height;var f=j._("Your browser does not support 3D");if(c)return n.jsxs("div",{children:[n.jsx(b("ScaledImage.react"),{width:e,height:a,imageSize:{height:a,width:e},src:c}),n.jsx("div",{className:"_3gss",children:f})]});else{d(f);return n.jsx("div",{})}}a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={isNuxActive:!1,isSceneRendered:!1,isTooltipDisabled:!1,fps:0,debugMode:null,isRenderContextValid:!0,showModal:!1,modalSize:{width:1,height:1}},d.$5=!0,d.$6=null,d.$9=0,d.$10=!1,d.$11=0,d.$12=null,d.$17=null,d.$18=new(b("SubscriptionsHandler"))(),d.$19=!1,d.$26=function(a){var c=b("DOMQuery").find(d.props.initialViewContainer,"._623o");b("CSS").setClass(c,"_3gsr");c=b("DOM").create("div",{className:"_3gss"});b("DOM").setContent(c,a);b("DOM").appendContent(d.props.initialViewContainer,c)},d.$28=function(){d.setState({isRenderContextValid:!1})},d.onRequestAnimationFrame=function(){if(d.$4){var a=d.update();a&&(d.$6=window.requestAnimationFrame(d.onRequestAnimationFrame));d.$19=a}},d.$42=function(){var a=Math.min(d.$11/(t/1e3),60);d.setState({fps:a});d.$11=0;d.$12=window.setTimeout(d.$42,t)},d.$32=function(a){if(!d.$2)return;var c=!0,e=!0,f=b("getElementRect")(d.$2),g=a.top;a=a.bottom;c=f.top>g&&f.top<a||f.bottom>g&&f.bottom<a||g>f.top&&a<f.bottom;e=f.top>g&&f.bottom<a;c&&(d.$43(f),d.$14.cameraControl.setDirty(!0,!0));d.$14.cameraControl.setFullVisibility(e);d.$4!==c&&(d.$4=c,c?d.$38():d.$40());d.$29()},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){var a=this;this.$1&&this.$1.setIsClientReady(!0);this.$4=!1;this.$15=this.$20.bind(this);this.$21();this.$22(this.props);if(this.$2){this.$18.addSubscriptions(b("EventListener").listen(this.$2,"contextmenu",function(a){(a.shiftKey||!b("gkx")("678197"))&&a.preventDefault()}));var c=null,d=null;if(this.props.category==="photos_3d"){var e=this.props.postID;c=new(l||(l=b("URI")))("/intern/compphoto/x3d/3dphoto_console").setDomain("our.intern.facebook.com").setProtocol("https").addQueryData({ent_id:e}).toString();d=new l("/intern/compphoto/x3d/"+this.props.asset3dID+"/depth").setDomain("our.intern.facebook.com").setProtocol("https").toString()}if(this.$2 instanceof HTMLElement){e=this.props;var f=e.postID;e=e.asset3dID;e=n.jsx(b("Asset3dComponentContextMenu.react"),{asset3DID:e,postID:f,target:this.$2,fileURL:this.props.glbURI,fallbackImgURL:this.props.originalImageURI,consoleURL:c,depthImageURL:d,onToggleDevPanel:function(){return a.$23()}});b("ReactDOM").render(e,this.$2)}}};d.componentWillUnmount=function(){this.$24()};d.UNSAFE_componentWillReceiveProps=function(a){a.glbURI&&a.glbURI!==this.props.glbURI&&(this.$4=!1,this.$5=!0,this.$24(),this.$22(a),this.$25())};d.$22=function(a){var b=this,c=a.glbURI,d=a.asset3dID,e=a.actorID;a=a.statusID;var f=j._("3D post failed to load");return m.load({uri:c,assetID:d,statusID:a,actorID:e}).then(function(a){a.error?b.$26(f):b.$27(a)},function(a){b.$26(f)})};d.$21=function(){var a=this,c=this.props.vrProps;this.$14=new(b("Asset3dRenderManager"))(this.props.category,this.props.compressor,this.props.compressionLevel,this.$7,!!c,c?c.photoViewerProps:null,this.props.isModal,this.$28,{startRenderingLoop:function(){return a.$29()},update:function(){return a.update()}})};d.$29=function(){this.$19||(this.$19=!0,this.onRequestAnimationFrame())};d.$27=function(a){var c=this,d=this.$2,e=this.props,f=e.storyTimelineID,g=e.width;e=e.height;var h=a.assetID,i=a.uri;if(!i||!d)return;this.$14.onModelLoad(a.scene,g,e,a.userData,a.performanceInfo);this.$7=new(b("GLTFSceneLoggerUtils"))({asset3dID:h,asset3dCategory:this.props.category,sceneURL:i,storyTimelineID:f});this.$10=!1;this.$9=0;this.$16=new(b("Asset3dScrollTracker"))();this.$17=null;if(!d)return;this.$3=this.$14.canvas;d.appendChild(this.$3);this.$18.addSubscriptions(b("EventListener").listen(this.$3,"mousemove",function(a){if(c.$10)return;c.$9+=1;c.$9>r&&(c.$10=!0,c.setState({isNuxActive:!0}),c.$17=window.setTimeout(function(){c.setState({isNuxActive:!1})},s))}),b("EventListener").listen(this.$3,"dblclick",function(a){c.$14.cameraControl.resetCamera()}));(this.props.enableFullscreen&&!this.props.isModal&&this.props.category==="photos_3d"||this.props.category==="composer"&&b("gkx")("693522"))&&(b("EventListener").listen(this.$3,"click",function(a){c.$30()}),b("EventListener").listen(this.$3,"DOM/click",function(a){c.$30()}));g=Date.now();this.$7.logGpuUploadStart();this.$8=.5;this.$31(!1);this.$7.logGpuUploadEnd(Date.now()-g);e=this.$14.getEl();a=this.$14;if(this.props.shouldUpdateFallbackImage&&e&&a){h=b("Asset3DUtils").takeScreenshot(e);b("Asset3DUtils").saveScreenshot(h,this.props.asset3dID,this.props.actorID)}i=b("onViewportChanged")(this.$32);i.scheduleCheck();this.$13=i};d.$30=function(){var a=this.$33();this.setState({modalSize:a,showModal:!0})};d.$24=function(){this.$14&&this.$14.destroy(),this.$6!=null&&(window.cancelAnimationFrame(this.$6),this.$6=null),this.$17&&(window.clearTimeout(this.$17),this.$17=null),this.$18&&this.$18.release(),this.$34(),this.$2&&this.$3&&this.$3.parentNode===this.$2&&this.$2.removeChild(this.$3)};d.$31=function(a){this.$14.cameraControl.update(this.$8);var b=this.$14.cameraControl.isDirty();this.$14.renderAsset3D(a);return b};d.$35=function(){var a=this.$1;a||k(0,10952);var b=this.$14.vrRenderer;b||k(0,10950);a.setVrOn(b.domElement());window.cancelAnimationFrame(this.$6);this.$6=null};d.$36=function(){var a=this.$1;a||k(0,10951);a.setVrOff();this.$14.cameraControl.setDirty(!0,!0);this.$6=window.requestAnimationFrame(this.onRequestAnimationFrame)};d.$37=function(){new(b("Animation"))(this.props.initialViewContainer).to("opacity",0).duration(350).hide().go()};d.$25=function(){new(b("Animation"))(this.props.initialViewContainer).to("opacity",1).duration(0).show().go()};d.$38=function(){if(this.$5){this.props.isModal||this.$37();var a=b("DOMQuery").scry(b("ReactDOM").findDOMNode(this),"._3xkn")[0];a&&new(b("Animation"))(a).to("opacity",1).duration(700).go();this.$5=!1}this.$14.vrRenderer&&b("WebXRManager").getInstance().addXRSupportListener(this.$15);this.state.debugMode===u.DEV&&this.$39();window.requestAnimationFrame(this.onRequestAnimationFrame)};d.$40=function(){this.$14.disposeModel(),this.$14.vrRenderer&&b("WebXRManager").getInstance().removeXRSupportListener(this.$15),this.$34()};d.$20=function(a){var b=this.$1;b||k(0,11095);a?b.setDeviceReady(!0,0,0):b.setDeviceReady(!1,0,0)};d.update=function(){if(this.$4){this.$41();var a=this.$31(!0);this.state.isSceneRendered||this.setState({isSceneRendered:!0});return a}return!1};d.$41=function(){if(this.props.isModal){this.$8=.5;return}var a=this.$16.samplePosition();Math.abs(a-this.$8)>.001&&(this.$8=a,this.$14.cameraControl.setDirty(!0,!1))};d.$33=function(){var a=window.innerWidth||document.documentElement.clientWidth,b=window.innerHeight||document.documentElement.clientHeight,c=this.props.aspectRatio;(!c||c==0)&&(c=this.props.width/this.props.height);a=p*Math.min(a-o-2*q,b*c);b=a/c;return{width:a,height:b}};d.$43=function(a){if(!this.$2)return;var b=window.innerHeight||document.documentElement.clientHeight,c=0;a.height>.5*b?c=a.bottom/(b+a.height):a.top<0?c=.25*a.bottom/a.height:a.bottom>b?c=.75+.25*(a.bottom-b)/a.height:c=.25+.5*a.top/(b-a.height);this.$16.onScroll(c,this.$5);this.$5&&(this.$8=c)};d.$23=function(){var a=this.state.debugMode,b=a===u.DEV?u.DISABLED:u.DEV;a===u.DEV?this.$34():this.$39();this.setState({debugMode:b})};d.$39=function(){this.$12||(this.$12=window.setTimeout(this.$42,t))};d.$34=function(){this.$12&&(window.clearTimeout(this.$12),this.$12=null)};d.render=function(){var a=this,c=this.props.attribution,d=c?function(){var a=c.href,d=c.source,e=c.title;return n.jsx("div",{className:"_3xkn",children:n.jsxs(b("Link.react"),{href:a,target:"_blank",children:[n.jsx(b("Image.react"),{className:"_47ru",src:g("459146")}),n.jsxs("div",{className:"_47rt",children:[n.jsx("div",{className:"_72zk",children:e}),n.jsx("div",{className:"_377g",children:d?d:a})]})]})})}():null,e={overflow:"hidden",position:"relative"};this.props.background&&this.props.background!=="default"&&(e=Object.assign(e,b("Asset3DUtils").getBackgroundStyles(this.props.background,"story")));var f=x(this.props),h={height:this.props.height},i=this.props.postID,j=this.props.vrProps&&i?n.jsx(b("WebVrContainer.react"),{ref:function(b){return a.$1=b},enterVrCallback:function(){a.$7.logOnWebVrRequestEnter();var c=a.props.vrProps;c||k(0,3400);c=a.$14.vrRenderer.createVrDeviceManagerProps(a.props.category,a.$14.model,null,i,c.navigationProps,a.$14.userData,a.$7,a.$35.bind(a),a.$36.bind(a));b("promiseDone")(b("WebXRManager").getInstance().enterVr(c))},exitVrCallback:function(){b("promiseDone")(b("WebXRManager").getInstance().exitVr())},needsOverlay:d===null}):null,l=null;if(this.props.enableFullscreen&&this.state.showModal){var m=this.state.modalSize;this.$14.cameraControl.resize(m.width,m.height);var o=this.$14.cameraControl.camera();this.props.category==="photos_3d"?l=n.jsx(b("Asset3dFeedViewerModalContainer.react"),{scene:this.$14.scene,camera:o,viewportInfo:{width:m.width,height:m.height,pixelRatio:1},asset3DInfo:{horizontalFov:this.$14.cameraControl.getHorizontalFov()||0,verticalFov:this.$14.cameraControl.getVerticalFov()||0},onExit:function(){a.setState({showModal:!1,isSceneRendered:!0}),a.$14.cameraControl.resize(a.props.width,a.props.height),a.$31(!0)},storyID:this.props.storyID}):l=n.jsx(b("Asset3DFullscreenViewContainer.react"),{model:this.$14.scene,cameraPosition:o.position,viewportInfo:{width:m.width,height:m.height,pixelRatio:1},onExit:function(){a.setState({showModal:!1})},storyID:this.props.storyID,backgroundType:this.props.background})}if(this.state.isRenderContextValid){o=this.props.initialViewContainer;o.style.position="absolute";return n.jsxs("div",{children:[l,n.jsxs("div",{style:e,tabIndex:0,children:[n.jsx("div",{style:h,ref:function(b){return a.$2=b}}),n.jsx(b("SphericalMediaMouseOverlay.react"),{className:f.sphericalOverlay,isActive:this.state.isNuxActive,copy:this.props.category==="photos_3d"?w:v}),n.jsx("div",{className:"_34-b",ref:"nuxAnchor"}),d,j,n.jsx(y,{isVisible:this.state.debugMode===u.DEV,fps:this.state.fps,asset3dID:this.props.asset3dID,postID:this.props.postID})]})]})}else{this.props.fallbackImageURI&&this.$37();return n.jsx(z,{width:this.props.width,height:this.props.height,fallbackImageURI:this.props.fallbackImageURI,showErrorMsg:this.$26})}};return c}(n.Component);a.defaultProps={enableFullscreen:!0,storyTimelineID:null,storyID:null,statusID:null,asset3dID:"",postID:"",glbURI:null,compressor:null,compressionLevel:null,attribution:null,width:0,height:0,aspectRatio:0,composerID:null,background:null,shouldUpdateFallbackImage:!1,vrProps:null,fallbackImageURI:null,originalImageURI:null};e.exports=a}),null);